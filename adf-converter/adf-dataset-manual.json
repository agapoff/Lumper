[
  {
    "key": "SA-3065",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The debug version installed manually or with Xamarin Studio works. Release build signed with real cert does not work."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "There is an exception message: "
            },
            {
              "type": "text",
              "text": "3635/? W/WindowManager: Token{2a2d108 ActivityRecord{b5e76ab u0 com.cryptzone.appgate.xdp/md593195132c581f2d639295d9deb1c789f.SplashActivity t2314}} failed creating starting window android.view.InflateException: Binary XML file line #35: Binary XML file line #35: Error inflating class <unknown>",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Full log:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "https://www.chromestatus.com/features/6750456638341120](https://www.chromestatus.com/features/6750456638341120)"
            },
            {
              "type": "text",
              "text": " for more details.\", source:  (0)\n\n06-14 12:30:41.980 3591-4758/? D/MdnieScenarioControlService:  packageName : com.cryptzone.appgate.xdp    className : md593195132c581f2d639295d9deb1c789f.MainActivity\n\n06-14 12:30:41.990 3591-4674/? D/CustomFrequencyManagerService: releaseDVFSLockLocked : Getting Lock type frm List : DVFS\\_MIN\\_LIMIT  frequency : 2600000  uid : 1000  pid : 3591  tag : LAUNCHER\\_APP\\_BOOSTER\\_CPU@7\n\n06-14 12:30:42.070 5035-5035/? D/Recents: onTaskStackChanged\n\n06-14 12:30:42.080 3591-4758/? I/MdnieScenarioControlService: mGameModeLauncher : false\n\n06-14 12:30:42.090 3591-4758/? I/MdnieScenarioControlService: setUIMode\n\n06-14 12:30:42.350 15019-15019/? I/chromium: \\[INFO:CONSOLE(14)\\] \"ipc.on called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (14)\n\n06-14 12:30:42.350 15019-15019/? I/chromium: \\[INFO:CONSOLE(14)\\] \"ipc.on called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (14)\n\n06-14 12:30:42.360 15019-15019/? I/chromium: \\[INFO:CONSOLE(14)\\] \"ipc.on called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (14)\n\n06-14 12:30:42.510 15019-15019/? I/chromium: \\[INFO:CONSOLE(0)\\] \"/deep/ combinator is deprecated. See ["
            },
            {
              "type": "text",
              "text": "https://www.chromestatus.com/features/6750456638341120](https://www.chromestatus.com/features/6750456638341120)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "06-14 12:30:37.680 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.700 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.720 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.740 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.760 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.780 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.800 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.820 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.840 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.860 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.880 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.900 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.920 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.940 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.960 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:37.980 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.000 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.020 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.040 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.060 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.080 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.100 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.120 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.140 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.160 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.180 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.200 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.220 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.240 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.260 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.280 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.300 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.320 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.340 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.360 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.380 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.400 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.420 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.440 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.460 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.480 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.500 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.520 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.540 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.560 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.580 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.600 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.620 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.640 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.660 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.680 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.700 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.720 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.740 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.760 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.780 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.800 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.820 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.840 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.860 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.880 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.900 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.920 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.940 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.950 3591-4683/? D/BatteryService: !@BatteryListener : batteryPropertiesChanged!\n\n06-14 12:30:38.950 3591-4683/? D/BatteryService: level:39, scale:100, status:2, health:2, present:true, voltage: 3805, temperature: 324, technology: Li-ion, AC powered:false, USB powered:true, POGO powered:false, Wireless powered:false, icon:17303413, invalid charger:0, maxChargingCurrent:0\n\n06-14 12:30:38.950 3591-4683/? D/BatteryService: online:4, current avg:222, charge type:1, power sharing:false, high voltage charger:false, capacity:280000, batterySWSelfDischarging:false, current\\_now:254\n\n06-14 12:30:38.950 3591-3591/? D/BatteryService: Sending ACTION\\_BATTERY\\_CHANGED.\n\n06-14 12:30:38.960 3591-3591/? I/MotionRecognitionService: Plugged\n\n06-14 12:30:38.960 3591-3591/? D/MotionRecognitionService:   cableConnection= 1\n\n06-14 12:30:38.960 3591-3591/? D/MotionRecognitionService: setPowerConnected | current backoffstate  = 1024 , state =1024\n\n06-14 12:30:38.960 3591-3591/? D/MotionRecognitionService: skip setTransmitPower. \n\n06-14 12:30:38.960 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n                                                    \n\n                                                    --------- beginning of main\n\n06-14 12:30:38.970 3591-4727/? D/WifiController: ApOrStaEnabledState  msg.what= 155652\n\n06-14 12:30:38.970 4959-4959/? D/KeyguardUpdateMonitor: received broadcast android.intent.action.BATTERY\\_CHANGED\n\n06-14 12:30:38.970 4959-4959/? D/KeyguardUpdateMonitor: handleBatteryUpdate\n\n06-14 12:30:38.970 4959-4959/? D/PowerUI: priorPlugType = 2 mPlugType =  2\n\n06-14 12:30:38.970 4959-4959/? D/PowerUI.Notification: showChargingNotice oldChargingType : 1 currentChargingType : 1 oldChargingTime : 16863000 mChargingTime : 16863000\n\n06-14 12:30:38.970 4959-4959/? D/PowerUI.Notification: There is no change about charging status, so return!\n\n06-14 12:30:38.980 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:38.990 5932-5932/? V/HeadsetService: HeadsetService - Received Intent.ACTION\\_BATTERY\\_CHANGED\n\n06-14 12:30:38.990 5932-6297/? D/HeadsetStateMachine: Disconnected process message: 10, size: 0\n\n06-14 12:30:39.010 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.020 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:30:39.020 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.020 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:30:39.030 3591-4655/? D/ApplicationPolicy: isStatusBarNotificationAllowedAsUser: packageName = com.devuni.flashlight,userId = 0\n\n06-14 12:30:39.040 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.060 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.070 3591-3591/? D/MARsPolicyManager: NotificationListenerService OngoingNotificationPosted"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " com.devuni.flashlight\n\n06-14 12:30:39.080 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.080 5177-5189/? D/CatchNotificationsService: onNotificationPosted\n\n06-14 12:30:39.090 3591-3915/? I/TLC\\_TIMA\\_PKM\\_measure\\_kernel: TIMA: response\\_id = 3\n\n06-14 12:30:39.090 3591-3915/? I/TLC\\_TIMA\\_PKM\\_measure\\_kernel: TIMA: response ret = 0, result\\_ondemand = MSG=Kernel Verification Success;\n\n06-14 12:30:39.100 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.100 13130-13140/? D/BadgeProvider: query, \\[selection\\] : null\n\n06-14 12:30:39.100 4959-4959/? D/PhoneStatusBar: setAreThereNotifications: N=3 any=true clearable=false\n\n06-14 12:30:39.110 4959-4959/? D/NotificationStackScrollLayout:  scroll range should be extended : 1600\n\n06-14 12:30:39.110 3591-3915/? D/TimaService: TIMA MEASUREMENT Result: TIMA\\_STATUS=0;MSG=Kernel Verification Success;\n\n06-14 12:30:39.110 3591-3915/? D/TimaService: TIMA MEASUREMENT success status: TIMA\\_STATUS=0;MSG=Kernel Verification Success;\n\n06-14 12:30:39.110 5177-5189/? E/CatchNotificationsService: Invalid notification data\n\n06-14 12:30:39.120 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.140 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.160 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.180 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.200 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.220 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.240 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.260 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.280 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.300 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.320 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.340 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.360 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.380 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.400 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.420 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.440 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.460 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.480 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.500 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.520 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.540 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.560 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.580 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.600 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.620 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.640 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.660 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.680 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.700 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.720 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.740 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.760 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.780 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.800 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.820 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.840 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.860 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.880 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.900 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.920 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.940 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.960 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:39.980 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.000 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.020 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.040 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.060 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.080 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.100 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.120 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.140 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.160 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.180 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.200 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.220 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.240 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.260 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.280 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.300 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.320 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.340 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.360 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.380 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.400 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.420 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.440 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.460 3591-4662/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.480 3591-4699/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.500 3591-4651/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.520 3591-4234/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.540 3591-3612/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.560 3591-4674/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.580 3591-4711/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.600 3591-4665/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.620 3591-3613/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.640 3591-4678/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.660 3591-4704/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.680 3591-4655/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.700 3591-4697/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.720 3591-4688/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.740 3591-4671/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.760 3591-4683/? D/RestrictionPolicy: userId: 0, isMicrophoneEnabledAsUser : true\n\n06-14 12:30:40.780 3591-4662/? "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " : type : DVFS\\_MIN\\_LIMIT  frequency : 1872000  uid : 1000  pid : 3591  pkgName : ACTIVITY\\_RESUME\\_BOOSTER@8\n\n06-14 12:30:41.030 3591-4665/? D/CustomFrequencyManagerService: FrequencyrequestList.getNextCStateDisableRequest, index: 2\n\n06-14 12:30:41.030 3591-4665/? D/ActivityManager: mDVFSHelper.acquire()\n\n06-14 12:30:41.030 3591-4665/? V/WindowManager: addAppToken: AppWindowToken{d0748a5dd token=Token{f17f5b4 ActivityRecord{68bd287 u0 com.cryptzone.appgate.xdp/md593195132c581f2d639295d9deb1c789f.MainActivity t2314}}} to stack=2 task=2314 at 1\n\n06-14 12:30:41.030 7655-9195/? I/TrayUsageStatesWatcher: notePauseComponent : ComponentInfo{com.cryptzone.appgate.xdp/md593195132c581f2d639295d9deb1c789f.SplashActivity}\n\n06-14 12:30:41.030 3591-4665/? D/InputDispatcher: Focused application set to: xxxx\n\n06-14 12:30:41.040 3166-3166/? I/APM::AudioPolicyManager: stopInput() input 33\n\n06-14 12:30:41.040 5302-13542/? I/MicroRecognitionRunner: Stopping hotword detection.\n\n06-14 12:30:41.040 5302-15044/? I/MicroRecognitionRunner: Detection finished\n\n06-14 12:30:41.040 3166-15046/? I/audio\\_hw\\_primary: do\\_in\\_standby : in->standby 0\n\n06-14 12:30:41.040 3591-7999/? D/ConnectivityService: returning getNetworkInfo for network type 1 : \\[type: WIFI\\[\\] - WIFI, state: CONNECTED/CONNECTED, reason: (unspecified), extra: \"INT-Guest\", roaming: false, failover: false, isAvailable: true\\]\n\n06-14 12:30:41.040 3591-3625/? V/BroadcastQueue: \\[background\\] Process cur broadcast BroadcastRecord{4491023 u0 update-hint qIdx=4}, state= (APP\\_RECEIVE) DELIVERED for app ProcessRecord{ec123cc 5302:com.google.android.googlequicksearchbox:search/u0a70}\n\n06-14 12:30:41.050 3166-15046/? V/audio\\_hw\\_primary: select\\_devices output\\_scenario:-1 input\\_scenario:-1 out\\_snd\\_device 0x0 in\\_snd\\_device:0x0\n\n06-14 12:30:41.050 3166-15046/? I/audio\\_route: > audio\\_route\\_reset :\n\n06-14 12:30:41.050 3166-15046/? I/audio\\_route: > audio\\_route\\_update\\_mixer : +\n\n06-14 12:30:41.060 15019-15019/? D/SecWifiDisplayUtil: Metadata value : SecSettings2\n\n06-14 12:30:41.060 15019-15019/? D/ViewRootImpl: #1 mView = com.android.internal.policy.PhoneWindow$DecorView{616b4d1 I.E...... R.....I. 0,0-0,0}\n\n06-14 12:30:41.060 15019-15062/? D/OpenGLRenderer: Use EGL\\_SWAP\\_BEHAVIOR\\_PRESERVED: true\n\n06-14 12:30:41.060 3591-4683/? D/ISSUE\\_DEBUG: InputChannelName : 6a0474c com.cryptzone.appgate.xdp/md593195132c581f2d639295d9deb1c789f.SplashActivity\n\n06-14 12:30:41.060 3591-4234/? D/ActivityManager: post active user change for 0 fullscreen true isFloatingActivity() false isHomeActivity() false\n\n06-14 12:30:41.060 3591-4234/? D/KnoxTimeoutHandler: postActiveUserChange \\[MsgParam\\] userId: 0 fullscreen is true showWhenlocked is false\n\n06-14 12:30:41.060 3591-3591/? D/KnoxTimeoutHandler: handleActiveUserChange \\[MsgParam\\] userId: 0 fullscreen is true showWhenlocked is false\n\n06-14 12:30:41.070 3591-3591/? I/KnoxTimeoutHandler: Shared devices show user statefalse\n\n06-14 12:30:41.070 7655-7666/? I/TrayUsageStatesWatcher: noteResumeComponent : ComponentInfo{com.cryptzone.appgate.xdp/md593195132c581f2d639295d9deb1c789f.MainActivity} Intent { cmp=com.cryptzone.appgate.xdp/md593195132c581f2d639295d9deb1c789f.MainActivity VirtualScreenParam=Params{mDisplayId=-1, null, mFlags=0x00000000)} }\n\n06-14 12:30:41.070 3591-3591/? D/GameManagerService: NotifyRunnable. pkg: com.cryptzone.appgate.xdp, type: 4, isMinimized: false, isTunableApp: false\n\n06-14 12:30:41.080 3003-3003/? I/SurfaceFlinger: id=84 createSurf (1440x2560),1 flag=4, TplashActiv\n\n06-14 12:30:41.080 3166-15046/? I/audio\\_route: > audio\\_route\\_update\\_mixer : changed(5) -\n\n06-14 12:30:41.080 3166-15046/? I/audio\\_hw\\_primary: select\\_devices - \n\n06-14 12:30:41.080 3166-3651/? V/audio\\_hw\\_primary: stop\\_voice\\_note\\_recording\n\n06-14 12:30:41.080 3166-3651/? E/audio\\_hw\\_primary: adev\\_close\\_input\\_stream, set jack\\_in to null\n\n06-14 12:30:41.080 3591-3625/? V/MARsPolicyManager: updatePackagesScore PackageInfo name -- com.cryptzone.appgate.xdp\n\n06-14 12:30:41.080 15019-15062/? D/libEGL: eglInitialize EGLDisplay = 0xdc7ff7c4\n\n06-14 12:30:41.080 15019-15062/? I/OpenGLRenderer: Initialized EGL, version 1.4\n\n                                                   \n\n                                                   \\[ 06-14 12:30:41.080 15019:15062 D/         \\]\n\n                                                   ro.exynos.dss isEnabled: 0\n\n06-14 12:30:41.090 15019-15062/? D/mali\\_winsys: new\\_window\\_surface returns 0x3000,  \\[1440x2560\\]-format:1\n\n06-14 12:30:41.100 15019-15019/? W/ResourcesManager: getTopLevelResources: /data/app/com.cryptzone.appgate.xdp-1/base.apk / 1.0 running in com.cryptzone.appgate.xdp rsrc of package com.cryptzone.appgate.xdp\n\n06-14 12:30:41.100 15019-15019/? D/RelationGraph: garbageCollect()\n\n06-14 12:30:41.100 15019-15019/? I/WebViewFactory: Loading com.google.android.webview version 51.0.2704.81 (code 270408150)\n\n06-14 12:30:41.120 15019-15019/? W/ResourcesManager: getTopLevelResources: /data/app/com.google.android.webview-1/base.apk / 1.0 running in com.cryptzone.appgate.xdp rsrc of package com.google.android.webview\n\n06-14 12:30:41.120 15019-15019/? D/ResourcesManager: For user 0 new overlays fetched Null\n\n06-14 12:30:41.120 15019-15019/? I/InjectionManager: Inside getClassLibPath caller \n\n06-14 12:30:41.130 15019-15019/? I/cr\\_LibraryLoader: Time to load native libraries: 2 ms (timestamps 9219-9221)\n\n06-14 12:30:41.130 15019-15019/? I/cr\\_LibraryLoader: Expected native library version number \"51.0.2704.81\", actual native library version number \"51.0.2704.81\"\n\n06-14 12:30:41.130 15019-15019/? V/WebViewChromiumFactoryProvider: Binding Chromium to main looper Looper (main, tid 1) {c80cd0d}\n\n06-14 12:30:41.130 15019-15019/? I/cr\\_LibraryLoader: Expected native library version number \"51.0.2704.81\", actual native library version number \"51.0.2704.81\"\n\n06-14 12:30:41.130 15019-15019/? I/chromium: \\[INFO:library\\_loader\\_hooks.cc(143)\\] Chromium logging enabled: level = 0, default verbosity = 0\n\n06-14 12:30:41.140 15019-15019/? I/cr\\_BrowserStartup: Initializing chromium process, singleProcess=true\n\n06-14 12:30:41.150 15019-15019/? D/libEGL: eglInitialize EGLDisplay = 0xffb9675c\n\n                                           \n\n                                           \\[ 06-14 12:30:41.150 15019:15019 D/         \\]\n\n                                           ro.exynos.dss isEnabled: 0\n\n06-14 12:30:41.160 3591-3613/? D/ActivityManager: The following uid has registered to recieve broadcast for proxy related updates 10237\n\n06-14 12:30:41.160 3591-3613/? W/ContextImpl: Calling a method in the system process without a qualified user: android.app.ContextImpl.sendBroadcast:845 com.android.server.am.ActivityManagerService.requestKnoxVpnToSendProxyBroadcast:29676 com.android.server.am.ActivityManagerService.registerReceiver:22546 android.app.ActivityManagerNative.onTransact:431 com.android.server.am.ActivityManagerService.onTransact:3986 \n\n06-14 12:30:41.160 3591-3591/? D/KnoxVpnEngineService: Vpn Receiver : send\\_knoxvpn\\_proxy\\_broadcast\n\n06-14 12:30:41.160 3591-4690/? I/KnoxVpnEngineService: vpn handle : Message received\n\n06-14 12:30:41.170 15019-15086/? W/cr\\_media: Requires BLUETOOTH permission\n\n06-14 12:30:41.170 3591-4714/? D/NetworkPolicy: isUidForegroundLocked: 10019, mScreenOn: true, uidstate: 2, mProxSensorScreenOff: false\n\n06-14 12:30:41.200 15019-15019/? D/cr\\_Ime: \\[InputMethodManagerWrapper.java:30\\] Constructor\n\n06-14 12:30:41.200 15019-15019/? W/cr\\_AwContents: onDetachedFromWindow called when already detached. Ignoring\n\n06-14 12:30:41.200 15019-15019/? D/cr\\_Ime: \\[InputMethodManagerWrapper.java:59\\] isActive: false\n\n06-14 12:30:41.210 15019-15019/? W/art: JNI RegisterNativeMethods: attempt to register 0 native methods for md593195132c581f2d639295d9deb1c789f.WebAppInterface\n\n06-14 12:30:41.220 15019-15019/? I/cr\\_Ime: ImeThread is not enabled.\n\n06-14 12:30:41.230 15019-15019/? D/cr\\_Ime: \\[InputMethodManagerWrapper.java:30\\] Constructor\n\n06-14 12:30:41.230 15019-15019/? W/cr\\_AwContents: onDetachedFromWindow called when already detached. Ignoring\n\n06-14 12:30:41.230 15019-15019/? D/cr\\_Ime: \\[InputMethodManagerWrapper.java:59\\] isActive: false\n\n06-14 12:30:41.230 15019-15097/? E/libEGL: validate\\_display:255 error 3008 (EGL\\_BAD\\_DISPLAY)\n\n06-14 12:30:41.230 15019-15097/? D/libEGL: eglInitialize EGLDisplay = 0xd8d3f3dc\n\n06-14 12:30:41.230 15019-15019/? I/cr\\_Ime: ImeThread is not enabled.\n\n06-14 12:30:41.240 15019-15019/? D/Activity: performCreate Call Injection manager\n\n06-14 12:30:41.240 15019-15097/? W/AudioCapabilities: Unsupported mime audio/mpeg-L1\n\n06-14 12:30:41.240 15019-15097/? W/AudioCapabilities: Unsupported mime audio/mpeg-L2\n\n06-14 12:30:41.240 15019-15019/? I/InjectionManager: dispatchOnViewCreated > Target : md593195132c581f2d639295d9deb1c789f.MainActivity isFragment :false\n\n06-14 12:30:41.240 15019-15097/? W/AudioCapabilities: Unsupported mime audio/x-ms-wma\n\n06-14 12:30:41.240 15019-15019/? D/SecWifiDisplayUtil: Metadata value : SecSettings2\n\n06-14 12:30:41.240 15019-15097/? W/AudioCapabilities: Unsupported mime audio/x-ima\n\n06-14 12:30:41.240 15019-15019/? D/ViewRootImpl: #1 mView = com.android.internal.policy.PhoneWindow$DecorView{b50d9a0["
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " for more details.\", source:  (0)\n\n06-14 12:30:42.560 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:42.560 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:42.560 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:42.570 15019-15019/? I/chromium: \\[INFO:CONSOLE(17)\\] \"ipc.send called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (17)\n\n06-14 12:30:42.680 15019-15019/? I/chromium: \\[INFO:CONSOLE(17)\\] \"ipc.send called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (17)\n\n06-14 12:30:43.580 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:43.580 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:43.590 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:44.010 3591-4815/? W/System.err: remove failed: ENOENT (No such file or directory) : /data/system/recent\\_tasks/2314\\_task.xml.bak\n\n06-14 12:30:44.600 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:44.600 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:44.600 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:45.050 3591-7999/? D/SSRM:n: SIOP:: AP = 380, PST = 383 (W:10), CP = 315, CUR = 222, LCD = 115\n\n06-14 12:30:45.070 3591-7999/? D/ConnectivityService: returning getNetworkInfo for network type 1 : \\[type: WIFI\\[\\] - WIFI, state: CONNECTED/CONNECTED, reason: (unspecified), extra: \"INT-Guest\", roaming: false, failover: false, isAvailable: true\\]\n\n06-14 12:30:45.620 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:45.620 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:45.620 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:46.630 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:46.630 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:46.640 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:47.060 3591-7999/? D/ConnectivityService: returning getNetworkInfo for network type 1 : \\[type: WIFI\\[\\] - WIFI, state: CONNECTED/CONNECTED, reason: (unspecified), extra: \"INT-Guest\", roaming: false, failover: false, isAvailable: true\\]\n\n06-14 12:30:47.650 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:47.650 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:47.650 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:48.670 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:30:48.670 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:30:48.670 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:30:48.980 3591-4655/? D/PackageManager: setEnabledSetting : userId = 0 packageName = com.google.android.gms cmp = com.google.android.gms.icing.proxy.SmsMonitor newState = 1 callingPackage = 10019\n\n06-14 12:30:49.010 3591-4674/? D/BatteryService: !@BatteryListener : batteryPropertiesChanged!\n\n06-14 12:30:49.010 3591-4674/? D/BatteryService: level:39, scale:100, status:2, health:2, present:true, voltage: 3813, temperature: 323, technology: Li-ion, AC powered:false, USB powered:true, POGO powered:false, Wireless powered:false, icon:17303413, invalid charger:0, maxChargingCurrent:0\n\n06-14 12:30:49.010 3591-4674/? D/BatteryService: online:4, current avg:201, charge type:1, power sharing:false, high voltage charger:false, capacity:280000, batterySWSelfDischarging:false, current\\_now:395\n\n06-14 12:30:49.010 3591-3591/? D/BatteryService: Sending ACTION\\_BATTERY\\_CHANGED.\n\n06-14 12:30:49.020 3591-3591/? I/MotionRecognitionService: Plugged\n\n06-14 12:30:49.020 3591-3591/? D/MotionRecognitionService:   cableConnection= 1\n\n06-14 12:30:49.020 3591-3591/? D/MotionRecognitionService: setPowerConnected | current backoffstate  = 1024 , state =1024\n\n06-14 12:30:49.020 3591-3591/? D/MotionRecognitionService: skip setTransmitPower. \n\n06-14 12:30:49.020 3591-4727/? D/WifiController: ApOrStaEnabledState  msg.what= 155652\n\n06-14 12:30:49.020 4959-4959/? D/KeyguardUpdateMonitor: received broadcast android.intent.action.BATTERY\\_CHANGED\n\n06-14 12:30:49.020 4959-4959/? D/KeyguardUpdateMonitor: handleBatteryUpdate\n\n06-14 12:30:49.030 4959-4959/? D/PowerUI: priorPlugType = 2 mPlugType =  2\n\n06-14 12:30:49.030 4959-4959/? D/PowerUI.Notification: showChargingNotice oldChargingType : 1 currentChargingType : 1 oldChargingTime : 16863000 mChargingTime : 16863000\n\n06-14 12:30:49.030 4959-4959/? D/PowerUI.Notification: There is no change about charging status, so "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  setCAProperty(ContextAwareService.java:584) - \\[setProperty 02\\] Mutex is unlocked for DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR\n\n06-14 12:31:11.600 3591-4671/? W/CAE: registerCallback(ContextAwareService.java:144) - \\[regi 01\\] Mutex is locked for DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR\n\n06-14 12:31:11.600 5194-5194/? I/PeopleStripeService: sendEdgeNotification  peopleEnabled true lightingEnabled true edgeEnabled true\n\n06-14 12:31:11.600 5194-5194/? I/PeopleDataManager: removeNotification\n\n06-14 12:31:11.600 5194-5194/? I/NotificationParser: getNotiType:com.microsoft.skydrive,null\n\n06-14 12:31:11.600 5194-5194/? D/PeopleDataManager: removeNotiInfo: id =666,packageName=com.microsoft.skydrive,isEdgeNotification=false,key=null,removeAll=false\n\n06-14 12:31:11.600 5194-5194/? D/PeopleDataManager: removeNotiInfo =null\n\n06-14 12:31:11.600 6038-6038/? D/BatteryController: saveBatteryData : level\\[39\\], status\\[2\\]\n\n06-14 12:31:11.600 6038-6038/? D/AODService: Cover coverOpen\\[true\\], isBlackListCover(type)\\[false\\]\n\n06-14 12:31:11.600 6038-6038/? D/AODService.ClockTimer: ClockTimer:start : true\n\n06-14 12:31:11.600 3591-4671/? V/CAE: start(ContextProvider.java:128)\n\n06-14 12:31:11.610 3591-4671/? V/CAE: clear(DevicePhysicalContextMonitorRunner.java:497)\n\n06-14 12:31:11.610 3591-4671/? V/CAE: enable(DevicePhysicalContextMonitorRunner.java:471)\n\n06-14 12:31:11.610 3591-4671/? I/CAE: sendCmdToSensorHub(SensorHubCommManager.java:162) - -79, 56, 0, 10, 31, 11,\n\n06-14 12:31:11.610 3591-4671/? D/SensorHubManager: SendSensorHubData: send data = -79, 56, 0, 10, 31, 11\n\n06-14 12:31:11.610 3173-3215/? D/Sensorhubs: sendContextData: -79, 56, 0, 10, 31, 11\n\n06-14 12:31:11.610 3591-4671/? D/CAE: getFaultDetectionResult(DevicePhysicalContextMonitorRunner.java:521) - true\n\n06-14 12:31:11.610 6038-6038/? D/AODService.ClockTimer: observe start aod\n\n06-14 12:31:11.610 6038-6038/? D/AODService.ClockTimer: notifyWakeUp\n\n06-14 12:31:11.610 3591-4671/? I/CAE: notifyCmdProcessResultObserver(ContextProvider.java:627) - CheckResult = 0, Cause = Success\n\n06-14 12:31:11.620 6038-6038/? V/BatteryController: getBatteryLevel\\[39.0\\], batteryStatus\\[2\\]\n\n06-14 12:31:11.620 3591-4655/? D/SecContentProvider: query(), uri = 17 selection = isSettingsChangesAllowed\n\n06-14 12:31:11.620 3591-4655/? D/SettingsProvider: isChangeAllowed() : name = aod\\_show\\_state\n\n06-14 12:31:11.620 3591-4655/? D/SettingsProvider: edmUri: content://com.sec.knox.provider/RestrictionPolicy3\n\n06-14 12:31:11.620 3591-4655/? D/SettingsProvider: projectionArgs: isSettingsChangesAllowed\n\n06-14 12:31:11.620 3591-4655/? D/SettingsProvider: selectionArgs: false\n\n06-14 12:31:11.620 3591-4655/? D/SettingsProvider: selectionArgs: 10000\n\n06-14 12:31:11.620 3591-4655/? D/RestrictionPolicy: isSettingsChangesAllowedAsUser, userId 0 : true\n\n06-14 12:31:11.620 3591-4655/? D/SettingsProvider: ret = 1\n\n06-14 12:31:11.630 3591-4671/? D/CAE: doCommendProcess(ContextAwareService.java:433) - complete notify the operation result.\n\n06-14 12:31:11.630 6038-6038/? E/SettingsUtils: setAODShowState  config = 1\n\n06-14 12:31:11.630 3591-4671/? I/CAE: displayUsedCountForService(ContextAwareService.java:525) - totalCnt = 1, serviceCount = 1, subCollectionCount = 0\n\n06-14 12:31:11.630 3591-4671/? D/CAE: showListenerList(ContextAwareService.java:366) - ===== Context Aware Service List =====\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@be795ca, Service : PEDOMETER(1)\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@8041817, Service : ACTIVITY\\_TRACKER\\_BATCH(1)\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@95cded, Service : STEP\\_LEVEL\\_MONITOR(1)\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@d847ac4, Service : SENSOR\\_STATUS\\_CHECK\\_RUNNER(1)\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@9774aa9, Service : ACTIVITY\\_TRACKER\\_CURRENT\\_INFO(1)\n\n06-14 12:31:11.630 6038-6038/? D/AlpmModeManager: setFirstStartALPM() initialize value\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@9774aa9, Service : ACTIVITY\\_TRACKER(1)\n\n06-14 12:31:11.630 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@7d35f06, Service : ANY\\_MOTION\\_DETECTOR\\_RUNNER(1)\n\n06-14 12:31:11.640 3591-3600/? I/art: Background partial concurrent mark sweep GC freed 255933(13MB) AllocSpace objects, 57(1140KB) LOS objects, 23% free, 50MB/66MB, paused 2.196ms total 250.480ms\n\n06-14 12:31:11.640 3591-4671/? I/CAE: showListenerList(ContextAwareService.java:375) - Listener : com.samsung.android.contextaware.manager.ContextAwareService$Listener@b4b5661, Service : DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR(1)\n\n06-14 12:31:11.640 3591-4671/? W/CAE: registerCallback(ContextAwareService.java:180) - \\[regi 02\\] Mutex is unlocked for DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR\n\n06-14 12:31:11.640 6038-6038/? D/AODService: createWindow\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: \u00a0\u00a0\u00a0\u00a0.registerCallback : 6, client=\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: ===== SContext Service List =====\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@57a833b, Service : Step Level Monitor\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@57a833b, Service : Pedometer\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@1df7404, Service : Activity Batch\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@6682dad, Service : Sensor Status Check\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@e83abf4, Service : Any Motion Detector\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@ecf2ef4, Service : Activity Tracker\n\n06-14 12:31:11.640 3591-4671/? D/SContextService: Listener : android.hardware.scontext.SContextService$Listener@36b8586, Service : Device Physical Context Monitor\n\n06-14 12:31:11.650 6038-15145/? D/SContextManager:   .registerListener : listener = com.samsung.android.app.aodservice.AODService$7@a2cc353, service=Device Physical Context Monitor\n\n06-14 12:31:11.650 6038-6038/? I/AODUpdatePositionController: initPosition : X\\[22\\], Y\\[82\\] Rect(-50, 0 - 50, 920)\n\n06-14 12:31:11.660 3591-3649/? D/SurfaceControl: Excessive delay in setPowerMode(): 170ms\n\n06-14 12:31:11.660 3591-3649/? D/PowerManagerUtil: Excessive delay in !@display\\_state: OFF: 171ms\n\n06-14 12:31:11.660 3591-3649/? D/PowerManagerUtil: Excessive delay in DisplayManagerInternal.requestDesiredDisplayState: 177ms\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: animateScreenStateChange\\[0\\]: target=1\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: \\[Dual Screen Compatible\\] state\\[0\\] :1\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: getFinalBrightness : Summary is 0 -> 0\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: Animating brightness: target=0, rate=0 (PSM:false, AB limit:(-1 ~ -1) MB Limit:(-1 ~ 255))\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\] Off : 0s ago\n\n06-14 12:31:11.660 3591-3638/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_enable\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]   PowerManagerService.WakeLocks: ref count=1\n\n06-14 12:31:11.660 3591-3638/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_enable done\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]     mWakeLockSummary : 0x1\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]       PARTIAL\\_WAKE\\_LOCK              '\\*sync\\*/media/com.microsoft.skydrive/eM\\_ADDR' (uid=1000, pid=3591, ws=WorkSource{10123}) (elapsedTime=340)\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]       PARTIAL\\_WAKE\\_LOCK              'AlwaysOnDisplay\\_EnsureWorkingTime' (uid=10000, pid=6038, ws=null) (elapsedTime=84)\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]   PowerManagerService.Display: ref count=2\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]     mUserActivitySummary : 0x4\n\n06-14 12:31:11.660 3591-3638/? I/PowerManagerService: \\[PWL\\]     mDisplayReady : false\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: animateScreenStateChange\\[0\\]: target=1\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: \\[Dual Screen Compatible\\] state\\[0\\] :1\n\n06-14 12:31:11.660 3591-3638/? D/DisplayPowerController: getFinalBrightness :"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " cableConnection= 1\n\n06-14 12:31:19.200 3591-3591/? D/MotionRecognitionService: setPowerConnected | current backoffstate  = 1024 , state =1024\n\n06-14 12:31:19.200 3591-3591/? D/MotionRecognitionService: skip setTransmitPower. \n\n06-14 12:31:19.200 3591-4727/? D/WifiController: ApOrStaEnabledState  msg.what= 155652\n\n06-14 12:31:19.210 4959-4959/? D/KeyguardUpdateMonitor: received broadcast android.intent.action.BATTERY\\_CHANGED\n\n06-14 12:31:19.210 4959-4959/? D/KeyguardUpdateMonitor: handleBatteryUpdate\n\n06-14 12:31:19.210 4959-4959/? D/PowerUI: priorPlugType = 2 mPlugType =  2\n\n06-14 12:31:19.210 4959-4959/? D/PowerUI.Notification: showChargingNotice oldChargingType : 1 currentChargingType : 1 oldChargingTime : 16834000 mChargingTime : 16834000\n\n06-14 12:31:19.210 4959-4959/? D/PowerUI.Notification: There is no change about charging status, so return!\n\n06-14 12:31:19.220 5932-5932/? V/HeadsetService: HeadsetService - Received Intent.ACTION\\_BATTERY\\_CHANGED\n\n06-14 12:31:19.230 5932-6297/? D/HeadsetStateMachine: Disconnected process message: 10, size: 0\n\n06-14 12:31:19.250 6038-6038/? D/BatteryController: saveBatteryData : level\\[39\\], status\\[2\\]\n\n06-14 12:31:19.250 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:31:19.260 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:31:19.270 3591-4234/? D/ApplicationPolicy: isStatusBarNotificationAllowedAsUser: packageName = com.devuni.flashlight,userId = 0\n\n06-14 12:31:19.300 3591-3591/? D/MARsPolicyManager: NotificationListenerService OngoingNotificationPosted : com.devuni.flashlight\n\n06-14 12:31:19.310 5177-5653/? D/CatchNotificationsService: onNotificationPosted\n\n06-14 12:31:19.320 4959-4959/? D/PhoneStatusBar: setAreThereNotifications: N=3 any=true clearable=false\n\n06-14 12:31:19.330 13130-13141/? D/BadgeProvider: query, \\[selection\\] : null\n\n06-14 12:31:19.330 4959-4959/? D/NotificationStackScrollLayout:  scroll range should be extended : 1600\n\n06-14 12:31:19.330 5177-5653/? E/CatchNotificationsService: Invalid notification data\n\n06-14 12:31:20.750 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:31:20.750 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:31:20.750 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n                                             contents\\_sample\\_state: \\[ agr({\\[1\\]=3, \\[1 ,1 ,5\\]=18, \\[1 ,5 ,7 ,15 ,15\\]=1, \\[1 ,1 ,5 ,5 ,12\\]=1, \\[1 ,1 ,5 ,5 ,7 ,15\\]=2, \\[1 ,5 ,17\\]=1, \\[1 ,13\\]=1, \\[1 ,1 ,5 ,5 ,7\\]=1, \\[7 ,12 ,12\\]=2, \\[1 ,1 ,1 ,1 ,5 ,5 ,5 ,5 ,15 ,12\\]=1, \\[12 ,15\\]=8, \\[7 ,15 ,12\\]=1, \\[1 ,1 ,5 ,5 ,7 ,12\\]=5, \\[1 ,1 ,5 ,15 ,12\\]=1, \\[1 ,5 ,7 ,12 ,15\\]=3, \\[1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1\\]=1, \\[1 ,1 ,5 ,15\\]=8, \\[1 ,5 ,12\\]=5, \\[1 ,1 ,1 ,1 ,5 ,5 ,5 ,5 ,7 ,15\\]=2, \\[1 ,5\\]=177, \\[1 ,5 ,7 ,15\\]=30, \\[1 ,1 ,5 ,7\\]=2, \\[1 ,1 ,5 ,5 ,7 ,15 ,12 ,12\\]=1, \\[12 ,12 ,12\\]=1, \\[7 ,12\\]=52, \\[7\\]=437, \\[7 ,12 ,15\\]=4, \\[1 ,1 ,5 ,7 ,15 ,12\\]=3, \\[1 ,5 ,7 ,15 ,12 ,17\\]=1, \\[1 ,5 ,7\\]=17, \\[12\\]=101, \\[1 ,1 ,5 ,5 ,7 ,15 ,12\\]=1, \\[1 ,5 ,7 ,15 ,12\\]=6, \\[1 ,5 ,15\\]=71, \\[1 ,1 ,5 ,7 ,12 ,12\\]=1, \\[1 ,5 ,15 ,12\\]=2, \\[1 ,1 ,5 ,7 ,15 ,12 ,12\\]=1, \\[1 ,5 ,15 ,15\\]=1, \\[5 ,15\\]=1, \\[2\\]=18, \\[5 ,2\\]=1, \\[1 ,5 ,7 ,15 ,12 ,12\\]=1, \\[1 ,1 ,5 ,5\\]=1, \\[1 ,1 ,1 ,5 ,5\\]=1, \\[15 ,12 ,12\\]=1, \\[1 ,5 ,15 ,15 ,12\\]=1, \\[1 ,5 ,5 ,5 ,5 ,5 ,5 ,5 ,7 ,15\\]=1, \\[1 ,1 ,5 ,7 ,15\\]=4, \\[5\\]=31, \\[1 ,5 ,12 ,12\\]=1, \\[5 ,5 ,17\\]=1, \\[1 ,1 ,5 ,5 ,15 ,15\\]=1, \\[1 ,5 ,7 ,12\\]=13, \\[7 ,15 ,12 ,15 ,17\\]=1, \\[1 ,12\\]=1})  \\]\n\n06-14 12:31:22.200 3591-7999/? D/SSRM:n: SIOP:: AP = 350, PST = 366 (W:14), CP = 304, CUR = 359, LCD = 1\n\n06-14 12:31:24.010 3591-5175/? E/Watchdog: !@Sync 20 \\[06-14 12:31:24.020\\]\n\n06-14 12:31:26.260 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:31:26.270 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:31:26.270 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:31:27.280 3591-3925/? V/AlarmManager: Expired Alarm result :8\n\n06-14 12:31:29.240 3591-4651/? D/BatteryService: !@BatteryListener : batteryPropertiesChanged!\n\n06-14 12:31:29.240 3591-4651/? D/BatteryService: level:39, scale:100, status:2, health:2, present:true, voltage: 3826, temperature: 321, technology: Li-ion, AC powered:false, USB powered:true, POGO powered:false, Wireless powered:false, icon:17303413, invalid charger:0, maxChargingCurrent:0\n\n06-14 12:31:29.240 3591-4651/? D/BatteryService: online:4, current avg:423, charge type:1, power sharing:false, high voltage charger:false, capacity:280000, batterySWSelfDischarging:false, current\\_now:489\n\n06-14 12:31:29.250 3591-4651/? D/BatteryService: stay LED for charging\n\n06-14 12:31:29.250 3591-3591/? D/BatteryService: Sending ACTION\\_BATTERY\\_CHANGED.\n\n06-14 12:31:29.250 3591-3591/? I/MotionRecognitionService: Plugged\n\n06-14 12:31:29.250 3591-3591/? D/MotionRecognitionService:   cableConnection= 1\n\n06-14 12:31:29.250 3591-3591/? D/MotionRecognitionService: setPowerConnected | current backoffstate  = 1024 , state =1024\n\n06-14 12:31:29.250 3591-3591/? D/MotionRecognitionService: skip setTransmitPower. \n\n06-14 12:31:29.260 3591-4727/? D/WifiController: ApOrStaEnabledState  msg.what= 155652\n\n06-14 12:31:29.260 4959-4959/? D/KeyguardUpdateMonitor: received broadcast android.intent.action.BATTERY\\_CHANGED\n\n06-14 12:31:29.260 4959-4959/? D/KeyguardUpdateMonitor: handleBatteryUpdate\n\n06-14 12:31:29.260 4959-4959/? D/PowerUI: priorPlugType = 2 mPlugType =  2\n\n06-14 12:31:29.270 4959-4959/? D/PowerUI.Notification: showChargingNotice oldChargingType : 1 currentChargingType : 1 oldChargingTime : 16834000 mChargingTime : 16834000\n\n06-14 12:31:29.270 4959-4959/? D/PowerUI.Notification: There is no change about charging status, so return!\n\n06-14 12:31:29.280 5932-5932/? V/HeadsetService: HeadsetService - Received Intent.ACTION\\_BATTERY\\_CHANGED\n\n06-14 12:31:29.280 5932-6297/? D/HeadsetStateMachine: Disconnected process message: 10, size: 0\n\n06-14 12:31:29.300 6038-6038/? D/BatteryController: saveBatteryData : level\\[39\\], status\\[2\\]\n\n06-14 12:31:29.310 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:31:29.310 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:31:29.320 3591-3613/? D/ApplicationPolicy: isStatusBarNotificationAllowedAsUser: packageName = com.devuni.flashlight,userId = 0\n\n06-14 12:31:29.370 3591-3591/? D/MARsPolicyManager: NotificationListenerService OngoingNotificationPosted : com.devuni.flashlight\n\n06-14 12:31:29.380 5177-5189/? D/CatchNotificationsService: onNotificationPosted\n\n06-14 12:31:29.400 4959-4959/? D/PhoneStatusBar: setAreThereNotifications: N=3 any=true clearable=false\n\n06-14 12:31:29.400 13130-14358/? D/BadgeProvider: query, \\[selection\\] : null\n\n06-14 12:31:29.410 5177-5189/? E/CatchNotificationsService: Invalid notification data\n\n06-14 12:31:29.410 4959-4959/? D/NotificationStackScrollLayout:  scroll range should be extended : 1600\n\n06-14 12:31:31.190 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:31:31.190 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:31:31.190 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:31:31.350 3591-3625/? I/ActivityManager: setMaxStartingBackgroundTimer onfinish\n\n06-14 12:31:31.350 3591-3625/? I/ActivityManager: MaxStartingBackground is set. ( current : 8 )\n\n06-14 12:31:31.650 3591-6030/? V/MARsPolicyManager: updatePackagesScore PackageInfo name -- null\n\n06-14 12:31:31.650 3591-6030/? V/MARsPolicyManager: updateSMDBValues\n\n06-14 12:31:31.650 3591-3633/? E/MARsDBManager: updateDBAll : begin --size 1\n\n06-14 12:31:31.700 3591-8159/? W/ContextImpl: Calling a method in the system process without a qualified user: android.app.ContextImpl.sendBroadcast:830 com.absolute.android.persistservice.a.run:1244 java.lang.Thread.run:818 <bottom of call stack> <bottom of call stack> \n\n06-14 12:31:31.700 3591-3633/? E/MARsDBManager: updateDBAll : end\n\n06-14 12:31:31.700 3591-3633/? D/MARsDBManager: onChange - mSmartManagerObserver! Uri = content://com.samsung.android.sm/AppFreezer?MARs-self=true&MARs=true\n\n06-14 12:31:32.230 3591-7999/? D/SSRM:n: SIOP:: AP = 340, PST = 363 (W:14), CP = 301, CUR = 423, LCD = 1\n\n06-14 12:31:33.370 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:31:33.370 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:31:33.370 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:31:36.980 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:31:36.990 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:31:36.990 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:31:39.300 3591-4699/? D/BatteryService: !@BatteryListener : batteryPropertiesChanged!\n\n06-14 12:31:39.300 3591-4699/? D/BatteryService: level:39, scale:100, status:2, health:2, present:true, voltage: 3821, temperature: 319, technology: Li-ion, AC powered:false, USB powered:true, POGO powered:false, Wireless powered:false, icon:17303413, invalid charger:0, maxChargingCurrent:0\n\n06-14 12:31:39.300 3591-4699/? D/BatteryService: online:4, current avg:442, charge type:1, power sharing:false, high voltage charger:false, capacity:280000, batterySWSelfDischarging:false, current\\_now:375\n\n06-14 12:31:39.300 3591-4699/? D/BatteryService: stay LED for charging\n\n06-14 12:31:39.300 3591-3591/? D/BatteryService: Sending ACTION\\_BATTERY\\_CHANGED.\n\n06-14 12:31:39.310 3591-3591/? I/MotionRecognitionService: Plugged\n\n06-14 12:31:39.310 3591-3591/? D/MotionRecognitionService:   )"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "3591-3591/? D/MotionRecognitionService:   cableConnection= 1\n\n06-14 12:31:59.420 3591-3591/? D/MotionRecognitionService: setPowerConnected | current backoffstate  = 1024 , state =1024\n\n06-14 12:31:59.420 3591-3591/? D/MotionRecognitionService: skip setTransmitPower. \n\n06-14 12:31:59.430 3591-4727/? D/WifiController: ApOrStaEnabledState  msg.what= 155652\n\n06-14 12:31:59.430 4959-4959/? D/KeyguardUpdateMonitor: received broadcast android.intent.action.BATTERY\\_CHANGED\n\n06-14 12:31:59.430 4959-4959/? D/KeyguardUpdateMonitor: handleBatteryUpdate\n\n06-14 12:31:59.430 4959-4959/? D/PowerUI: priorPlugType = 2 mPlugType =  2\n\n06-14 12:31:59.440 4959-4959/? D/PowerUI.Notification: showChargingNotice oldChargingType : 1 currentChargingType : 1 oldChargingTime : 16809000 mChargingTime : 16809000\n\n06-14 12:31:59.440 4959-4959/? D/PowerUI.Notification: There is no change about charging status, so return!\n\n06-14 12:31:59.450 5932-5932/? V/HeadsetService: HeadsetService - Received Intent.ACTION\\_BATTERY\\_CHANGED\n\n06-14 12:31:59.450 5932-6297/? D/HeadsetStateMachine: Disconnected process message: 10, size: 0\n\n06-14 12:31:59.470 6038-6038/? D/BatteryController: saveBatteryData : level\\[39\\], status\\[2\\]\n\n06-14 12:31:59.480 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:31:59.480 4959-4959/? D/BatteryMeterView: ACTION\\_BATTERY\\_CHANGED : level:39 status:2 health:2\n\n06-14 12:31:59.490 3591-4678/? D/ApplicationPolicy: isStatusBarNotificationAllowedAsUser: packageName = com.devuni.flashlight,userId = 0\n\n06-14 12:31:59.530 3591-3591/? D/MARsPolicyManager: NotificationListenerService OngoingNotificationPosted : com.devuni.flashlight\n\n06-14 12:31:59.540 5177-14352/? D/CatchNotificationsService: onNotificationPosted\n\n06-14 12:31:59.550 4959-4959/? D/PhoneStatusBar: setAreThereNotifications: N=3 any=true clearable=false\n\n06-14 12:31:59.550 13130-13140/? D/BadgeProvider: query, \\[selection\\] : null\n\n06-14 12:31:59.560 5177-14352/? E/CatchNotificationsService: Invalid notification data\n\n06-14 12:31:59.560 4959-4959/? D/NotificationStackScrollLayout:  scroll range should be extended : 1600\n\n06-14 12:31:59.990 3591-3925/? V/AlarmManager: Expired Alarm result :8\n\n06-14 12:32:00.750 15019-15019/? I/chromium: \\[INFO:CONSOLE(362)\\] \"WebSocket connection to 'ws://localhost:29000/live' failed: Error in connection establishment: net::ERR\\_CONNECTION\\_REFUSED\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (362)\n\n06-14 12:32:00.750 15019-15019/? I/chromium: \\[INFO:CONSOLE(393)\\] \"we have a error:\", source: [file:///android\\_asset/mobile/bower\\_components/smackbone-live/out/smackbone-live.js](file:///android_asset/mobile/bower_components/smackbone-live/out/smackbone-live.js) (393)\n\n06-14 12:32:00.750 15019-15019/? I/chromium: \\[INFO:CONSOLE(30)\\] \"Disconnected from daemon\", source: [file:///android\\_asset/mobile/elements/app-data/connection.js](file:///android_asset/mobile/elements/app-data/connection.js) (30)\n\n06-14 12:32:00.860 3591-3925/? V/AlarmManager: Expired Alarm result :4\n\n06-14 12:32:00.860 3591-3925/? V/AlarmManager: Send whitelist package alarm :PendingIntent{514200c: PendingIntentRecord{9d7d55 com.samsung.android.app.aodservice broadcastIntent}}\n\n06-14 12:32:00.870 3591-3591/? V/AlarmManager: \\_\\_\\_SyncScheduler (v3) ACTIVATED\\_\\_\\_\n\n06-14 12:32:00.870 7465-7465/? I/PedometerService: onStartCommand  true, true, false\n\n06-14 12:32:00.870 3591-3591/? V/AlarmManagerEXT: <AppSync3 Whitelist>\n\n06-14 12:32:00.870 3591-3591/? V/AlarmManagerEXT: (AppSync) com.google.android.gms : 300(300)\n\n06-14 12:32:00.870 3591-4699/? D/SContextService: updateSContext() : event = Sensor Status Check\n\n06-14 12:32:00.870 3591-3591/? V/AlarmManagerEXT: (AppSync) ### 1 added ###\n\n06-14 12:32:00.870 3591-4699/? D/SContextService: requestToUpdate() : service = Sensor Status Check\n\n06-14 12:32:00.870 4959-4959/? D/KeyguardUpdateMonitor: received broadcast android.intent.action.TIME\\_TICK\n\n06-14 12:32:00.880 7465-7465/? D/SContextManager:   .requestToUpdate : listener = com.samsung.android.app.shealth.tracker.pedometer.service.logger.PedometerNoAccelerometerLogger@3b7b068, service=Sensor Status Check\n\n06-14 12:32:00.880 4959-4959/? D/KeyguardUpdateMonitor: handleTimeUpdate\n\n06-14 12:32:00.890 4959-4959/? D/Clock: received broadcast android.intent.action.TIME\\_TICK\n\n06-14 12:32:00.970 4959-4959/? D/DateView: received broadcast android.intent.action.TIME\\_TICK\n\n06-14 12:32:01.100 6038-6038/? D/AODService.ClockTimer: onReceive : com.samsung.android.app.aodservice.ClockTimer.TICK, mWakeUp = true\n\n06-14 12:32:01.100 6038-6038/? V/BatteryController: getBatteryLevel\\[39.0\\], batteryStatus\\[2\\]\n\n06-14 12:32:01.100 3591-4234/? W/CAE: setCAProperty(ContextAwareService.java:578) - \\[setProperty 01\\] Mutex is locked for DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR\n\n06-14 12:32:01.110 3591-4234/? I/CAE: setPropertyValue(DevicePhysicalContextMonitorRunner.java:155) - Get status\n\n06-14 12:32:01.110 3591-4234/? I/CAE: sendCmdToSensorHub(SensorHubCommManager.java:162) - -72, 56, 1, 1,\n\n06-14 12:32:01.110 3591-4234/? D/SensorHubManager: SendSensorHubData: send data = -72, 56, 1, 1\n\n06-14 12:32:01.110 3173-15148/? D/Sensorhubs: sendContextData: -72, 56, 1, 1\n\n06-14 12:32:01.120 3591-4234/? I/CAE: setCAProperty(ContextAwareService.java:583) - result : true\n\n06-14 12:32:01.120 3591-4234/? W/CAE: setCAProperty(ContextAwareService.java:584) - \\[setProperty 02\\] Mutex is unlocked for DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR\n\n06-14 12:32:01.120 3591-4234/? D/SContextService: requestToUpdate() : service = Device Physical Context Monitor\n\n06-14 12:32:01.120 6038-6038/? D/SContextManager:   .requestToUpdate : listener = com.samsung.android.app.aodservice.AODService$7@a2cc353, service=Device Physical Context Monitor\n\n06-14 12:32:01.120 6038-6038/? I/AlpmModeManager: startAlpmMode : state  = BLANK\n\n06-14 12:32:01.130 6038-6038/? D/DefaultClockView: Window showed. Time views updating\n\n06-14 12:32:01.130 3591-4674/? D/PowerManagerService: \\[api\\] acquire WakeLock flags=0x80 tag=Window:AOD uid=1000 pid=3591\n\n06-14 12:32:01.130 3591-4674/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_disable\n\n06-14 12:32:01.130 3591-4674/? D/PowerManagerService: mDisplayReady: false\n\n06-14 12:32:01.130 3591-4674/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_disable done\n\n06-14 12:32:01.130 3591-3638/? D/DisplayPowerController: animateScreenStateChange\\[0\\]: target=3\n\n06-14 12:32:01.130 6038-6038/? D/AODUpdatePositionController: updatePosition: direction\\[1\\] updatePosition: X\\[21\\] Y\\[81\\] NewPositionTimer\\[59\\]\n\n06-14 12:32:01.130 3591-4674/? D/PowerManagerService: \\[PWL\\] sb acquire: PowerManagerService.Display\n\n06-14 12:32:01.130 3591-3638/? D/DisplayPowerController: \\[Dual Screen Compatible\\] state\\[0\\] :3\n\n06-14 12:32:01.130 3591-3638/? D/DisplayPowerController: getFinalBrightness : Summary is 1 -> 1\n\n06-14 12:32:01.130 3591-3638/? D/DisplayPowerController: Animating brightness: target=1, rate=2000 (PSM:false, AB limit:(-1 ~ -1) MB Limit:(-1 ~ 255))\n\n06-14 12:32:01.130 3591-3649/? D/DisplayManagerService: !@display\\_state: DOZE\\_SUSPEND -> DOZE brightness: 1 -> 1\n\n06-14 12:32:01.140 3591-3635/? I/DisplayManagerService: Display device changed state: \"Built-in Screen\", DOZE\n\n06-14 12:32:01.140 3591-3635/? I/DisplayManagerService: Display device changed state: \"ActivityViewVirtualDisplay\", DOZE\n\n06-14 12:32:01.140 3003-3003/? D/SurfaceFlinger: Set power mode=1, type=0 flinger=0x7fb0a43c00\n\n06-14 12:32:01.140 3003-3003/? I/hwcomposer: int exynos\\_setPowerMode(hwc\\_composer\\_device\\_1\\*, int, int):: disp(0), mode(1)\n\n06-14 12:32:01.140 6038-6038/? D/DefaultClockView: LocalTime Pattern : HH:mm\n\n06-14 12:32:01.150 3173-3214/? D/Sensorhubs: readContextData: 1, 1, 56, 1, 1, 1, 1\n\n06-14 12:32:01.150 6038-6038/? D/TimeViewHolder: onTimeUpdate: timeZone:libcore.util.ZoneInfo\\[id=\"Europe/Stockholm\",mRawOffset=3600000,mEarliestRawOffset=3600000,mUseDst=true,mDstSavings=3600000,transitions=118\\] isSplitHour:false isSingleView:false isAMPMonLeft:null time01: 12:32 time02: null ampm: null\n\n06-14 12:32:01.160 3591-3928/? D/SensorHubManager: onGetSensorHubDataLocked: library(7) = 1, 1, 56, 1, 1, 1, 1\n\n06-14 12:32:01.160 3591-3927/? I/CAE: sendCmdToSensorHub(SensorHubCommManager.java:162) - -63, 14, 10, 32, 1,\n\n06-14 12:32:01.160 3591-3927/? D/SensorHubManager: SendSensorHubData: send data = -63, 14, 10, 32, 1\n\n06-14 12:32:01.170 3591-3638/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_enable\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: animateScreenStateChange\\[0\\]: target=3\n\n06-14 12:32:01.170 3591-3638/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_enable done\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: \\[Dual Screen Compatible\\] state\\[0\\] :3\n\n06-14 12:32:01.170 3173-3173/? D/Sensorhubs: sendContextData: -63, 14, 10, 32, 1\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: getFinalBrightness : Summary is 1 -> 1\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: Animating brightness: target=1, rate=2000 (PSM:false, AB limit:(-1 ~ -1) MB Limit:(-1 ~ 255))\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: animateScreenStateChange\\[0\\]: target=3\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: \\[Dual Screen Compatible\\] state\\[0\\] :3\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: getFinalBrightness : Summary is 1 -> 1\n\n06-14 12:32:01.170 3591-3638/? D/DisplayPowerController: Animating brightness: target=1, rate=2000 (PSM:false, AB limit:(-1 ~ -1) MB Limit:(-1 ~ 255))\n\n06-14 12:32:01.170 3591-3638/? D/PowerManagerService: \\[s\\] DisplayPowerCallbacks : onStateChanged()\n\n06-14 12:32:01.170 3591-3638/? D/PowerManagerService: mDisplayReady: true\n\n06-14 12:32:01.170 3591-3638/? D/PowerManagerService: \\[PWL\\] sb release: PowerManagerService.Display\n\n06-14 12:32:01.180 7655-7655/? E/CocktailBarPositionManager: Window direction: 0\n\n06-14 12:32:01.180 7655-7655/? I/CocktailBarPositionManager: updateAlphaScreenPosition position is dirty 0\n\n06-14 12:32:01.190 3591-3927/? D/CAE: onGetSensorHubData(SensorHubParserProvider.java:92) - onGetSensorHubData Event \\[event buffer len :7\\], AP\\_SLEEP\n\n06-14 12:32:01.190 3591-3927/? I/CAE: parse(SensorHubParserProvider.java:188) - buffer size = 7\n\n06-14 12:32:01.190 3591-3927/? I/CAE: parse(SensorHubParserProvider.java:199) - 1, 1, 56, 1, 1, 1, 1,\n\n06-14 12:32:01.190 3591-3927/? D/CAE: display(ContextProvider.java:375) - ================= DEVICE\\_PHYSICAL\\_CONTEXT\\_MONITOR =================\n\n06-14 12:32:01.190 3591-3927/? I/CAE: display(ContextProvider.java:391) - AODReason=\\[1\\], AODStatus=\\[1\\], DataType=\\[1\\]\n\n06-14 12:32:01.190 3591-3930/? D/SContextService: updateSContext() : event = Device Physical Context Monitor\n\n06-14 12:32:01.200 6038-6038/? D/RoamingTimeViewHolder: isRomingClockset true\n\n06-14 12:32:01.200 6038-6038/? D/RoamingTimeViewHolder: getHomeCalendar: homecity\\_timezone : Europe/Luxembourg (libcore.util.ZoneInfo\\[id=\"Europe/Luxembourg\",mRawOffset=3600000,mEarliestRawOffset=3600000,mUseDst=true,mDstSavings=3600000,transitions=184\\])\n\n06-14 12:32:01.200 6038-6038/? D/RoamingTimeViewHolder: onTimeUpdate: isVisible:true timeZone:libcore.util.ZoneInfo\\[id=\"Europe/Luxembourg\",mRawOffset=3600000,mEarliestRawOffset=3600000,mUseDst=true,mDstSavings=3600000,transitions=184\\] text:Tue, Jun 14 12:32\n\n06-14 12:32:01.200 6038-6038/? I/AODService.ClockTimer: startAlarm : TICK\n\n06-14 12:32:01.200 3591-4655/? V/AlarmManager: Add whitelist package alarm :PendingIntent{a98758a: PendingIntentRecord{9d7d55 com.samsung.android.app.aodservice broadcastIntent}}\n\n06-14 12:32:01.210 6038-6038/? I/AlpmModeManager: handleUnblankDisplay: state  = BLANK\n\n06-14 12:32:01.210 6038-6038/? V/AlpmModeManager: updateAlpmMode: setDoze \\[DISPLAY\\_STATE\\_DOZE\\_SUSPEND\\]\n\n06-14 12:32:01.210 3591-4671/? I/PowerManagerService: \\[api\\] setDozeOverrideFromAod AlpmHlpmSysfs = -1, screenState = 4, Brightness = 0, wakefulness = false\n\n06-14 12:32:01.210 3591-4671/? D/PowerManagerService: setDozeModeBySysfs:  value is -1 , we ignore it. \n\n06-14 12:32:01.220 6038-6038/? I/AODService: onSContextChanged: AODScreenShown state is already true\n\n06-14 12:32:01.220 6038-6038/? D/DefaultClockView: RootView invalidate()\n\n06-14 12:32:01.220 3591-4674/? D/PowerManagerService: \\[api\\] acquire WakeLock flags=0x80 tag=Window:AOD uid=1000 pid=3591\n\n06-14 12:32:01.370 3591-3591/? D/PowerManagerService: \\[api\\] release WakeLock flags=0x80 tag=Window:AOD uid=1000 pid=3591 (0x0)\n\n06-14 12:32:01.370 3591-3591/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_disable\n\n06-14 12:32:01.370 3591-3591/? D/PowerManagerService: mDisplayReady: false\n\n06-14 12:32:01.370 3591-3591/? I/libsuspend: !@autosuspend\\_wakeup\\_count\\_disable done\n\n06-14 12:32:01.370 3591-3638/? D/DisplayPowerController: animateScreenStateChange\\[0\\]:"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Logs from clean phone > install XDP > start XDP (attached as log.txt)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "With the threading fix, both Daemon and VPN services are logged as started but UI still cannot connect to WS channel on Daemon."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1465982040775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Will look more into 0.5mb debug logs but the upcoming debug menu can help also: "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-3080",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-3080"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1466414757673
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Kurt had a phone with a Build.Serial longer than 16 bytes :)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/1004",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/1004"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1470821371505
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Why didn't the exception pop out in the logs do you know "
                },
                {
                  "type": "text",
                  "text": "Per Allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                        "title": "per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1472479284748
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I have no idea why. It just silently crashed. The XML parsing error is completely unrelated, and harmless, although I fixed that one too."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1472479910819
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok then, GG!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1472480829991
      }
    ]
  },
  {
    "key": "SA-14994",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "No journal logs after restore from 5.2 to 5.3"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "root@envy-172-17-124-1:~# cz-restore --keep-network backup_envy-172-17-122-1.devops_2020-09-29_12_44.tar.bz \nKeeping current network settings\n[screen is terminating]\n[screen is terminating]\nroot@envy-172-17-124-1:~# journalctl -f\nNo journal files were found.\n^C\nroot@envy-172-17-124-1:~# journalctl -f\nNo journal files were found.\n\n\n^C\nroot@envy-172-17-124-1:~# ls -l /etc/machine-id \n-r--r--r-- 1 root root 33 Sep 29 12:46 /etc/machine-id\nroot@envy-172-17-124-1:~# journalctl -f\nNo journal files were found.\n^C\nroot@envy-172-17-124-1:~# cat /etc/machine-id \n3c2604ad19d84d34bfb9c51c5e00a175\nroot@envy-172-17-124-1:~# journalctl -f\nNo journal files were found.\n^C\nroot@envy-172-17-124-1:~# ls\nbackup_envy-172-17-122-1.devops_2020-09-29_12_44.tar.bz\nroot@envy-172-17-124-1:~# cat /etc/jou^C\nroot@envy-172-17-124-1:~# systemctl systemd-journald\nUnknown operation systemd-journald.\nroot@envy-172-17-124-1:~# systemctl restart systemd-journald\nroot@envy-172-17-124-1:~# journalctl -f\n-- Logs begin at Tue 2020-09-29 12:50:00 UTC. --\nSep 29 12:50:00 envy-172-17-124-1.devops systemd[1]: Starting Journal Service...\nSep 29 12:50:00 envy-172-17-124-1.devops systemd-journald[31650]: Journal started\nSep 29 12:50:00 envy-172-17-124-1.devops systemd-journald[31650]: System journal (/var/log/journal/3c2604ad19d84d34bfb9c51c5e00a175) is 8.0M, max 5.5G, 5.5G free.\nSep 29 12:50:00 envy-172-17-124-1.devops rsyslogd[30811]: imjournal: journal reloaded... [v8.1908.0 try "
            },
            {
              "type": "text",
              "text": "https://www.rsyslog.com/e/0"
            },
            {
              "type": "text",
              "text": " ]\nSep 29 12:50:00 envy-172-17-124-1.devops systemd[1]: Starting Flush Journal to Persistent Storage...\nSep 29 12:50:00 envy-172-17-124-1.devops systemd[1]: Started Journal Service.\nSep 29 12:50:00 envy-172-17-124-1.devops systemd[1]: Started Flush Journal to Persistent Storage.\nSep 29 12:50:00 envy-172-17-124-1.devops cz-proxyd[28669]: INFO    [2020-09-29T12:50:00.988Z] [M 7fceccac5c80] [3] New connection from 172.17.124.2:26458\nSep 29 12:50:00 envy-172-17-124-1.devops cz-proxyd[28669]: ERROR   [2020-09-29T12:50:00.988Z] [M 7fceccac5c80] [spalib] spa_decrypt(): Failed to decrypt/authenticate the data\nSep 29 12:50:00 envy-172-17-124-1.devops cz-proxyd[28669]: ERROR   [2020-09-29T12:50:00.988Z] [M 7fceccac5c80] [7] SPA-TCP message from 172.17.124.2:26458 failed to get authorized. Dropping!\n^C\n"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is when restoring a backup from one appliance to another, so the machine id changes. I think we need to restart systemd-journald if the machine id changes."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1601383981990
      }
    ]
  },
  {
    "key": "SA-14984",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "hmm couple of issues with my Android this morning. First issue is that SAML token renewal screen was not shown on top after wakeup. It just showed the disconnect launchpanel. After reauth connection did not came back"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here are my droid 10 logs:"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1601365966471
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And yesterdays logs "
                },
                {
                  "type": "text",
                  "text": "https://appgate.slack.com/files/UU44MBN2D/F01C9P0ANFJ/log-2020-09-28.log",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://appgate.slack.com/files/UU44MBN2D/F01C9P0ANFJ/log-2020-09-28.log"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1601366279527
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2020-09-29T05:06:06.789Z\\] Info : 2FA required while updating claims token at '["
                },
                {
                  "type": "text",
                  "text": "https://purple10.appgate.com/'](https://purple10.appgate.com/')"
                },
                {
                  "type": "text",
                  "text": "."
                },
                {
                  "type": "text",
                  "text": "\n\n\\[2020-09-29T05:06:06.831Z\\] Info : Initializing on-boarding OTP seed.\n\n\\[2020-09-29T05:06:07.065Z\\] Info : OTP seed is already initialized for this user.\n\n\\[2020-09-29T05:06:08.936Z\\] Info : 'UI': User action renew-saml seems to be removed. Going back to status view.\n\n\\[2020-09-29T05:06:14.242Z\\] Info : 'UI': Submitting user action respondMotd."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " Hmm, MFA renewal never showed up for some reason?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1601393643400
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jamie's logs going crazy is the amount of route changes. I believe we talked about that already."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1601393842695
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like a combination of "
                },
                {
                  "type": "text",
                  "text": "SA-15005",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-15005"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and another issue of suddenly this starting to happen whole app-wise"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SAML token renewal screen was not shown on top after wakeup"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There was a task for this but we couldn't figure out why it's happening nor reproduce "
                },
                {
                  "type": "text",
                  "text": "SA-14254",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-14254"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1601457579682
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, still can't reproduce. Closing this one."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1601458759382
      }
    ]
  },
  {
    "key": "SA-14859",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "First start a prepared upgrade using controller, upload or download gives the same result: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ python3 appgate-upgrade.pyz prepare ec2-3-95-132-40.compute-1.amazonaws.com:444 --no-verify --yes AppGate-SDP-5.2.1.img.zip --ignore-target-version"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " For upload, ctrl-c while the file is uploading, on 5.1 versions it worked by using username+password to trigger that bug."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Then its impossible to delete the file: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ python3 appgate-upgrade.pyz cancel ec2-3-95-132-40.compute-1.amazonaws.com:444 --no-verify --yes --delete-image-from-controller AppGate-SDP-5.2.1.img.zip\n20:26:50 Discovering peer API version for "
            },
            {
              "type": "text",
              "text": "https://ec2-3-95-132-40.compute-1.amazonaws.com:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n20:26:50 Peer API version is 13\n20:26:50 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://ec2-3-95-132-40.compute-1.amazonaws.com:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n20:26:51 Authentication succeeded\n20:26:51 Authorizing...\n20:26:54 \n20:26:54 Cancel upgrade plan:\n20:26:54 1. Delete upgrade image AppGate-SDP-5.2.1.img.zip from controller\n20:26:54 \n20:26:54 1. Delete upgrade image AppGate-SDP-5.2.1.img.zip from controller\n20:26:54 Deleting appliance upgrade image file AppGate-SDP-5.2.1.img.zip from controller\n20:26:54 DELETE /admin/files/AppGate-SDP-5.2.1.img.zip: HTTP Error 422: {\"id\":\"unprocessable entity\",\"message\":\"'AppGate-SDP-5.2.1.img.zip' is still being uploaded. Please try later.\"}. Retrying in 3 seconds ...\n20:26:58 DELETE /admin/files/AppGate-SDP-5.2.1.img.zip: HTTP Error 422: {\"id\":\"unprocessable entity\",\"message\":\"'AppGate-SDP-5.2.1.img.zip' is still being uploaded. Please try later.\"}. Retrying in 3 seconds ...\n^C20:27:01 \nInterrupted by user"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Controller stack trace: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Sep 17 18:25:36 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]: 127.0.0.1 - - [17/Sep/2020:18:25:36 +0000] \"GET /admin/files/AppGate-SDP-5.2.1.img.zip HTTP/1.0\" 404 76 \"-\" \"Python-urllib/3.6\" 17\nSep 17 18:25:36 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]: INFO [PeerWebSocketEndpoint] /127.0.0.1:54530 1822 \"revocation_list\" success 2\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]: ERROR[FileResource] Error while streaming. Filename: AppGate-SDP-5.2.1.img.zip\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]: org.eclipse.jetty.io.EofException: Early EOF\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpInput$3.getError(HttpInput.java:1141)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpInput$3.noContent(HttpInput.java:1129)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpInput.read(HttpInput.java:321)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.makeAvailable(MultipartStream.java:1027)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.read(MultipartStream.java:931)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/java.io.InputStream.transferTo(InputStream.java:704)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/java.nio.file.Files.copy(Files.java:3077)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at com.cyxtera.controller.service.management.resource.FileResource.uploadFile(FileResource.java:125)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/java.lang.reflect.Method.invoke(Method.java:566)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodInvocationHandlerFactory.java:52)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:124)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:167)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$VoidOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:159)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:79)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:469)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:391)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:80)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:253)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:292)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:274)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:244)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:232)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:680)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:366)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:319)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at io.dropwizard.jetty.NonblockingServletHolder.handle(NonblockingServletHolder.java:50)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1631)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.websocket.server.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:226)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1618)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at io.dropwizard.servlets.ThreadNameFilter.doFilter(ThreadNameFilter.java:35)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1618)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.handle(AllowedMethodsFilter.java:47)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.doFilter(AllowedMethodsFilter.java:41)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1618)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:549)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1369)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:489)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1284)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at com.codahale.metrics.jetty9.InstrumentedHandler.handle(InstrumentedHandler.java:249)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at io.dropwizard.jetty.RoutingHandler.handle(RoutingHandler.java:52)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:717)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.RequestLogHandler.handle(RequestLogHandler.java:54)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.Server.handle(Server.java:501)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:383)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:556)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:375)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:272)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:103)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:806)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:938)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         at java.base/java.lang.Thread.run(Thread.java:834)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:         Suppressed: org.eclipse.jetty.io.EofException: Early EOF\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at org.eclipse.jetty.server.HttpInput$3.getError(HttpInput.java:1141)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at org.eclipse.jetty.server.HttpInput$3.noContent(HttpInput.java:1129)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at org.eclipse.jetty.server.HttpInput.read(HttpInput.java:321)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at org.apache.commons.fileupload.MultipartStream$ItemInputStream.makeAvailable(MultipartStream.java:1027)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at org.apache.commons.fileupload.MultipartStream$ItemInputStream.close(MultipartStream.java:971)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at org.apache.commons.fileupload.MultipartStream$ItemInputStream.close(MultipartStream.java:950)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 at com.cyxtera.controller.service.management.resource.FileResource.uploadFile(FileResource.java:124)\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:                 ... 66 common frames omitted\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]: {\"id\":\"0e64a016-0551-4910-8cf0-793c09e6edd5\",\"timestamp\":\"2020-09-17T18:26:17.923283Z\",\"version\":13,\"distinguished_name\":\"CN=5535163656b345fba9b7d1520dd27507,CN=admin,OU=local\",\"filename\":\"AppGate-SDP-5.2.1.img.zip\",\"reason\":\"Early EOF\",\"client_ip\":\"212.16.176.132\",\"event_type\":\"file_upload_failed\"}\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]: INFO [InputExceptionMapper] Error while streaming. Early EOF\nSep 17 18:26:17 ec2-3-95-132-40.compute-1.amazonaws.com cz-controllerd[2996]:  - - [17/Sep/2020:18:26:17 +0000] \"PUT /admin/files HTTP/1.0\" 422 74 \"-\" \"Python-urllib/3.6\" 41094"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-14526",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "cz-gateway-sessiond     Unzipping /root/.gradle/wrapper/dists/gradle-5.6-bin/5kicqg6ztneao1g81310ql3q8/gradle-5.6-bin.zip to /root/.gradle/wrapper/dists/gradle-5.6-bin/5kicqg6ztneao1g81310ql3q8\ncz-gateway-sessiond     Set executable permissions for: /root/.gradle/wrapper/dists/gradle-5.6-bin/5kicqg6ztneao1g81310ql3q8/gradle-5.6/bin/gradle\ncz-gateway-sessiond\ncz-gateway-sessiond     Welcome to Gradle 5.6!\ncz-gateway-sessiond\ncz-gateway-sessiond     Here are the highlights of this release:\ncz-gateway-sessiond      - Incremental Groovy compilation\ncz-gateway-sessiond      - Groovy compile avoidance\ncz-gateway-sessiond      - Test fixtures for Java projects\ncz-gateway-sessiond      - Manage plugin versions via settings script\ncz-gateway-sessiond\ncz-gateway-sessiond     For more details see "
            },
            {
              "type": "text",
              "text": "https://docs.gradle.org/5.6/release-notes.html"
            },
            {
              "type": "text",
              "text": "\ncz-gateway-sessiond\ncz-gateway-sessiond     Starting a Gradle Daemon (subsequent builds will be faster)\ncz-gateway-sessiond\ncz-gateway-sessiond     > Task :dependencyCheckAnalyze\ncz-gateway-sessiond     Verifying dependencies for project project\ncz-gateway-sessiond     Checking for updates and analyzing dependencies for vulnerabilities\ncz-gateway-sessiond     Generating report for project project\ncz-gateway-sessiond     Found 6 vulnerabilities in project project\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond     One or more dependencies were identified with known vulnerabilities in project:\ncz-gateway-sessiond\ncz-gateway-sessiond     jetty-servlet-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-servlet@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-security-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-security@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-server-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-server@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-jmx-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-jmx@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-http-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-http@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-util-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-util@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond     See the dependency-check report for more details.\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond     > Task :dependencyCheckAnalyze FAILED\ncz-gateway-sessiond     1 actionable task: 1 executed\ncz-gateway-sessiond     Makefile:6: recipe for target 'build/libs/sessiond-1.0-all.jar' failed\ncz-gateway-sessiond     make[1]: Leaving directory '/build/project'\ncz-gateway-sessiond     dh_auto_build: make -j4 -O \"INSTALL=install --strip-program=true\" returned exit code 2\ncz-gateway-sessiond     debian/rules:6: recipe for target 'build' failed\ncz-gateway-sessiond     make: *** [build] Error 25\ncz-gateway-sessiond     dpkg-buildpackage: error: debian/rules build subprocess returned exit status 2\ncz-gateway-sessiond     + cleanup\ncz-gateway-sessiond     + post_cleanup\ncz-gateway-sessiond     + hook_if_needed post-cleanup\ncz-gateway-sessiond     + hook=post-cleanup\ncz-gateway-sessiond     + echo 'Checking for post-cleanup hook'\ncz-gateway-sessiond     + '[' 1 = 1 -a -f /build/project/building/docker-post-cleanup.sh ']'\ncz-gateway-sessiond     Checking for post-cleanup hook\ncz-gateway-sessiond     ##teamcity[blockClosed name='cz-gateway-sessiond run-in-docker']\n"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-gateway/pull/2642",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-gateway/pull/2642"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1595849327547
      }
    ]
  },
  {
    "key": "SA-14526",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "cz-gateway-sessiond     Unzipping /root/.gradle/wrapper/dists/gradle-5.6-bin/5kicqg6ztneao1g81310ql3q8/gradle-5.6-bin.zip to /root/.gradle/wrapper/dists/gradle-5.6-bin/5kicqg6ztneao1g81310ql3q8\ncz-gateway-sessiond     Set executable permissions for: /root/.gradle/wrapper/dists/gradle-5.6-bin/5kicqg6ztneao1g81310ql3q8/gradle-5.6/bin/gradle\ncz-gateway-sessiond\ncz-gateway-sessiond     Welcome to Gradle 5.6!\ncz-gateway-sessiond\ncz-gateway-sessiond     Here are the highlights of this release:\ncz-gateway-sessiond      - Incremental Groovy compilation\ncz-gateway-sessiond      - Groovy compile avoidance\ncz-gateway-sessiond      - Test fixtures for Java projects\ncz-gateway-sessiond      - Manage plugin versions via settings script\ncz-gateway-sessiond\ncz-gateway-sessiond     For more details see "
            },
            {
              "type": "text",
              "text": "https://docs.gradle.org/5.6/release-notes.html"
            },
            {
              "type": "text",
              "text": "\ncz-gateway-sessiond\ncz-gateway-sessiond     Starting a Gradle Daemon (subsequent builds will be faster)\ncz-gateway-sessiond\ncz-gateway-sessiond     > Task :dependencyCheckAnalyze\ncz-gateway-sessiond     Verifying dependencies for project project\ncz-gateway-sessiond     Checking for updates and analyzing dependencies for vulnerabilities\ncz-gateway-sessiond     Generating report for project project\ncz-gateway-sessiond     Found 6 vulnerabilities in project project\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond     One or more dependencies were identified with known vulnerabilities in project:\ncz-gateway-sessiond\ncz-gateway-sessiond     jetty-servlet-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-servlet@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-security-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-security@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-server-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-server@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-jmx-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-jmx@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-http-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-http@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond     jetty-util-9.4.29.v20200521.jar (pkg:maven/org.eclipse.jetty/jetty-util@9.4.29.v20200521, cpe:2.3:a:eclipse:jetty:9.4.29:20200521:*:*:*:*:*:*, cpe:2.3:a:jetty:jetty:9.4.29.v20200521:*:*:*:*:*:*:*) : CVE-2019-17638\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond     See the dependency-check report for more details.\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond\ncz-gateway-sessiond     > Task :dependencyCheckAnalyze FAILED\ncz-gateway-sessiond     1 actionable task: 1 executed\ncz-gateway-sessiond     Makefile:6: recipe for target 'build/libs/sessiond-1.0-all.jar' failed\ncz-gateway-sessiond     make[1]: Leaving directory '/build/project'\ncz-gateway-sessiond     dh_auto_build: make -j4 -O \"INSTALL=install --strip-program=true\" returned exit code 2\ncz-gateway-sessiond     debian/rules:6: recipe for target 'build' failed\ncz-gateway-sessiond     make: *** [build] Error 25\ncz-gateway-sessiond     dpkg-buildpackage: error: debian/rules build subprocess returned exit status 2\ncz-gateway-sessiond     + cleanup\ncz-gateway-sessiond     + post_cleanup\ncz-gateway-sessiond     + hook_if_needed post-cleanup\ncz-gateway-sessiond     + hook=post-cleanup\ncz-gateway-sessiond     + echo 'Checking for post-cleanup hook'\ncz-gateway-sessiond     + '[' 1 = 1 -a -f /build/project/building/docker-post-cleanup.sh ']'\ncz-gateway-sessiond     Checking for post-cleanup hook\ncz-gateway-sessiond     ##teamcity[blockClosed name='cz-gateway-sessiond run-in-docker']\n"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-gateway/pull/2642",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-gateway/pull/2642"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1595849327547
      }
    ]
  },
  {
    "key": "SA-14522",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz-spad[1264]: ERR     [2020-07-23T09:46:44.230Z] [C 7f41f8789700] [4] Failed to connect SPA-TCP socket: Connection refused"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1595497651034
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "All daemons seem to be running"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1595501671879
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Full logs would be useful to have any look. Most importantly what binds has configd given to proxyd and whats up with iptables. From the little log above the only thing that it can tell us is that the 443 is not reachable which in turn, as it is in the same appliance (edit: spad connects to another appliance not the same. See last comment..), feels that the appliance setup of the role is broken. configd needs to open this port and start a proxyd there. Really smells appliance fuckery. However it is very strange unless someone touched configd or this scenario was never tested. Putting in in more info requires as needs some investigation to see if it is bug in configd or something else"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1595539895979
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "My test env is still up there if you want to check it"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "userappgate [] | 2020-07-23 08:07:25\n        id:      9f98686a-85a1-47e4-bfdc-acd786ac2650\n        state:    finished-execution\n        appliance build from release[#21563] "
                },
                {
                  "type": "text",
                  "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=506676&buildTypeId=StratusImage_Build"
                },
                {
                  "type": "text",
                  "text": "\n        scenario: 4gw\n        keep on error: False\n        nodes:\n                controller\n                        roles:   controller, logserver\n                        web ui:  "
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-120-1.devops:444"
                },
                {
                  "type": "text",
                  "text": "\n                        status:  Running\n                        ip:      172.17.120.1\n                        network: 172.17.120.0/24\n                        hostname: envy-172-17-120-1.devops\n                        admin username: admin\n                        admin password: admin\n                gateway1\n                        roles:   gateway\n                        status:  Running\n                        ip:      172.17.120.2\n                        network: 172.17.120.0/24\n                        hostname: envy-172-17-120-2.devops\n                gateway2\n                        roles:   gateway\n                        status:  Running\n                        ip:      172.17.120.3\n                        network: 172.17.120.0/24\n                        hostname: envy-172-17-120-3.devops\n                gateway3\n                        roles:   gateway\n                        status:  Running\n                        ip:      172.17.120.4\n                        network: 172.17.120.0/24\n                        hostname: envy-172-17-120-4.devops\n                gateway4\n                        roles:   gateway\n                        status:  Running\n                        ip:      172.17.120.5\n                        network: 172.17.120.0/24\n                        hostname: envy-172-17-120-5.devops\n                endpoint\n                        roles:   endpoint\n                        status:  Running\n                        ip:      172.17.121.5\n                        network: 172.17.121.0/24\n                        hostname: envy-172-17-121-5.devops"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1595571103556
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Easy to reproduce, just create an env, disable logserver on controller, take a gateway, and enable only the logserver role on it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1595571141537
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Alright I did some investigation. Created an envy environment with 2 Gateways and 1 Controller. I disabled log server from Controller and enabled it in Gateway 2. Disabled Gateway role in Gateway 2 as well so the appliance functions only as a log server. The problem is as expected that proxyd is not running in the log server appliance! Thus all connections from Controller and Gateway 1 to the log server (ex Gateway 2) are failing as there is no proxyd listening at 443... The fix should be configd to start proxyd normally as usual (minus the client spa key. It's not needed)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1596454545461
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Note same for LogForwarder"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1596461880312
      }
    ],
    "description": {
      "type": "doc",
      "version": 1,
      "content": []
    }
  },
  {
    "key": "SA-14452",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Release notes:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\# Controller\n\n\\- Added an Express Connector validation for checking overlaps.\n\n\\- Fixed an issue where saving an LDAP Certificate Identity Provider with a CA certificate that does not have any Key Usage extension will fail with an error.\n\n\\- Fixed an issue where upgrade fails due to stale App Shortcuts in the database. This could be caused creating an Entitlement with App Shortcut on 5.0 and deleting it.\n\n\\- Fixed an issue where the privilege for testing name resolution for specific appliances cause errors. The privilege now cannot be assigned to specific Appliances but it requires View privilege as extra.\n\n\\- Fixed stats/failed-authentication API.\n\n\\# Frontend\n\n\\- Fixed an issue where the query, page and sorting order are reset after applying bulk actions.\n\n\\- Fixed an issue on Session Details where Express Connector only shows single gateway. Unlike the regular Clients, Express Connector connects to all the gateways on a Site.\n\n\\- Removed the unsupported \"None\" Access Method under Appliance - LogForwarder - AWS Kinesis."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1597676846116
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "`"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Gatway:"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Fix of issue with alert not working on http based actions."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Security updates"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Fix of a bug where name is included in pre expire remedies"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Fix of a issue where the gateway complained about had access when SNAT mode was enabled"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Fix of a issue that multiple entitlements was presented in sessions details on express-connectors"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Improved filter setup time for large rule set in the firewall engine"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Show name resolver creation errors in appliance status as part of gateway role."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "ICMP/ICMPv6 ip"
                        },
                        {
                          "type": "text",
                          "text": "access audit logs now contains identifier and sequence no.",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "In case of identical http and tcp actions, http actions now have preceding."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Small description update of ip-access audit log for blocking TCP segments without connection state"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Logforwarder/Logserver:"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Fix of a bug where changing of filters on kinesis and tcp outputs did not result in changes beeing applied."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1597738433870
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "While there were a few small fixes on the appliance side, not much release note worthy."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "# Appliance\n- Fix bug in autoscaling script when dealing with appliance template with older version than the controller version."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1597740641076
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Known Issue:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Multiple http access urls with or without / postfixes may have nondeterministic behaviour on what url will be preferred\n- Example: action1-> "
                },
                {
                  "type": "text",
                  "text": "http://foo/bar"
                },
                {
                  "type": "text",
                  "text": "\n           action2-> "
                },
                {
                  "type": "text",
                  "text": "http://foo/bar/"
                },
                {
                  "type": "text",
                  "text": "\n  It will be nondeterministic wich action will be preferred.\n"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1598527127445
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Known Issue: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "    * When http access, and alert is used. An audit-log with type remedy is created from the http-module at rule hit"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1598527203435
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Known issue:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Audit log entitlement"
                        },
                        {
                          "type": "text",
                          "text": "token",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "evaluated, the evaluation time is displayed in seconds, and not miliseconds."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1598530226911
      }
    ],
    "description": {
      "type": "doc",
      "version": 1,
      "content": []
    }
  },
  {
    "key": "SA-14429",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This can result in upgrading all gateways in a given site at the same time, resulting in downtime! "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "C:\\Users\\Jamie\\Desktop>python appgate-upgrade.pyz install --no-verify --unique-hostname 35.246.176.90 --host-on-controller 35.246.176.90 "
            },
            {
              "type": "text",
              "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.2.0-21445-release.img.zip"
            },
            {
              "type": "text",
              "text": "\n09:30:36 Discovering peer API version for "
            },
            {
              "type": "text",
              "text": "https://35.246.176.90:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n09:30:37 Peer API version is 12\nEnter password for username admin and provider name local:\n09:30:43 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://35.246.176.90:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n09:30:44 Authentication succeeded\n09:30:44 Authorizing...\n09:30:47\n09:30:47 Upgrade plan:\n09:30:47 1. Download upgrade image appgate-5.2.0-21445-release.img.zip from source url "
            },
            {
              "type": "text",
              "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.2.0-21445-release.img.zip"
            },
            {
              "type": "text",
              "text": " to controller\n09:30:47 2. Upgrade gateways: gateway4, gateway5\n09:30:47 3. Upgrade plain appliance: Connector Express\n09:30:47 4. Delete upgrade image from controller\n09:30:47 Appliances will be upgraded to version 5.2.0-21445-release\n09:30:47\nDo you want to continue [y/N]? y\n09:31:16 1. Download upgrade image appgate-5.2.0-21445-release.img.zip from source url "
            },
            {
              "type": "text",
              "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.2.0-21445-release.img.zip"
            },
            {
              "type": "text",
              "text": " to controller\n09:31:17 File appgate-5.2.0-21445-release.img.zip already exists, using it as is\n09:31:17 Controller downloaded upgrade image appgate-5.2.0-21445-release.img.zip, using image url controller://35.246.176.90:444/appgate-5.2.0-21445-release.img.zip\n09:31:17\n09:31:17 2. Upgrade gateways: gateway4, gateway5\n09:31:17 Preparing upgrade for gateway5\n09:31:18 Preparing upgrade for gateway4\n09:31:19 Upgrade status for gateway5 changed to downloading: controller://35.246.176.90:444/appgate-5.2.0-21445-release.img.zip\n09:31:19 Upgrade status for gateway4 changed to downloading: controller://35.246.176.90:444/appgate-5.2.0-21445-release.img.zip\n09:31:30 Upgrade status for gateway5 reached expected value verifying: appgate-5.2.0-21445-release.img.zip\n09:31:30 Upgrade status for gateway4 reached expected value verifying: appgate-5.2.0-21445-release.img.zip\n09:32:44 Upgrade status for gateway5 reached expected value ready: appgate-5.2.0-21445-release.img.zip\n09:32:44 Upgrade status for gateway4 reached expected value ready: appgate-5.2.0-21445-release.img.zip\n09:32:44 Completing upgrade on gateway5\n09:32:44 Completing upgrade on gateway4\n09:32:45 Upgrade status for gateway5 changed to downloading: controller://35.246.176.90:444/appgate-5.2.0-21445-release.img.zip\n09:32:45 Upgrade status for gateway4 changed to downloading: controller://35.246.176.90:444/appgate-5.2.0-21445-release.img.zip\n09:32:45 Upgrade status for gateway5 changed to installing: appgate-5.2.0-21445-release.img.zip\n09:32:46 Upgrade status for gateway4 changed to installing: appgate-5.2.0-21445-release.img.zip"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is because the upgrade script only considers the site and not the roles too, gateways should be grouped separately: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "def appliance_group_id(appliance: Appliance) -> str:\n    \"\"\"\n    Return a group id used to group appliances logically, e.g. all gateways\n    belonging to the same site. Use hashlib instead of the built-in hash\n    to make the output stable across runs.\n    \"\"\"\n    import hashlib\n    m = hashlib.md5()\n    if appliance.site:\n        m.update(appliance.site.encode('utf-8'))\n    if appliance.log_forwarder_sites:\n        # We want a single log forwarder site to result in a different\n        # group id than a single gateway site so they get grouped separately.\n        m.update(str(appliance.log_forwarder_sites).encode('utf-8'))\n    group_id = m.hexdigest()\n    return group_id"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-14408",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ python3 appgate-backup.pyz purple10.agi.appgate.com:8443 --username appgate-upgrade\n10:33:02 Discovering peer API version for "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n10:33:02 Peer API version is 13\nEnter password for username appgate-upgrade and provider name local:\n10:33:09 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n10:33:09 Authentication succeeded\n10:33:09 Authorizing...\n10:33:10 Starting backup on 1 appliances:\n10:33:10   * aws - purple10\n10:33:10 Backup creation started.\n10:33:10 All files will be stored in ./appgate_backup_1594024382.5750604/\n10:33:10 Backup complete on appliance: aws - purple10\n10:33:10 Appliance 801db367-58d0-4876-84ae-f6d1fdab6c0d reported the following issues:\nNot enough space on disk to perform backup\n10:33:10 Downloading backup from aws - purple10 in ./appgate_backup_1594024382.5750604/aws - purple10.bkp\n10:33:10 Download complete for appliance: aws - purple10\n10:33:11 Removed remote download for appliance: aws - purple10\n10:33:11 Some issues were encountered during the backup process. The downloaded files might not work or contain incomplete data."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "purple10 is just a controller and gateway, no log server."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "root@purple10:~# df -h\nFilesystem        Size  Used Avail Use% Mounted on\nudev              3.9G     0  3.9G   0% /dev\ntmpfs             796M  8.6M  788M   2% /run\n/dev/czvg/image1  4.0G  2.6G  1.2G  70% /mnt/root-ro\ntmpfs-root        3.9G  4.4M  3.9G   1% /mnt/root-rw\noverlay-root      3.9G  4.4M  3.9G   1% /\n/dev/czvg/data    8.8G  5.4G  3.0G  65% /mnt/data\n/dev/czvg/state1  960M  3.9M  889M   1% /mnt/state\ntmpfs             3.9G  4.0K  3.9G   1% /dev/shm\ntmpfs             5.0M     0  5.0M   0% /run/lock\ntmpfs             3.9G     0  3.9G   0% /sys/fs/cgroup"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Added set -x and ran cz-backup: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@purple10:/mnt/data/backup# cz-backup\n+ SYSLOG_NAME=cz-backup\n++ getopt -o h,a,L --long passphrase:,passphrase-file:,overwrite,help,audit,logs -n cz-backup --\n+ PARAMS=' --'\n+ eval set -- ' --'\n++ set -- --\n+ SKIPLOGSERVER=yes\n+ SKIPLOGS=yes\n+ ENCRYPT=no\n+ true\n+ case \"$1\" in\n+ shift\n+ break\n+ [[ 0 -gt 1 ]]\n+ [[ 0 = 0 ]]\n++ hostname\n++ date -u +%F_%H_%M\n+ DEST=backup_purple10.cryptzone.com_2020-07-06_08_38.tar.bz\n++ id -u\n+ [[ 0 -gt 0 ]]\n+ [[ '' != \\y\\e\\s ]]\n+ [[ -e backup_purple10.cryptzone.com_2020-07-06_08_38.tar.bz ]]\n+ '[' -e /mnt/data/log.bkp ']'\n+++ realpath /proc/6148/fd/1\n++ stat --format %t /dev/pts/0\n+ '[' 88 = 88 ']'\n+ printlog warning 'Running this interactively is deprecated. Please check man 5 appgate-backup.'\n+ FACILITY=warning\n+ MESSAGE='Running this interactively is deprecated. Please check man 5 appgate-backup.'\n+ logger -p warning -t cz-backup 'Running this interactively is deprecated. Please check man 5 appgate-backup.'\n+ [[ warning == \\i\\n\\f\\o ]]\n+ [[ warning == \\n\\o\\t\\i\\c\\e ]]\n+ [[ warning == \\d\\e\\b\\u\\g ]]\n+ echo 'Running this interactively is deprecated. Please check man 5 appgate-backup.'\nRunning this interactively is deprecated. Please check man 5 appgate-backup.\n+ exec\n+ flock -n 99\n+ SIZE_DIRECTORIES='/mnt/data/log /mnt/state/'\n+ [[ yes = no ]]\n+ '[' -d /mnt/data/postgresql ']'\n+ SIZE_DIRECTORIES='/mnt/data/log /mnt/state/ /mnt/data/postgresql'\n++ du --bytes -cL /mnt/data/log /mnt/state/ /mnt/data/postgresql\n++ tail -1\n++ cut -dt -f1\n+ ESTIMATED_BACKUP_SIZE=11207161404\n++ tail -1\n++ cut '-d ' -f4\n++ tr --squeeze-repeats ' '\n++++ realpath backup_purple10.cryptzone.com_2020-07-06_08_38.tar.bz\n+++ dirname /mnt/data/backup/backup_purple10.cryptzone.com_2020-07-06_08_38.tar.bz\n++ df --block-size 1 /mnt/data/backup\n+ FREE_SPACE=3164110848\n+ printlog info 'Estimated space required (including temporary files): 11207161404 bytes'\n+ FACILITY=info\n+ MESSAGE='Estimated space required (including temporary files): 11207161404 bytes'\n+ logger -p info -t cz-backup 'Estimated space required (including temporary files): 11207161404 bytes'\n+ [[ info == \\i\\n\\f\\o ]]\n+ echo 'Estimated space required (including temporary files): 11207161404 bytes'\nEstimated space required (including temporary files): 11207161404 bytes\n+ [[ 11207161404 -ge 3164110848 ]]\n+ printlog err 'Not enough space on disk to perform backup'\n+ FACILITY=err\n+ MESSAGE='Not enough space on disk to perform backup'\n+ logger -p err -t cz-backup 'Not enough space on disk to perform backup'\n+ [[ err == \\i\\n\\f\\o ]]\n+ [[ err == \\n\\o\\t\\i\\c\\e ]]\n+ [[ err == \\d\\e\\b\\u\\g ]]\n+ echo 'Not enough space on disk to perform backup'\nNot enough space on disk to perform backup\n+ exit 7"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1594024723338
      }
    ]
  },
  {
    "key": "SA-14404",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "In the SSO Client installation section in the Admin Guide("
            },
            {
              "type": "text",
              "text": "https://sdphelp.appgate.com/adminguide/v5.1/windows-plap-client.html)",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://sdphelp.appgate.com/adminguide/v5.1/windows-plap-client.html)"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " it mentions several times that the switch /L should be always used when trying to install SSO client, nevertheles the example installation command line provided doesn't include it!."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I realize later that /SSO and /L are the same switch for the installer but it is a bit confusing, so maybe it will use /L in the example installation line or refer to this option as /SSO instead of /L."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The section I refer is below:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "To install the client as a SSO service the installation needs to be run with the switch /L. It is recommended to run it using the /S (silent installation) switch. Refer to Windows Client for a full explanation of all the installation switch options. So run the following command from a command prompt to install the Windows SSO (PLAP) Client using silent mode and wait until installer is finished:\n\nstart \"\" /WAIT \"AppGate Client Installer.exe\" /SSO /S /G /U=\""
            },
            {
              "type": "text",
              "text": "https://url.com\""
            },
            {
              "type": "text",
              "text": "\n\nNOTE: The profile link included after the /U switch can be obtained from Settings>Client Connections.\n\nAn existing AppGate SDP installation can be upgraded to run as Windows SSO Client by simply running installer with /SSO and additional parameters (e.g. /U). The Client will be upgraded and the Windows SSO Client installed. Any existing configuration set for the normal Client will not be transferred to the SSO sign-in screen.\n\nNOTE: Always provide the /L flag every time the AppGate SDP client is installed, upgraded or reinstalled to keep the AppGate SDP SSO functionality installed."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-14403",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  forward\\"
                    },
                    {
                      "type": "text",
                      "text": "compatibility\\- old\\",
                      "marks": [
                        {
                          "type": "em"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": "forward\\"
                    },
                    {
                      "type": "text",
                      "text": "compatibility",
                      "marks": [
                        {
                          "type": "em"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\\- nightly\\"
            },
            {
              "type": "text",
              "text": "upgrade\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "previous\\"
            },
            {
              "type": "text",
              "text": "old",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\\- nightly\\"
            },
            {
              "type": "text",
              "text": "upgrade\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "previous"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\\- backuprestore (Bonus)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "userappgate ['very_old_backward_compatibility'] | 2020-07-06 09:51:32\n        id:   f8935e1f-e269-40fd-917a-49cf00bfe36b\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/757848"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 0/60\nuserappgate ['very_old_forward_compatibility'] | 2020-07-06 09:51:54\n        id:   a51d12a8-0892-44f7-bdbe-c495fe0b04e5\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/757852"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 0/60"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks to me the builds it picks are correct and something else is failing later on."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1594030212376
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Running this to further debug, but i'll probably open a new task "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/757864",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/757864"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1594030608332
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Anddd of course now it works .D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1594031623407
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It might be that the crontab doesn't get regenerated? But The file date seemed correct. Will check tomorrow."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1594032039843
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "userappgate ['very"
                },
                {
                  "type": "text",
                  "text": "old",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "backward"
                },
                {
                  "type": "text",
                  "text": "compatibility'] | 2020-07-06 10{{COLON",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NUM"
                },
                {
                  "type": "text",
                  "text": "46}}40 id:   de780707-e3a9-41b1-81c2-0f1c45814772 url:  ",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/757874",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/757874"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Creating a multipurpose test, we will query aitorbot for the test case ids now userappgate ['old",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "backward"
                },
                {
                  "type": "text",
                  "text": "compatibility'] | 2020-07-06 10{{COLON",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NUM"
                },
                {
                  "type": "text",
                  "text": "46}}51 id:   517a40fe-1097-457d-a0d6-dc7235f36c4f url:  None Creating a multipurpose test, we will query aitorbot for the test case ids now userappgate ['backward",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "compatibility'] | 2020-07-06 10{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "47}}02 id:   60389555-ffd5-4e67-883f-cde892b06d13 url:  None Creating a multipurpose test, we will query aitorbot for the test case ids now userappgate ['very"
                },
                {
                  "type": "text",
                  "text": "old",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "forward"
                },
                {
                  "type": "text",
                  "text": "compatibility'] | 2020-07-06 10{{COLON",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NUM"
                },
                {
                  "type": "text",
                  "text": "47}}12 id:   8e1d71c1-b0b5-4cad-9eae-03df508357d2 url:  None Creating a multipurpose test, we will query aitorbot for the test case ids now userappgate ['old",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "forward"
                },
                {
                  "type": "text",
                  "text": "compatibility'] | 2020-07-06 10{{COLON",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NUM"
                },
                {
                  "type": "text",
                  "text": "47}}23 id:   78003c64-d3a4-4094-b8f0-06b215e2a0b5 url:  None Creating a multipurpose test, we will query aitorbot for the test case ids now userappgate ['forward",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "compatibility'] | 2020-07-06 10{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "47}}33 id:   32a5553b-9eda-432d-8207-266f20edbc82 url:  None userappgate ['nightly"
                },
                {
                  "type": "text",
                  "text": "upgrade",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "previous"
                },
                {
                  "type": "text",
                  "text": "old'] | 2020-07-06 10{{COLON",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NUM"
                },
                {
                  "type": "text",
                  "text": "47}}36 id:   a03ee45d-2403-440b-a765-df8176dfce85 url:  None userappgate ['nightly",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "upgrade"
                },
                {
                  "type": "text",
                  "text": "previous'] | 2020-07-06 10{{COLON",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NUM"
                },
                {
                  "type": "text",
                  "text": "47}}40 id:   d72cdfed-a32a-49db-b05b-92fec425a6e7 url:  None",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1594032493252
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "coolio. if you're making changes, could you also remove the useless nightly\\"
                },
                {
                  "type": "text",
                  "text": "candidate runs?",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1594033441723
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Someone removed this line from the crontab on testyd machine"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "20 22   * * *   czd     aitorbot cron | crontab -"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so it could never work."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "aitor.iturri",
                    "text": "@aitor.iturri",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " was it you?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1594103044945
      }
    ]
  },
  {
    "key": "SA-14365",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "[^image.png]"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The message is:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Your computer violates the corporate BYOD Policy.   Go to Outlook.com to submit a helpdesk ticket.<br><br><br>\n\nTo Download the BYOD Policy, click <a href=\"["
            },
            {
              "type": "text",
              "text": "https://appgate.sharepoint.com/:b:/r/sites/Resources/Corporate/Shared%20Documents/Interim%20Email%20Signature/Signature\\_Instructions%20(2).pdf?csf=1&web=1&e=4CtJmf](https://appgate.sharepoint.com/:b:/r/sites/Resources/Corporate/Shared%20Documents/Interim%20Email%20Signature/Signature_Instructions%20\\(2\\).pdf?csf=1&web=1&e=4CtJmf)\">here</a>"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\nPlease send an email to <a href=\"mailto:ITHelp@XYZcompany.com>ITHelp@XYZcompany.com</a> for further assistance."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A suggestion is to have a button here to show this in full screen (user action)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1593693329862
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well the main problem is that the formatting is messed up in the popup message element. It uses formatting from CSS it shouldn't have and is quite different from what you see on a normal remedy display message. Fixing that will make the message above look normal."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "per.svensson",
                    "text": "@per.svensson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " and I talked about if there's potentially more that needs to be done after fixing that issue. We still believe it works fine in the popup context and don't see the need to show the message in a different context. All the tags that you can use (found in Sanitize component) as admin will fit within the popup."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1596014093870
      }
    ]
  },
  {
    "key": "SA-14337",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Controller logs: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 30 14:01:16 envy-172-17-116-1.devops cz-controllerd[2674]: INFO [ApplianceManager] Wiping appliance 'gateway-e04da56d-5ac5-415c-a266-d2b0a4d662c9-site1'\nJun 30 14:01:16 envy-172-17-116-1.devops cz-controllerd[2674]: {\"id\":\"97a60ea2-bc94-4bcd-b669-b5653414c9c5\",\"timestamp\":\"2020-06-30T14:01:16.436602Z\",\"version\":13,\"entity_id\":\"7ede36d1-209b-4f99-57f3-01eede1bb982\",\"entity_name\":\"gateway-e04da56d-5ac5-415c-a266-d2b0a4d662c9-site1\",\"distinguished_name\":\"CN=9796835a256e4f4cb3721041d9d1bddc,CN=admin,OU=local\",\"client_ip\":\"192.168.111.220\",\"event_type\":\"appliance_deactivated\"}\nJun 30 14:01:16 envy-172-17-116-1.devops cz-controllerd[2674]: 127.0.0.1 - - [30/Jun/2020:14:01:16 +0000] \"POST /admin/appliances/7ede36d1-209b-4f99-57f3-01eede1bb982/deactivate HTTP/1.0\" 204 0 \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-116-1.devops:444/ui/appliances\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:77.0) Gecko/20100101 Firefox/77.0\" 13\nJun 30 14:01:16 envy-172-17-116-1.devops cz-controllerd[2674]: ERROR[ApplianceWebSocketStore] JSON-RPC request got rejected by the appliance with code -32000 and message 'Bad request'.\nJun 30 14:01:16 envy-172-17-116-1.devops cz-controllerd[2674]: INFO [ApplianceManager] Error on appliance connection to 'gateway-e04da56d-5ac5-415c-a266-d2b0a4d662c9-site1' during wipe. HTTP 500 Internal Server Error"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Appliance doesn't say much: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 30 14:01:16 envy-172-17-116-2.devops cz-configd[2342]: INFO [jsonrpcapp] envy-172-17-116-1.devops 12 \"deactivate\" fail 0"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-14177",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Related to "
            },
            {
              "type": "text",
              "text": "SA-14074",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "SA-14074"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Warn : \\[UI\\] Error with handling a message. Unexpected token j in JSON at position 15362\n\nMessage: {\"jsonrpc\":\"2.0\",\"method\":\"setModel\",\"params\":{\"view\":\"partiallyconnected\",\"viewData\":{\"sites\":\\[{\"name\":\"AWS EU Central 1\",\"shortName\":\"AWS1\",\"description\":\"AWS testing and has our Controllers\",\"gateway\":\"aws - purple10\",\"connected\":true,\"entitlementCount\":5},{\"name\":\"AWS EU West 2\",\"shortName\":\"AWS2\",\"description\":\"\",\"gateway\":\"aws - purple40\",\"connected\":true,\"entitlementCount\":2},{\"name\":\"Gothenburg 2\",\"shortName\":\"GOT2\",\"description\":\"Where Jamie's magic happens\",\"gateway\":\"got - purple6\",\"connected\":true,\"entitlementCount\":2},{\"name\":\"Gothenburg\",\"shortName\":\"GOT1\",\"description\":\"Where the magic happens\",\"gateway\":\"got - purple1\",\"connected\":true,\"entitlementCount\":34},{\"name\":\"GCP Europe West 3\",\"shortName\":\"\",\"description\":\"\",\"gateway\":\"gcp - purple31\",\"connected\":true,\"entitlementCount\":2},{\"name\":\"Azure North Europe\",\"shortName\":\"AZNO\",\"description\":\"I just love <p style=\\\\\"color:DodgerBlue;\\\\\">Azure</p>!\",\"gateway\":\"azure - purple21\",\"connected\":true,\"entitlementCount\":1}\\],\"userActions\":\\[\\],\"appShortcuts\":\\[{\"id\":\"Admin UI Access-Admin UI\",\"name\":\"Admin UI\",\"siteName\":\"AWS EU Central 1\",\"siteShortName\":\"AWS1\",\"description\":\"This will whizz you to our AWESOME Admin UI.\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/](https://purple10.agi.appgate.com:8443/ui/)\",\"colorCode\":13,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[\\]},{\"id\":\"Akira"
            },
            {
              "type": "text",
              "text": " Artifact Repo-Akira\",\"name\":\"Akira\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"Our beloved artifact repository.\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://cyx-sedev-repo01.corp.cyxtera.com:8443](https://cyx-sedev-repo01.corp.cyxtera.com:8443)\",\"colorCode\":14,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"AppGate"
            },
            {
              "type": "text",
              "text": " SDP License Server-AppGate SDP License Server\",\"name\":\"AppGate SDP License Server\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://sdplicense.agi.appgate.com/](https://sdplicense.agi.appgate.com/)\",\"colorCode\":4,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"AWS"
            },
            {
              "type": "text",
              "text": " Appliances SSH Access-AWS Appliances SSH Access\",\"name\":\"AWS Appliances SSH Access\",\"siteName\":\"AWS EU Central 1\",\"siteShortName\":\"AWS1\",\"description\":\"When you press this button you will be overjoyed to see the the developers best friend appear - the command line!\",\"blockedDescription\":\"\",\"uri\":\"ssh://purple10.cryptzone.com\",\"colorCode\":8,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"AWS Kibana-AWS Kibana New\",\"name\":\"AWS Kibana New\",\"siteName\":\"AWS EU Central 1\",\"siteShortName\":\"AWS1\",\"description\":\"Only Mr Leino has any clue what happens here.\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "http://purple-kibana.agi.appgate.com/app/kibana#/discover](http://purple-kibana.agi.appgate.com/app/kibana#/discover)\",\"colorCode\":7,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"AWS"
            },
            {
              "type": "text",
              "text": " London Appliances SSH Access-AWS London Appliances SSH Access\",\"name\":\"AWS London Appliances SSH Access\",\"siteName\":\"AWS EU West 2\",\"siteShortName\":\"AWS2\",\"description\":\"When you press this button you will be overjoyed to see the the developers best friend appear - the command line!\",\"blockedDescription\":\"\",\"uri\":\"ssh://purple40.cryptzone.com\",\"colorCode\":9,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"Chat Server-Chat Server\",\"name\":\"Chat Server\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"Here you will find Andrea complaining about Swedish pizza - or any other subject that has crossed his path today!  \",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://appgate.slack.com](https://appgate.slack.com)\",\"colorCode\":18,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"Coverity-Coverity\",\"name\":\"Coverity\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"This"
            },
            {
              "type": "text",
              "text": " is one of those strange places that only people with beards go!\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://got-coverity.agi.appgate.com:8443](https://got-coverity.agi.appgate.com:8443)\",\"colorCode\":4,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"Devops"
            },
            {
              "type": "text",
              "text": " Servers-Devops Servers\",\"name\":\"Devops Servers\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"\",\"blockedDescription\":\"\",\"uri\":\"ssh://172.17.40.55:22\",\"colorCode\":5,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"Github-Github\",\"name\":\"Github\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"New and improved\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int](https://github.com/appgate-sdp-int)\",\"colorCode\":20,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"Grafana"
            },
            {
              "type": "text",
              "text": " Dashboard-Grafana Dashboard\",\"name\":\"Grafana Dashboard\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"All lies - it should be all green. We want more Green. And we want it NOW!\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "http://grafana.devops:3000](http://grafana.devops:3000)\",\"colorCode\":2,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"PasswordAuthentication\",\"active\":true}\\]},{\"id\":\"Github-Old"
            },
            {
              "type": "text",
              "text": " Github\",\"name\":\"Old Github\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"Enter at your own risk.\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com](https://code.cyxtera.com)\",\"colorCode\":19,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"AppGate"
            },
            {
              "type": "text",
              "text": " SDP Manual Server-RDP Manual\",\"name\":\"RDP Manual\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"Never risk going here unless you want a job in Product Management!\",\"blockedDescription\":\"\",\"uri\":\"rdp://full%20address=s:sa-manual-srv.ad.cryptzone.com:3389\",\"colorCode\":4,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[\\]},{\"id\":\"Teamcity-Teamcity\",\"name\":\"Teamcity\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"For some of the most amazing bug-free builds known to mankind just click on this beautifully designed button.\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://got-teamcity.agi.appgate.com](https://got-teamcity.agi.appgate.com)\",\"colorCode\":10,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]},{\"id\":\"Test"
            },
            {
              "type": "text",
              "text": " - All Remedy-Test - All Remedy\",\"name\":\"Test - All Remedy\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"A shortcut to test all things there are!\",\"blockedDescription\":\"You shall not test things!\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "http://192.168.111.75:9999](http://192.168.111.75:9999)\",\"colorCode\":11,\"isAvailable\":false,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"DisplayMessage\",\"active\":true},{\"type\":\"OtpAuthentication\",\"active\":true},{\"type\":\"Reason\",\"active\":true},{\"type\":\"PasswordAuthentication\",\"active\":true}\\]},{\"id\":\"Test"
            },
            {
              "type": "text",
              "text": " - AWS West Test-Test - AWS West Test\",\"name\":\"Test - AWS West Test\",\"siteName\":\"AWS EU West 2\",\"siteShortName\":\"AWS2\",\"description\":\"\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "http://172.31.4.105](http://172.31.4.105)\",\"colorCode\":12,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[\\]},{\"id\":\"Test"
            },
            {
              "type": "text",
              "text": " - Display Message-Test - Display Message\",\"name\":\"Test - Display Message\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"\",\"blockedDescription\":\"You can only access this resource during working hours.\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "http://192.168.111.27:9999](http://192.168.111.27:9999)\",\"colorCode\":1,\"isAvailable\":false,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"DisplayMessage\",\"active\":true}\\]},{\"id\":\"Test"
            },
            {
              "type": "text",
              "text": " - Reason-Test - Reason\",\"name\":\"Test - Reason\",\"siteName\":\"AWS EU Central 1\",\"siteShortName\":\"AWS1\",\"description\":\"Check out the Reason user interaction here.\",\"blockedDescription\":\"\",\"uri\":\"ssh://172.31.22.174:22\",\"colorCode\":6,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"Reason\",\"active\":true}\\]},{\"id\":\"Testrail-Testrail\",\"name\":\"Testrail\",\"siteName\":\"Gothenburg\",\"siteShortName\":\"GOT1\",\"description\":\"\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com](https://got-testrail.agi.appgate.com)\",\"colorCode\":7,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[\\]},{\"id\":\"Test"
            },
            {
              "type": "text",
              "text": " - Azure Test-trololololol\",\"name\":\"trololololol\",\"siteName\":\"Azure North Europe\",\"siteShortName\":\"AZNO\",\"description\":\"\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=dOkNFwRp2dA](https://www.youtube.com/watch?v=dOkNFwRp2dA)\",\"colorCode\":12,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[\\]},{\"id\":\"Test"
            },
            {
              "type": "text",
              "text": " - Azure Test-y( ???? ???? ????)y\",\"name\":\"y( ???? ???? ????)y\",\"siteName\":\"Azure North Europe\",\"siteShortName\":\"AZNO\",\"description\":\"\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=oHg5SJYRHA0](https://www.youtube.com/watch?v=oHg5SJYRHA0)\",\"colorCode\":14,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[\\]},{\"id\":\"Youtrack-Youtrack\",\"name\":\"Youtrack\",\"siteName\":\"Gothenburg"
            },
            {
              "type": "text",
              "text": " 2\",\"siteShortName\":\"GOT2\",\"description\":\"This is Jamie's favourite app of all time!\",\"blockedDescription\":\"\",\"uri\":\"["
            },
            {
              "type": "text",
              "text": "https://got-youtrack.agi.appgate.com](https://got-youtrack.agi.appgate.com)\",\"colorCode\":12,\"isAvailable\":true,\"isConnecting\":false,\"remedies\":\\[{\"type\":\"OtpAuthentication\",\"active\":true}\\]}\\],\"entitlements\":\\[{\"name\":\"AWS"
            },
            {
              "type": "text",
              "text": " Appliances SSH Access\",\"site\":\"AWS EU Central 1\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"aws://tag:Name=purple10.cryptzone.com|purple11.cryptzone.com|purple12.cryptzone.com|purple-detectid|purple-elasticsearch&region=eu-central-1&account=master\"\\],\"ports\":\\[\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"aws://tag:Name=purple13.agi.appgate.com\"\\],\"ports\":\\[\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"aws://tag:Name=purple70.agi.appgate.com&region=eu-west-3\"\\],\"ports\":\\[\"22\"\\]}\\],\"conditions\":\\[\"OTP Required\",\"Not iOS\"\\]},{\"name\":\"AWS Kibana\",\"site\":\"AWS EU Central 1\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"ec2-35-156-8-52.eu-central-1.compute.amazonaws.com\"\\],\"ports\":\\[\"80\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"AWS Linux 2 test instance\",\"site\":\"AWS EU Central 1\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.31.21.128\"\\],\"ports\":\\[\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"icmp\\_up\",\"hosts\":\\[\"172.31.21.128\"\\],\"types\":\\[\"0-255\"\\]}\\],\"conditions\":\\[\"Always\"\\]},{\"name\":\"Admin UI Access\",\"site\":\"AWS EU Central 1\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"aws://lb-tag:kubernetes.io/service-name=opsnonprod/erp-dev\"\\],\"ports\":\\[\"80\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"aws://security-group:purple\"\\],\"ports\":\\[\"444\",\"8443\"\\]}\\],\"conditions\":\\[\"Always\"\\]},{\"name\":\"Test - Reason\",\"site\":\"AWS EU Central 1\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"icmp\\_up\",\"hosts\":\\[\"172.31.22.174\"\\],\"types\":\\[\"0-255\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.31.22.174\"\\],\"ports\":\\[\"22\"\\]}\\],\"conditions\":\\[\"Reason Required\"\\]},{\"name\":\"AWS London Appliances SSH Access\",\"site\":\"AWS EU West 2\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"aws://tag:Name=purple40.cryptzone.com\"\\],\"ports\":\\[\"22\"\\]}\\],\"conditions\":\\[\"OTP Required\",\"Not iOS\"\\]},{\"name\":\"Test - AWS West Test\",\"site\":\"AWS EU West 2\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.31.4.105\"\\],\"ports\":\\[\"80\"\\]}\\],\"conditions\":\\[\"Not iOS\"\\]},{\"name\":\"Test - Azure Test\",\"site\":\"Azure North Europe\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"azure://network-security-group:purple-endpoints-nsg\"\\],\"ports\":\\[\"80\",\"22\"\\]}\\],\"conditions\":\\[\"Always\"\\]},{\"name\":\"GCP Appliances SSH Access\",\"site\":\"GCP Europe West 3\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"gcp://instance:name=purple-gateway\"\\],\"ports\":\\[\"22\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"Test - GCP Test Server\",\"site\":\"GCP Europe West 3\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"icmp\\_up\",\"hosts\":\\[\"gcp://instance=\\\\\"name:purple-\\*\\\\\";serviceAccountEmail=82699087620-compute@developer.gserviceaccount.com\"\\],\"types\":\\[\"0-255\"\\]}\\],\"conditions\":\\[\"Not iOS\"\\]},{\"name\":\"Aitorbot\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"apt.devops\"\\],\"ports\":\\[\"80\"\\]},{\"action\":\"allow\",\"subtype\":\"http\\_up\",\"hosts\":\\[\"["
            },
            {
              "type": "text",
              "text": "https://got-helvetest.agi.appgate.com/testsd](https://got-helvetest.agi.appgate.com/testsd)\",\"[https://got-helvetest.agi.appgate.com/prsd](https://got-helvetest.agi.appgate.com/prsd)\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"pypi.ad.cryptzone.com\"\\],\"ports\":\\[\"8080\"\\]}\\],\"conditions\":\\[\"OTP"
            },
            {
              "type": "text",
              "text": " Required\"\\]},{\"name\":\"Akira Artifact Repo\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"cyx-sedev-repo01.corp.cyxtera.com\"\\],\"ports\":\\[\"1-65535\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"AppGate SDP License Server\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"sdplicense.agi.appgate.com\"\\],\"ports\":\\[\"443\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"sdplicense.agi.appgate.com\"\\],\"ports\":\\[\"22\"\\]}\\],\"conditions\":\\[\"OTP Required\",\"Always Fail\"\\]},{\"name\":\"AppGate SDP Manual Server\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"samanual.ad.cryptzone.com\"\\],\"ports\":\\[\"1-65535\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"agmanual.ad.cryptzone.com\"\\],\"ports\":\\[\"1-65535\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"sa-manual-srv.ad.cryptzone.com\"\\],\"ports\":\\[\"3389\"\\]},{\"action\":\"allow\",\"subtype\":\"icmp\\_up\",\"hosts\":\\[\"sa-manual-srv.ad.cryptzone.com\",\"agmanual.ad.cryptzone.com\",\"samanual.ad.cryptzone.com\"\\],\"types\":\\[\"0-255\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"fil002.ad.cryptzone.com\"\\],\"ports\":\\[\"1-65535\"\\]}\\],\"conditions\":\\[\"Always\"\\]},{\"name\":\"CZ\\_Terminal\\_Servers\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.17.40.48\",\"172.17.40.49\"\\],\"ports\":\\[\"3389\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"Chat Server\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"123.123.123.123\"\\],\"ports\":\\[\"443\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"Client to Client Access\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"icmp\\_up\",\"hosts\":\\[\"script://tun\\_ips\"\\],\"types\":\\[\"0-255\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"script://tun\\_ips\"\\],\"ports\":\\[\"80\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"Coverity\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"got-coverity.agi.appgate.com\"\\],\"ports\":\\[\"8443\",\"8080\",\"9090\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"DNS\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.17.40.8/32\",\"172.17.40.9/32\",\"172.17.93.10/32\",\"172.17.40.65/32\"\\],\"ports\":\\[\"53\"\\]},{\"action\":\"allow\",\"subtype\":\"udp\\_up\",\"hosts\":\\[\"172.17.40.8/32\",\"172.17.40.9/32\",\"172.17.93.10/32\",\"172.17.40.65/32\"\\],\"ports\":\\[\"53\"\\]}\\],\"conditions\":\\[\"Always\"\\]},{\"name\":\"Developer Desktops\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"192.168.111.150\"\\],\"ports\":\\[\"3389\",\"22\",\"5900-5910\",\"80\",\"443\",\"8080\",\"444\"\\]},{\"action\":\"allow\",\"subtype\":\"icmp\\_up\",\"hosts\":\\[\"192.168.111.150\"\\],\"types\":\\[\"0-255\"\\]}\\],\"conditions\":\\[\"OTP Required\"\\]},{\"name\":\"Devops DNS\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.17.93.10\",\"fd00:ffff:a:93:172:17:93:10\"\\],\"ports\":\\[\"53\"\\]},{\"action\":\"allow\",\"subtype\":\"udp\\_up\",\"hosts\":\\[\"172.17.93.10\",\"fd00:ffff:a:93:172:17:93:10\"\\],\"ports\":\\[\"53\"\\]}\\],\"conditions\":\\[\"Always\"\\]},{\"name\":\"Devops Servers\",\"site\":\"Gothenburg\",\"actions\":\\[{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"grafana.devops\"\\],\"ports\":\\[\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"envy.devops\"\\],\"ports\":\\[\"443\",\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"apt.devops\"\\],\"ports\":\\[\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"artifacts.ad.cryptzone.com\"\\],\"ports\":\\[\"22\",\"443\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"czse-mgnt-srv.ad.cryptzone.com\"\\],\"ports\":\\[\"443\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"esx://folder:Servers\",\"cyx-sedev-repo01.corp.cyxtera.com\"\\],\"ports\":\\[\"22\"\\]},{\"action\":\"allow\",\"subtype\":\"tcp\\_up\",\"hosts\":\\[\"172.17.93.0/24\"\\],\"ports\":\\[\"2{\"jsonrpc\":\"2.0\",\"method\":\"setModel\",\"params\":{\"view\":\"noneconnected\",\"viewData\":{\"sites\":\\[\\],\"userActions\":\\[{\"id\":\"renew-saml\",\"message\":\"AppGate Azure AD SAML Client\",\"error\":\"\",\"type\":\"renewSaml\",\"processing\":false,\"success\":false,\"show\":true,\"providerName\":\"AppGate Azure AD SAML Client\"}\\],\"appShortcuts\":\\[\\],\"entitlements\":\\[\\],\"setup\":{\"userApproval\":true,\"isCreated\":true,\"displayName\":\"\",\"selectedProfile\":{\"identityProvider\":\"AppGate Azure AD SAML Client\",\"id\":\"1262924097\",\"name\":\"Azure AD\",\"server\":\"purple.cryptzone.com\"}}},\"appSettings\":{\"autoStart\":false,\"autoSaml\":false,\"clientType\":\"Full\",\"ringfenceEnabled\":false,\"profiles\":\\[\"1262924097\"\\],\"selectedProfile\":\"1262924097\"},\"sessionDetails\":{\"connected\":false}}}"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The problematic part of the message:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\"ports\": \\[\"2{\"jsonrpc \":\"2.0 \",\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " This smells like some threading issue.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1592213891859
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The error seems to happen after UI is brought to the front. Which leads to a reconnection."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2020-06-12T22:05:29.905Z\\] Info : Parsed HTTP header. Waiting for payload.\n\n\\[2020-06-12T22:05:29.934Z\\] Info : UI has connected to service.\n\n\\[2020-06-12T22:05:29.938Z\\] Info : \\[UI\\] Connected to the service.\n\n\\[2020-06-12T22:05:29.956Z\\] Info : UI connected.\n\n\\[2020-06-12T22:05:29.977Z\\] Warn : \\[UI\\] Error with handling a message. Unexpected token j in JSON at position 10242"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I presumed the following would fix that kind of issue but let's see:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  private onConnect(): void {\n\n    this.readBuffer = '';"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1592214037176
      }
    ]
  },
  {
    "key": "SA-14137",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "https://sso.connect.pingidentity.com/sso/sp/initsso?saasid=21dac3da-de92-44ba-8e6f-3944584e93e5&idpid=40af977b-c9ce-4883-90e4-88ad54b74c6c](https://sso.connect.pingidentity.com/sso/sp/initsso?saasid=21dac3da-de92-44ba-8e6f-3944584e93e5&idpid=40af977b-c9ce-4883-90e4-88ad54b74c6c)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "ends up as"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "https://sso.connect.pingidentity.com/sso/sp/initsso?saasid=21dac3da-de92-44ba-8e6f-3944584e93e5&idpid=40af977b-c9ce-4883-90e4-88ad54b74c6c&SAMLRequest=fZDBTsMwEER%2Fxdp7gu02SVnFqSpVSJHgAoUDF7R1TImU2MHrID6fCIpULhxXo5l5O%2FX2cxzEh4vcB29A5RKE8zZ0vT8ZeDzcZBvYNjXTOOgJd3N68%2FfufXacxGL0jD%2BKgTl6DMQ9o6fRMSaLD7u7W9S5xCmGFGwYQLR7Ay%2F2qFYVVQXZolMkC0cl2ddj12lVleVmIWiZZ9d6TuSTAS21zGSZyeuDWqGSKNe5LqpnEE%2B%2F3EsLnCnx2xwv8f6nI2YX0xIDDU3TiZLL0vJffXUZ15zPvxs0Xw%3D%3D](https://sso.connect.pingidentity.com/sso/sp/initsso?saasid=21dac3da-de92-44ba-8e6f-3944584e93e5&idpid=40af977b-c9ce-4883-90e4-88ad54b74c6c&SAMLRequest=fZDBTsMwEER%2Fxdp7gu02SVnFqSpVSJHgAoUDF7R1TImU2MHrID6fCIpULhxXo5l5O%2FX2cxzEh4vcB29A5RKE8zZ0vT8ZeDzcZBvYNjXTOOgJd3N68%2FfufXacxGL0jD%2BKgTl6DMQ9o6fRMSaLD7u7W9S5xCmGFGwYQLR7Ay%2F2qFYVVQXZolMkC0cl2ddj12lVleVmIWiZZ9d6TuSTAS21zGSZyeuDWqGSKNe5LqpnEE%2B%2F3EsLnCnx2xwv8f6nI2YX0xIDDU3TiZLL0vJffXUZ15zPvxs0Xw%3D%3D)"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "which removes the second query parameter "
            },
            {
              "type": "text",
              "text": "idpid=..",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nvm, I was blind."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591717412132
      }
    ]
  },
  {
    "key": "SA-14118",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Because it looks for nameID and fails.."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"\\_91e533b1-0e60-41cb-8455-cf71181fadd2\" Version=\"2.0\" IssueInstant=\"2020-06-08T09:44:02.196Z\" Destination=\"["
            },
            {
              "type": "text",
              "text": "https://saml.appgate-sdp.com](https://saml.appgate-sdp.com)\""
            },
            {
              "type": "text",
              "text": " InResponseTo=\"\\_d20602a0acc06c12b1d4c0a636a9484e\">\n\n   <Issuer xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">["
            },
            {
              "type": "text",
              "text": "https://sts.windows.net/bf3fa960-485b-4f24-bb7b-e854f9e7631d/](https://sts.windows.net/bf3fa960-485b-4f24-bb7b-e854f9e7631d/)</Issuer>"
            },
            {
              "type": "text",
              "text": "\n\n   <samlp:Status>\n\n      <samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\" />\n\n   </samlp:Status>\n\n   <EncryptedAssertion xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n\n      <xenc:EncryptedData xmlns:xenc=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\""
            },
            {
              "type": "text",
              "text": " Type=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2001/04/xmlenc#Element](http://www.w3.org/2001/04/xmlenc#Element)\">"
            },
            {
              "type": "text",
              "text": "\n\n         <xenc:EncryptionMethod Algorithm=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2001/04/xmlenc#aes256-cbc](http://www.w3.org/2001/04/xmlenc#aes256-cbc)\""
            },
            {
              "type": "text",
              "text": " />\n\n         <KeyInfo xmlns=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
            },
            {
              "type": "text",
              "text": "\n\n            <e:EncryptedKey xmlns:e=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\">"
            },
            {
              "type": "text",
              "text": "\n\n               <e:EncryptionMethod Algorithm=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p](http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p)\">"
            },
            {
              "type": "text",
              "text": "\n\n                  <DigestMethod Algorithm=\"["
            },
            {
              "type": "text",
              "text": "http://www.w3.org/2000/09/xmldsig#sha1](http://www.w3.org/2000/09/xmldsig#sha1)\""
            },
            {
              "type": "text",
              "text": " />\n\n               </e:EncryptionMethod>\n\n               <KeyInfo>\n\n                  <o:SecurityTokenReference xmlns:o=\"["
            },
            {
              "type": "text",
              "text": "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd)\">"
            },
            {
              "type": "text",
              "text": "\n\n                     <X509Data>\n\n                        <X509IssuerSerial>\n\n                           <X509IssuerName>CN=appgatectrl.smallprawn.com, OU=GIG, O=GT, L=Singapore, S=Singapore, C=SG</X509IssuerName>\n\n                           <X509SerialNumber>612231384853597392478109146512459773372433536405</X509SerialNumber>\n\n                        </X509IssuerSerial>\n\n                     </X509Data>\n\n                  </o:SecurityTokenReference>\n\n               </KeyInfo>\n\n               <e:CipherData>\n\n                  <e:CipherValue>H3yE2n1iy0z4QFZuYVbYA2kg94lEQyRLRoepTcHfl/IOvPuOm+LCiT9U9sy8fipT9J5eLqIq7TEAlHamxslzkQEvhnaTIDfBIkMwdRx8Hyt1JTKxCu+NsHt+eQhZc3GQx9qVOe1tIRUsUIBnGcev0d3Y1Tdnse5otHgvjs+ou+4OGaS655UgwJinB5VCKF2psY9wXm6+g30Jxufkdwti2ZtEv9JntM1IGVcbV4VTJ5oOqg/USu6HZohEXmLxlihOVo8DAjW5eTrQINyhgJ4fT6shQNR1aviY3DXz+XbgzDK/wR/bh8cemYvOIG8248Fcpk55huXSfawIDFdmiQsq4g==</e:CipherValue>\n\n               </e:CipherData>\n\n            </e:EncryptedKey>\n\n         </KeyInfo>\n\n         <xenc:CipherData>\n\n            <xenc:CipherValue>EGfCRxmJz1VcBKb3zSopV0khxwNjw5JfjVfa1NE7BJrw+G+KZqB2FksyweTFeru8/GpUn2FT6aG0m86zutPWHtDkqrn6pPcTGwoXcXJiZCml7HqzVp35h1ODsHWcV6Y94O3o/8/Yio1LVTCGX5wtiXW4NdEtz9NwiSrsClR4lijlIkQOOSpmkuOrAjhAHHfasbNoheT5vVy546m4g+wDOXZ469z72LuuRzY3NKe4zCFAarLgHIk5WggQzEt855otS4t99mqcn/xbHaIz0HEOQ0krce4l26CDTV54+a3LCc5XR9ZoKIE0mgNOXKsIdKKn4UFcubk7EduKrEDkKNklgHPH0w594zBItrBzaWjWXSzXmmgFb10GPrOUjY0ftbyVem8H7Z3hVuPdA9qXH4pf8uglV8mQOHPSfNY/x0gsU8PV0e8EMZyB09hWuq0mf8uoUen8O+YgAkmwzPUcuGT+e8SYF+cgehxOl9FT11WoyZGNiLyOLhx47lnu3w3bNV5zEL8qiNobXV5fyDWww1k3ybarUTVqqGLNeofJ7sN9ktydOue5ksKH7Du0DUuJqxMphcvE7f1yWIgKo6mN/dJ0Rqs5fGis+ZdseKRPTUnhVCUXPxMeEGmsHh6bkWMwQt9qRpEaZ3VLhNG5KkPCODRgrftG6U3UcZ4rzZH7MZ8gAxGPK02BJueicqTMeq3agCx/j1+sTKR3IPbpv5Bl2Ewlpj42Y9ZW9Wez5VLx0YNfjf3eoT0lSqZgluXmBD7EhE3KxSpogQodwrNbq7dWFrGhvwX4amCPRCDgOmL5viBQyMCE88rRvFlbfsEjdhUiy2GyD3TaOREk/Ygumo9qWwAnV1rITb2NQ4wPvqFEUZC/kC53c9UvdzIFIF9wXWxFSI6B2pZDJPYvGss+PSqFFT9RxSDR/tJegqOSs+r3BzotCRHzpHbKHeDg/8gNLqh5ZyH+MVNAUJWPrPnBVyHNmUWPRllAnT4Yc+w72sjSkPyCUJFAD591PWYanD3PIKKvwRQ9n8H3hJIFVVpq2zOgAWPalizT9T/TccBrj5Rk0A2A75n+v5oqs/iw5tz4DQzzheRXWR/aOGGdSF+oxgGY5RHw+1csbpXtKBL6B1JITHlILp4dk69ME4t3Y3YOJwA9ZKe7XN/8HZcVPv0pjoGm+H5FDgyKObvVPca35gQqVKDkupuyK2Yk2BgawIItnW1ROiPNK6PZtXRDmdSQKvm+N0Dsj3h/43Q2VA2oHwmTM3zU9ojnJ/d8Yz2j2k5hSMHB1r0j4kYbG+GvVQhCb6CEOCAaa/Bv+1wHHgF2tWnPn38KU9Lhh/MUTg1F7TEjgA0BeerhgEJ8hzTACHD+3OnJavPsyL+44kbKBAHVUZ9mES0zPmKzt/W26XRKKdwlULUJOJN/9a70T8W6/1v8751Yic097DHX3oZFB56ZKy0Xah1gJy180RbovKwChHnYDbZ8gExiM/w2Q+bdbYmhpDoI9xg2XDT1fd+71S/LC2r9WE5sVgf4fGl+nHXK6U0Mav5JITLQCLgin/yU5oqXCsSA4L1RiQVnwtzgpiqtD9t6mvdDwPSWzy+ScelQaUHKiVyhrM1eHFSM2BfzGqeSQzRiAV9JTShSkI/gs0D5Xnx8f7+JsKSyI1tbt0uDRF4rkzi77NmyDCtjdVEeDA4mf8gw8EopxKKFCSlTG6dGY3uLAHI4BeViwgMx3J0MQ6R+B3vbym0FZOy8BuTLX54NL2Tnn+nWZmCw6GQPOZwpY25h7fdjjv6y9DXGhup74T6yNVgtVpNnl+mu1ogbAxPFqgjJnMN42HuLduvEBoFt8SxQYNhJ18vI3OdzNaMi8UUaImQ1yqmd/5gZCTfOPB0wveo5xDs0Mon5/kYgZSaco4cLIIx+dNVbdnuDK/iRn0in1g/+dcI/YlHFXB6rSkiKnyPIdxIcZLTre8O3x8/okHm+kAXd7r5t2S/MBabn+tuMr2TZA5/CGHphNxjXXlBQov3EtXcE/BuGwY9XZdBlKjR3iPXZoekMRDYtERfSKk2lKxvlKHvGqWOdX3b7LRXv+/kBsVm62ha+JpFIrc94gK4l8aCkmGoA1b3jonsrnx40Ydy9onxhME3ZrGYQvHasp60lX96KIQxjpreCFW4JVErRlpmqcO34Fw4x7yyscp6fopv6DY8Muw/hMBuYl56+QaOlhvP/V9R+DMebNB1ll1Hf48Yho6jwpt3IlCIxNDkQhbHK64xvHtxDrCa9kGVd1/1Jis2TqY+djOTyKWhBAtefCkJfqBCoi4pbfOvgFlOmqSVikcawUJP5A1SwgcdOm2FBd0Iwl2jZbT0xCspE8G0nxqMYQd5sH7kShKEopn8TnGt9hdjMpliGUX3ccjBZUK+sGSimsAkWcdata+O46pjqkNV3ZfOH3W4p8seHf3QmvD7U//zSjc8guZMSz/C7yrknKLLyaaloFq7eQH5HuKgs8/lUUl7vKVWMuxuSz+B2VGXTRn484iOkLnQMVKXbIJC9xkPMqUUWtC+XT1kBjtR9V9RMa3jEEy4FzcYIG78mFqZolepPdAnaGVdY8T24Fx/Jl/s3xjifiNscn0ApA/KyhUDG2CjDjM8L2duEXu0MI26maYdZJ1HN5ncDVvlRFui2w8Uy1qA1VW50SlYLHzkSyje4BkCEbt9SOZXeqknpGu/j2btQNEdFfMZDbVt0t+bapdortZFtCiDusTIG26eWnGLYssX+q4lcKzfmLcFIYktZJaRfSWOvdTJCgZTEDn/Oeus6sQVTv+WTBhJQ1yJZrY/KQ/a8aJDScnSSh+L2d3pCt6y+oe7jX2uLWb8oOsDKGk95gzf/Wro6cMABrV9DJvYXHbV+bAz6xpdWP3SnBmFZnZYMwz/+CKVSXL4pstHCDv2jwBoAErSWrB7lIeeVVqHmnDWrfodLx1nakL+jQE4x0BoT57Ribovnx2zyAG3n+RNoaEIU2F+vLI5aopCK3vamHK+yjYclqsAeyZ2oW8DcUvL3xD1HsFxkneIeZb6mO+GbvuH8l1OAz5pJHJqyhklI5LIiSAGH7IoO/Dcoq7b3td+WcirEoKawdSaRAw80Q7/vcquXj21qJAEr4ma0ZklWXS91AQ56Es0sBXDBn+UQ5EGgC+y0t/9KY/JLL9Dsx8zXRIn+CP/xrnI+KTHUQuflQCaxYU+NoFkvGnxliFCwicX9Sd0LaF0umI9qmXR5E/o2P1vsOTJitW7OGG/aKPMN1Sm6v4co4YwxegtzDZ8pj7xasVt1wn5bg3DuBGE5g2DWMfs+GpRjkUACAWg3ZlXmBLaKTwJD5cJHpmH9q67xr4B3IwV/gIi2KXox/c5Xoyd1pyMUiarubt9YxTR9LOFcYOnAPjTVZe3Ma/kemmNfEcUUxRjK5Gpv3JxR420+Ks5aP66r9u4Ez0FEMlOphcXSqWm9kYLnskRX7q5MQ3mdnJbE3AcxGwX7J3J3xpmgI8xGGxd1wxgHwupFOgAxTSRwfbNmlRES3bUoT0za3opUTHNTKl2N2gMgupKPOC0wJ1QDe9Q0x4PVew2wEE6dyvtyneor+gyDuG1ZD0sAZAkVUcmGrz+OdIkmfKulBTF0GWuXCVs5RsYwi4/pacYIyuJRUjsc1D6xrCQAkXygKz4oaMMLgvW0/4ZHvYWS/9q0q4uV35H1C8FohJuc2OM6tl9B2v2O0DR6s7AdamdmkJrFuyWiMtbNidcyC8v/c33Zi9VHQVYz/+Fi52TwR/6tSIvlsPOahe8l0agCyBcTkoBKk03sIa0Zd0ErYqxpuPd1k+mEqcrjRHvp4kzQFFmb35syotJwRds8NhBAS3xAPTTKPxGR9iwRWTKglwYxopGUde4nk3wbxOtSc+cNyOWwu6GR4p9OWGgptVwdsMAzFCNS3nJjkI2FlcgbbZfoRqw5oNzSrgZhaSK7MTdhqX5EEKAa0y59r+wJ8sBPqShBvS5CL54tmaGdzs5EnDFlut65S5k+DAoz1obJQMabYAtk1t94OcFVlOzRfHucwKXpdge4olZ7QGPBjJC9j+t/1cSFAnjYMp63LUu8ioCY+34JIzMumyyRO6zqJk4wSvDc83XiftawDlBd3U8fd8eMdptREkEDtaqCswdjBbj0uNqzJpxJSqc8LUlkcquwvKUyICWOCWX/dlxLbft5tUVwSgmshdiKGtPX1OKU0nD8lK9mMHo9q5l8sQVLsLrO+2FJVtyWdihhexsfR+hAexGHupQjL6KUQ98fUpQzfOVfUEZEneLk92NHOPtjU25msBsKRMeFYXXpCb9dRlZoj1W7Jp28ilgMiPCzZ3RO7e5/Wt7VchEr3DX7tejkXePacmZpJWygH/Nml5Z/y5bwkz/LCaagEdFtPnbv5bkZIJw99CBVFWnMVr1lYGs9clBOz+2a/BShFMb6mG0eUPzJ7pgFbC/7YaVVNsjoeD8r2lRcDpXtFCnnbhuVV9BVhe7o/5X36QFjdKIFvkJQQTS7sDVlg/+jYwO4KsL06HLIqT7eDYbFwIMOPOJkygX2YLeYOwd5GotUkoW1GZB6/cWVKyGciTYcaRa9KScrdMi9wDkoqXuf8v/L+N21UOGw128JGiwvup3Gir0x2/UTpAD4p0fitponL4X6S7fvR9dJsyQxBYqGDZSfYpmXom6YUKzNlrrBos69XcUpeHVwGjFHZaLHuhLwtyQR59lM5WWA8H0dD4Z+XBB8/5IGEb2HomqlvjcWDr6gOZFBClolNHZ7x3WViZ31TyzaMFyJV23PBkOE8V9mtIoRN2OuxLwH/B1poFcpO1yyMxcI/gM0/EzrrqDJDP3jaVnFXtW183/sR/ilbVLr15+dzj6RbUVUU/sUqFe5RsT4dTp0z/uGXTNSpSbSDTiXynDTizSpekxdRkj6Y+0VJ9U4WrF45d0MhAyEdofPdNSnfVqMW15gMEOx1LvYpiTc2ww/LjNrqgNnms6prMLH+c7EAFOSIFRTvi/E0EB67qcMSoJeAxN/YykSZYQdiBAFe5N1f1Z8bskA7HJaqrH24CEDEToGp3+wlZqViSGmoSTlAS3FcCRr7FZy0Ctm3CRVEGB97y72/p9RiCs3VojC1tP7AAgLDSYIZmRdcWpTOWvq6PiFJq6YIQIWohNiO9t2+zDQKG17eWjh4iKExHqO9LbzEawPTegmztaykealWd0CzkF3Bci93dposlG+sZdH8gwmO/C9yROmWx1bXqVf/IJGnkodDeq6G5G2NuWVajpNf/8qsNgY6hjmD+DC9YA0AwDtGAKE4xrzpxrs2+iyGiAUlvPnVfaTr+SnVie0C4fAvb2CUMlJtNcODKMF2VQoFXIfHDqRMC782KfXJnGq9FRpMwv4bgHYalKyjkqv9FAIK2/mIvte3vj6s9wUIrfkc2p9LXdgkJoldGJUego75mKZ4JkBtdpEogqq3XC98Qq/xnX8aq9VOL6f0MRn4IDmfBQRgjKUft0QX7o8GGS79pnZ0kVE4trmMTWCdZD96K7/GZ0fcQtIB76VSPYlMBL918pSuv8kmAnD3HSs0HYc+mI8VHCcFhWTSGxwjLALrD5L80yMhx7oernLFBEa/GzmyoEYwqnh3MJnXlJQNsHJ7lYS3JygHJY5WmB40kOQALbr70XWjlRU27Y4CwOaTNid9THqqWEQv3dA8Qn5xBaRsxdjvLPqOS/Reg7dnoyL7YNGMhM5g4gc47ufuUo4rlbzwW3mZhE40EG0uXbJfj5F1nKaAPi4spvelIoAof+2oziL600faal3WDmQHGUrpzZgTl1zqdKguB9I8yEAl+ulmA7oHzMHTt3uIRBeN5rHNl1V6XpZw718QInFy2kUztE3FJku+OPrDYwhuXp7w69hSS8+d1O8dLdm53vc5j0HKBDgZK8gi8TpsRRTf6RjU/mvu7kJ3Tci1/8qrKEZnIMZlboIS5Fe7Cif+gXpIp7v7oyZqBtqXSe5X5l3tpsOnWN1deE53yAGDuBpAy0ZOyl7IHkdEeiZ8Cbc7ROL12FsD+kaSNflNxRKffcGvL5bHp/Wjo1Hp2Bm7PW7JTrLmVJpVY+HXNz3zGsAFYQ9juB940xqnYCqechpxGp74BtdMTPRTFlJrgxSs6WQMa4F2O2zuWJE7QUho9WEar/UkzrruKTSY7k9DnhzST6zbm8EeN8NG6+BZQw2QYpbr1i+c87C6OdMkRVN/s9MEEz59EIoU7/bDbS2vztPrsZcaw+In0WY/s+u/JWh+I65NoieiM2e751elJYt630kEY8qCWatj1awdVDx8J9owUuWwuiKMfAzU5oIokIrgKyhy2v6zhvQwKC4hkKg5ILKpPzHMAyV23AzPQ0JRKAwIxOIfwBzDLPS7Fb0L8cw5RLmQciJnVQMV3f7Bir8op20W25DHhJwV9s/JUz73wiVLqRMDV9SliGTKMAWICW1w1wkS9rytL8o9dAMBuOKIPUa7e9dUw8oxHac8hGkHjEY5jAXA+lTeL8eNsnIubt6/8FJFKrfplVc7WFsZTA5MAegfJiBtkaEjVVtTP2fa6HwheVS4jIARyVCkHs3Y75Q+2CONlezAPB0V/1Jg1AKM7XbZ1JoI6j3S0Ps8QNRZ5jl1q1IN4VDi2EP3K+MW6Jl43O0Y5SFUuvBemr3IMODZlYplvutnJ8nH7Typ/IBrZkNrn0uCqH2326+zh7WEA==</xenc:CipherValue>\n\n         </xenc:CipherData>\n\n      </xenc:EncryptedData>\n\n   </EncryptedAssertion>\n\n</samlp:Response>"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the saml flow:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Get SAML token from provider"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Try to parse (for a few versions) the nameID"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If it succeeds, the flow is the same as before."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If it fails, then you send the token without any cookie."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If on-boarding MFA is disabled, Controller will return 200 with username+cookie. Store it."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If on-boarding MFA is enabled, Controller will returned 412 (I think) with username (5.2 Controller)."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If the username is not there, you can give up or just do the MFA anyway. It will be MFA every login in that case."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Take the username and check if you have the cookie already in the SecureStorage"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If you don't have the cookie, go the MFA step."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  If you have it, try logging in with the cookie and the SAML token"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Controller may still return 412 after this if the cookie is wrong. Then go to MFA step."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Otherwise Controller will return 200 with username+cookie. Store it."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591705005945
      }
    ]
  },
  {
    "key": "SA-14086",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "[^image.png]"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "If I disconnect and sign in on Android I get this"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "hmm, it must be either caching the URL or the token"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "it's probably not a new bug, but rather something we now noticed with Azure AD which uses the timestamp from the SAMLRequest"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Couldn't reproduce this, even left my phone running for a longer time, disconnect > still able to reconnect without issues. Same for emulator. Maybe someone else is more lucky."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1591692574589
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What do you need in case it happened? I got this after keeping my phone connected for several hours. Maybe a test env with very short claim and entitlements token can trigger it more quickly. I will keep it running today and see if I get it back"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kurt.glazemakers",
        "created": 1591775650102
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The odd thing is, it didn't even trigger the SAML. It just used the existing token it looks like:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2020-06-04T11:24:48.147Z\\] Info : \\[UI\\] Signing in with SAML.\n\n\\[2020-06-04T11:24:49.153Z\\] Info : CA certificate found in the storage for 'purple.cryptzone.com'.\n\n\\[2020-06-04T11:24:49.153Z\\] Info : Resolving hostname 'purple.cryptzone.com'\n\n\\[2020-06-04T11:24:49.160Z\\] Info : Resolved IPs: \\[35.157.222.129, 35.177.27.1, 35.157.235.196\\]\n\n\\[2020-06-04T11:24:49.161Z\\] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA key name 'CryptZone'.\n\n\\[2020-06-04T11:24:49.424Z\\] Info : Identity Provider AppGate Azure AD SAML Client found.\n\n\\[2020-06-04T11:24:49.424Z\\] Info : Logging in using 'AppGate Azure AD SAML Client'.\n\n\\[2020-06-04T11:24:49.425Z\\] Info : Authenticating for the first time. AppGate Azure AD SAML Client\n\n\\[2020-06-04T11:24:49.425Z\\] Info : Retrieving claims token.\n\n\\[2020-06-04T11:24:49.426Z\\] Info : Fetching on-boarding cookie for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-d54608a6-e7b7-69c0-79a9-3149168baa60' from secure storage.\n\n\\[2020-06-04T11:24:49.431Z\\] Info : Got write permissions\n\n\\[2020-06-04T11:24:49.468Z\\] Info : On-boarding cookie available for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-d54608a6-e7b7-69c0-79a9-3149168baa60'.\n\n\\[2020-06-04T11:24:49.541Z\\] Warn : Authentication to '["
                },
                {
                  "type": "text",
                  "text": "https://purple.cryptzone.com/'](https://purple.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": " failed on first login.\n\n\\[2020-06-04T11:24:49.542Z\\] Warn : SAML authentication failed"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591808788346
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Just to make sure that it sent some sort of SAML token I checked kibana:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "reason:\u00a0\u00a0\u00a0\u00a0SAML assertion is either not valid yet or expired."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591865578431
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The previous login included on-boarding MFA. And I believe it does not cleanup the token in that case."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591866459607
      }
    ]
  },
  {
    "key": "SA-14056",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Stumbled on this: "
            },
            {
              "type": "text",
              "text": "https://www.peternijssen.nl/high-availability-haproxy-keepalived-aws/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://www.peternijssen.nl/high-availability-haproxy-keepalived-aws/"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Doesn't look too hard if using AWS CLI + the appropriate IAM role on the iot connector instances."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Next, create the /etc/keepalived/failover.sh on both servers. Make sure that the instance"
            },
            {
              "type": "text",
              "text": "id has the instance ID of the other server. "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "#!/bin/bash\n\nEIP=52.212.151.17\nINSTANCE_ID=i-0bdd8a68eb573fd1a\n\n/usr/bin/aws ec2 disassociate-address --public-ip $EIP\n/usr/bin/aws ec2 associate-address --public-ip $EIP --instance-id $INSTANCE_ID"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is now targetted to 6.4."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1702991967342
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A few potential steps here:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Try it out manually"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Make it work with keepalived"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Make it work with configd"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Make it generic so we can do the same with gcloud & azure"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1705565385216
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Should all the agents for all the clouds be installed by default on the appliance?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1716892652789
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "That would result in quite bloated images so I want to say no. Note that it doesn't require the agent, just making some API calls."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In the old named resolver (release-6.3 branch) and in aitorbot we have a very small aws client implementation that we could reuse if necessary to do the 2 API calls."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "To start with, for the proof of concept phase it should be enough to install AWS cli, e.g. via a customization."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1716896053638
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "named aws client: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-gateway/blob/release-6.3/named/named/resolvers/aws/client.py",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-gateway/blob/release-6.3/named/named/resolvers/aws/client.py"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "aitorbot aws client derived from named one: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/aitorbot/blob/master/aitorbot/aitorbot/aws.py",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/aitorbot/blob/master/aitorbot/aitorbot/aws.py"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1716896258244
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "To be honest I didn't manage to set up HA at all with the connectors. The current thing that should already work."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1717162600001
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The current thing definitely does work since its setup on purple."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1717402393018
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe best to try on the release-6.3 branch though to avoid issues due to coredns and whatnot in 6.4"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1717402417423
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Somewhat relevant doc from aws on floating ips "
                },
                {
                  "type": "text",
                  "text": "https://docs.aws.amazon.com/whitepapers/latest/real-time-communication-on-aws/floating-ip-pattern-for-ha-between-activestandby-stateful-servers.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.aws.amazon.com/whitepapers/latest/real-time-communication-on-aws/floating-ip-pattern-for-ha-between-activestandby-stateful-servers.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1717416828532
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "On the part of \"checking\" vrrp depends on ARP, so we need to use another mechanism. Keepalived provides support for \"check scripts\" for this purpose, see e.g. "
                },
                {
                  "type": "text",
                  "text": "https://tobru.ch/keepalived-check-and-notify-scripts/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://tobru.ch/keepalived-check-and-notify-scripts/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1717417270451
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Its possible to use either the allocation id or the public ip in the aws API call, here with the AWS CLI: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aws --region eu-north-1 ec2 associate-address --allocation-id eipalloc-01adba1049bb6c37e --instance-id i-05c45e5f1570f5483 \n{\n    \"AssociationId\": \"eipassoc-066aace6ac873cb8c\"\n}\n$ aws --region eu-north-1 ec2 disassociate-address --association-id eipassoc-066aace6ac873cb8c\n$ aws --region eu-north-1 ec2 associate-address --public-ip 16.16.240.191 --instance-id i-05c45e5f1570f5483 \n{\n    \"AssociationId\": \"eipassoc-03803b0f747678a79\"\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This means we could possibly keep using the existing VIP configuration with an IP instead of requiring an eip."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736848084795
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So a public elastic ip is actually not what we want to move around but rather a private ip."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "# Reserve VIP in subnet\n$ aws --region eu-north-1 ec2 create-subnet-cidr-reservation --subnet-id subnet-0faaa777 --reservation-type explicit --cidr 172.31.32.166/32\n{\n    \"SubnetCidrReservation\": {\n        \"SubnetCidrReservationId\": \"scr-07cadd74e71e1d676\",\n        \"SubnetId\": \"subnet-0faaa777\",\n        \"Cidr\": \"172.31.32.166/32\",\n        \"ReservationType\": \"explicit\",\n        \"OwnerId\": \"194335033129\"\n    }\n}\n\n# Assign VIP to Connector1's ENI\n$ aws --region eu-north-1 ec2 assign-private-ip-addresses --network-interface-id eni-06fc544f5a0514b5d --private-ip-addresses 172.31.32.166\n{\n    \"NetworkInterfaceId\": \"eni-06fc544f5a0514b5d\",\n    \"AssignedPrivateIpAddresses\": [\n        {\n            \"PrivateIpAddress\": \"172.31.32.166\"\n        }\n    ],\n    \"AssignedIpv4Prefixes\": []\n}\n\n# On failover, detach from Connector1's ENI\n$ aws --region eu-north-1 ec2 unassign-private-ip-addresses --network-interface-id eni-06fc544f5a0514b5d --private-ip-addresses 172.31.32.166\n\n# And attach to Connector2's ENI instead\n$ aws --region eu-north-1 ec2 assign-private-ip-addresses --network-interface-id eni-055995dc42074937f --private-ip-addresses 172.31.32.166\n{\n    \"NetworkInterfaceId\": \"eni-055995dc42074937f\",\n    \"AssignedPrivateIpAddresses\": [\n        {\n            \"PrivateIpAddress\": \"172.31.32.166\"\n        }\n    ],\n    \"AssignedIpv4Prefixes\": []\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736860953541
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You can allow VRRP in the AWS SG: ![](image.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736862505029
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Get the network interface id: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@connector1:/home/cz# TOKEN=': TOKEN=`curl -X PUT \""
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/api/token\""
                },
                {
                  "type": "text",
                  "text": " -H \"X-aws-ec2-metadata-token-ttl-seconds: 21600\"`\nroot@connector1:/home/cz# curl -H \"X-aws-ec2-metadata-token: $TOKEN\" "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/meta-data/network/interfaces/macs/0a:52:35:63:ca:d5/interface-id"
                },
                {
                  "type": "text",
                  "text": "\neni-06fc544f5a0514b5d"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736863000107
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "AssignPrivateIpAddresses.html ",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "UnassignPrivateIpAddresses.html"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736863678837
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "TOKEN=`curl -X PUT \""
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/api/token\""
                },
                {
                  "type": "text",
                  "text": " -H \"X-aws-ec2-metadata-token-ttl-seconds: 21600\"`\n\nIAM_ROLE=$(curl -sS -H \"X-aws-ec2-metadata-token: $TOKEN\"  "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/meta-data/iam/security-credentials/|head"
                },
                {
                  "type": "text",
                  "text": " -1)\nAWS_CREDENTIALS=$(curl -sS -H \"X-aws-ec2-metadata-token: $TOKEN\"  "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/meta-data/iam/security-credentials/$IAM_ROLE)"
                },
                {
                  "type": "text",
                  "text": "\nAWS_ACCESS_KEY_ID=$(jq -r .AccessKeyId <<< \"$AWS_CREDENTIALS\")\nAWS_SECRET_ACCESS_KEY=$( jq -r .SecretAccessKey <<< \"$AWS_CREDENTIALS\")\nAWS_SESSION_TOKEN=$(jq -r .Token <<< \"$AWS_CREDENTIALS\")\nAWS_REGION=$(curl -sS -H \"X-aws-ec2-metadata-token: $TOKEN\"  "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/meta-data/placement/region)"
                },
                {
                  "type": "text",
                  "text": "\n\nENI_ID=\"eni-055995dc42074937f\"\n\n# Assign private IP to ENI\ncurl --request POST --url \""
                },
                {
                  "type": "text",
                  "text": "https://ec2.$AWS_REGION.amazonaws.com\""
                },
                {
                  "type": "text",
                  "text": " -H \"x-amz-security-token: $AWS_SESSION_TOKEN\" --header \"Content-Type: application/x-www-form-urlencoded\"      --header \"X-Amz-Target: AmazonEC2.AssignPrivateIpAddresses\"      --data-urlencode \"Action=AssignPrivateIpAddresses\"      --data-urlencode \"Version=2016-11-15\"      --data-urlencode \"NetworkInterfaceId=$ENI_ID\"      --data-urlencode \"PrivateIpAddress.1=172.31.32.166\"      --aws-sigv4 \"aws:amz:eu-north-1:ec2\" --user \"$AWS_ACCESS_KEY_ID:$AWS_SECRET_ACCESS_KEY\"\n\n# Unassign private IP from ENI\ncurl --request POST --url \""
                },
                {
                  "type": "text",
                  "text": "https://ec2.$AWS_REGION.amazonaws.com\""
                },
                {
                  "type": "text",
                  "text": " -H \"x-amz-security-token: $AWS_SESSION_TOKEN\" --header \"Content-Type: application/x-www-form-urlencoded\"      --header \"X-Amz-Target: AmazonEC2.UnassignPrivateIpAddresses\"      --data-urlencode \"Action=UnassignPrivateIpAddresses\"      --data-urlencode \"Version=2016-11-15\"      --data-urlencode \"NetworkInterfaceId=$ENI_ID\"      --data-urlencode \"PrivateIpAddress.1=172.31.32.166\"      --aws-sigv4 \"aws:amz:eu-north-1:ec2\" --user \"$AWS_ACCESS_KEY_ID:$AWS_SECRET_ACCESS_KEY\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736864538184
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Create an IAM policy, e.g. call it "
                },
                {
                  "type": "text",
                  "text": "SDP_Connector_HA_Test",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ": "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n\t\"Version\": \"2012-10-17\",\n\t\"Statement\": [\n\t\t{\n\t\t\t\"Sid\": \"VisualEditor0\",\n\t\t\t\"Effect\": \"Allow\",\n\t\t\t\"Action\": [\n\t\t\t\t\"ec2:UnassignPrivateIpAddresses\",\n\t\t\t\t\"ec2:AssignPrivateIpAddresses\"\n\t\t\t],\n\t\t\t\"Resource\": [\n\t\t\t\t\"arn:aws:ec2:eu-north-1:194335033129:network-interface/eni-055995dc42074937f\",\n\t\t\t\t\"arn:aws:ec2:eu-north-1:194335033129:network-interface/eni-06fc544f5a0514b5d\"\n\t\t\t]\n\t\t}\n\t]\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736864731348
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The python client aitorbot uses "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/aitorbot/blob/master/aitorbot/aitorbot/aws.py",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/aitorbot/blob/master/aitorbot/aitorbot/aws.py"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " The old python client that named used "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-gateway/blob/release-6.3/named/named/resolvers/aws/client.py",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-gateway/blob/release-6.3/named/named/resolvers/aws/client.py"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736865549311
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The only tricky thing in the SDP config is that we need to assign the static IP as well as the DHCP with the matching IP address. This is so the controller can send the other connector's IP to each connector in the HA pair."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736865585534
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The IAM Role assigned to the HA Connectors: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aws iam get-role --role-name SDP_Connector_HA_Test\n{\n    \"Role\": {\n        \"Path\": \"/\",\n        \"RoleName\": \"SDP_Connector_HA_Test\",\n        \"RoleId\": \"AROAS2P2FI4UXUC3TVU7P\",\n        \"Arn\": \"arn:aws:iam::194335033129:role/SDP_Connector_HA_Test\",\n        \"CreateDate\": \"2025-01-14T14:27:16+00:00\",\n        \"AssumeRolePolicyDocument\": {\n            \"Version\": \"2012-10-17\",\n            \"Statement\": [\n                {\n                    \"Effect\": \"Allow\",\n                    \"Principal\": {\n                        \"Service\": \"ec2.amazonaws.com\"\n                    },\n                    \"Action\": \"sts:AssumeRole\"\n                }\n            ]\n        },\n        \"Description\": \"Allow SDP HA Connector to assign and unassign private IPs dynamically.\",\n        \"MaxSessionDuration\": 3600,\n        \"RoleLastUsed\": {}\n    }\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The policy: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aws iam get-policy --policy-arn arn:aws:iam::194335033129:policy/SDP_Connector_HA_Test\n{\n    \"Policy\": {\n        \"PolicyName\": \"SDP_Connector_HA_Test\",\n        \"PolicyId\": \"ANPAS2P2FI4UUEBYZ5AJ5\",\n        \"Arn\": \"arn:aws:iam::194335033129:policy/SDP_Connector_HA_Test\",\n        \"Path\": \"/\",\n        \"DefaultVersionId\": \"v1\",\n        \"AttachmentCount\": 1,\n        \"PermissionsBoundaryUsageCount\": 0,\n        \"IsAttachable\": true,\n        \"Description\": \"Testing the AWS Connector HA functionality in AWS.\",\n        \"CreateDate\": \"2025-01-14T14:26:17+00:00\",\n        \"UpdateDate\": \"2025-01-14T14:26:17+00:00\",\n        \"Tags\": []\n    }\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The policy version: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ POLICY_VERSION=$(aws iam get-policy --policy-arn arn:aws:iam::194335033129:policy/SDP_Connector_HA_Test  | jq -r .Policy.DefaultVersionId)\n$ aws iam get-policy-version --policy-arn arn:aws:iam::194335033129:policy/SDP_Connector_HA_Test --version-id \"$POLICY_VERSION\"\n{\n    \"PolicyVersion\": {\n        \"Document\": {\n            \"Version\": \"2012-10-17\",\n            \"Statement\": [\n                {\n                    \"Sid\": \"VisualEditor0\",\n                    \"Effect\": \"Allow\",\n                    \"Action\": [\n                        \"ec2:UnassignPrivateIpAddresses\",\n                        \"ec2:AssignPrivateIpAddresses\"\n                    ],\n                    \"Resource\": [\n                        \"arn:aws:ec2:eu-north-1:194335033129:network-interface/eni-055995dc42074937f\",\n                        \"arn:aws:ec2:eu-north-1:194335033129:network-interface/eni-06fc544f5a0514b5d\"\n                    ]\n                }\n            ]\n        },\n        \"VersionId\": \"v1\",\n        \"IsDefaultVersion\": true,\n        \"CreateDate\": \"2025-01-14T14:26:17+00:00\"\n    }\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1736865798462
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe we can avoid the subnet cidr reservation step by using the "
                },
                {
                  "type": "text",
                  "text": "--allow-reassignment",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " flag, not sure about the timing though. I guess that unassigns the IP from the other instance?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See "
                },
                {
                  "type": "text",
                  "text": "https://docs.aws.amazon.com/cli/latest/reference/ec2/assign-private-ip-addresses.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.aws.amazon.com/cli/latest/reference/ec2/assign-private-ip-addresses.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1737018730728
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Notes about how to configure this feature:"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "IAM Role in the connector EC2 instances"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The connector EC2  instances need to have assigned an IAM Role with the following actions:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "- ec2:UnassignPrivateIpAddresses\n- ec2:AssignPrivateIpAddresses"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "with access to the ENIs attached to the connector instance (the ones that are involved in the Connector HA)."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Security group for the connector EC2 instances"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Each ec2 instance should allow access to protocol 112 from each other."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "AWS Networking setup"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We need to assign an static private ip to the ENI for each EC2 connector instance. This is a workaround to limitations in the SDP (we need to know the IP in the nic to enable HA in connectors)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In the VPC subnet where our EC2 connectors are located we need to add a CIDR reservation for the VIP (so it will never be assigned to any machine in that subnet)"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Configuration for the connector (SDP Configuration)"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "To workaround the limitation in SDP  we need to assign an static ip in the connectors configuration (The one we assigned to the ENI before) and DHCP at the same time."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1737451302177
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will endeavour to document this and ping you when it is done for checking."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1737733110453
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "How does this tie in with the existing HA set up? VIPs etc?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1737733185290
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Cloning appliances etc?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1737733232739
      }
    ]
  },
  {
    "key": "SA-14048",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "var meta = JSON.parse(httpGet(\"["
            },
            {
              "type": "text",
              "text": "https://api.github.com/meta](https://api.github.com/meta)\").data)"
            },
            {
              "type": "text",
              "text": ";"
            },
            {
              "type": "text",
              "text": "\n\nvar fields = \\[\"hooks\", \"web\", \"api\", \"git\", \"pages\", \"importer\"\\];\n\nvar hosts = \\[\\];\n\nfor(var field in fields) { \n\n  hosts = hosts.concat(meta\\[field\\]);\n\n}\n\nconsole.log(hosts);\n\nreturn hosts;"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-14011",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Driver says:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[2020-05-29T14:18:34.207Z\\] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"send-to\", \"params\": { \"id\": \"staticid\", \"site-id\": \"Azure North Europe\", \"message\": {\"result\":true,\"id\":3,\"jsonrpc\":\"2.0\"} }}>\n\n\\[2020-05-29T14:18:34.208Z\\] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"send-to\", \"params\": { \"id\": \"staticid\", \"site-id\": \"Azure North Europe\", \"message\": {\"method\":\"app-update\",\"params\":{\"apps\":{\"Test - Azure Test\":{\"status\":\"Available\",\"appData\":{\"name\":\"g( \u0361\u00b0 \u035c\u0296 \u0361\u00b0)g\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=oHg5SJYRHA0](https://www.youtube.com/watch?v=oHg5SJYRHA0)\",\"colorCode\":6},\"appDatas\":\\[{\"name\":\"g("
            },
            {
              "type": "text",
              "text": " \u0361\u00b0 \u035c\u0296 \u0361\u00b0)g\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=oHg5SJYRHA0](https://www.youtube.com/watch?v=oHg5SJYRHA0)\",\"colorCode\":6},{\"name\":\"\ud83d\udca9\",\"url\":\"[https://www.youtube.com/watch?v=dOkNFwRp2dA](https://www.youtube.com/watch?v=dOkNFwRp2dA)\",\"colorCode\":17}\\],\"displayName\":\"g("
            },
            {
              "type": "text",
              "text": " \u0361\u00b0 \u035c\u0296 \u0361\u00b0)g\",\"name\":\"g( \u0361\u00b0 \u035c\u0296 \u0361\u00b0)g\"}}},\"jsonrpc\":\"2.0\"} }}>"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " Service says:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[2020-05-29T14:18:34.293Z\\] Info : 'Azure North Europe': Successfully updated tokens.\n\n\\[2020-05-29T14:18:34.293Z\\] Info : 'Azure North Europe': App source is offline with 2 client apps."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The best way to trigger is to restart the driver enough times."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-13926",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "[^image.png]"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\"Test - All Remedy\":{\"remedies\":\\[{\"method\":\"DisplayMessage\",\"params\":{\"message\":\"test \\\\n<b>bold</b>\\\\n</i>italics</i>\\\\n<strike>strike</strike>\\\\n<s>s</s>\\\\n<strong>strong</strong>\\\\n<small>small</small>\",\"actionIdentifier\":\"-467232987\"},\"active\":true},{\"method\":\"OtpAuthentication\",\"params\":{\"providerId\":\"03542d1e-733c-4c43-a567-d28fbc4649a7\",\"message\":\"test\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"2026085608\"},\"active\":true},{\"method\":\"Reason\",\"params\":{\"message\":\"test\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"3556569\"},\"active\":true},{\"method\":\"PasswordAuthentication\",\"params\":{\"message\":\"test\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"3556577\"},\"active\":true}\\],\"status\":\"Remedy\",\"appData\":{\"name\":\"Test - All Remedy\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "http://192.168.111.75:9999](http://192.168.111.75:9999)\",\"colorCode\":11},\"appDatas\":\\[{\"name\":\"Test"
            },
            {
              "type": "text",
              "text": " - All Remedy\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "http://192.168.111.75:9999](http://192.168.111.75:9999)\",\"colorCode\":11}\\],\"displayName\":\"Test"
            },
            {
              "type": "text",
              "text": " - All Remedy\",\"name\":\"Test - All Remedy\"}"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-13863",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "mai 13 15:02:44 appgatedriver\\[1105\\]: Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"send-to\", \"params\": { \"id\": \"staticid\", \"site-id\": \"Azure North Europe\", \"message\": {\"method\":\"app-update\",\"params\":{\"apps\":{\"Test - Azure Test\":{\"status\":\"Available\",\"appData\":{\"name\":\"a( \u0361\u00b0 \u035c\u0296 \u0361\u00b0)a\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=oHg5SJYRHA0](https://www.youtube.com/watch?v=oHg5SJYRHA0)\",\"colorCode\":-14},\"appDatas\":\\[{\"name\":\"a("
            },
            {
              "type": "text",
              "text": " \u0361\u00b0 \u035c\u0296 \u0361\u00b0)a\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=oHg5SJYRHA0](https://www.youtube.com/watch?v=oHg5SJYRHA0)\",\"colorCode\":-14},{\"name\":\":hankey:("
            },
            {
              "type": "text",
              "text": " \u0361\u00b0 \u035c\u0296 \u0361\u00b0):hankey:\",\"url\":\"["
            },
            {
              "type": "text",
              "text": "https://www.youtube.com/watch?v=dOkNFwRp2dA](https://www.youtube.com/watch?v=dOkNFwRp2dA)\",\"colorCode\":6}\\],\"displayName\":\"a("
            },
            {
              "type": "text",
              "text": " \u0361\u00b0 \u035c\u0296 \u0361\u00b0)a\"}}},\"jsonrpc\":\"2.0\"} }}>"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "it's using displayName for both appShortcuts instead of appShortcut.name"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-13804",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We always want them English."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Example:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Client update download error: $["
            },
            {
              "type": "text",
              "text": "https://formulaire.ingdirect.fr/f5-status/AppGate-SDP-4.2.2-Installer.exe](https://formulaire.ingdirect.fr/f5-status/AppGate-SDP-4.2.2-Installer.exe)"
            },
            {
              "type": "text",
              "text": " , $System.Net.WebException: Impossible de se connecter au serveur distant ---> System.Net.Sockets.SocketException: Une tentative de connexion a \u00e9chou\u00e9 car le parti connect\u00e9 n'a pas r\u00e9pondu convenablement au-del\u00e0 d'une certaine dur\u00e9e ou une connexion \u00e9tablie a \u00e9chou\u00e9 car l'h\u00f4te de connexion n'a pas r\u00e9pondu 10.249.42.99:443"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " Hopefully .NET has a setting for this."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "eah, there are too many options and no clear answer which one is the correct one."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image1589816156528.png]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "(only affecting current thread?)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image1589816187057.png]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I couldn't trigger a failure case where the exception message is translated and I don't want to change the language of my Windows. So I can't try and find the best solution."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So I'll just leave it be."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1589816271945
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/dotnet/runtime/issues/40427",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/dotnet/runtime/issues/40427"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " looking at this it doesn't seem like there is a currently working simple way for this. Windows systems with other locales don't even have the necessary language files to show exceptions in English for example."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1670849090023
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Close issue or move to 6.4 (or backlog)?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "christoffer.karlsson",
        "created": 1706174801265
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Backlog I guess. This has bitten us a few times in the past and will probably do it again. So it would be good to fix it eventually."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1706176133098
      }
    ]
  },
  {
    "key": "SA-13764",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "All 25 client fail to contact controller at the "
            },
            {
              "type": "text",
              "text": "/admin/authentication",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " service"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,378392Z [INFO] [ha/garp:0.json] Running time: 10.07187    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,378950Z [INFO] [ha/garp:1.json] Running time: 10.072392    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,379467Z [INFO] [ha/garp:2.json] Running time: 10.083816    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,379968Z [INFO] [ha/garp:3.json] Running time: 10.071247    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,380453Z [INFO] [ha/garp:4.json] Running time: 10.09584    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,380955Z [INFO] [ha/garp:5.json] Running time: 10.081141    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,381436Z [INFO] [ha/garp:6.json] Running time: 10.094012    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:40]\n[Step 1/1]     2020-05-02T14:02:41,381930Z [INFO] [ha/garp:7.json] Running time: 10.067801    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,382542Z [INFO] [ha/garp:8.json] Running time: 10.085087    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,383060Z [INFO] [ha/garp:9.json] Running time: 10.062513    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,383536Z [INFO] [ha/garp:10.json] Running time: 10.079213    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,384030Z [INFO] [ha/garp:11.json] Running time: 10.082712    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,384502Z [INFO] [ha/garp:12.json] Running time: 10.084742    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,384997Z [INFO] [ha/garp:13.json] Running time: 10.157172    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,385478Z [INFO] [ha/garp:14.json] Running time: 10.139565    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,385981Z [INFO] [ha/garp:15.json] Running time: 10.123791    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,386486Z [INFO] [ha/garp:16.json] Running time: 10.083936    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,387068Z [INFO] [ha/garp:17.json] Running time: 10.088916    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,387566Z [INFO] [ha/garp:18.json] Running time: 10.171658    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,388043Z [INFO] [ha/garp:19.json] Running time: 10.114297    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,388648Z [INFO] [ha/garp:20.json] Running time: 10.123426    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,389117Z [INFO] [ha/garp:21.json] Running time: 10.172963    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,389596Z [INFO] [ha/garp:22.json] Running time: 10.153914    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,390120Z [INFO] [ha/garp:23.json] Running time: 10.171719    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,390708Z [INFO] [ha/garp:24.json] Running time: 10.059666    Result: FAILED     Exception: Request to \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-122-1.devops:444/admin/authentication\""
            },
            {
              "type": "text",
              "text": " timed out after 10.0 seconds: POST /admin/authentication    \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:41,390864Z [INFO] [ha/garp] Passed: 0, Failed: 25\n[16:02:56]\n[Step 1/1]     [EXCEPTION] [Assertion (False) failed: Test failed in 25 instance's] \n[16:02:56]\n[Step 1/1]   File \"/tmp/cz-stratus-tests/cases/ha/garp.py\", line 89, in run\n[16:02:56]\n[Step 1/1]     asserts.true(result, msg)\n[16:02:56]\n[Step 1/1]   File \"/tmp/virtualenv_f165e9c9-8b6c-4a04-8889-da4144293d82/lib/python3.6/site-packages/testy/assertions.py\", line 55, in true\n[16:02:56]\n[Step 1/1]     raise_error('{}', a, None, message, *args)\n[16:02:56]\n[Step 1/1]   File \"/tmp/virtualenv_f165e9c9-8b6c-4a04-8889-da4144293d82/lib/python3.6/site-packages/testy/assertions.py\", line 7, in raise_error\n[16:02:56]\n[Step 1/1]     raise AssertionError('Assertion ({}) failed: {}'.format(assertion, message.format(*args)))\n[16:02:56]\n[Step 1/1] \n[16:02:56]\n[Step 1/1]     2020-05-02T14:02:42,120324Z [INFO] [ha/garp] Calling command: sudo stdbuf --output=L /tmp/cz-stratus-tests/bin/destroy_ns.sh\n[16:02:56]\n[Step 1/1] [FAILED] [ha/garp] Failed after 49.334325 seconds: Assertion (False) failed: Test failed in 25 instance's\n[16:02:56]\n[Step 1/1]   File \"/tmp/cz-stratus-tests/cases/ha/garp.py\", line 89, in run\n[16:02:56]\n[Step 1/1]     asserts.true(result, msg)\n[16:02:56]\n[Step 1/1]   File \"/tmp/virtualenv_f165e9c9-8b6c-4a04-8889-da4144293d82/lib/python3.6/site-packages/testy/assertions.py\", line 55, in true\n[16:02:56]\n[Step 1/1]     raise_error('{}', a, None, message, *args)\n[16:02:56]\n[Step 1/1]   File \"/tmp/virtualenv_f165e9c9-8b6c-4a04-8889-da4144293d82/lib/python3.6/site-packages/testy/assertions.py\", line 7, in raise_error\n[16:02:56]\n[Step 1/1]     raise AssertionError('Assertion ({}) failed: {}'.format(assertion, message.format(*args)))"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " noticed that the port there is 444. We have everything at 443 these days..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1588576118944
      }
    ]
  },
  {
    "key": "SA-13757",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Putting this information here so we remember"
            }
          ]
        },
        {
          "type": "orderedList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "IPv6 AWS envy environment"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "IPv6 6rd at client's router (my home)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Connect with AppGate to the environment and access the IPv6 http resource"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "kosmas@kosmas-VirtualBox:~$ aitorbot env show\nkosmas-valianos [] | 2020-04-29 11:57:16\n\tid:      edd65c88-6ecb-4f69-8e8b-ac9b13fbce21\n\tstate:    finished-execution\n\tappliance build from master[#17712] "
                },
                {
                  "type": "text",
                  "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=486012&buildTypeId=StratusAppliance_BuildStratusAppliance_2"
                },
                {
                  "type": "text",
                  "text": "\n\tscenario: aws-simple_v6\n\tkeep on error: False\n\tnodes:\n\t\tcontroller\n\t\t\troles:   controller, logserver\n\t\t\tweb ui:  "
                },
                {
                  "type": "text",
                  "text": "https://ec2-52-91-89-170.compute-1.amazonaws.com:444"
                },
                {
                  "type": "text",
                  "text": "\n\t\t\tconnect: appgate://ec2-52-91-89-170.compute-1.amazonaws.com\n\t\t\tstatus:  Running\n\t\t\tip:      2600:1f18:6384:5b00:2991:6d6c:9ac5:85b9\n\t\t\tnetwork: 2600:1f18:6384:5b00::/64\n\t\t\thostname: ec2-52-91-89-170.compute-1.amazonaws.com\n\t\t\tadmin username: admin\n\t\t\tadmin password: i.LWzW9cs1fD1:J\n\t\t\tssh key: SHA256:47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU\n\t\tgateway\n\t\t\troles:   gateway\n\t\t\tstatus:  Running\n\t\t\tip:      2600:1f18:6384:5b00:aac4:e419:d4bb:7b2b\n\t\t\tnetwork: 2600:1f18:6384:5b00::/64\n\t\t\thostname: ec2-3-87-52-68.compute-1.amazonaws.com\n\t\t\tssh key: SHA256:47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU\n\t\tendpoint\n\t\t\troles:   endpoint\n\t\t\tstatus:  Running\n\t\t\tip:      2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7\n\t\t\tnetwork: 2600:1f18:6384:5b01::/64\n\t\t\thostname: ip-10-0-13-189.ec2.internal\n\t\t\tssh key: SHA256:47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@ec2-3-87-52-68:/home/cz# ip6tables -nvL -t mangle\nChain PREROUTING (policy ACCEPT 52 packets, 5558 bytes)\n pkts bytes target     prot opt in     out     source               destination\n   14  1503 TPROXY     tcp      tun+   *       ::/0                 ::/0                 DSCP match 0x13 ECN match ECT=0 TPROXY redirect ::1:9201 mark 0x2/0xffffffff\n    0     0 TPROXY     tcp      tun+   *       ::/0                 ::/0                 DSCP match 0x17 ECN match ECT=0 TPROXY redirect ::1:9203 mark 0x2/0xffffffff\n    0     0 TPROXY     udp      tun+   *       ::/0                 ::/0                 DSCP match 0x1b ECN match ECT=0 TPROXY redirect ::1:9204 mark 0x3/0xffffffff\n\t\n\nroot@ec2-3-87-52-68:/home/cz# journalctl -fu cz-nginx@urlaccess | grep \"url_access:\"\n[debug] 11039#11039: *12938 url_access: process' version: 1 shared memory's version: 1 - shared memory's size: 67108864\n[debug] 11039#11039: *12938 url_access: Source: fd00::ffff:c0a8:6401:49688\n[debug] 11039#11039: *12938 url_access: Destination: 2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7:80\n[debug] 11039#11039: *12938 url_access: Host: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]\n[debug] 11039#11039: *12938 url_access: extracted: URI: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80/ Len: 45\n[debug] 11039#11039: *12938 url_access: raxSeek(<=) for URI: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80/ Len: 45\n[debug] 11039#11039: *12938 url_access: candidate key: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80 Len: 44\n[debug] 11039#11039: *12938 url_access: matching key: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80 Len: 44\n[debug] 11039#11039: *12938 url_access: looking up IP: fd00::ffff:c0a8:6401\n[debug] 11039#11039: *12938 url_access: access to [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80/ by IP fd00::ffff:c0a8:6401 has been granted\n[debug] 11039#11039: *12938 url_access: process' version: 1 shared memory's version: 1 - shared memory's size: 67108864\n[debug] 11039#11039: *12938 url_access: Source: fd00::ffff:c0a8:6401:49688\n[debug] 11039#11039: *12938 url_access: Destination: 2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7:80\n[debug] 11039#11039: *12938 url_access: Host: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]\n[debug] 11039#11039: *12938 url_access: extracted: URI: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80/favicon.ico Len: 56\n[debug] 11039#11039: *12938 url_access: raxSeek(<=) for URI: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80/favicon.ico Len: 56\n[debug] 11039#11039: *12938 url_access: candidate key: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80 Len: 44\n[debug] 11039#11039: *12938 url_access: matching key: [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80 Len: 44\n[debug] 11039#11039: *12938 url_access: looking up IP: fd00::ffff:c0a8:6401\n[debug] 11039#11039: *12938 url_access: access to [2600:1f18:6384:5b01:16cf:dd9c:c949:c7d7]:80/favicon.ico by IP fd00::ffff:c0a8:6401 has been granted"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "!"
                },
                {
                  "type": "text",
                  "text": "alt text",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "IPv6.jpg"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1588241615569
      }
    ]
  },
  {
    "key": "SA-13583",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is what I get with \\"
            },
            {
              "type": "text",
              "text": "curl -k\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " \\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "502 Bad Gateway"
            }
          ],
          "attrs": {
            "level": 1
          }
        },
        {
          "type": "rule"
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "nginx"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is absolutely no way of figuring anything here. Really feels configuration issue and these are just useless logs out of context. If even the slightest help could be given to you to configure it, would need logs of nginx that say what is wrong with the server you have set up, see logs of the endpoint webserver etc."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1585925874793
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, you probably should ask for help on Slack before creating an issue here. I think if https had never worked, we would have noticed it; so this is most likely a configuration issue or an edge case bug which is probably very difficult to figure out from a bunch of logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1585926271825
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We use https URL access on purple every single day, in fact every aitorbot command goes through it when connected to purple. So I will repeat what Natan said here. It is better to first try to contact a person who knows  more about the feature in question and try to figure out what is going on instead of directly creating a task. This way everyone wastes a lot less time and we all learn something (Instructions could be improved, how a given feature works...)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1585926564996
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I created some http entitlements and https entitlements. Each one of them had the same url, once with http and once with https."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I uploaded the certificate indicated in the test on the site. I expected https to work and it did not."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1586160772268
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As a side note, creating https entitlements with no certificate set should IMO generate a warning\u2026 which does not."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1586161049270
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 03 14:15:53.764945 ec2-35-174-136-92.compute-1.amazonaws.com nginx[3168]: 2020/04/03 14:15:53 [error] 6997#6997: *186 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.100.1, server: , request: \"GET /app1 HTTP/1.1\", upstream: \""
                },
                {
                  "type": "text",
                  "text": "https://10.0.21.120:443/app1\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " host: \"10.0.21.120\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The webserver at the endpoint needs to start as HTTPs. "
                },
                {
                  "type": "text",
                  "text": "openssl s_client",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " or "
                },
                {
                  "type": "text",
                  "text": "curl",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " from the appliance to the endpoint webserver to verify the HTTPs is working"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1586162597836
      }
    ]
  },
  {
    "key": "SA-13554",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Instead of downloading anyways and displaying \"not a zip file\". ![](image.png)"
            },
            {
              "type": "text",
              "text": "https://files.slack.com/files-pri/T0252KQF8-F010YR0CHAM/image.png",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://files.slack.com/files-pri/T0252KQF8-F010YR0CHAM/image.png"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It already works: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-102-1:~# cz-config upgrade "
                },
                {
                  "type": "text",
                  "text": "https://bin.appgate-sdp.com/5.1/appliance/AppGate-SDP-5.1.0.img.zip"
                },
                {
                  "type": "text",
                  "text": "\nUpgrade failed! Failed to download upgrade file: Unauthorized"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1585918954953
      }
    ]
  },
  {
    "key": "SA-13506",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "On purple, this caused a \"major upgrade\" even though this is a \"patch upgrade\": "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cellsons@cellsons:~/Projects/purple-pants$ ./thomas_upgrade.sh \nStarting automated purple upgrade process...\nDownloading latest release appliance image...\nRunning: aitorbot artifact --branch release download -j stratus-appliance appgate-.*.img.zip\nDownloaded /home/cellsons/Projects/purple-pants/appgate-5.1.1-17334-release.img.zip from testyd\nUploading appgate-5.1.1-17334-release.img.zip to AWS S3...\nRunning: aws --region eu-central-1 s3 cp --acl public-read /home/cellsons/Projects/purple-pants/appgate-5.1.1-17334-release.img.zip s3://appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip\nupload: ./appgate-5.1.1-17334-release.img.zip to s3://appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip\nUploaded /home/cellsons/Projects/purple-pants/appgate-5.1.1-17334-release.img.zip to AWS S3 at "
                },
                {
                  "type": "text",
                  "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip"
                },
                {
                  "type": "text",
                  "text": "\nRunning: /home/cellsons/Projects/purple-pants/virtualenv/bin/python /home/cellsons/Projects/purple-pants/appgate-upgrade.pyz prepare purple10.ad.cryptzone.com:8443 --yes --username appgate-upgrade "
                },
                {
                  "type": "text",
                  "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip"
                },
                {
                  "type": "text",
                  "text": " --throttle 0 --exclude site=4fcbb04f-4bfa-4668-a426-f534f37f712f\n17:08:08 Discovering peer API version for "
                },
                {
                  "type": "text",
                  "text": "https://purple10.ad.cryptzone.com:8443"
                },
                {
                  "type": "text",
                  "text": "..."
                },
                {
                  "type": "text",
                  "text": "\n17:08:08 Peer API version is 12\n17:08:08 Authenticating to "
                },
                {
                  "type": "text",
                  "text": "https://purple10.ad.cryptzone.com:8443"
                },
                {
                  "type": "text",
                  "text": "..."
                },
                {
                  "type": "text",
                  "text": "\n17:08:08 Authentication succeeded\n17:08:08 Authorizing...\n17:08:09 The appliance download throttle is set to 0, meaning up to 13 appliances will download the upgrade image at the same time, this will likely result in download failures\n17:08:09 \n17:08:09 Prepared upgrade plan:\n17:08:09 1. Prepare upgrade on the following appliances: aws - purple10, aws - purple11, aws - purple12, aws - purple40, azure - purple20, azure - purple21, gcp - purple31, got - purple1, got - purple2, got - purple3, got - purple5, got - purple6, nutanix - purple50\n17:08:09 Appliances will be prepared for upgrade to version 5.1.1-17334-release\n17:08:09 \n17:08:09 1. Prepare upgrade on the following appliances: aws - purple10, aws - purple11, aws - purple12, aws - purple40, azure - purple20, azure - purple21, gcp - purple31, got - purple1, got - purple2, got - purple3, got - purple5, got - purple6, nutanix - purple50\n17:08:09 Preparing upgrade for aws - purple10\n17:08:10 Preparing upgrade for aws - purple11\n17:08:10 Upgrade already prepared for aws - purple12\n17:08:10 Preparing upgrade for aws - purple40\n17:08:10 Upgrade already prepared for azure - purple20\n17:08:10 Upgrade already prepared for azure - purple21\n17:08:10 Upgrade already prepared for gcp - purple31\n17:08:10 Upgrade already prepared for got - purple1\n17:08:10 Upgrade already prepared for got - purple2\n17:08:10 Upgrade already prepared for got - purple3\n17:08:10 Upgrade already prepared for got - purple5\n17:08:10 Upgrade already prepared for got - purple6\n17:08:10 Upgrade already prepared for nutanix - purple50\n17:08:10 Upgrade status for aws - purple10 changed to downloading: "
                },
                {
                  "type": "text",
                  "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip"
                },
                {
                  "type": "text",
                  "text": "\n17:08:10 Upgrade status for aws - purple11 changed to downloading: "
                },
                {
                  "type": "text",
                  "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip"
                },
                {
                  "type": "text",
                  "text": "\n17:08:10 Upgrade status for aws - purple40 changed to downloading: "
                },
                {
                  "type": "text",
                  "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-5.1.1-17334-release.img.zip"
                },
                {
                  "type": "text",
                  "text": "\n17:08:31 Upgrade status for aws - purple10 reached expected value verifying: appgate-5.1.1-17334-release.img.zip\n17:08:31 Upgrade status for aws - purple11 reached expected value verifying: appgate-5.1.1-17334-release.img.zip\n17:08:41 Upgrade status for aws - purple40 reached expected value verifying: appgate-5.1.1-17334-release.img.zip\n17:09:22 Upgrade status for aws - purple40 reached expected value ready: appgate-5.1.1-17334-release.img.zip\n17:09:33 Upgrade status for aws - purple11 reached expected value ready: appgate-5.1.1-17334-release.img.zip\n17:09:43 Upgrade status for aws - purple10 reached expected value ready: appgate-5.1.1-17334-release.img.zip\n17:09:43 \n17:09:43 Ready for upgrade!\nRunning: /home/cellsons/Projects/purple-pants/virtualenv/bin/python /home/cellsons/Projects/purple-pants/appgate-upgrade.pyz complete purple10.ad.cryptzone.com:8443 --yes --username appgate-upgrade --exclude site=4fcbb04f-4bfa-4668-a426-f534f37f712f\n17:09:43 Discovering peer API version for "
                },
                {
                  "type": "text",
                  "text": "https://purple10.ad.cryptzone.com:8443"
                },
                {
                  "type": "text",
                  "text": "..."
                },
                {
                  "type": "text",
                  "text": "\n17:09:43 Peer API version is 12\n17:09:43 Authenticating to "
                },
                {
                  "type": "text",
                  "text": "https://purple10.ad.cryptzone.com:8443"
                },
                {
                  "type": "text",
                  "text": "..."
                },
                {
                  "type": "text",
                  "text": "\n17:09:44 Authentication succeeded\n17:09:44 Authorizing...\n17:09:45 \n17:09:45 Upgrade plan:\n17:09:45 1. Disable controller role on the following appliance: aws - purple40\n17:09:45 2. Install prepared upgrade on first controller: aws - purple10\n17:09:45 3. Install prepared upgrade on additional controller: aws - purple40\n17:09:45 4. Enable controller role on the following appliance: aws - purple40\n17:09:45 5. Install prepared upgrade on log aggregators: aws - purple11, azure - purple20, gcp - purple31, got - purple1, got - purple3, got - purple5, nutanix - purple50\n17:09:45 6. Install prepared upgrade on log aggregators: aws - purple12, azure - purple21, got - purple2, got - purple6\n17:09:45 \n17:09:45 1. Disable controller role on the following appliance: aws - purple40\n17:09:45 Disabling controller role on aws - purple40...\n17:09:46 Waiting for appliance to come back online in state appliance_ready: aws - purple40 ...\n17:09:46 Appliance aws - purple40 is online and in state multi_controller_ready\n17:10:16 Appliance aws - purple40 is now in state appliance_ready\n17:10:16 Waiting for appliance to come back online in state single_controller_ready: aws - purple10 ...\n17:10:16 Appliance aws - purple10 is online and in state single_controller_ready\n17:10:16 \n17:10:16 2. Install prepared upgrade on first controller: aws - purple10\n17:10:17 Completing upgrade and switching partition on aws - purple10\n17:10:17 Waiting for first controller to come back online in state single_controller_ready within 1200 seconds: aws - purple10 ...\n17:10:27 First controller aws - purple10 is offline\n17:15:21 First controller aws - purple10 has reached expected state single_controller_ready and volume number 2\n17:15:21 \n17:15:21 3. Install prepared upgrade on additional controller: aws - purple40\n17:15:22 Completing upgrade on aws - purple40\n17:15:23 Upgrade status for aws - purple40 changed to ready: no details\n17:15:33 Upgrade status for aws - purple40 changed to installing: appgate-5.1.1-17334-release.img.zip\n17:16:45 Upgrade status for aws - purple40 reached expected value success: a reboot is required for the upgrade to go into effect\n17:16:45 Switching partition on aws - purple40\n17:16:45 Waiting for additional controller to come back online in state appliance_ready within 1200 seconds: aws - purple40 ...\n17:16:45 Additional controller aws - purple40 is in state upgrading and volume number 1\n17:17:04 Additional controller aws - purple40 is offline\n\n17:18:40 Additional controller aws - purple40 is in state data_migration and volume number 2\n17:19:00 Additional controller aws - purple40 has reached expected state appliance_ready and volume number 2\n17:19:00 \n17:19:00 4. Enable controller role on the following appliance: aws - purple40\n17:19:00 Enabling controller role on aws - purple40...\n17:19:03 PUT /admin/appliances/48843b32-4247-435e-80ba-4e273914fa81: HTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Cannot reach the database. It may be restarting. Please try again in a few moments.\"}. Retrying in 3 seconds ...\n17:19:06 PUT /admin/appliances/48843b32-4247-435e-80ba-4e273914fa81: HTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Cannot reach the database. It may be restarting. Please try again in a few moments.\"}. Retrying in 3 seconds ...\n17:19:09 PUT /admin/appliances/48843b32-4247-435e-80ba-4e273914fa81: HTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Cannot reach the database. It may be restarting. Please try again in a few moments.\"}. Retrying in 3 seconds ...\n17:19:12 PUT /admin/appliances/48843b32-4247-435e-80ba-4e273914fa81: HTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Cannot reach the database. It may be restarting. Please try again in a few moments.\"}. Retrying in 3 seconds ...\n17:19:15 Waiting for appliances to come back online in state multi_controller_ready: aws - purple10, aws - purple40 ...\n17:19:25 Appliance aws - purple10 is online and in state single_controller_ready\n17:19:25 Appliance aws - purple40 is online and in state appliance_ready"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1585239642651
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also this: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "17:40:26 6. Install prepared upgrade on log aggregators: aws - purple12, azure - purple21, got - purple2, got - purple6"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If the roles are too varied it should just say \"appliances\"."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1585241018797
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok actually this isn't the bug I thought it was, there were 2 versions prepared simultaneously on purple because of a previous failed upgrade to a broken version. I will add a warning in this case."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1585292160603
      }
    ],
    "description": {
      "type": "doc",
      "version": 1,
      "content": []
    }
  },
  {
    "key": "SA-13504",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Probably doesn't happen the first time but rather when OTP expires."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2020-03-26T15:31:05.626Z\\] Info : Launching App with URL '["
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com'](https://youtrack.ad.cryptzone.com')"
                },
                {
                  "type": "text",
                  "text": "\n\n\\[2020-03-26T15:31:05.847Z\\] Info : OTP remedy action is received by 'got - purple6'. \\[RemedyOtp: Message 'Please provide OTP to access the resource. ', RemedyProperties 'ClaimSuffix global, ProviderId 03542d1e-733c-4c43-a567-d28fbc4649a7, EntitlementName Youtrack'\\]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " this shouldn't happen."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1585237338665
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This was a Gateway issue. Tried GW patch from "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "per.leino",
                    "text": "@per.leino",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " that fixed the issue for me."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com/issue/SA-13539",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-youtrack.agi.appgate.com/issue/SA-13539"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1585746512956
      }
    ]
  },
  {
    "key": "SA-13472",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Info about nginx monitoring "
            },
            {
              "type": "text",
              "text": "https://www.nginx.com/blog/monitoring-nginx",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://www.nginx.com/blog/monitoring-nginx"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Module reference "
            },
            {
              "type": "text",
              "text": "https://nginx.org/libxslt/en/docs/http/ngx",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://nginx.org/libxslt/en/docs/http/ngx"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "http",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "stub"
            },
            {
              "type": "text",
              "text": "status",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "module.html"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-134-2:/home/cz# curl "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9202/url_access/statistics"
                },
                {
                  "type": "text",
                  "text": "\nActive connections: 1 \nserver accepts handled requests\n 13 13 13 \nReading: 0 Writing: 1 Waiting: 0"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1584706969469
      }
    ]
  },
  {
    "key": "SA-13465",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Think about scenarios (admin password forgotten, admin policy deleted or edited wrongly, etc.) and provide some solutions via SSH."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Please pop a screen shot in here when done."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1590568675851
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "After looking at this for quite a while, I couldn't shake the feeling that this is a very wrong approach. I understand the reason for wanting it and why it feels like there should be an option to change the admin password from cz-setup since you can set it there. But the admin password is global for the whole collective, cz-setup is only about channging the appliance where it is running. If there should be a way to change the admin password from the cli, it should be in cz-config."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592815827590
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is severely underspecified."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There can be multiple admin users, the default admin user can easily get removed. There are a number of cases that should be considered."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "cz-setup after seeding is basically a fancy gui to cz-config so tht isn't the major issue, but deciding precisely what this is supposed to do is."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1592815996997
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, the task originally was to be able to change the password for the hardcoded user admin, from the cli."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592817347007
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But now Jamie also says it is wrong that cz-setup can change the password for the cz user... "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "jamie.bodley",
                    "text": "@jamie.bodley",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-scott could you explain a bit more about this?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592817924278
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "UPDATE: that's not wrong after all. In fact, there's nothing wrong with cz-setup and maybe cz-setup does not need to be involved at all."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The task is to add a CLI way to reset the admin password."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": ">There can be multiple admin users,"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, this is only for the user called \"admin\", if it exists"
                }
              ]
            },
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "the default admin user can easily get removed."
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Indeed. If no user named \"admin\" is found, we'll print an error message."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592822576228
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "And i suppose the command is only supposed to work on controllers?"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes. There needs to be some check for this."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592822643102
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe we should also have a check that the cz user has a password or pk set? Right now cz is logged in automatically on the local and serial consoles and cloud providers have started handing out access to the serial console."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592822854987
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "kasper.gustavsson",
                    "text": "@kasper.gustavsson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " it is logged in automatically if the password is not set, after seeding+reboot even on serial it will ask for password. On cloud providers i suppose it all works differently."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1592823074187
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, on cloud providers the password is not set and there is no requirement for password on sudo either."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1592823267935
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I implemented this as a script. "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "jamie.bodley",
                    "text": "@jamie.bodley",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-scott does this really need to have a separate PR to implement the cz-setup wrapper or is the script enough?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1592898243690
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image1592919085234.png]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'll make this a Story for handling being locked out."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1592919105507
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "salvatore.tomaselli",
                    "text": "@salvatore.tomaselli",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " where is this script?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1593069691685
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "jamie.bodley",
                    "text": "@jamie.bodley",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-scott there is no script. It's an open story for 5.3. I had made one but was scrapped in favour of a more proper solution later on."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1593070737888
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[Marc Schneider]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/marc.schneider",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/marc.schneider"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"marc.schneider\") has some tools for this that we can use if needed "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-cre/sdp-extras/blob/master/admin/injectadmin.sh",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-cre/sdp-extras/blob/master/admin/injectadmin.sh"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1604055692681
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "404 page not found"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1604059590731
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, Marc need to give some rights."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1604063498296
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Oh, I missed that one. lets see I can let "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "salvatore.tomaselli",
                    "text": "@salvatore.tomaselli",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " to access our repos."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "marc.schneider",
        "created": 1604405722814
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "# Publicly available: "
                },
                {
                  "type": "text",
                  "text": "https://appgate-material.s3.eu-central-1.amazonaws.com/bin/injectadmin.sh"
                },
                {
                  "type": "text",
                  "text": "\n#\n# Run on the controller: \n#   - install:\n#\tbash <(curl -s  "
                },
                {
                  "type": "text",
                  "text": "https://appgate-material.s3.eu-central-1.amazonaws.com/bin/install-adminuser.sh)"
                },
                {
                  "type": "text",
                  "text": "\n#   - uninstall:\n#\tbash <(curl -s  "
                },
                {
                  "type": "text",
                  "text": "https://appgate-material.s3.eu-central-1.amazonaws.com/bin/uninstall-adminuser.sh)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "marc.schneider",
        "created": 1604417991416
      }
    ]
  },
  {
    "key": "SA-13369",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Nginx is refusing requests bigger than 1MB: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Mar 05 15:57:16 purple2.cryptzone.com nginx[32606]: 192.168.100.108 - TeamCityBuildId=473274 [05/Mar/2020:15:57:16 +0000] \"POST /httpAuth/artefactUpload.html HTTP/1.1\" 413 176 \"-\" \"TeamCity Agent 2019.2.2\""
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Using this rule: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "allow http-up "
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "FYI this is what we use for the upgrade file upload: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "    # Peer file upload\n    location /peer/files {\n        if ($ssl_client_verify = NONE) {\n            return 401;\n        }\n        proxy_set_header cz-distinguished-name $ssl_client_s_dn;\n        proxy_set_header cz-fingerprint $ssl_client_fingerprint;\n        # Necessary for streaming of request body using chunked encoding\n        proxy_http_version 1.1;\n        proxy_buffering off;\n        proxy_request_buffering off;\n        client_max_body_size 0;\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9130/peer/files"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n    }"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1583501681989
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It should just need these 2 lines, that were added for the sessiond<->nginx server block in "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-12490",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-12490"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " to be added in the https and http server blocks \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " client\\_body\\_buffer\\_size 32m; client\\_max\\_body\\_size 0; \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1583512785354
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Copying what I wrote on slack here: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "About the URL Access issue, I don't know if I agree with the temporary file fix.\nIs the temporary file just a buffer for chunks of data, if so why not use memory?\nIs it buffering the entire file? If so that will suck with big file uploads (e.g. >1GB) or even stuff like video streams.\nShouldn't we configure nginx to do real streaming of the uploaded and downloaded data instead? We are supposed to be as transparent as possible here.\nThe fix definitly works for 5.1 though, just not sure if its the right thing to do long term?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1583741265676
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sure if that works without buffering even better. I just mentioned the 2 lines fix above as I had stumbled in this problem at the sessiond<->nginx communication so I know it works"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1583913929553
      }
    ]
  },
  {
    "key": "SA-13364",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "the login\\"
            },
            {
              "type": "text",
              "text": "saml test started to fail yesterday. It looks like client gets the token and does nothing for about 7-8 seconds.",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Test case 6129266 failed at 2020-03-04 15:38:05.584307. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717411](https://testrail.ad.cryptzone.com/index.php?/plans/view/717411)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-04 16:38:06.311375. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717429](https://testrail.ad.cryptzone.com/index.php?/plans/view/717429)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-04 18:38:06.268991. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717463](https://testrail.ad.cryptzone.com/index.php?/plans/view/717463)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-04 19:38:05.979964. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717481](https://testrail.ad.cryptzone.com/index.php?/plans/view/717481)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-04 20:38:05.965456. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717503](https://testrail.ad.cryptzone.com/index.php?/plans/view/717503)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-05 07:38:05.821797. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717626](https://testrail.ad.cryptzone.com/index.php?/plans/view/717626)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-05 08:38:11.137156. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717656](https://testrail.ad.cryptzone.com/index.php?/plans/view/717656)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-05 09:38:05.811833. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717676](https://testrail.ad.cryptzone.com/index.php?/plans/view/717676)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-05 10:38:05.490442. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717717](https://testrail.ad.cryptzone.com/index.php?/plans/view/717717)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-05 11:38:11.508453. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717751](https://testrail.ad.cryptzone.com/index.php?/plans/view/717751)"
            },
            {
              "type": "text",
              "text": "\n\nTest case 6129266 failed at 2020-03-05 12:38:06.582209. ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/717769](https://testrail.ad.cryptzone.com/index.php?/plans/view/717769)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "most likely culprit: "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-client-shared/pull/5041",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-client-shared/pull/5041"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1583920585303
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It seems this happens only on linux. Windows is fine and macOS fails less often and with a different error."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I can't reproduce locally and can't figure out what the hell is going on.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think this is a timing issue and how fast servers start on each OS. Though it doesn't really explain the linux logs, I will still go with a time.sleep."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1583942374145
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like it's still happening and seems to be linux only."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1584632667821
      }
    ]
  },
  {
    "key": "SA-13242",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It should at least refuse to run in that case... Or allow using the peer hostname."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](image.png)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A possible fix for this, the disambiguation flag should not be --admin-hostname but --peer-hostname since that one is guaranteed to be unique I you use a shared admin hostname the script will force you to pass --peer-hostname."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1582144500887
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This workaround worked: 1. Disable admin interface on all but first controller 2. Run upgrade script with \\"
                },
                {
                  "type": "text",
                  "text": ":\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and pass \\"
                },
                {
                  "type": "text",
                  "text": "--admin-hostname \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 3. Enable admin interface again on all controllers"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1582145005861
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another fix proposed by "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "gokhan.berberoglu",
                    "text": "@gokhan.berberoglu",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " : The upgrade script just picks 1 controller matching the hostname used to connect to the admin API and sticks to it. Basically decoupling the connectiong hostname from the master controller selection."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1582192368254
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "jamie.bodley",
                    "text": "@jamie.bodley",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-scott Docs need update"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "On the controller hostname: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  CONTROLLER            AppGate SDP controller peer or admin hostname or ip\n                        The server should be specified in the following form:\n                            ["
                },
                {
                  "type": "text",
                  "text": "https://]hostname[:port]"
                },
                {
                  "type": "text",
                  "text": "\n                        The hostname should point to a specific controller.\n                        If the port is specified here it takes precedence over the port argument.\n                        The port should be the AppGate SDP admin API port.\n                        If the admin interface is configured, use admin interface port.\n                        Else, use the peer interface port."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The --admin-hostname flag has been renamed to --unique-hostname: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  --unique-hostname UNIQUE_HOSTNAME\n                        Specify the unique hostname of the AppGate SDP controller you are connecting to.\n                        Use this if connecting via an ip or hostname that differs from the peer or admin hostname or if the admin hostname is shared across multiple controllers"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1582282690143
      }
    ]
  },
  {
    "key": "SA-13079",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ python3 appgate-backup.pyz --cacert cacert.pem mycontroller.example.com --backup-all -a\n14:21:41 Discovering peer API version for "
            },
            {
              "type": "text",
              "text": "https://mycontroller.example.com:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n  File \"appgate-backup.pyz/appgate_backup/__init__.py\", line 263, in main\n    run_backup_command()\n  File \"appgate-backup.pyz/appgate_backup/__init__.py\", line 180, in run_backup_command\n    os.getenv('APPGATE_PASSWORD')\n  File \"appgate-backup.pyz/appgate_backup/admin.py\", line 372, in authenticate\n    self._peer_api_version = self._discover_peer_api_version()\n  File \"appgate-backup.pyz/appgate_backup/admin.py\", line 353, in _discover_peer_api_version\n    self._request('POST', '/admin/authentication', headers={'Accept': 'application/json'})\n  File \"appgate-backup.pyz/appgate_backup/admin.py\", line 296, in _request\n    r = urllib.request.urlopen(req, cafile=cafile, context=ssl_context, timeout=timeout)\n  File \"/usr/lib/python3.6/urllib/request.py\", line 213, in urlopen\n    capath=capath)\n  File \"/usr/lib/python3.6/ssl.py\", line 512, in create_default_context\n    context.load_verify_locations(cafile, capath, cadata)\n14:21:41 Unexpected error during backup: [Errno 2] No such file or directory\nTraceback (most recent call last):\n  File \"appgate-backup.pyz/appgate_backup/__init__.py\", line 263, in main\n    run_backup_command()\n  File \"appgate-backup.pyz/appgate_backup/__init__.py\", line 180, in run_backup_command\n    os.getenv('APPGATE_PASSWORD')\n  File \"appgate-backup.pyz/appgate_backup/admin.py\", line 372, in authenticate\n    self._peer_api_version = self._discover_peer_api_version()\n  File \"appgate-backup.pyz/appgate_backup/admin.py\", line 353, in _discover_peer_api_version\n    self._request('POST', '/admin/authentication', headers={'Accept': 'application/json'})\n  File \"appgate-backup.pyz/appgate_backup/admin.py\", line 296, in _request\n    r = urllib.request.urlopen(req, cafile=cafile, context=ssl_context, timeout=timeout)\n  File \"/usr/lib/python3.6/urllib/request.py\", line 213, in urlopen\n    capath=capath)\n  File \"/usr/lib/python3.6/ssl.py\", line 512, in create_default_context\n    context.load_verify_locations(cafile, capath, cadata)\nFileNotFoundError: [Errno 2] No such file or directory"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": []
  },
  {
    "key": "SA-8715",
    "comments": [],
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Right now it just say "
            },
            {
              "type": "text",
              "text": "error 422",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " '(see capture)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Logs from journalctl: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jul 02 13:43:58 envy-172-17-100-2.devops cz-controllerd[19501]: INFO [InputExceptionMapper] The last controller cannot be deactivated.\nJul 02 13:43:58 envy-172-17-100-2.devops nginx[19312]: 192.168.111.220 - - [02/Jul/2018:13:43:58 +0000] \"POST /admin/appliances/aa0d020e-77a8-450e-7485-6a570e0d5065/deactivate HTTP/2.0\" 422 84 \""
            },
            {
              "type": "text",
              "text": "https://envy-172-17-100-2.devops:444/ui/appliances\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\""
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-8716",
    "description": {
      "type": "doc",
      "version": 1,
      "content": []
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "per@perl1:~/GIT\\_APPLIANCE\\_AZURE/stratus-appliance/building$ ./cz-azure-vhi --image-name \"SDP-4.1.0-10519-beta\" --image ~/Downloads/appgate-4.1.0-10519-beta.img.zip --debug --batch-mode --install-script ../scripts/cz-install\n\nAzure image information\n\n\\------------\n\nName:        SDP-4.1.0-10519-beta \n\nImage:       /home/per/Downloads/appgate-4.1.0-10519-beta.img.zip \n\nVariables used\n\n\\------------\n\nresource-group: 79a7a72b00e643f3a12f92b5\n\nlocation: northeurope\n\nbootstrap-vm-name: cz-deployment-bootstrap\n\nbootstrap-vm-size: Standard\\_DS4\n\nprivate-key: /home/per/.ssh/azure.key\n\npublic-key: /home/per/.ssh/azure.key.pub\n\nvnet-name: cz-deployment-vnet\n\nsubnet-name: cz-deployment-subnet\n\nnic-name: cz-deployment-nic\n\npublic-ip-name: cz-deployment-pip\n\nstorage-account-name: d1d6df7038f044bcaf9aa03e\n\nstorage-container-name: czimages\n\nuser: cz-deployment\n\ncz-install: ../scripts/cz-install\n\naz account show\n\n{\n\n  \"environmentName\": \"AzureCloud\",\n\n  \"id\": \"807b5a34-7e08-4528-ad09-329699b60402\",\n\n  \"isDefault\": true,\n\n  \"name\": \"Per Leino\",\n\n  \"state\": \"Enabled\",\n\n  \"tenantId\": \"fb673f48-d025-4c03-aaa5-fbd0d41f3872\",\n\n  \"user\": {\n\n    \"name\": \"per.leino@cryptzone.com\",\n\n    \"type\": \"user\"\n\n  }\n\n}\n\nCreating resource group for deployment ...\n\n\\--------\n\naz group create --name 79a7a72b00e643f3a12f92b5 --location northeurope\n\n{\n\n  \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5\",\n\n  \"location\": \"northeurope\",\n\n  \"managedBy\": null,\n\n  \"name\": \"79a7a72b00e643f3a12f92b5\",\n\n  \"properties\": {\n\n    \"provisioningState\": \"Succeeded\"\n\n  },\n\n  \"tags\": null\n\n}\n\nCreating storage account ...\n\n\\--------\n\naz storage account create --resource-group 79a7a72b00e643f3a12f92b5 --location northeurope --name d1d6df7038f044bcaf9aa03e --sku Standard\\_LRS\n\n{\n\n  \"accessTier\": null,\n\n  \"creationTime\": \"2018-07-04T12:36:59.066467+00:00\",\n\n  \"customDomain\": null,\n\n  \"encryption\": {\n\n    \"services\": {\n\n      \"blob\": {\n\n        \"enabled\": true,\n\n        \"lastEnabledTime\": \"2018-07-04T12:36:59.207071+00:00\"\n\n      },\n\n      \"file\": {\n\n        \"enabled\": true,\n\n        \"lastEnabledTime\": \"2018-07-04T12:36:59.207071+00:00\"\n\n      },\n\n      \"queue\": null,\n\n      \"table\": null\n\n    }\n\n  },\n\n  \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Storage/storageAccounts/d1d6df7038f044bcaf9aa03e\",\n\n  \"kind\": \"Storage\",\n\n  \"lastGeoFailoverTime\": null,\n\n  \"location\": \"northeurope\",\n\n  \"name\": \"d1d6df7038f044bcaf9aa03e\",\n\n  \"primaryEndpoints\": {\n\n    \"blob\": \"["
                },
                {
                  "type": "text",
                  "text": "https://d1d6df7038f044bcaf9aa03e.blob.core.windows.net/](https://d1d6df7038f044bcaf9aa03e.blob.core.windows.net/)\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\n    \"file\": \"["
                },
                {
                  "type": "text",
                  "text": "https://d1d6df7038f044bcaf9aa03e.file.core.windows.net/](https://d1d6df7038f044bcaf9aa03e.file.core.windows.net/)\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\n    \"queue\": \"["
                },
                {
                  "type": "text",
                  "text": "https://d1d6df7038f044bcaf9aa03e.queue.core.windows.net/](https://d1d6df7038f044bcaf9aa03e.queue.core.windows.net/)\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\n    \"table\": \"["
                },
                {
                  "type": "text",
                  "text": "https://d1d6df7038f044bcaf9aa03e.table.core.windows.net/](https://d1d6df7038f044bcaf9aa03e.table.core.windows.net/)\""
                },
                {
                  "type": "text",
                  "text": "\n\n  },\n\n  \"primaryLocation\": \"northeurope\",\n\n  \"provisioningState\": \"Succeeded\",\n\n  \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\",\n\n  \"secondaryEndpoints\": null,\n\n  \"secondaryLocation\": null,\n\n  \"sku\": {\n\n    \"name\": \"Standard\\_LRS\",\n\n    \"tier\": \"Standard\"\n\n  },\n\n  \"statusOfPrimary\": \"available\",\n\n  \"statusOfSecondary\": null,\n\n  \"tags\": {},\n\n  \"type\": \"Microsoft.Storage/storageAccounts\"\n\n}\n\nCreating vnet ...\n\n\\--------\n\naz network vnet create --address-prefix 10.66.66.0/24 --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-vnet --location northeurope\n\n{\n\n  \"newVNet\": {\n\n    \"addressSpace\": {\n\n      \"addressPrefixes\": \\[\n\n        \"10.66.66.0/24\"\n\n      \\]\n\n    },\n\n    \"dhcpOptions\": {\n\n      \"dnsServers\": \\[\\]\n\n    },\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"resourceGuid\": \"646316b0-d189-43c4-98f1-d7131b993cdb\",\n\n    \"subnets\": \\[\\]\n\n  }\n\n}\n\nCreating subnet ...\n\n\\--------\n\naz network vnet subnet create --address-prefix 10.66.66.0/24 --resource-group 79a7a72b00e643f3a12f92b5 --vnet-name cz-deployment-vnet --name cz-deployment-subnet\n\n{\n\n  \"addressPrefix\": \"10.66.66.0/24\",\n\n  \"etag\": \"W/\\\\\"1f1f1066-9d62-49f6-ad1f-5a1e707ace47\\\\\"\",\n\n  \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/virtualNetworks/cz-deployment-vnet/subnets/cz-deployment-subnet\",\n\n  \"ipConfigurations\": null,\n\n  \"name\": \"cz-deployment-subnet\",\n\n  \"networkSecurityGroup\": null,\n\n  \"provisioningState\": \"Succeeded\",\n\n  \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\",\n\n  \"resourceNavigationLinks\": null,\n\n  \"routeTable\": null\n\n}\n\nCreating bootstrap public ip ...\n\n\\--------\n\naz network public-ip create --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-pip --location northeurope\n\n{\n\n  \"publicIp\": {\n\n    \"idleTimeoutInMinutes\": 4,\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"publicIPAllocationMethod\": \"Dynamic\",\n\n    \"resourceGuid\": \"8f624a1b-547e-4b6e-839c-bd67dcc7e557\"\n\n  }\n\n}\n\nCreating appliance public ip ...\n\n\\--------\n\naz network public-ip create --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-pip-xdp --location northeurope\n\n{\n\n  \"publicIp\": {\n\n    \"idleTimeoutInMinutes\": 4,\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"publicIPAllocationMethod\": \"Dynamic\",\n\n    \"resourceGuid\": \"75d9cacc-7584-44e7-9ec1-519c165b614e\"\n\n  }\n\n}\n\nCreating bootstrap nic ...\n\n\\--------\n\naz network nic create --private-ip-address 10.66.66.66 --subnet cz-deployment-subnet --vnet-name cz-deployment-vnet --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-nic --location northeurope --public-ip-address cz-deployment-pip\n\n{\n\n  \"newNIC\": {\n\n    \"dnsSettings\": {\n\n      \"appliedDnsServers\": \\[\\],\n\n      \"dnsServers\": \\[\\]\n\n    },\n\n    \"enableIPForwarding\": false,\n\n    \"ipConfigurations\": \\[\n\n      {\n\n        \"etag\": \"W/\\\\\"0a4d29c9-c051-4522-affc-f8306047cef7\\\\\"\",\n\n        \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/networkInterfaces/cz-deployment-nic/ipConfigurations/ipconfig1\",\n\n        \"name\": \"ipconfig1\",\n\n        \"properties\": {\n\n          \"isInUseWithService\": false,\n\n          \"primary\": true,\n\n          \"privateIPAddress\": \"10.66.66.66\",\n\n          \"privateIPAllocationMethod\": \"Static\",\n\n          \"provisioningState\": \"Succeeded\",\n\n          \"publicIPAddress\": {\n\n            \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/publicIPAddresses/cz-deployment-pip\",\n\n            \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n          },\n\n          \"subnet\": {\n\n            \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/virtualNetworks/cz-deployment-vnet/subnets/cz-deployment-subnet\",\n\n            \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n          }\n\n        },\n\n        \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n      }\n\n    \\],\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"resourceGuid\": \"18ab7406-cc60-4328-9eec-8634b6094e2d\"\n\n  }\n\n}\n\nCreating appliance nic ...\n\n\\--------\n\naz network nic create --private-ip-address 10.66.66.33 --subnet cz-deployment-subnet --vnet-name cz-deployment-vnet --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-nic-xdp --location northeurope --public-ip-address cz-deployment-pip-xdp\n\n{\n\n  \"newNIC\": {\n\n    \"dnsSettings\": {\n\n      \"appliedDnsServers\": \\[\\],\n\n      \"dnsServers\": \\[\\]\n\n    },\n\n    \"enableIPForwarding\": false,\n\n    \"ipConfigurations\": \\[\n\n      {\n\n        \"etag\": \"W/\\\\\"14936a07-27cf-4023-ab4e-00d2b238c1a8\\\\\"\",\n\n        \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/networkInterfaces/cz-deployment-nic-xdp/ipConfigurations/ipconfig1\",\n\n        \"name\": \"ipconfig1\",\n\n        \"properties\": {\n\n          \"isInUseWithService\": false,\n\n          \"primary\": true,\n\n          \"privateIPAddress\": \"10.66.66.33\",\n\n          \"privateIPAllocationMethod\": \"Static\",\n\n          \"provisioningState\": \"Succeeded\",\n\n          \"publicIPAddress\": {\n\n            \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/publicIPAddresses/cz-deployment-pip-xdp\",\n\n            \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n          },\n\n          \"subnet\": {\n\n            \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Network/virtualNetworks/cz-deployment-vnet/subnets/cz-deployment-subnet\",\n\n            \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n          }\n\n        },\n\n        \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n      }\n\n    \\],\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"resourceGuid\": \"53ce0eef-eeca-40ce-ba2c-a340aedf6845\"\n\n  }\n\n}\n\nCreating bootstrap vm ...\n\n\\--------\n\naz vm create --name cz-deployment-bootstrap --nics cz-deployment-nic --ssh-key-value /home/per/.ssh/azure.key.pub --resource-group 79a7a72b00e643f3a12f92b5 --image Canonical:UbuntuServer:16.04.0-LTS:16.04.201604203 --admin-username cz-deployment --size Standard\\_DS4\n\n{\n\n  \"fqdns\": \"\",\n\n  \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/virtualMachines/cz-deployment-bootstrap\",\n\n  \"location\": \"northeurope\",\n\n  \"macAddress\": \"00-0D-3A-B0-D2-84\",\n\n  \"powerState\": \"VM running\",\n\n  \"privateIpAddress\": \"10.66.66.66\",\n\n  \"publicIpAddress\": \"65.52.68.129\",\n\n  \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n}\n\nAttaching volume to bootstrap vm ...\n\n\\--------\n\naz vm disk attach --resource-group 79a7a72b00e643f3a12f92b5 --vm-name cz-deployment-bootstrap --new --disk cz-deployment-disk --size-gb 20 --sku Standard\\_LRS\n\nUploading image and cz-install ...\n\n\\--------\n\naz network public-ip list --resource-group 79a7a72b00e643f3a12f92b5\n\nscp -o StrictHostKeyChecking=no -o ServerAliveInterval=300 -i /home/per/.ssh/azure.key /home/per/Downloads/appgate-4.1.0-10519-beta.img.zip cz-deployment@65.52.68.129:/tmp/appgate-4.1.0-10519-beta.img.zip\n\nWarning: Permanently added '65.52.68.129' (ECDSA) to the list of known hosts.\n\nappgate-4.1.0-10519-beta.img.zip                                                                                                                                          100%  696MB  21.1MB/s   00:33    \n\naz network public-ip list --resource-group 79a7a72b00e643f3a12f92b5\n\nscp -o StrictHostKeyChecking=no -o ServerAliveInterval=300 -i /home/per/.ssh/azure.key ../scripts/cz-install cz-deployment@65.52.68.129:/tmp/cz-install\n\ncz-install                                                                                                                                                                100%   26KB  26.2KB/s   00:00    \n\nInstalling image\n\n\\--------\n\naz network public-ip list --resource-group 79a7a72b00e643f3a12f92b5\n\nssh -o StrictHostKeyChecking=no -o ServerAliveInterval=300 -tt -i /home/per/.ssh/azure.key cz-deployment@65.52.68.129         sudo chmod +x /tmp/cz-install &&         sudo /tmp/cz-install --verbose --device /dev/sdc --yes --environment-type azure partition &&         sudo /tmp/cz-install --verbose --device /dev/sdc --boot-device /dev/sda install /tmp/appgate-4.1.0-10519-beta.img.zip 1 &&         sudo /tmp/cz-install --verbose --device /dev/sdc bootmenu 1\n\nChecking that /dev/sdc is not being used...\n\nPartitioning /dev/sdc...\n\nHard drive block device:     /dev/sdc\n\nBoot partition block device: /dev/sdc1\n\nLVM partition block device:  /dev/sdc2\n\nChecking if LVM volume group czvg is being used...\n\nCreating LVM physical volume in /dev/sdc2...\n\nCreating LVM volume group czvg...\n\nCreating logical volume czvg/dummy to reserve space for software...\n\nCreating logical volume czvg/data...\n\nRemoving logical volume czvg/dummy...\n\nCreating boot partition filesystem in /dev/sdc1...\n\nMounting boot partition /dev/sdc1 at /tmp/cz-install-d7\\_0q0r3/boot...\n\nSaving metadata on boot partition...\n\nInstalling GRUB2 on /dev/sdc...\n\nCreating data volume filesystem...\n\nMounting data volume at /tmp/cz-install-qc31vusq...\n\nCreating directories in data volume...\n\nExamining contents of /tmp/appgate-4.1.0-10519-beta.img.zip...\n\nHard drive block device:     /dev/sdc\n\nBoot partition block device: /dev/sdc1\n\nLVM partition block device:  /dev/sdc2\n\nChecking that /dev/mapper/czvg-image1 is not being used...\n\nChecking that /dev/mapper/czvg-state1 is not being used...\n\nChecking that /dev/czvg/image1 is not being used...\n\nChecking that /dev/czvg/state1 is not being used...\n\nRemoving any existing destination LVM volumes...\n\nCreating logical volume czvg/image1 with size 4194304 kB...\n\nUncompressing disk image appgate-4.1.0-10519-beta.img to czvg/image1...\n\nVerifying written disk image...\n\nMounting czvg/image1 volume at /tmp/cz-install-ktx90r40...\n\nTitle:            AppGate\n\nVersion:          4.1.0-10519-beta\n\nState size (kB):  1048576\n\nKernel arguments: root=/dev/czvg/image1 ro console=tty0 console=ttyS0,115200 earlyprintk=ttyS0 rootdelay=300 net.ifnames=0 biosdevname=0 nomodeset scsi\\_mod.scan=sync megaraid\\_sas.smp\\_affinity\\_enable=0 cz-boot-fs=/dev/sda1 cz-state-fs=/dev/czvg/state1\n\nMounting boot partition /dev/sdc1 at /tmp/cz-install-gqhq587i...\n\nRecreating boot directory...\n\nCopying kernel and initrd to boot directory...\n\nCreating GRUB2 menu entry...\n\nCreating logical volume czvg/state1 with size 1048576 kB...\n\nCreating czvg/state1 volume filesystem...\n\nMounting czvg/state1 volume at /tmp/cz-install-azpmqmji...\n\nSaving files to czvg/state1...\n\nHard drive block device:     /dev/sdc\n\nBoot partition block device: /dev/sdc1\n\nLVM partition block device:  /dev/sdc2\n\nMounting boot partition /dev/sdc1 at /tmp/cz-install-7vq2ck4g...\n\nCreating GRUB2 menu...\n\nConnection to 65.52.68.129 closed.\n\nDeattaching disk ...\n\n\\--------\n\naz vm disk detach --resource-group 79a7a72b00e643f3a12f92b5 --vm-name cz-deployment-bootstrap --name cz-deployment-disk\n\nCreating image ...\n\n\\--------\n\naz image create --name cz-deployment-image --source cz-deployment-disk --resource-group 79a7a72b00e643f3a12f92b5 --os-type Linux\n\n{\n\n  \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/images/cz-deployment-image\",\n\n  \"location\": \"northeurope\",\n\n  \"name\": \"cz-deployment-image\",\n\n  \"provisioningState\": \"Succeeded\",\n\n  \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\",\n\n  \"sourceVirtualMachine\": null,\n\n  \"storageProfile\": {\n\n    \"dataDisks\": \\[\\],\n\n    \"osDisk\": {\n\n      \"blobUri\": null,\n\n      \"caching\": \"None\",\n\n      \"diskSizeGb\": 20,\n\n      \"managedDisk\": {\n\n        \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/disks/cz-deployment-disk\",\n\n        \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n      },\n\n      \"osState\": \"Generalized\",\n\n      \"osType\": \"Linux\",\n\n      \"snapshot\": null\n\n    }\n\n  },\n\n  \"tags\": null,\n\n  \"type\": \"Microsoft.Compute/images\"\n\n}\n\nStarting created appliance\n\n\\--------\n\naz vm create --name cz-deployment-xdp --nics cz-deployment-nic-xdp --ssh-key-value /home/per/.ssh/azure.key.pub --resource-group 79a7a72b00e643f3a12f92b5 --image cz-deployment-image --admin-username cz-deployment --size Standard\\_DS4\n\n{\n\n  \"fqdns\": \"\",\n\n  \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/virtualMachines/cz-deployment-xdp\",\n\n  \"location\": \"northeurope\",\n\n  \"macAddress\": \"00-0D-3A-BA-65-A5\",\n\n  \"powerState\": \"VM running\",\n\n  \"privateIpAddress\": \"10.66.66.33\",\n\n  \"publicIpAddress\": \"40.113.72.45\",\n\n  \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\"\n\n}\n\nCleaning up appliance\n\n\\--------\n\naz network public-ip list --resource-group 79a7a72b00e643f3a12f92b5\n\nssh -o StrictHostKeyChecking=no -o ServerAliveInterval=300 -tt -i /home/per/.ssh/azure.key cz@40.113.72.45 sudo cz-config wipe-appliance --wipe-rclocal --wipe-network --force --stop-configd --wipe-service-logs --wipe-machine-id\n\nWarning: Permanently added '40.113.72.45' (RSA) to the list of known hosts.\n\nAuthorized uses only. All activity may be monitored and reported.\n\nConnection to 40.113.72.45 closed.\n\nStopping appliance\n\n\\--------\n\naz vm deallocate --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-xdp\n\n{\n\n  \"endTime\": \"2018-07-04T13:01:57.963600+00:00\",\n\n  \"error\": null,\n\n  \"name\": \"b46e5a01-b72f-40b0-a139-70af7a73587d\",\n\n  \"startTime\": \"2018-07-04T12:59:24.258625+00:00\",\n\n  \"status\": \"Succeeded\"\n\n}\n\nCreating new azure image\n\n\\--------\n\naz vm generalize --resource-group 79a7a72b00e643f3a12f92b5 --name cz-deployment-xdp\n\naz disk list --resource-group 79a7a72b00e643f3a12f92b5\n\naz disk grant-access --resource-group 79a7a72b00e643f3a12f92b5 --name --duration-in-seconds 3600\n\naz disk grant-access: error: argument --name/-n: expected one argument\n\nusage: az disk grant-access \\[-h\\] \\[--output {json,tsv,table,jsonc}\\] \\[--verbose\\]\n\n                            \\[--debug\\] \\[--query JMESPATH\\]\n\n                            \\[--resource-group RESOURCE\\_GROUP\\_NAME\\]\n\n                            --duration-in-seconds DURATION\\_IN\\_SECONDS\n\n                            \\[--name NAME\\]\n\n                            \\[--ids RESOURCE\\_ID \\[RESOURCE\\_ID ...\\]\\]\n\naz storage container create --name czimages --account-name d1d6df7038f044bcaf9aa03e\n\n{\n\n  \"created\": true\n\n}\n\naz storage blob copy start --destination-blob SDP-4.1.0-10519-beta.vhd --destination-container czimages --account-name d1d6df7038f044bcaf9aa03e --source-uri\n\naz storage blob copy start: error: argument --source-uri/-u: expected one argument\n\nusage: az storage blob copy start \\[-h\\] \\[--output {json,tsv,table,jsonc}\\]\n\n                                  \\[--verbose\\] \\[--debug\\] \\[--query JMESPATH\\]\n\n                                  \\[--destination-lease-id DESTINATION\\_LEASE\\_ID\\]\n\n                                  \\[--account-key ACCOUNT\\_KEY\\]\n\n                                  --destination-blob BLOB\\_NAME\n\n                                  \\[--source-container SOURCE\\_CONTAINER\\]\n\n                                  \\[--source-if-modified-since SOURCE\\_IF\\_MODIFIED\\_SINCE\\]\n\n                                  \\[--metadata METADATA \\[METADATA ...\\]\\]\n\n                                  \\[--source-share SOURCE\\_SHARE\\]\n\n                                  \\[--source-lease-id SOURCE\\_LEASE\\_ID\\]\n\n                                  --destination-container CONTAINER\\_NAME\n\n                                  \\[--destination-if-modified-since DESTINATION\\_IF\\_MODIFIED\\_SINCE\\]\n\n                                  \\[--source-uri COPY\\_SOURCE\\]\n\n                                  \\[--source-if-match SOURCE\\_IF\\_MATCH\\]\n\n                                  \\[--sas-token SAS\\_TOKEN\\]\n\n                                  \\[--source-account-name SOURCE\\_ACCOUNT\\_NAME\\]\n\n                                  \\[--source-path SOURCE\\_PATH\\]\n\n                                  \\[--timeout TIMEOUT\\]\n\n                                  \\[--destination-if-match DESTINATION\\_IF\\_MATCH\\]\n\n                                  \\[--source-account-key SOURCE\\_ACCOUNT\\_KEY\\]\n\n                                  \\[--account-name ACCOUNT\\_NAME\\]\n\n                                  \\[--destination-if-unmodified-since DESTINATION\\_IF\\_UNMODIFIED\\_SINCE\\]\n\n                                  \\[--source-blob SOURCE\\_BLOB\\]\n\n                                  \\[--source-if-none-match SOURCE\\_IF\\_NONE\\_MATCH\\]\n\n                                  \\[--source-snapshot SOURCE\\_SNAPSHOT\\]\n\n                                  \\[--destination-if-none-match DESTINATION\\_IF\\_NONE\\_MATCH\\]\n\n                                  \\[--connection-string CONNECTION\\_STRING\\]\n\n                                  \\[--source-sas SOURCE\\_SAS\\]\n\n                                  \\[--source-if-unmodified-since SOURCE\\_IF\\_UNMODIFIED\\_SINCE\\]\n\nCopying disk blob. This can take several minutes.\n\n\\--------\n\naz storage blob show --name SDP-4.1.0-10519-beta.vhd --container-name czimages --account-name d1d6df7038f044bcaf9aa03e\n\n./cz-azure-vhi: line 199: \\[: ==: unary operator expected\n\nDone copying disk blob.\n\n\\--------\n\naz disk revoke-access --resource-group 79a7a72b00e643f3a12f92b5 --name\n\naz disk revoke-access: error: argument --name/-n: expected one argument\n\nusage: az disk revoke-access \\[-h\\] \\[--output {json,tsv,table,jsonc}\\]\n\n                             \\[--verbose\\] \\[--debug\\] \\[--query JMESPATH\\]\n\n                             \\[--name NAME\\]\n\n                             \\[--resource-group RESOURCE\\_GROUP\\_NAME\\]\n\n                             \\[--ids RESOURCE\\_ID \\[RESOURCE\\_ID ...\\]\\]\n\nERROR:  Could't capture vm \n\nper@perl1:~/GIT\\_APPLIANCE\\_AZURE/stratus-appliance/building$ az disk list --resource-group 79a7a72b00e643f3a12f92b5\n\n\\[\n\n  {\n\n    \"accountType\": \"Premium\\_LRS\",\n\n    \"creationData\": {\n\n      \"createOption\": \"Empty\",\n\n      \"imageReference\": null,\n\n      \"sourceResourceId\": null,\n\n      \"sourceUri\": null,\n\n      \"storageAccountId\": null\n\n    },\n\n    \"diskSizeGb\": 20,\n\n    \"encryptionSettings\": null,\n\n    \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/disks/cz-deployment-disk\",\n\n    \"location\": \"northeurope\",\n\n    \"name\": \"cz-deployment-disk\",\n\n    \"osType\": null,\n\n    \"ownerId\": null,\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\",\n\n    \"tags\": {},\n\n    \"timeCreated\": \"2018-07-04T12:43:32.161388+00:00\",\n\n    \"type\": \"Microsoft.Compute/disks\"\n\n  },\n\n  {\n\n    \"accountType\": \"Premium\\_LRS\",\n\n    \"creationData\": {\n\n      \"createOption\": \"Copy\",\n\n      \"imageReference\": null,\n\n      \"sourceResourceId\": null,\n\n      \"sourceUri\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/snapshots/cz-deployment-image\\_0\\_0svhz0nlmsk\",\n\n      \"storageAccountId\": null\n\n    },\n\n    \"diskSizeGb\": 20,\n\n    \"encryptionSettings\": null,\n\n    \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/disks/osdisk\\_JHHjSKPvlt\",\n\n    \"location\": \"northeurope\",\n\n    \"name\": \"osdisk\\_JHHjSKPvlt\",\n\n    \"osType\": \"Linux\",\n\n    \"ownerId\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/virtualMachines/cz-deployment-xdp\",\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\",\n\n    \"tags\": {},\n\n    \"timeCreated\": \"2018-07-04T12:55:11.236676+00:00\",\n\n    \"type\": \"Microsoft.Compute/disks\"\n\n  },\n\n  {\n\n    \"accountType\": \"Premium\\_LRS\",\n\n    \"creationData\": {\n\n      \"createOption\": \"FromImage\",\n\n      \"imageReference\": {\n\n        \"id\": \"/Subscriptions/807b5a34-7e08-4528-ad09-329699b60402/Providers/Microsoft.Compute/Locations/northeurope/Publishers/Canonical/ArtifactTypes/VMImage/Offers/UbuntuServer/Skus/16.04.0-LTS/Versions/16.04.201604203\",\n\n        \"lun\": null\n\n      },\n\n      \"sourceResourceId\": null,\n\n      \"sourceUri\": null,\n\n      \"storageAccountId\": null\n\n    },\n\n    \"diskSizeGb\": 29,\n\n    \"encryptionSettings\": null,\n\n    \"id\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/disks/osdisk\\_kILMUXQthh\",\n\n    \"location\": \"northeurope\",\n\n    \"name\": \"osdisk\\_kILMUXQthh\",\n\n    \"osType\": \"Linux\",\n\n    \"ownerId\": \"/subscriptions/807b5a34-7e08-4528-ad09-329699b60402/resourceGroups/79a7a72b00e643f3a12f92b5/providers/Microsoft.Compute/virtualMachines/cz-deployment-bootstrap\",\n\n    \"provisioningState\": \"Succeeded\",\n\n    \"resourceGroup\": \"79a7a72b00e643f3a12f92b5\",\n\n    \"tags\": {},\n\n    \"timeCreated\": \"2018-07-04T12:41:09.744449+00:00\",\n\n    \"type\": \"Microsoft.Compute/disks\"\n\n  }\n\n\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1530709829217
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Installing the lastest version from pip makes the problem go away.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1530785656453
      }
    ]
  },
  {
    "key": "SA-8730",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "So the backup script can differentiate a controller DB down case from what is really a configuration problem and show a nice message to the admin."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ APPGATE\\_PASSWORD=admin python3 appgate-backup.pyz --cacert AppGate\\_SDP\\_envy-172-17-124-1.devops\\_CA.pem envy-172-17-124-1.devops --audit --logs --opt -d backups --backup-all\n\nAuthenticating to ["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devops:444..](https://envy-172-17-124-1.devops:444..)"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\nAuthentication succeeded\n\nAuthorizing...\n\nStarting backup on 3 appliances:\n\n  \\* controller2-c26fe247-87dc-43be-8192-8140e49ebcfa-site1\n\n  \\* controller-c26fe247-87dc-43be-8192-8140e49ebcfa-site1\n\n  \\* gateway-c26fe247-87dc-43be-8192-8140e49ebcfa-site1\n\nFailed to start backup creation.\n\nHTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Backup passphrase is not set. Please contact your administrator.\"}"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "From discussing this on slack HTTP 503 Service Unavailable sounds like a better code to use here."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Also no need to print a stack trace on the controller when that happens."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "FYI, appgate-backup side of this "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2175",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2175"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530785349609
      }
    ]
  },
  {
    "key": "SA-8733",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "example?"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "helvetest-prod $ journalctl --since ''2018-07-05 02:43:27 CEST\" --until \"2018-07-05 02:44:07 CEST\""
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: \\[0142ad7c-b271-441b-81cd-b34345c6d12d\\] \\[ActionRunner\\] Unhandled error while running action CancelTeamCityBuildAction(execution\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: Traceback (most recent call last):\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 219, in \\_cancel\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     'Origin': '["
            },
            {
              "type": "text",
              "text": "https://\\_:443'](https://_:443')"
            },
            {
              "type": "text",
              "text": "\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 111, in request\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     return await self.\\_request(method, path, data, json\\_, headers)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 93, in \\_request\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     async with self.session.request(method=method, url=request\\_url, data=data, headers=headers, json=json\\_) as resp:\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 779, in \\_\\_aenter\\_\\_\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     self.\\_resp = await self.\\_coro\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 408, in \\_request\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     resp.raise\\_for\\_status()\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client\\_reqrep.py\", line 772, in raise\\_for\\_status\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     headers=self.headers)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: aiohttp.client\\_exceptions.ClientResponseError: 404, message='None'\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: During handling of the above exception, another exception occurred:\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: Traceback (most recent call last):\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 236, in cancel\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     await self.cancel\\_queued\\_build(build\\_id=build\\_id, reason=reason)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 228, in cancel\\_queued\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     await self.\\_cancel\\_build(build\\_id, reason, 'buildQueue')\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 223, in \\_cancel\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     raise BuildNotFoundError(f'Build {build\\_id} not found')\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: clients.teamcity.BuildNotFoundError: Build 308349 not found\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: During handling of the above exception, another exception occurred:\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: Traceback (most recent call last):\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 219, in \\_cancel\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     'Origin': '["
            },
            {
              "type": "text",
              "text": "https://\\_:443'](https://_:443')"
            },
            {
              "type": "text",
              "text": "\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 111, in request\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     return await self.\\_request(method, path, data, json\\_, headers)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 93, in \\_request\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     async with self.session.request(method=method, url=request\\_url, data=data, headers=headers, json=json\\_) as resp:\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 779, in \\_\\_aenter\\_\\_\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     self.\\_resp = await self.\\_coro\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 408, in \\_request\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     resp.raise\\_for\\_status()\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client\\_reqrep.py\", line 772, in raise\\_for\\_status\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     headers=self.headers)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: aiohttp.client\\_exceptions.ClientResponseError: 400, message='None'\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: The above exception was the direct cause of the following exception:\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]: Traceback (most recent call last):\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/lib/python3/dist-packages/themachine/action\\_runner.py\", line 116, in arun\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     action\\_result = await action.arun()\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/actions.py\", line 151, in arun\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     await teamcity\\_client.cancel\\_build(build\\_id=self.queued\\_build.id, reason=self.reason)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 239, in cancel\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     await self.cancel\\_running\\_build(build\\_id=build\\_id, reason=reason)\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 231, in cancel\\_running\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     await self.\\_cancel\\_build(build\\_id, reason, 'builds')\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 225, in \\_cancel\\_build\n\nJul 05 02:44:00 helvetest-prod helvetest\\[3034\\]:     raise TeamCityError(f'Failed to cancel build {build\\_id} with reason {reason}') from e"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed by "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-7637",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-7637"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1543239287597
      }
    ]
  },
  {
    "key": "SA-8840",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Create controller and gateway as separated appliances. 4.0.4 was used in this example."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Turn off the controller and try to upgrade the gateway to 4.1.0."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The expected result is that it should fail, since it cannot verify that the controller already is upgraded."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "But at attempt 10, the gateway suddenly assumes the \"force\" flag was used."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "And thus the upgrade is done after all."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jul 17 12:30:56 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[rest\\] \"GET /upgrade HTTP/1.1\" 200 57 \"\" \"python-requests/2.14.2\" 396\n\nJul 17 12:31:01 kasper5.ad.cryptzone.com cz-configd\\[601\\]: WARNING \\[get\\_max\\_peer\\_api\\_version\\] Attempt 9 of 10 failed with error: Failed to get max API version from controller: HTTPSConnectionPool(host='kasper4.ad\n\n.cryptzone.com', port=444): Max retries exceeded with url: /admin/appliance/configuration (Caused by NewConnectionError('<requests.packages.urllib3.connection.VerifiedHTTPSConnection object at 0x7f82241d3b00>: F\n\nailed to establish a new connection: \\[Errno 113\\] No route to host',)). Sleeping 10 seconds before retrying...\n\nJul 17 12:31:01 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[StateMachine\\] Received event GetUpgradeStatusEvent(), staying in state upgrading\n\nJul 17 12:31:01 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[ActionsRunner\\] Running action UpgradeStatusAction(upgrade\\_status=DetailedUpgradeStatus(status=<UpgradeStatus.VERIFYING: 'verifying'>, details='4.1.\n\n0.img.zip', metadata=UpgradeMetadata(image\\_url='["
            },
            {
              "type": "text",
              "text": "http://192.168.111.90/4.1.0.img.zip'](http://192.168.111.90/4.1.0.img.zip')"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " image\\_path=PosixPath('/mnt/data/download/4.1.0.img.zip')))) ...\n\nJul 17 12:31:01 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[ActionsRunner\\] UpgradeStatusAction done\n\nJul 17 12:31:02 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[rest\\] \"GET /upgrade HTTP/1.1\" 200 57 \"\" \"python-requests/2.14.2\" 404\n\nJul 17 12:31:07 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[StateMachine\\] Received event GetUpgradeStatusEvent(), staying in state upgrading\n\nJul 17 12:31:07 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[ActionsRunner\\] Running action UpgradeStatusAction(upgrade\\_status=DetailedUpgradeStatus(status=<UpgradeStatus.VERIFYING: 'verifying'>, details='4.1.\n\n0.img.zip', metadata=UpgradeMetadata(image\\_url='["
            },
            {
              "type": "text",
              "text": "http://192.168.111.90/4.1.0.img.zip'](http://192.168.111.90/4.1.0.img.zip')"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " image\\_path=PosixPath('/mnt/data/download/4.1.0.img.zip')))) ...\n\nJul 17 12:31:07 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[ActionsRunner\\] UpgradeStatusAction done\n\nJul 17 12:31:07 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[rest\\] \"GET /upgrade HTTP/1.1\" 200 57 \"\" \"python-requests/2.14.2\" 412\n\nJul 17 12:31:12 kasper5.ad.cryptzone.com cz-configd\\[601\\]: WARNING \\[upgrade\\] Force flag is set, ignoring validation error: Failed to get max API version from controller: HTTPSConnectionPool(host='kasper4.ad.crypt\n\nzone.com', port=444): Max retries exceeded with url: /admin/appliance/configuration (Caused by NewConnectionError('<requests.packages.urllib3.connection.VerifiedHTTPSConnection object at 0x7f822419ae10>: Failed\n\nto establish a new connection: \\[Errno 113\\] No route to host',))\n\nJul 17 12:31:12 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[upgrade\\] Upgrading using /mnt/data/download/4.1.0.img.zip...\n\nJul 17 12:31:12 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[rest\\] \"POST /event HTTP/1.1\" 204 0 \"\" \"python-requests/2.14.2\" 0\n\nJul 17 12:31:12 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[upgrade\\] Examining contents of /mnt/data/download/4.1.0.img.zip...\n\nJul 17 12:31:12 kasper5.ad.cryptzone.com cz-configd\\[601\\]: INFO \\[upgrade\\] Installing upgrade /mnt/data/download/4.1.0.img.zip to volume 2..."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Grumble, seems like i need to write unit tests for this..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1531832941099
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like i forgot to check the force flag and re-raise if not set.... grmble..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/commit/67cdddeedf8258746b17e7fcca3415418c2ccabe#diff-f2418d8666bc4337cd01a4968a670b6bR153",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/commit/67cdddeedf8258746b17e7fcca3415418c2ccabe#diff-f2418d8666bc4337cd01a4968a670b6bR153"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1531833469961
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2194",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2194"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1531833628354
      }
    ]
  },
  {
    "key": "SA-8865",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "removeIndexOlderThan.sh",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " is not able to handle dots and dashes for the logstash filenames. In 4.1 logd which replaces logstash creates those files with dashes while 4.0 files contain dots"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-logging/pull/232",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-logging/pull/232"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Initial state:\n\nroot@c1mkt:/home/cz# /usr/bin/curl -s -XGET ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/\\_cat/indices?v](http://127.0.0.1:9300/_cat/indices?v)"
                },
                {
                  "type": "text",
                  "text": "\n\nhealth status index               uuid                   pri rep docs.count docs.deleted store.size pri.store.size\n\ngreen  open   .kibana             lkq7HbV6Q6qbjOh\\_tNxdyQ   1   0         36            8    134.5kb        134.5kb\n\ngreen  open   logstash-2018.07.23 Ig3UxNV9QF--R56aQN3-TA   5   0         69            0    593.9kb        593.9kb\n\ngreen  open   logstash-2018-07-23 QmMbZg8zQLukZO4fT15szw   5   0         10            0    121.9kb        121.9kb\n\nRemoving before 10 days: Everything stays as is as they are from 23rd i.e. today\n\nroot@c1mkt:/home/cz# /usr/cz-elasticsearch/scripts/removeIndexOlderThan.sh 10\n\nroot@c1mkt:/home/cz# /usr/bin/curl -s -XGET ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/\\_cat/indices?v](http://127.0.0.1:9300/_cat/indices?v)"
                },
                {
                  "type": "text",
                  "text": "\n\nhealth status index               uuid                   pri rep docs.count docs.deleted store.size pri.store.size\n\ngreen  open   .kibana             lkq7HbV6Q6qbjOh\\_tNxdyQ   1   0         36            8    134.5kb        134.5kb\n\ngreen  open   logstash-2018.07.23 Ig3UxNV9QF--R56aQN3-TA   5   0         69            0    593.9kb        593.9kb\n\ngreen  open   logstash-2018-07-23 QmMbZg8zQLukZO4fT15szw   5   0         10            0    121.9kb        121.9kb\n\nRemove all: Both files are removed (The one listed below is a new one and is created directly. Notice the different uuid)\n\nroot@c1mkt:/home/cz# /usr/cz-elasticsearch/scripts/removeIndexOlderThan.sh 0\n\nroot@c1mkt:/home/cz# /usr/bin/curl -s -XGET ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/\\_cat/indices?v](http://127.0.0.1:9300/_cat/indices?v)"
                },
                {
                  "type": "text",
                  "text": "\n\nhealth status index               uuid                   pri rep docs.count docs.deleted store.size pri.store.size\n\ngreen  open   .kibana             lkq7HbV6Q6qbjOh\\_tNxdyQ   1   0         36            8    134.5kb        134.5kb\n\ngreen  open   logstash-2018-07-23 XcPWrDunT-uYfbS3iyimlw   5   0          0            0       810b           810b"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1532356164825
      }
    ]
  },
  {
    "key": "SA-8884",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Azure ADFS needs this.."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "SAMLRequest=jVFRa4MwGPwrkveq0QyzoIKtLRS6UdpuD3sL%2BnUNmMTli2X797OWjcLY2Otxd9%2FdfTlK3fWiGvzJ7OBtAPTBu%2B4MFmRwRliJCoWRGlD4Ruyrh41Iwlho8LKVXpJgXRdkxVnNOa%2BqdM7Ygs45Y2l2V7ElT2hc3y9J8AwOlTUFGcWjBnGAtUEvjR%2BhmPJZnM2S7EBTEWciTUKasJcLbysR1RkKcpQdAgkqRHB%2BdFpYg4MGtwd3Vg087TYFOXnfo4gibPumU2D8pVuI8hUM%2BLCxOroA5NpPTMX%2Fbtk7621jO1LmU2T3n2nkV0RSjkFuz%2BfR1aXMr6M%2Fjtp1vbWdaj6ClXVa%2Bt%2BtaUgnRLWz40QVg8EeGnVU0I4Bo5%2Be3%2BDtd8tP"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://idp.ssocircle.com/sso/toolbox/samlDecode.jsp",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://idp.ssocircle.com/sso/toolbox/samlDecode.jsp"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<samlp:AuthnRequest ID=\"F84D888AA3B44C1B844375A4E8210D9E\" Version=\"2.0\" IssueInstant=\"2018-07-27T13:07:32.124Z\" IsPassive=\"false\" AssertionConsumerServiceURL=\"["
                },
                {
                  "type": "text",
                  "text": "https://sdpclientsaml.sagenet.com/saml](https://sdpclientsaml.sagenet.com/saml)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n  <Issuer>sdp.sagenet.com</Issuer>\n\n  <samlp:NameIDPolicy Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\"/>\n\n</samlp:AuthnRequest>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1532961696274
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://docs.microsoft.com/en-us/azure/active-directory/connect/active-directory-aadconnect-federation-saml-idp",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.microsoft.com/en-us/azure/active-directory/connect/active-directory-aadconnect-federation-saml-idp"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1532962051478
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ze goal:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Keep changes to minimum. Preferably no new configuration at all."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Ze hope:"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Add \"ID\" (random?), \"Version\", \"IssueInstant\", maybe \"AssertionConsumerServiceURL\" and \"Issuer\" and that's enough"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Don't want to change name id format accidentally, so hope it's not required. also don't know what \"isPassive\" is."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Ze plan:"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Test OKTA, ADFS and Azure ADFS (when we have access) with the generated SAML request. See how they behave."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Read and tweak accordingly."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1532962931923
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " - not very clear what we need to docuent here."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1541428671859
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " still the same ?!@$%^&\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "(()"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1542290806161
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "well, I was in vacation.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When we redirect the client to SAML destinations, some of the SAML providers require some extra parameters in the URL, namely \"SAMLRequest=<base64>\". That includes some details that the provider validates. Google SAML and Azure ADFS requires it, so it's good for that. Others ignore it unless you configure them to require."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1542291990857
      }
    ]
  },
  {
    "key": "SA-8888",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Which causes tests to fail."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Just seen it happening on admin UI:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jul 30 08:16:48 envy-172-17-144-1.devops nginx\\[2968\\]: 192.168.111.140 - - \\[30/Jul/2018:08:16:48 +0000\\] \"GET /admin/client-connections HTTP/2.0\" 200 14453 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-144-1.devops:444/ui/client-connections](https://envy-172-17-144-1.devops:444/ui/client-connections)\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 (Windows\n\nJul 30 08:16:48 envy-172-17-144-1.devops cz-controllerd\\[3118\\]: 192.168.111.140 - - \\[30/Jul/2018:08:16:48 +0000\\] \"GET /peer/client-connections HTTP/1.0\" 200 19578 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-144-1.devops:444/ui/client-connections](https://envy-172-17-144-1.devops:444/ui/client-connections)\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\" 11190"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Only suspicious thing there is the barcode generation"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1532939145311
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "3 failures I checked were the first SPA calls after controller start. So that seems to be a pattern."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Not the first calls in general, just that the first SPA calls which might occur after running 10 tests already."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1532955279839
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sigh.. Couldn't find anything."
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Wrote a test that generates QR code 10000 times. no problem"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Wrote a test that makes GET request for it 1000 times, no problem"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Tried various manual tests with restarting controllerd or rebooting, couldn't reproduce anything."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  tcpdumped outgoing request when generating QR codes (including after restarting) in case it's calling home and hanging occasionally. Nope."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Skimmed the QR generation library code, nothing obvious there"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Checked issues in the library's github, same."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If I don't get any revelation, I'll separate QR code generation into a new REST API so it won't affect the tests. And hope that it was indeed the QR generation that had a problem."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1532956025357
      }
    ]
  },
  {
    "key": "SA-8999",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Example "
            },
            {
              "type": "text",
              "text": "curl",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " used to get the Discovered Apps from an appliance:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "curl -H 'Accept: application/vnd.appgate.peer-v9+json' -XGET ["
            },
            {
              "type": "text",
              "text": "http://localhost:9200/hostnames](http://localhost:9200/hostnames)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Appliance envy-172-17-154-2"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-154-2:/home/cz# curl -H 'Accept: application/vnd.appgate.peer-v9+json' -XGET ["
                },
                {
                  "type": "text",
                  "text": "http://localhost:9200/hostnames](http://localhost:9200/hostnames)"
                },
                {
                  "type": "text",
                  "text": "\n\n{\"hostnames\":{\"google.com\":\\[\"172.217.21.174\"\\],\"upload.slack.com\":\\[\"52.87.62.44\",\"23.22.232.115\",\"34.232.94.128\",\"35.174.119.179\"\\],\"skai.gr\":\\[\"151.101.128.204\",\"151.101.64.204\",\"151.101.192.204\",\"151.101.0.204\"\\]}}root@envy-172-17-154-2:/home/cz#"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "JSONLint to show the above result better"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n\n\"hostnames\": {\n\n\"google.com\": \\[\"172.217.21.174\"\\],\n\n\"upload.slack.com\": \\[\"52.87.62.44\", \"23.22.232.115\", \"34.232.94.128\", \"35.174.119.179\"\\],\n\n\"skai.gr\": \\[\"151.101.128.204\", \"151.101.64.204\", \"151.101.192.204\", \"151.101.0.204\"\\]\n\n}\n\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1534419888609
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This task includes controller work to collect these. But it depends what we want to show and how we want to aggregate the results, so I'll wait for the design."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1534420091014
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "controller: "
                },
                {
                  "type": "text",
                  "text": "GET /admin/stats/app-discovery",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", requires "
                },
                {
                  "type": "text",
                  "text": "View - SessionInfo",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " privilege."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1535094533739
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is done with mock data on the frontend, but needs controller integration. Controller needs a small change regarding to data which requires a gateway change, so it's waiting for that."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"In progress\" so Jamie does not complain."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1537175764119
      }
    ]
  },
  {
    "key": "SA-9082",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}14 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Could not create index in elasticsearch result was 7: Couldn't connect to server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}14 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Url used: ["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":9300/logstash-2018-08-28]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "9300/logstash-2018-08-28)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}17 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Could not create index in elasticsearch result was 7: Couldn't connect to server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}17 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Url used: ["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":9300/logstash-2018-08-28]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "9300/logstash-2018-08-28)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}20 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Could not create index in elasticsearch result was 7: Couldn't connect to server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}20 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Url used: ["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":9300/logstash-2018-08-28]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "9300/logstash-2018-08-28)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}23 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Could not create index in elasticsearch result was 7: Couldn't connect to server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Aug 28 06{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "46}}23 envy-172-17-100-1.devops cz-logd[12848]: [ERROR][elasticsearch.c][create\\"
            },
            {
              "type": "text",
              "text": "new\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "index]Url used: ["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":9300/logstash-2018-08-28]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "9300/logstash-2018-08-28)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So with this PR it will looks like this instead:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "8:29:44 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[INFO\\]\\[relp\\_sender.c\\]\\[relp\\_initial\\_connect\\]Relp connected, port: 20514\n\nAug 28 08:29:47 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:30:20 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:30:20 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:30:53 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:30:53 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:31:26 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:31:26 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:31:59 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:31:59 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:32:32 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:32:32 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:33:05 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:33:05 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                },
                {
                  "type": "text",
                  "text": "\n\nAug 28 08:33:38 envy-172-17-100-1.devops cz-logd\\[32198\\]: wrapped 11 times\n\nAug 28 08:33:38 envy-172-17-100-1.devops cz-logd\\[32198\\]: \\[ERROR\\]\\[elasticsearch.c\\]\\[create\\_new\\_index\\]Could not create index in elasticsearch result was 7: Couldn't connect to server, URL: ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/logstash-2018-08-28](http://127.0.0.1:9300/logstash-2018-08-28)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1535445359711
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so it outputs every 30 sec, \"wrapped X times\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1535445404651
      }
    ]
  },
  {
    "key": "SA-9131",
    "comments": [],
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "G:\\\\Code\\\\stratus-client-shared\\\\src\\\\ui\\\\node\\_modules\\\\electron\\\\dist\\\\resources\\\\electron.asar\\\\renderer\\\\security-warnings.js:188 Electron Security Warning (Insecure Content-Security-Policy) This renderer process has either no Content Security Policy set or a policy with \"unsafe-eval\" enabled. This exposes users of this app to unnecessary security risks.\n\nFor more information and help, consult ["
            },
            {
              "type": "text",
              "text": "https://electronjs.org/docs/tutorial/security](https://electronjs.org/docs/tutorial/security)"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\nThis warning will not show up once the app is packaged."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-9152",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Sep 11 08:43:34.646519 asdemo5.cryptzone.com cz-configd\\[810\\]: INFO \\[rest\\] \"GET /logs HTTP/1.0\" 200 - \"\" \"Service.Controller (appliance-connector)\" 5\n\nSep 11 08:44:07.262073 asdemo5.cryptzone.com cz-configd\\[810\\]: ERROR Exception when serving /logs\n\n                                                              Traceback (most recent call last):\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/channel.py\", line 336, in service\n\n                                                                  task.service()\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/task.py\", line 169, in service\n\n                                                                  self.execute()\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/task.py\", line 426, in execute\n\n                                                                  self.write(chunk)\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/task.py\", line 303, in write\n\n                                                                  channel.write\\_soon(towrite)\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/channel.py\", line 318, in write\\_soon\n\n                                                                  self.outbufs\\[-1\\].append(data)\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/buffers.py\", line 242, in append\n\n                                                                  buf.append(s)\n\n                                                                File \"/usr/lib/python3/dist-packages/waitress/buffers.py\", line 53, in append\n\n                                                                  read\\_pos = file.tell()\n\n                                                              ValueError: I/O operation on closed file.\n\nSep 11 08:44:07.263239 asdemo5.cryptzone.com cz-configd\\[810\\]: ERROR:waitress:Exception when serving /logs\n\nSep 11 08:44:07.263414 asdemo5.cryptzone.com cz-configd\\[810\\]: Traceback (most recent call last):\n\nSep 11 08:44:07.263676 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/channel.py\", line 336, in service\n\nSep 11 08:44:07.263842 asdemo5.cryptzone.com cz-configd\\[810\\]:     task.service()\n\nSep 11 08:44:07.264000 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/task.py\", line 169, in service\n\nSep 11 08:44:07.264243 asdemo5.cryptzone.com cz-configd\\[810\\]:     self.execute()\n\nSep 11 08:44:07.264406 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/task.py\", line 426, in execute\n\nSep 11 08:44:07.264561 asdemo5.cryptzone.com cz-configd\\[810\\]:     self.write(chunk)\n\nSep 11 08:44:07.264809 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/task.py\", line 303, in write\n\nSep 11 08:44:07.264982 asdemo5.cryptzone.com cz-configd\\[810\\]:     channel.write\\_soon(towrite)\n\nSep 11 08:44:07.265140 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/channel.py\", line 318, in write\\_soon\n\nSep 11 08:44:07.265328 asdemo5.cryptzone.com cz-configd\\[810\\]:     self.outbufs\\[-1\\].append(data)\n\nSep 11 08:44:07.265551 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/buffers.py\", line 242, in append\n\nSep 11 08:44:07.265722 asdemo5.cryptzone.com cz-configd\\[810\\]:     buf.append(s)\n\nSep 11 08:44:07.265879 asdemo5.cryptzone.com cz-configd\\[810\\]:   File \"/usr/lib/python3/dist-packages/waitress/buffers.py\", line 53, in append\n\nSep 11 08:44:07.266172 asdemo5.cryptzone.com cz-configd\\[810\\]:     read\\_pos = file.tell()\n\nSep 11 08:44:07.266329 asdemo5.cryptzone.com cz-configd\\[810\\]: ValueError: I/O operation on closed file.\n\nSep 11 08:45:07.471552 asdemo5.cryptzone.com cz-configd\\[810\\]: INFO \\[rest\\] \"GET /logs HTTP/1.0\" 200 - \"\" \"Service.Controller (appliance-connector)\" 0"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "On nginx"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Sep 11 08:43:55.103366 asdemo5.cryptzone.com nginx\\[13837\\]: 127.0.0.1 - - \\[11/Sep/2018:08:43:55 +0000\\] \"GET /appliance/logs HTTP/1.1\" 200 2670234 \"-\" \"Service.Controller (appliance-connector)\"\n\nSep 11 08:43:55.155713 asdemo5.cryptzone.com nginx\\[13835\\]: 82.196.109.239 - - \\[11/Sep/2018:08:43:55 +0000\\] \"POST /admin/appliances/25e0d4f6-be68-4dc9-b50f-19cafe686fb9/logs HTTP/2.0\" 200 2667348 \"["
            },
            {
              "type": "text",
              "text": "https://asdemo5.cryptzone.com:444/ui/appliances](https://asdemo5.cryptzone.com:444/ui/appliances)\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\""
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like its caused by a timeout in either nginx, controller or browser causing the file to be truncated, or rather, not downloaded fully."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1536660705021
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Steps to reproduce?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537174918602
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The only thing I have noticed is it happens when you have a looot of logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1537176431634
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm lowering the prio to 300 as this isn't really a blocker, but we still need to look into it as it's annoying, it gets in the way of getting logs from customers when they have other issues."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1537176473387
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Does it happen on purple?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537177037816
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Nope, but purple is still quite low traffic compared to a customer install."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Perhaps it would be reproducible on the performance test machines?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1537178317757
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Who has access to those?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537186498813
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per allansson for example. Or you if you ask him for the credentials etc..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1537187764580
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I managed to reproduce it, by using this python script"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "from syslog import *\nfor i in range(10000000):\n    syslog(LOG_INFO, 'log line: %d' % i)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It does not seem to be related to configd, since curl terminates first, and then after a few seconds configd reports that the connection is closed and makes an exception."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537441056067
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Because the code is compressing files one by one and then sending them, while they are getting compressed no data is sent. If no data is sent for 30 seconds, the connection gets dropped."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537450557017
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The client (at least curl) has no timeouts it seems. I tried connecting it to nc on localhost. It just sends the request and hangs, so it is the server which is closing the connection."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537510462444
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK, so there is hope that we can fix this without changing the file format then."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1537511610315
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also got to change the journald thing from using tempfiles to streaming, otherwise I get the timeout there too."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537521292194
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2359/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2359/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1537538074173
      }
    ]
  },
  {
    "key": "SA-9294",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[DEBUG\\] \\[Resolver \"AWS Resolver 1\"\\] Resolving aws://lbv2:name=lb2-ntwrk\n\n\\[DEBUG\\] \\[ELBv2Client\\] Request POST DescribeLoadBalancers (region: us-east-1, credentials: classic credentials, access key id: <removed for security>)\n\n\\[DEBUG\\] \\[ELBv2Client\\] Request POST DescribeLoadBalancers (region: eu-west-1, credentials: classic credentials, access key id: <removed for security>)\n\n\\[ERROR\\] \\[ELBv2Client\\] Action DescribeLoadBalancers using POST ["
            },
            {
              "type": "text",
              "text": "https://elasticloadbalancing.eu-west-1.amazonaws.com](https://elasticloadbalancing.eu-west-1.amazonaws.com)"
            },
            {
              "type": "text",
              "text": " returned with HTTP 400 Bad Request\n\n\\[ERROR\\] \\[ELBv2Client\\] Got error response of type Sender and code ValidationError: Pagination is not supported when specifying load balancers"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "pr: "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-gateway/pull/1829",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-gateway/pull/1829"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "harish.dinne",
        "created": 1538479343592
      }
    ]
  },
  {
    "key": "SA-9379",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The problem is that it is not possible to open IPv6 TCP connections back to client machine, but ping works."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-fd00-ffff-a-304-172-17-304-1:~# ping6 fd00:ffff:a:60:192:168:111:154\n\nPING fd00:ffff:a:60:192:168:111:154(fd00:ffff:a:60:192:168:111:154) 56 data bytes\n\n64 bytes from fd00:ffff:a:60:192:168:111:154: icmp\\_seq=1 ttl=62 time=1.83 ms\n\n64 bytes from fd00:ffff:a:60:192:168:111:154: icmp\\_seq=2 ttl=62 time=1.26 ms\n\n^C\n\n\\--- fd00:ffff:a:60:192:168:111:154 ping statistics ---\n\n2 packets transmitted, 2 received, 0% packet loss, time 1001ms\n\nrtt min/avg/max/mdev = 1.263/1.550/1.838/0.290 ms\n\nroot@envy-fd00-ffff-a-304-172-17-304-1:~# wget ["
                },
                {
                  "type": "text",
                  "text": "http://\\[fd00:ffff:a:60:192:168:111:154\\]/](http://[fd00:ffff:a:60:192:168:111:154]/)"
                },
                {
                  "type": "text",
                  "text": "\n\n\\--2018-10-12 12:07:55--  ["
                },
                {
                  "type": "text",
                  "text": "http://\\[fd00:ffff:a:60:192:168:111:154\\]/](http://[fd00:ffff:a:60:192:168:111:154]/)"
                },
                {
                  "type": "text",
                  "text": "\n\nConnecting to \\[fd00:ffff:a:60:192:168:111:154\\]:80... ^C\n\nroot@envy-fd00-ffff-a-304-172-17-304-1:~# "
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "tcpdump on client machine shows:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ sudo tcpdump -n host fd00:ffff:a:304::1 and not port 22\n\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\n\nlistening on enp0s25, link-type EN10MB (Ethernet), capture size 262144 bytes\n\n14:07:34.563217 IP6 fd00:ffff:a:304::1 > fd00:ffff:a:60:192:168:111:154: ICMP6, echo request, seq 1, length 64\n\n14:07:34.563262 IP6 fd00:ffff:a:60:192:168:111:154 > fd00:ffff:a:304::1: ICMP6, echo reply, seq 1, length 64\n\n14:07:35.564809 IP6 fd00:ffff:a:304::1 > fd00:ffff:a:60:192:168:111:154: ICMP6, echo request, seq 2, length 64\n\n14:07:35.564844 IP6 fd00:ffff:a:60:192:168:111:154 > fd00:ffff:a:304::1: ICMP6, echo reply, seq 2, length 64\n\n^C\n\n4 packets captured\n\n4 packets received by filter\n\n0 packets dropped by kernel"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1539346361794
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another interesting thing to note is that it works fine to connect with ssh to local client port 22. Are we blocking ports > X somewhere?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1539361173471
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The problem was that traffic was blocked in the WG. Fixed by Tyron now."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1539602935265
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "good job guys [Per Allansson]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"per.allansson\") "
                },
                {
                  "type": "text",
                  "text": "Tyron Turner",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/tyron.turner",
                        "title": "tyron.turner"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadi.misagh",
        "created": 1539603875234
      }
    ]
  },
  {
    "key": "SA-9428",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/88074105&group\\",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/88074105&group\\"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "by=cases",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": ":section\\_id&group\\_order=asc&group\\_id=7699036]("
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/88074105&group_by=cases",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/88074105&group_by=cases"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "section"
            },
            {
              "type": "text",
              "text": "id&group",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "order=asc&group"
            },
            {
              "type": "text",
              "text": "id=7699036)",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I've seen it fail around 40-50% for quite some time now (like months?)."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Afaict it seems pretty stable now, and when if fails it seems to be when getting the entitlement token - maybe controller just takes > 10s to generate token?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1541684290605
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:26,256423Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:26.255Z\\] Info : Getting entitlement tokens for the first time. \\[0m\n\n\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:26,259423Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:26.257Z\\] Info : Retrieving entitlement tokens. \\[0m\n\n\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:36,291423Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:36.289Z\\] Info : Existing REST connection lost. Reconnecting. \\[0m\n\n\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:36,302423Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:36.291Z\\] Info : Resolving hostname 'envy-fd00-ffff-a-302-172-17-302-1.devops' \\[0m\n\n\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:36,306423Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:36.304Z\\] Info : Trying to connect 'envy-fd00-ffff-a-302-172-17-302-1.devops/fd00:ffff:a:302::1' with SPA UdpTcp and key name 'Built-in-be85360895242'. \\[0m\n\n\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:46,824780Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:46.822Z\\] Info : REST connection could not be established. 'Connection lost.'. Will try the next IP address. \\[0m\n\n\\[06:15:08\\] : \\[Step 1/1\\]  \\[35m    2018-11-06T05:14:46,825780Z \\[STREAM\\] \\[performance\\\\complex\\_ruleset\\\\complex\\_ruleset\\_no\\_download\\] \\[client-service/stdout\\] \\[2018-11-06T05:14:46.824Z\\] Error : Retrieving new entitlement token from '["
                },
                {
                  "type": "text",
                  "text": "https://envy-fd00-ffff-a-302-172-17-302-1.devops/'](https://envy-fd00-ffff-a-302-172-17-302-1.devops/')"
                },
                {
                  "type": "text",
                  "text": " during login has failed. Reason: Connection lost. \\[0m"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1541684415819
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Indeed, request takes 11303ms"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Nov 06 05:14:37.387223 envy-fd00-ffff-a-302-172-17-302-1.devops cz-controllerd\\[3556\\]: fd00:ffff:a:94:b97d:6e53:ae27:140d - - \\[06/Nov/2018:05:14:37 +0000\\] \"GET /client/authorization/ HTTP/1.0\" 200 39447 \"-\" \"AppGateClient/4.2.0-13713-beta\" 11303"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1541684586600
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-9633",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-9633"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1541685251347
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Do you think it's the same as [SA-9633](SA-9633) "
                },
                {
                  "type": "text",
                  "text": "Per Allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                        "title": "per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "? If so, let's mark this Duplicate."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1542731238253
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Pretty low odds on that I would say."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1542731781455
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Opening this again as it started not working on Windows 10."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1545380188235
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-tests/pull/1794",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-tests/pull/1794"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1545407732089
      }
    ]
  },
  {
    "key": "SA-9519",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. if you.. on the logserver stop for example cz-nginx. and then go to another appliance and ssh (this will generate audit logs). And then go back to logserver and enabled nginx again. Then some audit logs are disappearing."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Putting ffwd into trace mode.. shows the problem. When the connection is reEstablished. Then the logd send the audit logs."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\-30T08:47:14Z\",\"protocol\":\"ssh2\",\"client\\_port\":45172,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: \\[client\\]\\[9010-->envy-172-17-156-1.devops:444:9320\\]\\[session:62\\]\\[TRACE\\] received ws: 15\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: \\[client\\]\\[9010-->envy-172-17-156-1.devops:444:9320\\]\\[session:62\\]\\[TRACE\\] ws->local 15, str:2 rsp 6 200 OK\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: \\[client\\]\\[9010-->envy-172-17-156-1.devops:444:9320\\]\\[session:62\\]\\[TRACE\\] local->ws 3427, str:3 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 4 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 5 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 6 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 7 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 8 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 9 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 10 open 86 relp\\_version=0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: relp\\_software=librelp,1.2.14,["
                },
                {
                  "type": "text",
                  "text": "http://librelp.adiscon.com](http://librelp.adiscon.com)"
                },
                {
                  "type": "text",
                  "text": "\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: commands=syslog\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 11 syslog 363 {\"version\":1,\"date\":\"Oct 30 08:47:14\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"publickey\",\"event\\_type\":\"ssh\\_access\\_failed\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:14Z\",\"protocol\":\"ssh2\",\"client\\_port\":45172,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 12 syslog 363 {\"version\":1,\"date\":\"Oct 30 08:47:14\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"publickey\",\"event\\_type\":\"ssh\\_access\\_failed\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:14Z\",\"protocol\":\"ssh2\",\"client\\_port\":45172,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 13 syslog 365 {\"version\":1,\"date\":\"Oct 30 08:47:16\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"password\",\"event\\_type\":\"ssh\\_access\\_succeeded\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:16Z\",\"protocol\":\"ssh2\",\"client\\_port\":45172,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 14 syslog 363 {\"version\":1,\"date\":\"Oct 30 08:47:30\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"publickey\",\"event\\_type\":\"ssh\\_access\\_failed\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:30Z\",\"protocol\":\"ssh2\",\"client\\_port\":45184,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 15 syslog 363 {\"version\":1,\"date\":\"Oct 30 08:47:30\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"publickey\",\"event\\_type\":\"ssh\\_access\\_failed\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:30Z\",\"protocol\":\"ssh2\",\"client\\_port\":45184,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 16 syslog 363 {\"version\":1,\"date\":\"Oct 30 08:47:30\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"publickey\",\"event\\_type\":\"ssh\\_access\\_failed\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:30Z\",\"protocol\":\"ssh2\",\"client\\_port\":45184,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 17 syslog 365 {\"version\":1,\"date\":\"Oct 30 08:47:31\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"password\",\"event\\_type\":\"ssh\\_access\\_succeeded\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:31Z\",\"protocol\":\"ssh2\",\"client\\_port\":45184,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: \\[client\\]\\[9010-->envy-172-17-156-1.devops:444:9320\\]\\[session:62\\]\\[TRACE\\] received ws: 82\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: \\[client\\]\\[9010-->envy-172-17-156-1.devops:444:9320\\]\\[session:62\\]\\[TRACE\\] ws->local 82, str:3 rsp 20 500 connection alrea\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 3 rsp 26 500 error 10047 on connect\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: 0 serverclose 0\n\nOct 30 08:47:54 envy-172-17-156-2.devops ffwd\\[5578\\]: \\[client\\]\\[9010-->envy-172-17-156-1.devops:444:9320\\]\\[session:62\\]\\[DEBUG\\] Websocket connection was ended by server: websocket: close 1006 (abnormal closure): unexpected EOF"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But on the other appliance:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Oct 30 08:47:40 envy-172-17-156-1.devops cz-logd\\[29388\\]: \\[DEBUG\\]\\[elasticsearch.c\\]\\[buffer\\_sender\\_entry\\]Flushing buffers of size: 1\n\nOct 30 08:47:40 envy-172-17-156-1.devops cz-logd\\[29388\\]: \\[DEBUG\\]\\[geo\\_ip.c\\]\\[geo\\_ip\\_lookup\\]No GEO-IP info for ip : 192.168.111.162, status: 7\n\nOct 30 08:47:54 envy-172-17-156-1.devops cz-logd\\[29388\\]: \\[DEBUG\\]\\[relp\\_input.c\\]\\[on\\_relp\\_msg\\_recv\\]Received syslog from localhost, ip 127.0.0.1 length: 363 msg:\\[{\"version\":1,\"date\":\"Oct 30 08:47:14\",\"hostname\":\"envy-172-17-156-2.devops\",\"daemon\":\"cz-appliance\",\"log\":{\"version\":9,\"username\":\"cz\",\"authentication\\_method\":\"publickey\",\"event\\_type\":\"ssh\\_access\\_failed\",\"client\\_ip\":\"192.168.111.162\",\"timestamp\":\"2018-10-30T08:47:14Z\",\"protocol\":\"ssh2\",\"client\\_port\":45172,\"collective\\_id\":\"784a4849-e835-4b2e-95ca-74cd63f60261\"}}\\]\n\nOct 30 08:47:54 envy-172-17-156-1.devops cz-logd\\[29388\\]: \\[DEBUG\\]\\[log\\_sender.c\\]\\[send\\_elasticsearch\\]Sending elasticsearch, db\\_id : 0\n\nOct 30 08:47:54 envy-172-17-156-1.devops cz-logd\\[29388\\]: \\[DEBUG\\]\\[elasticsearch.c\\]\\[buffer\\_sender\\_entry\\]Flushing buffers of size: 1\n\nOct 30 08:47:54 envy-172-17-156-1.devops cz-logd\\[29388\\]: \\[DEBUG\\]\\[geo\\_ip.c\\]\\[geo\\_ip\\_lookup\\]No GEO-IP info for ip : 192.168.111.162, status: 7"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " So.. The logs where sent by logd... but they where not reported back to the logd application."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1540889928232
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. Its more or less a variant of : "
                },
                {
                  "type": "text",
                  "text": "https://github.com/rsyslog/librelp/issues/129",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/rsyslog/librelp/issues/129"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1540889996043
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. there a workaround.. We could patch librelp to accept multiple open messages."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another workaround could also be, todo \"websocket initiated setup\" in ffwd."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1540890113386
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "going with \"websocket initiated setup\".. it should work fine"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1540894726827
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2441",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2441"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1540912851645
      }
    ]
  },
  {
    "key": "SA-9576",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Jamie said that since we support 4.0 for a couple more months, and we'll support 4.1 for some time, we should run nightlies also using those older clients against the current master (or beta) branch, so that we notice if changes break compatibility with still supported clients."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I suppose this involves making aitorbot generate more cron entries to run those extra tests, and also manage to point the tests to the pinned builds, and finding out how to either make them rebuild or ensuring tc won't remove the binaries."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1541092412912
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well old releases are always pinned (manually) on teamcity so that shouldn't be a problem."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1541156836456
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We already have some support for getting the release builds from teamcity, see "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/aitorbot/blob/master/aitorbot/aitorbot/client/cron\\_client.py#L64-L75",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/aitorbot/blob/master/aitorbot/aitorbot/client/cron_client.py#L64-L75"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Getting it for all supported versions could be doable by querying teamcity for all pinned release builds and taking the highest Z for versions X.Y.Z (e.g. only 4.0.4 for 4.0.Z and 4.1.6 for 4.1.Z)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1541156932975
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeah that part was what I wanted to modify"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1541159673381
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "for 4.2 we should be testing 2 back so 4.1 and 4.0 (latests) clients."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1541417615536
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " this is gonna introduce a tagging scheme in tc that you have to follow or i'll unleash Jamie on you! :P"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547204928472
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-9798",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-9798"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " yes, I'm waiting for this ;)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1547205062605
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but do tell me about this tagging scheme?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We're already tagging each release with "
                },
                {
                  "type": "text",
                  "text": "release#x.x.x",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". If you can just support startsWith, we should be fine."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Then we can just put "
                },
                {
                  "type": "text",
                  "text": "release#4.2",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " & "
                },
                {
                  "type": "text",
                  "text": "release#4.1",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " as params to the aitorbot command."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1547205181228
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I know, but there are a number of issues with that."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "1 - It doesn't know what \"2 releases back\" means 2 - It's a pain in the ass to implement."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Using int numbers like systemd does would be the best, and tagging every point release with that same number."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For example:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "4.0.0  40 4.0.1  40 4.0.2  40 4.1.0  41 4.1.1  41 4.2.0  42 5.9.xp  43 11.ultimate  44 11.ultimateforreal  44"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "in this way, if they are ints, it can just go n-2 and get the latest build with that tag, regardless of skipped versions, no complicated logic involved on calculating version numbers, check for skips, and so on."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547205767375
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "we have version parser everywhere already. it's not that hard to parse "
                },
                {
                  "type": "text",
                  "text": "x.x.x",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". It'd be great if we can avoid more manual work."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Not the prettiest code but: "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-controller/blob/master/Common.Library/src/main/java/com/cyxtera/controller/common/library/util/ClientVersion.java",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-controller/blob/master/Common.Library/src/main/java/com/cyxtera/controller/common/library/util/ClientVersion.java"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Probably much cleaner on Python."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1547210776680
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I am working on a REST api which will return the latest version of all supported versions. Would that help?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1547214009543
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But 4.0 came after 3.3 what math formula would give those arbitrary numbers?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We know that 5 comes after 4 if we just use natural numbers instead."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547215689585
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "first you compare the major version: 5 > 4 > 3"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "then minor version: 3 > 2 > 1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "then the patch version.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1547217744210
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/helvetest/pull/262",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/helvetest/pull/262"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547559112275
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/aitorbot/pull/671",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/aitorbot/pull/671"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547561117644
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/aitorbot/pull/672",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/aitorbot/pull/672"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547565331218
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/aitorbot/pull/675",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/aitorbot/pull/675"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1547650670752
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "jamie.bodley",
                    "text": "@jamie.bodley",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-scott in the end it tests:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "release client+master appliance release-1 client+master appliance master client+release appliance master client+release-1 appliance"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548077213411
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm now upgrading the envy machine so new aitorbot runs nicely."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548080267884
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm now upgrading the envy machine so new aitorbot runs nicely."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK but the cron is on testyd devops :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1548080391021
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "doh!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548081526920
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It is done."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548085024612
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Needs grafana update after they run once."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1548085149680
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "tomorrow then"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548085229801
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/aitorbot/pull/682",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/aitorbot/pull/682"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548337566555
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ for tag in $tags; do aitorbot test get --tags $tag --since yesterday --user aitorbot ; done\naitorbot ['forward_compatibility'] | 2019-01-25 00:00:10\n        id:   f98bfdd3-989b-4780-8433-711f2fe254d0\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/565285"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 61/61\naitorbot ['very_old_forward_compatibility'] | 2019-01-24 22:00:09\n        id:   0350792c-2974-4541-8979-5092d218acbc\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/565234"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 51/61\naitorbot ['backward_compatibility'] | 2019-01-24 21:00:11\n        id:   95eae792-04b2-4b09-b17e-b0defb8d52d7\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/565212"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 55/61\naitorbot ['old_backward_compatibility'] | 2019-01-24 20:00:11\n        id:   07cbf25b-60c6-42b4-8287-5c2af18c113d\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/565194"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 57/61\naitorbot ['very_old_backward_compatibility'] | 2019-01-24 19:00:10\n        id:   6bf545d2-96d3-406a-80e9-9803bf4d6ea4\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/565172"
                },
                {
                  "type": "text",
                  "text": "\n        passed: 2/61"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548404535929
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is one of them which is not being ran due to some issue in helvetest which am investigating as another task."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Anyway, "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " the tags I used are:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "forward"
                        },
                        {
                          "type": "text",
                          "text": "compatibility",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "old"
                        },
                        {
                          "type": "text",
                          "text": "forward",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "compatibility"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "very"
                        },
                        {
                          "type": "text",
                          "text": "old",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "forward"
                        },
                        {
                          "type": "text",
                          "text": "compatibility",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "backward"
                        },
                        {
                          "type": "text",
                          "text": "compatibility",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "old"
                        },
                        {
                          "type": "text",
                          "text": "backward",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "compatibility"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "very"
                        },
                        {
                          "type": "text",
                          "text": "old",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "backward"
                        },
                        {
                          "type": "text",
                          "text": "compatibility",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Feel free to add the missing ones to grafana."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548404700128
      }
    ]
  },
  {
    "key": "SA-9664",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It would be better, I could completely disable access for the controller process to tcp/ip protocols if it was only using unix sockets for everything."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "AFAIK we were using unix sockets.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1542034812796
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-140-1:/home/cz# netstat -p | grep java\ntcp6       0      0 localhost:9300          localhost:20786         ESTABLISHED 5093/java           \ntcp6       0      0 localhost:9300          localhost:20790         ESTABLISHED 5093/java           \nunix  3      [ ]         STREAM     CONNECTED     22978451 3438/java            \nunix  3      [ ]         STREAM     CONNECTED     22976411 3438/java            \nunix  2      [ ]         STREAM     CONNECTED     37763    3438/java            \nunix  2      [ ]         DGRAM                    40185    3438/java            \nunix  2      [ ]         STREAM     CONNECTED     48958    5093/java            \nunix  3      [ ]         STREAM     CONNECTED     22977468 3438/java            \nunix  3      [ ]         STREAM     CONNECTED     38468    3438/java            "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1542034840859
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "tcp6       0      0 127.0.0.1:9130          :::*                    LISTEN      3438/java           \ntcp6       0      0 127.0.0.1:9131          :::*                    LISTEN      3438/java"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-140-1:/home/cz# service cz-controllerd status\n cz-controllerd.service - AppGate Controller daemon\n   Loaded: loaded (/lib/systemd/system/cz-controllerd.service; static; vendor preset: enabled)\n   Active: active (running) since Tue 2018-11-06 11:41:51 UTC; 6 days ago\n  Process: 4856 ExecReload=/usr/bin/curl --silent -X POST "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9131/tasks/reload"
                },
                {
                  "type": "text",
                  "text": " (code=exited, status=0/SUCCESS)\n Main PID: 3438 (java)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Controller is listening to tcp stuff"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1542103856828
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "that's not postgres. that's http which nginx uses to connect. currently there is no http via unix socket support on controller due to the libraries we use. there is already a task for that though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1542106409079
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Can you link it to me? So I can add about the network protocol restriction there"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1542106786916
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-2738",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-2738"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1542106886254
      }
    ]
  },
  {
    "key": "SA-9671",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "https://www.mono-project.com/docs/faq/security/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://www.mono-project.com/docs/faq/security/"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[2018-11-14T10:41:31.710Z\\] Error : Error during downloading file. Error: TrustFailure (The authentication or decryption has failed.)\n\n\\[2018-11-14T10:41:31.713Z\\] Error : Client update download error: $["
            },
            {
              "type": "text",
              "text": "https://s3.eu-central-1.amazonaws.com/appgate-auto-update-artifacts/appgate\\_4.2.0%2B12892%2Bbeta\\_amd64.deb](https://s3.eu-central-1.amazonaws.com/appgate-auto-update-artifacts/appgate_4.2.0%2B12892%2Bbeta_amd64.deb)"
            },
            {
              "type": "text",
              "text": " , $System.Net.WebException: Error: TrustFailure (The authentication or decryption has failed.) ---> System.IO.IOException: The authentication or decryption has failed. ---> System.IO.IOException: The authentication or decryption has failed. ---> Mono.Security.Protocol.Tls.TlsException: Invalid certificate received from server. Error code: 0xffffffff800b010a\n\n  at Mono.Security.Protocol.Tls.RecordProtocol.EndReceiveRecord (System.IAsyncResult asyncResult) \\[0x00037\\] in <a4e5c40e89b7402eaec8568e30e9260a>:0 \n\n  at Mono.Security.Protocol.Tls.SslClientStream.SafeEndReceiveRecord (System.IAsyncResult ar, System.Boolean ignoreEmpty) \\[0x00000\\] in <a4e5c40e89b7402eaec8568e30e9260a>:0 \n\n  at Mono.Security.Protocol.Tls.SslClientStream.NegotiateAsyncWorker (System.IAsyncResult result) \\[0x00071\\] in <a4e5c40e89b7402eaec8568e30e9260a>:0 \n\n   --- End of inner exception stack trace ---\n\n  at Mono.Security.Protocol.Tls.SslClientStream.EndNegotiateHandshake (System.IAsyncResult result) \\[0x00032\\] in <a4e5c40e89b7402eaec8568e30e9260a>:0 \n\n  at Mono.Security.Protocol.Tls.SslStreamBase.AsyncHandshakeCallback (System.IAsyncResult asyncResult) \\[0x0000c\\] in <a4e5c40e89b7402eaec8568e30e9260a>:0 \n\n   --- End of inner exception stack trace ---\n\n  at Mono.Security.Protocol.Tls.SslStreamBase.EndRead (System.IAsyncResult asyncResult) \\[0x0004b\\] in <a4e5c40e89b7402eaec8568e30e9260a>:0 \n\n  at Mono.Net.Security.Private.LegacySslStream.EndAuthenticateAsClient (System.IAsyncResult asyncResult) \\[0x0000e\\] in <2736c63206b04ee9bdd526624de6640b>:0 \n\n  at Mono.Net.Security.Private.LegacySslStream.AuthenticateAsClient (System.String targetHost, System.Security.Cryptography.X509Certificates.X509CertificateCollection clientCertificates, System.Security.Authentication.SslProtocols enabledSslProtocols, System.Boolean checkCertificateRevocation) \\[0x0000e\\] in <2736c63206b04ee9bdd526624de6640b>:0 \n\n  at Mono.Net.Security.MonoTlsStream.CreateStream (System.Byte\\[\\] buffer) \\[0x0007b\\] in <2736c63206b04ee9bdd526624de6640b>:0 \n\n  at System.Net.WebConnection.CreateStream (System.Net.HttpWebRequest request) \\[0x00073\\] in <2736c63206b04ee9bdd526624de6640b>:0 \n\n   --- End of inner exception stack trace ---\n\n  at System.Net.HttpWebRequest.EndGetResponse (System.IAsyncResult asyncResult) \\[0x00058\\] in <2736c63206b04ee9bdd526624de6640b>:0 \n\n  at System.Net.WebClient.GetWebResponse (System.Net.WebRequest request, System.IAsyncResult result) \\[0x00000\\] in <2736c63206b04ee9bdd526624de6640b>:0 \n\n  at System.Net.WebClient.DownloadBitsResponseCallback (System.IAsyncResult result) \\[0x00015\\] in <2736c63206b04ee9bdd526624de6640b>:0 "
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "apt install ca-certificates-mono",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " solves but it download it 17,5 MB of mono crap"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Setting up cli-common (0.9+nmu1) ...\n\nSetting up mono-runtime-sgen (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up mono-runtime (4.6.2.7+dfsg-1ubuntu1) ...\n\nupdate-alternatives: using /usr/bin/mono to provide /usr/bin/cli (cli) in auto mode\n\nSetting up libmono-corlib4.5-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-i18n4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-system-xml4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-system4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-i18n-west4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-system-security4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-security4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up mono-4.0-gac (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up mono-gac (4.6.2.7+dfsg-1ubuntu1) ...\n\nupdate-alternatives: using /usr/bin/gacutil to provide /usr/bin/cli-gacutil (global-assembly-cache-tool) in auto mode\n\nSetting up mono-runtime-common (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up libmono-system-configuration4.0-cil (4.6.2.7+dfsg-1ubuntu1) ...\n\nSetting up ca-certificates-mono (4.6.2.7+dfsg-1ubuntu1) ...\n\nProcessing triggers for libc-bin (2.27-3ubuntu1) ...\n\nProcessing triggers for ca-certificates (20180409) ...\n\nUpdating certificates in /etc/ssl/certs..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1542193914252
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So scrap using C# for download on osx/linux and use wget or curl - whichever can be found."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1542194081095
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-client-shared/pull/3364",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-client-shared/pull/3364"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1542285628609
      }
    ]
  },
  {
    "key": "SA-9673",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I had the issue of "
            },
            {
              "type": "text",
              "text": "SA-9671",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "SA-9671"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " but then installed the mono stuff so client downloaded successfully the new .deb but it never notified for installation or anything. The only thing related to update that happened is that file has been downloaded. Note that even signing out and quit and starting again didn't do anything."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[2018-11-14T10:59:27.940Z\\] Info : Updating tokens at gateway '168.63.56.10'. Claims Token: True, Device Claims: False, Entitlement Token: True\n\n\\[2018-11-14T10:59:28.008Z\\] Info : Connected and logged into all sites.\n\n\\[2018-11-14T10:59:28.145Z\\] Info : Successfully updated tokens on gateway 'purple30.cryptzone.com'.\n\n\\[2018-11-14T10:59:28.145Z\\] Info : Successfully updated tokens on gateway '168.63.56.10'.\n\n\\[2018-11-14T10:59:28.145Z\\] Info : Successfully updated tokens on gateway 'purple5.cryptzone.com'.\n\n\\[2018-11-14T10:59:28.145Z\\] Info : Successfully updated tokens on gateway 'purple.cryptzone.com'.\n\n\\[2018-11-14T10:59:28.145Z\\] Info : Successfully updated tokens on gateway 'purple40.cryptzone.com'.\n\n\\[2018-11-14T10:59:28.247Z\\] Info : Successfully updated tokens on gateway 'purple15.cryptzone.com'.\n\n\\[2018-11-14T10:59:31.489Z\\] Info : Successfully updated tokens on gateway 'ec2-35-176-146-14.eu-west-2.compute.amazonaws.com'.\n\n\\[2018-11-14T10:59:31.489Z\\] Info : Successfully updated tokens on gateway 'purple1.cryptzone.com'.\n\n\\[2018-11-14T10:59:33.294Z\\] Info : Download completed, file is in '/tmp/appgate\\_4.2.0+12892+beta\\_amd64.deb'"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another case. Here has issue because the file is already there. Same result no notification for actually running the update or anything"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2018-11-14T10:59:13.676Z\\] Info : Successfully updated tokens on gateway 'ec2-35-176-146-14.eu-west-2.compute.amazonaws.com'.\n\n\\[2018-11-14T10:59:14.180Z\\] Info : Successfully updated tokens on gateway 'purple1.cryptzone.com'.\n\n\\[2018-11-14T10:59:14.950Z\\] Info : Download completed, file is in '/tmp/appgate\\_4.2.0+12892+beta\\_amd64.deb'\n\n\\[2018-11-14T10:59:19.318Z\\] Info : ExitCode: 0\n\n\\[2018-11-14T10:59:19.319Z\\] Info : output: GOODSIG \\_gpgcyxtera F36B319BCE0748F7793052E6F600207F0680FA29 1542124415\n\n\\[2018-11-14T10:59:19.319Z\\] Info : Copying file to: /home/kosmas/Downloads/appgate\\_4.2.0+12892+beta\\_amd64.deb\n\n\\[2018-11-14T10:59:19.320Z\\] Error : Error while copying file: /home/kosmas/Downloads/appgate\\_4.2.0+12892+beta\\_amd64.deb already exists\n\n\\[2018-11-14T10:59:25.380Z\\] Info : Starting HTTP Server to receive SAML token.\n\n\\[2018-11-14T10:59:25.382Z\\] Info : Starting the browser to ["
                },
                {
                  "type": "text",
                  "text": "https://dev-764072.oktapreview.com/app/cryptzonedev764072\\_cryptzonetest\\_1/exk67telgvNxuVCid0h7/sso/saml?SAMLRequest=fZDBSsQwEEDvfkWZe9ckG9t0aLIsiFDQi64evCxpGrXYJmsnFT%2Ff6iqsF48Dw3tvpt58jEP27ifqY9DAVwwyH1zs%2BvCs4X53lSvYmLOa7DiIA27n9BJu%2FdvsKWXNpYZ9uS5l16m2qpRqPXfOFYzxUvD2aW2luICsIZp9EyjZkDQIxlXOec7ljikUBcpiJSr5CNnDb4T4iliyAuFRq2GeAkZLPWGwoydMDu%2B2N9e4rOJhiim6OIA5VuK3cDol%2FA%2BwRH5KixpMfE12n5bj6vNTlvkZ%2Fz7AfAI%3D](https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml?SAMLRequest=fZDBSsQwEEDvfkWZe9ckG9t0aLIsiFDQi64evCxpGrXYJmsnFT%2Ff6iqsF48Dw3tvpt58jEP27ifqY9DAVwwyH1zs%2BvCs4X53lSvYmLOa7DiIA27n9BJu%2FdvsKWXNpYZ9uS5l16m2qpRqPXfOFYzxUvD2aW2luICsIZp9EyjZkDQIxlXOec7ljikUBcpiJSr5CNnDb4T4iliyAuFRq2GeAkZLPWGwoydMDu%2B2N9e4rOJhiim6OIA5VuK3cDol%2FA%2BwRH5KixpMfE12n5bj6vNTlvkZ%2Fz7AfAI%3D)"
                },
                {
                  "type": "text",
                  "text": "."
                },
                {
                  "type": "text",
                  "text": "\n\n\\[2018-11-14T10:59:27.033Z\\] Info : A new HTTP connection has been opened to the client.\n\n\\[2018-11-14T10:59:27.034Z\\] Info : Parsed HTTP header. Waiting for payload.\n\n\\[2018-11-14T10:59:27.034Z\\] Info : Received SAML token. Will send it to controller.\n\n\\[2018-11-14T10:59:27.111Z\\] Info : Retrieving claims token.\n\n\\[2018-11-14T10:59:27.273Z\\] Info : Fetching on-boarding cookie for 'onboardingcookie-15:f9:bc:22:13:3e:ba:0a:91:b2:e0:8e:e9:0e:89:a4:e7:91:ff:b5:39:f5:fc:c1:7a:e7:54:55:6d:54:d5:da-OKTA-kosmas.valianos-74874ee7-7f03-49c3-926d-3e6382effaee' from secure storage.\n\n\\[2018-11-14T10:59:27.281Z\\] Info : On-boarding cookie available for 'onboardingcookie-15:f9:bc:22:13:3e:ba:0a:91:b2:e0:8e:e9:0e:89:a4:e7:91:ff:b5:39:f5:fc:c1:7a:e7:54:55:6d:54:d5:da-OKTA-kosmas.valianos-74874ee7-7f03-49c3-926d-3e6382effaee'.\n\n\\[2018-11-14T10:59:27.413Z\\] Info : Authentication succeeded. Claims Token: \\[TokenId: 391b65de-743e-41d7-a1af-a5438984993f, DistinguishedName: CN=74874ee77f0349c3926d3e6382effaee,CN=kosmas.valianos,OU=OKTA, FirstName: Kosmas, LastName: Valianos, ExpirationTime: 11/14/2018 11:59:27 PM\\], On-demand Claims: \\[\\[\\]\\], Device Scripts: \\[\\[\\]\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1542195031746
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-9608",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-9608"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1542201255053
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I am not sure they are the same cause look the description log. The first time there was no problem and nothing happened. The file was downloaded but never moved on to installation."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The comment logs ok"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1542201595013
      }
    ]
  },
  {
    "key": "SA-9697",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "As it seems to fail very often lately. Possibly emulator not starting.."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "After switching to python, emulator startups were stable. Lately it has been chromedriver crash:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[09:08:52][Step 1/1] 2018-11-20 08:08:52:140 - error: Chromedriver: Chromedriver exited unexpectedly with code null, signal SIGTERM\n[09:08:52][Step 1/1] 2018-11-20 08:08:52:140 - warn: Chromedriver for context WEBVIEW_com.cryptzone.appgate.xdp stopped unexpectedly\n[09:08:52][Step 1/1] 2018-11-20 08:08:52:141 - warn: Chromedriver quit unexpectedly, but it wasn't the active context, ignoring\n[09:08:52][Step 1/1] 2018-11-20 08:08:52:144 - error: Chromedriver: Error: An error occurred (Original error: chrome not reachable\n[09:08:52][Step 1/1]   (Driver info: chromedriver=2.18.343845 (73dd713ba7fbfb73cbb514e62641d8c96a94682a),platform=Windows NT 6.1 SP1 x86_64))"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "same as in all following:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "aitorbot test get -t hourly_android\n\naitorbot ['hourly_android'] | 2018-11-20 05:50:12\n\tid:   6fdae79e-a96c-431a-81d0-b0dc0f9646b4\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/530541"
                },
                {
                  "type": "text",
                  "text": "\n\tpassed: 0/17\naitorbot ['hourly_android'] | 2018-11-20 07:50:12\n\tid:   d701e886-e443-46af-b20b-a6cb6956e4e3\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/530579"
                },
                {
                  "type": "text",
                  "text": "\n\tpassed: 0/17\naitorbot ['hourly_android'] | 2018-11-20 09:50:14\n\tid:   df886425-8399-4583-bbdc-d2444c954765\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/530647"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'll try restarting Appium service after failed test cases and see how it goes."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1542710545810
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "PR: "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-tests/pull/1741",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-tests/pull/1741"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1542803181201
      }
    ]
  },
  {
    "key": "SA-9711",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[16:00:50][Step 1/1] make -C geoip\n[16:00:50][Step 1/1] make[1]: Entering directory '/home/builderbob/buildAgent/work/8c5416e95911c40/geoip'\n[16:00:50][Step 1/1] cd geoip; geoipupdate -d . -f GeoIP.conf\n[16:02:58][Step 1/1] curl_easy_perform() failed: Couldn't connect to server\n[16:02:58][Step 1/1] Connect to "
            },
            {
              "type": "text",
              "text": "https://updates.maxmind.com/app/update_getfilename?product_id=GeoLite2-City"
            },
            {
              "type": "text",
              "text": "\n[16:02:58][Step 1/1] make[1]: *** [geoip/GeoLite2-City.mmdb] Error 1\n[16:02:58][Step 1/1] make: *** [cz-geoip] Error 2\n[16:02:58][Step 1/1] Makefile:4: recipe for target 'geoip/GeoLite2-City.mmdb' failed\n[16:02:58][Step 1/1] make[1]: Leaving directory '/home/builderbob/buildAgent/work/8c5416e95911c40/geoip'\n[16:02:58][Step 1/1] Makefile:94: recipe for target 'cz-geoip' failed\n[16:02:58][Step 1/1] Process exited with code 2"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "And that of course failed my build."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok.. but we should get the latest geo-ip db during the build.. so howto do that without downloading from the internet."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1542640427011
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Make a cron script to pull it and put it on akira i guess"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1542640773175
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Does it even matter if it's not the latest latest one?"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If appliances upgrade it anyway, it doesn't matter"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If they don't, it's out of date anyway, so doesn't matter"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": ":P"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1542640872405
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I would still think it better to provide a as-fresh as possible. I mean in theory we can add a 2 year old one, and it will probably take time before anyone will notice."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1542641137434
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2521",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2521"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1543483622770
      }
    ]
  },
  {
    "key": "SA-9787",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Controller still sends editable field in REST responses and UI sends it back, even if they are not used in the new UI any more:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "{  \n   \"enabled\":true,\n   \"criteriaScript\":\"7c643920-7112-11e6-8b77-86f30ca893d3\",\n   \"windows\":{  \n      \"url\":\""
            },
            {
              "type": "text",
              "text": "http://sadfsdafdsafpoidsafhspdaifhdlkfhsakljfhdsa.com\""
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": "\n      \"version\":\"5\"\n   },\n   \"editable\":true\n}"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Enabled is useful there though. You may want to keep your settings but just disable the whole thing altogether."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1542899788387
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ah ok it is just \"editable\", copy/pasta error."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1542900012566
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Realized I get "
                },
                {
                  "type": "text",
                  "text": "'deletable': True, 'taggable': True",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " while using API directly, don't know if they are also unused."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1542969232259
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, they are unused. All of them should be removed."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543220036102
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "API spec should be updated accordingly."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543220048817
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Frontend PR "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-9807",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-9807"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543240068404
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "thanks to "
                },
                {
                  "type": "text",
                  "text": "Hadrien Luttiau",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/hadrien.luttiau",
                        "title": "hadrien.luttiau"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " , we still need to keep these attributes in some places as follow:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "deletable: localUser, otpProvider IdentityProvider"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "editable: auto-update-settings, global-settings"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadi.misagh",
        "created": 1543240109637
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think we should remove them as well. It will just require a frontend update"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543240206439
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Actually, "
                },
                {
                  "type": "text",
                  "text": "removable",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is used in the UI to disable the delete button. So I think we should keep it for the entities with "
                },
                {
                  "type": "text",
                  "text": "builtin",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " that cannot be deleted. "
                },
                {
                  "type": "text",
                  "text": "localUser",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "text",
                  "text": "otpProvider",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "text",
                  "text": "IdentityProvider",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " are already implemented. From what I could find "
                },
                {
                  "type": "text",
                  "text": "conditions",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is missing. (If there is more please let me know I'll update the frontend too)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543241954032
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It seems that the controller is sending "
                },
                {
                  "type": "text",
                  "text": "deletable: true",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " for the builtin condition, I guess it is a small fix"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543242338206
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also I realised that the default builtin privileges are deletable, that can be dangerous I feel. Is there a reason for it ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543242838268
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes, ideally there shouldn't be a one big admin role to manage everything (separation of duties) except maybe for disaster reasons. So it's up to the administrators to set up a secure privilege division instead of one admin user. Though in reality that's not often the case :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543243075406
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and I think we should move all those logics to UI instead since we're already doing for the most part. There is no Condition code that sets deletable false, but there is one for LocalDatabase Identity Provider."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "    if (identityProviderDto.getType().equals(IdentityModel.IdentityProviderType.LocalDatabase)) {\n\n      identityProviderDto.setDeletable(false);\n\n    }"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " that's not awfully hard to migrate to UI code though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543243147820
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes it is possible in the UI too. The good point of having this check in the controller is that the UI doesn't need to know the "
                },
                {
                  "type": "text",
                  "text": "builtin",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " UUIDs But it is only for 4-5 entities so I guess we could add it"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543244001776
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "well, we have the checks on the controller for them, so if you try to delete it will return error. Just like HTTP 422, it doesn't inform you about the constraints beforehand."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Having \"deletable\" field in each item just for this use case is a bit weird I think from the controller perspective."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543244365505
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok, I'll add the check in the frontend. All the builtin UUID are always the same right ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543245017488
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes. But IDP and MFA providers, you can just check the "
                },
                {
                  "type": "text",
                  "text": "type",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " field instead."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543245187819
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I realised that one can delete "
                },
                {
                  "type": "text",
                  "text": "admin",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " user from the "
                },
                {
                  "type": "text",
                  "text": "local",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " IDP, is it by design ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543246707601
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes. you can also edit and break built-in administrator policy."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1543246873974
      }
    ]
  },
  {
    "key": "SA-9791",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Nov 23 11:37:43 envy-172-17-144-1.devops systemd[1]: Starting Message of the Day...\nNov 23 11:37:43 envy-172-17-144-1.devops 50-motd-news[5237]:   * MicroK8s is Kubernetes in a snap. Made by devs for devs. One quick\nNov 23 11:37:43 envy-172-17-144-1.devops 50-motd-news[5237]:     install on a workstation, VM, or appliance.\nNov 23 11:37:43 envy-172-17-144-1.devops 50-motd-news[5237]:    - "
            },
            {
              "type": "text",
              "text": "http://bit.ly/microk8s"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2520"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1543416085178
      }
    ]
  },
  {
    "key": "SA-9834",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When controller returns an response like following:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "{  \n   \"enabled\":true,\n   \"criteriaScript\":\"7c643920-7112-11e6-8b77-86f30ca893d3\",\n   \"macOS\":{  \n      \"url\":\""
            },
            {
              "type": "text",
              "text": "https://helvetest.ad.cryptzone.com:443/testsd/project/666/StratusClient_Osx/master/artifact/AppGate"
            },
            {
              "type": "text",
              "text": " SDP 4.2.0-14293-master Installer.dmg?is-build-type-id\",\n      \"version\":\"999\"\n   }\n}"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Page gets stuck at enabled/disabled (screenshot). Just run "
            },
            {
              "type": "text",
              "text": "testy tools/cleanup",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " against your env and browse to client-auto update page."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](image.png)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The state has "
                },
                {
                  "type": "text",
                  "text": "enabled: false",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " so I guess there is a default that is not updated after receiving controller values"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1543411659974
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "enabled is now hanled only with props, it should be fixed"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1552059807934
      }
    ]
  },
  {
    "key": "SA-9849",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Since we now moved all test agent build steps to "
            },
            {
              "type": "text",
              "text": "run_teamcity.py",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " inside the test repo, we can start using it for both release and master branches."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "From:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$env:aitorbot = python -c \"import glob;print(list(glob.glob('/users/admin/artifacts/aitorbot*.whl'))[0])\"\npython -m pip install --user --index "
                },
                {
                  "type": "text",
                  "text": "http://akira.ad.cryptzone.com:8082/repository/pypi/simple"
                },
                {
                  "type": "text",
                  "text": " --trusted-host akira.ad.cryptzone.com --no-cache-dir $env:aitorbot\npython -m aitorbot configure\npython -m aitorbot test launch %env.E2E_UUID% --collect-logs\nif (!$lastexitcode -eq 0)\n{\n    echo \"Failed to extract artifacts\"\n    exit 1\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "to:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "python /users/admin/artifacts/run_teamcity.py windows"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1543570508246
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "All test builds for all platforms passes with the new config so moving closing this."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1543574841685
      }
    ]
  },
  {
    "key": "SA-9883",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The first log is wrong, because it can be a build success notification, which it is here."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The teamcity build config is wrong because it succeeds even though the test didn't run"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "And finally, helvetest should complete the test in that case"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Dec 06 11:14:57 helvetest-prod helvetest\\[26035\\]: \\[e9638eeb-0ae3-4391-bf18-4efb8999f039\\] Got test build failed notification, queuing event:: TestBuildStatus(build=Build(id=349652, number=42805, branch\\_name='539580', web\\_url='["
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=349652'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=349652'))"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " success=True, reason='teamcity test build succeeded: ["
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=349652'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=349652'))"
            },
            {
              "type": "text",
              "text": " \\[in logger.info\\]\n\nDec 06 11:14:57 helvetest-prod helvetest\\[26035\\]: 169.254.240.30 \\[06/Dec/2018:10:14:57 +0000\\] \"POST /api/project/7/test-project/build/status HTTP/1.0\" 202 155 \"-\" \"Apache-HttpClient/4.5.4 (Java/1.8.0\\_181)\" \\[in helpers.log\\]\n\nDec 06 11:14:57 helvetest-prod helvetest\\[26035\\]: \\[e9638eeb-0ae3-4391-bf18-4efb8999f039\\] Received event TestBuildStatus(build=Build(id=349652, number=42805, branch\\_name='539580', web\\_url='["
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=349652'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=349652'))"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " success=True, reason='teamcity test build succeeded: ["
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=349652'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=349652'))"
            },
            {
              "type": "text",
              "text": " \\[in logger.info\\]\n\nDec 06 11:14:57 helvetest-prod helvetest\\[26035\\]: \\[e9638eeb-0ae3-4391-bf18-4efb8999f039\\] Staying in state TestsdStateLabel.RUNNING\\_TESTPLAN: Test build succeeded: teamcity test build succeeded: ["
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=349652](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=349652)"
            },
            {
              "type": "text",
              "text": " \\[in logger.info\\]"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=349652&buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&tab=buildLog",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=349652&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&tab=buildLog"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/539580",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://testrail.ad.cryptzone.com/index.php?/plans/view/539580"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544095199819
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "To give some more context, the test build terminated but there were no results in testrail, since the test had not really ran."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1544095490909
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ah I think the fact that it doesn't close the test is intentional because sometimes the TC build success event arrives before the finished test plan notification from testy."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544099417251
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fix for the bad log "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/helvetest/pull/250",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/helvetest/pull/250"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544099508549
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will mark this as won't fix as the teamcity build config should really be returning an error.. well on error."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544104890034
      }
    ]
  },
  {
    "key": "SA-9884",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "So we can't run backward\\"
            },
            {
              "type": "text",
              "text": "compatibility, appliance\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "upgrade from release and client\\"
            },
            {
              "type": "text",
              "text": "upgrade tests",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Or rather it's forcing you to specify the branch when the build number is enough."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544173388166
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I did similar fixes for the aitorbot artifacts command, I need to do it for test create and env create."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544173425678
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/helvetest/pull/254",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/helvetest/pull/254"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/aitorbot/pull/664",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/aitorbot/pull/664"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544791329238
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Creating a master test with a client from release using just the build number: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot --dev-mode test create --client-build-number 13231\nthomas-cellerier [] | 2018-12-14 10:22:11\n\tid:   5c7ec983-31dc-433b-8286-f8381f02c7c9\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/543451"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Creating 2 envs from different branches using just the build number."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "release "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot --dev-mode env create --build-number 12161\nbf776317-a9e8-4fcd-9152-a0eaa7dfa6df\n$ aitorbot --dev-mode env show\nthomas-cellerier [] | 2018-12-14 11:10:28\n\tid:      bf776317-a9e8-4fcd-9152-a0eaa7dfa6df\n\tappliance build from release[#12161] "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=348186&buildTypeId=StratusAppliance_BuildStratusAppliance_2"
                },
                {
                  "type": "text",
                  "text": "\n[...]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " release-4.1 {{CODEBLOCK2}}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1544791801383
      }
    ]
  },
  {
    "key": "SA-9933",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The logConsentrator will be a new role in the appgateSDP. With HA support, So you will be able to have multiple logConsentrators and the other appliances will be able to send their ogs to the consentrator."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The logConsentrator will be able to send logs over tcp/relp or elasticsearch destination."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If one logConsentrator is down, other appliances will connect to another logConsentrator and continue operation."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1544621634016
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "example logd configuration on a logConsentrator (same as for the logserver, but the elasticSearchUrl is different, and may have multiple other destinations)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "collectiveId: 7e04d91e-1fa4-4188-a937-3f39bd11e1e4\n\nelasticSearchUrl: ["
                },
                {
                  "type": "text",
                  "text": "https://search-logdtest-wb67vialcpyptz3mcw6ogsngny.us-east-1.es.amazonaws.com](https://search-logdtest-wb67vialcpyptz3mcw6ogsngny.us-east-1.es.amazonaws.com)"
                },
                {
                  "type": "text",
                  "text": "\n\ngeoIpDbPath: /etc/cz-geoip/GeoLite2-City.mmdb\n\nlogLevel: INFO\n\nlogServer: true\n\nmappingFile: /etc/cz-elasticsearch/mapping.json\n\npersistanceMode: default\n\nrelpClients:\n\n  - format: syslog\n\n    host: 127.0.0.1\n\n    name: rsyslog\n\n    port: 20514\n\ntcpClients:\n\n  - format: json\n\n    host: 192.168.111.162\n\n    name: extLog\n\n    port: 12345\n\nrelpServer:\n\n  bindHost: 127.0.0.1\n\n  bindPort: 9320"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This one is sending logs to elasticsearch/local relp/external tcp"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1544621751051
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "example ffwd configuration on a logConsentrator: (same as for a logserver)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "server:\n\n  allowedDestinations:\n\n    TCP/9301: \\[\\]\n\n    TCP/9320: \\[\\]\n\n    TCP/9350: \\[\\]\n\n  disabledDnChecks:\n\n    - TCP/9320\n\n  listenPath: /run/cz-ffwd/ffwd.socket\n\n  listenPathGroup: cz-ffwd\n\n  listenPathOwner: czd-priv"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1544621825133
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So [Thomas Cellerier]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"thomas.cellerier\") [Per Leino]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"per.leino\") "
                },
                {
                  "type": "text",
                  "text": "Per Svensson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.svensson",
                        "title": "per.svensson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". I think there is the challenge of guiding the admin here to assign sites to all the appliances now. It is likely that they will forget assigning a site to the controllers or the log aggregators themselves. (Which reminds me, you can't assign site to non-gateways today. Will make a task). And when that happens, they will just not receive the audit logs from those appliances and that might also be easy to miss for some time."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1551113431908
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "can we healthcheck that in the controller? And put a warning in the dashboard?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1551175586560
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "show warning on controller when there is one or more log aggregator and appliances without matching sites?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Doable, but can't say I like it. But I can do it if nothing better comes up."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1551175886203
      }
    ]
  },
  {
    "key": "SA-10083",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This way we could provide basic means to use a password vault out of the box."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Some other small things:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "put it in the path"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "add instructions to the readme"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "rename CZ"
                        },
                        {
                          "type": "text",
                          "text": "AUTOSCALE",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "PASSWORD to APPGATE"
                        },
                        {
                          "type": "text",
                          "text": "PASSWORD to match with upgrade and backup scripts",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1547626306615
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Evaluate if this would work for Hashicorp Vault, AWS, Azure, GCP..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1549555789810
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "= Adding the chat history for reference ="
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Harish 2:11 PM\nhi thomas, regarding this "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-10083"
                },
                {
                  "type": "text",
                  "text": "\npassword urls?, do u mean reading the password from a password manager?\nor this one "
                },
                {
                  "type": "text",
                  "text": "https://www.vaultproject.io/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.vaultproject.io/"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\n \nwww.vaultproject.io\nVault by HashiCorp\nVault secures, stores, and tightly controls access to tokens, passwords, certificates, API keys, and other secrets in modern computing. Vault handles leasing, key revocation, key rolling, auditing, and provides secrets as a service through a unified API.\n\n \n\nthomas.cellerier 2:55 PM\nyes for example\nif most of them support using a plain url we should have native supprot\nelse the executable thing supports everything already\n\n\nHarish 3:00 PM\nwell, usually it works like this\n\n\nimport os\nimport hvac\n\nclient = hvac.Client()\nclient = hvac.Client(\n url=os.environ['VAULT_URL'],\n token=os.environ['VAULT_TOKEN']\n)\nclient.write('secret/snakes', type='pythons', lease='1h')\nprint(client.read('secret/snakes'))\n\n\n\n\ni dont know if anyone is using a plain url for passwords.\n\n\nthomas.cellerier 3:12 PM\ni see\nok\nthen executable should be enough\nsince you can run whatever\nyou can put the task as \"Won't fix\"\nit would be good to try one of them using the executable though\nto prove that it works\n\n\nHarish 3:13 PM\nok\n"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "harish.dinne",
        "created": 1553782821804
      }
    ]
  },
  {
    "key": "SA-10094",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so i tried the "
                },
                {
                  "type": "text",
                  "text": "http://nginx.org/en/docs/http/ngx\\_http\\_auth\\_request\\_module.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://nginx.org/en/docs/http/ngx_http_auth_request_module.html."
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". with the following configuration:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "location /performauth {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "proxy\\"
                },
                {
                  "type": "text",
                  "text": "set\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "header Accept \"application/vnd.appgate.peer-v10+json\";"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "proxy\\"
                },
                {
                  "type": "text",
                  "text": "set\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "header Authorization $http\\"
                },
                {
                  "type": "text",
                  "text": "authorization;",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "proxy\\"
                },
                {
                  "type": "text",
                  "text": "pass\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "request\\"
                },
                {
                  "type": "text",
                  "text": "body off;",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "proxy\\"
                },
                {
                  "type": "text",
                  "text": "pass [",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":9130/admin/authorization/kibana]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "9130/admin/authorization/kibana);"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "location /auditlogs {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "auth\\"
                },
                {
                  "type": "text",
                  "text": "request /performauth;",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "proxy\\"
                },
                {
                  "type": "text",
                  "text": "pass [",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":9310]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "9310);"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But.. according to my pcap.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559311438435
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image1559311399069.png]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559311470079
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "no surprise there, since there is not any to to forward.. and there is no way of reading the local-storage through nginx... "
                },
                {
                  "type": "text",
                  "text": "https://stackoverflow.com/questions/47140384/read-local-storage-from-nginx",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://stackoverflow.com/questions/47140384/read-local-storage-from-nginx"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559311875268
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so now i have tried the nginx perl module.. "
                },
                {
                  "type": "text",
                  "text": "http://nginx.org/en/docs/http/ngx\\_http\\_perl\\_module.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://nginx.org/en/docs/http/ngx_http_perl_module.html"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " the problem i see with that one, is that there is no \"access\\"
                },
                {
                  "type": "text",
                  "text": "by\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "perl\" directive, as there is for the lua one..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559548473090
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so i have investigated this some more.. and it appears the there i no problem with the lua module.. the problem is to call \"ngx.location.capture(\" apparently this directive is not compatible with http2. "
                },
                {
                  "type": "text",
                  "text": "https://github.com/openresty/lua-nginx-module/issues/1195",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/openresty/lua-nginx-module/issues/1195"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559556102379
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. the alternative ("
                },
                {
                  "type": "text",
                  "text": "https://github.com/openresty/lua-nginx-module/issues/1285",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/openresty/lua-nginx-module/issues/1285"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") is to use resty.http module"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559556254877
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so instead of doing"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "if authHeader then\n\n    ngx.req.set\\_header(\"Content-type\",\"application/json\")\n\n    ngx.req.set\\_header(\"Accept\",\"application/vnd.appgate.peer-v10+json\")\n\n    ngx.req.set\\_header(\"Authorization\", authHeader)\n\n    location = \"/authorization-service\"\n\n    res = ngx.location.capture(location,{ method = ngx.HTTP\\_GET})\n\n    if res.status == 204 then\n\n        ngx.log(ngx.INFO, \"Accepting kibana query\")\n\n        return\n\n    else\n\n        ngx.log(ngx.WARN, \"Did not get a positive response from controller, result was \" .. tostring(res.status))\n\n    end\n\nelse"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559556315099
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "i first added these 2 files: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/ledgetech/lua-resty-http/tree/master/lib/resty",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/ledgetech/lua-resty-http/tree/master/lib/resty"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " into /etc/nginx/"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and then the following code works:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "if authHeader then\n\n      local http = require \"resty.http\"\n\n      local httpc = http.new()\n\n      local res, err = httpc:request\\_uri(\"["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9130/admin/authorization/kibana](http://127.0.0.1:9130/admin/authorization/kibana)\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " {\n\n            method = \"GET\",\n\n            headers = {\n\n                  \\[\"Authorization\"\\] = authHeader,\n\n                  \\[\"Content-type\"\\] = \"application/json\",\n\n                  \\[\"Accept\"\\] = \"application/vnd.appgate.peer-v10+json\"\n\n            },\n\n            keepalive\\_timeout = 60,\n\n            keepalive\\_pool = 10\n\n      })\n\n      if res then \n\n            if res.status == 204 then\n\n                  ngx.log(ngx.STDERR, \"ACCEPTING 204 from controller\")\n\n                  return\n\n            end\n\n            else\n\n                  ngx.log(ngx.STDERR, \"\" .. err)\n\n            end\n\n      end\n\nend"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559556518845
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So this works.. but it only works if the logserver and the controller is on the same machine.. if they are on different... then it does not.. 1 problem is that then instead of doing a call to localhost, we need to call ["
                },
                {
                  "type": "text",
                  "text": "https://THEIPOFTHECONTROLLER",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://THEIPOFTHECONTROLLER"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":444/some\\_url]("
                },
                {
                  "type": "text",
                  "text": "https://THEIPOFTHECONTROLLER",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://THEIPOFTHECONTROLLER"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "444/some"
                },
                {
                  "type": "text",
                  "text": "url) now the problem with that is that nginx does not do resolving using the system resolver.... so it wil be unable to resolve it... i guess we also need to start generating this file from configd?",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559556730659
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so.. adding all from /etc/resolve.conf to /etc/nginx.conf like:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "http {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "resolver 172.17.93.10;"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and also adding the cert like:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "lua\\"
                },
                {
                  "type": "text",
                  "text": "ssl\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "trusted\\"
                },
                {
                  "type": "text",
                  "text": "certificate /mnt/state/pki/appliance-cert.pem;",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and using:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "local res, err = httpc:request\\"
                },
                {
                  "type": "text",
                  "text": "uri(\"[",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-140-1.devops",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-172-17-140-1.devops"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":444/authorization-service]("
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-140-1.devops",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-172-17-140-1.devops"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "444/authorization-service)\", {"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559557667185
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and using the ca works also ofcource. like : lua\\"
                },
                {
                  "type": "text",
                  "text": "ssl\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "trusted\\"
                },
                {
                  "type": "text",
                  "text": "certificate /mnt/state/pki/ca-cert.pem;",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so... we could then be enable to use this.. if configd generates the auth.lua file.... the resolve thing, must be solve somehow.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559557837937
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so .. a workaround seems to be to enable a new nginx server configuration listening on localhost for http.. and then that can do a proxypass back to the regular one... and then we are back to the previous path.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1559566708576
      }
    ]
  },
  {
    "key": "SA-10152",
    "comments": [],
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "remember\\"
            },
            {
              "type": "text",
              "text": "me test (and tests similar to it) is failing due to this. I'm not sure what exactly is going on but it's most likely related to this PR: ",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com/appgate/stratus-client-shared/pull/3473",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://code.cyxtera.com/appgate/stratus-client-shared/pull/3473"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is terminal while running the remember\\"
            },
            {
              "type": "text",
              "text": "me test. The test does not remove the file until the end. Not the best proof but oh well.",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "ubuntu@ubuntu-VirtualBox:~/.config$ cat appgatesdp-service/user.settings \n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<configuration>\n\n    <appSettings>\n\n        <clear />\n\n        <add key=\"\" />\n\n        <add key=\"userApprovalPref\" value=\"True\" />\n\n        <add key=\"ControllerUrl\" value=\"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-112-1.devops/](https://envy-172-17-112-1.devops/)\""
            },
            {
              "type": "text",
              "text": " />\n\n    </appSettings>\n\n</configuration>ubuntu@ubuntu-VirtualBox:~/.config$ cat appgatesdp-service/user.settings \n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<configuration>\n\n    <appSettings file=\"\">\n\n        <clear />\n\n        <add key=\"\" value=\"\" />\n\n    </appSettings>\n\n</configuration>ubuntu@ubuntu-VirtualBox:~/.config$ cat appgatesdp-service/user.settings \n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<configuration>\n\n    <appSettings>\n\n        <clear />\n\n        <add key=\"\" />\n\n        <add key=\"ControllerUrl\" value=\"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-112-1.devops/](https://envy-172-17-112-1.devops/)\""
            },
            {
              "type": "text",
              "text": " />\n\n    </appSettings>\n\n</configuration>"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-10168",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Telemetry\n---------\nThe .NET Core tools collect usage data in order to help us improve your experience. The data is anonymous and doesn't include command-line arguments. The data is collected by Microsoft and shared with the community. You can opt-out of telemetry by setting the DOTNET_CLI_TELEMETRY_OPTOUT environment variable to '1' or 'true' using your favorite shell.\n\nRead more about .NET Core CLI Tools telemetry: "
            },
            {
              "type": "text",
              "text": "https://aka.ms/dotnet-cli-telemetry"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Also, we switched from having dependencies to downloading even more dependencies. Can we at least put them on akira or figure out a way of not downloading dependencies at every build?"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We have a nuget cache on akira, so the deps get pulled from there already. Or do you mean the ubuntu deps?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1549013484535
      }
    ]
  },
  {
    "key": "SA-10178",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-10179",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-10179"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " front end what will be possible todo. All in all."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "None-logAggregator appliances should be able to have 0-N hostnames of logAggregators that they use."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "LogAggregators should have elasticsearch/tcp/relp destinations."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In case of logAggregators then nginx/ffwd should be modified i much the same way as if the appliance was a logserver."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548673781188
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ref: Controller part: "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-10180",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-10180"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548673891210
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is the configuration needed in logd: "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/blob/master/logd/src/github.ad.cryptzone.com/cryptzone/logd/configuration/configuration.go#L75",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/blob/master/logd/src/github.ad.cryptzone.com/cryptzone/logd/configuration/configuration.go#L75"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548674144387
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here are some sample configurations:"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548676995043
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sample aggregator with 1 relp client"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "collectiveId: bee6d635-c4c9-452a-aaba-11862b4eaf7c\n\ngeoIpDbPath: /etc/cz-geoip/GeoLite2-City.mmdb\n\nlogLevel: INFO\n\nmappingFile: /etc/cz-elasticsearch/mapping.json\n\npersistanceMode: default\n\nrelpClients:\n\n  - format: syslog\n\n    host: 192.168.111.221\n\n    name: \"ext rsyslog\"\n\n    port: 20514\n\n    forwardedLocation: true\n\n  - format: syslog\n\n    host: 127.0.0.1\n\n    name: rsyslog\n\n    port: 20514\n\nrelpServer:\n\n  bindHost: 127.0.0.1\n\n  bindPort: 9320\n\n  idleTimeout: 1h\n\nrole: aggregator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548677022053
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sample aggregator with 1 relp client and 1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "TCP client (also relp to local rsyslog)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "collectiveId: bee6d635-c4c9-452a-aaba-11862b4eaf7c\n\ngeoIpDbPath: /etc/cz-geoip/GeoLite2-City.mmdb\n\nlogLevel: INFO\n\nmappingFile: /etc/cz-elasticsearch/mapping.json\n\npersistanceMode: default\n\nrelpClients:\n\n  - format: syslog\n\n    host: 192.168.111.221\n\n    name: \"ext rsyslog\"\n\n    port: 20514\n\n    forwardedLocation: true\n\n  - format: syslog\n\n    host: 127.0.0.1\n\n    name: rsyslog\n\n    port: 20514\n\ntcpClients:\n\n  - format: json\n\n    host: 192.168.111.222\n\n    name: slunk\n\n    port: 9999\n\nrelpServer:\n\n  bindHost: 127.0.0.1\n\n  bindPort: 9320\n\n  idleTimeout: 1h\n\nrole: aggregator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548677045590
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sample aggregator only Elasticsearch in AWS"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Security group set to accept for the appliance"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ip"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "elasticsearch:\n\n  url: ["
                },
                {
                  "type": "text",
                  "text": "https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com](https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com)"
                },
                {
                  "type": "text",
                  "text": "\n\ncollectiveId: bee6d635-c4c9-452a-aaba-11862b4eaf7c\n\ngeoIpDbPath: /etc/cz-geoip/GeoLite2-City.mmdb\n\nlogLevel: INFO\n\nmappingFile: /etc/cz-elasticsearch/mapping.json\n\npersistanceMode: default\n\nrelpClients:\n\n  - format: syslog\n\n    host: 127.0.0.1\n\n    name: rsyslog\n\n    port: 20514\n\nrelpServer:\n\n  bindHost: 127.0.0.1\n\n  bindPort: 9320\n\n  idleTimeout: 1h\n\nrole: aggregator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548677066299
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sample aggregator only Elasticsearch in AWS"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "With automatic credentials (instance credentials)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "elasticsearch:\n\n  url: ["
                },
                {
                  "type": "text",
                  "text": "https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com](https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com)"
                },
                {
                  "type": "text",
                  "text": "\n\n  useInstanceCredentials: true\n\ncollectiveId: bee6d635-c4c9-452a-aaba-11862b4eaf7c\n\ngeoIpDbPath: /etc/cz-geoip/GeoLite2-City.mmdb\n\nlogLevel: INFO\n\nmappingFile: /etc/cz-elasticsearch/mapping.json\n\npersistanceMode: default\n\nrelpClients:\n\n  - format: syslog\n\n    host: 127.0.0.1\n\n    name: rsyslog\n\n    port: 20514\n\nrelpServer:\n\n  bindHost: 127.0.0.1\n\n  bindPort: 9320\n\n  idleTimeout: 1h\n\nrole: aggregator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548677089394
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sample aggregator only Elasticsearch in AWS"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Using id/secret"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "###############################################"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "elasticsearch:\n\n  url: ["
                },
                {
                  "type": "text",
                  "text": "https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com](https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com)"
                },
                {
                  "type": "text",
                  "text": "\n\n  awsId: AKIBLXV4D56YAIHZEIDQ \n\n  awsSecret: tJtX7y6c+eIBKrIRlf33nfqXH123+wAKeItUdcuW\n\n  awsRegion: us-east-1\n\ncollectiveId: bee6d635-c4c9-452a-aaba-11862b4eaf7c\n\ngeoIpDbPath: /etc/cz-geoip/GeoLite2-City.mmdb\n\nlogLevel: INFO\n\nmappingFile: /etc/cz-elasticsearch/mapping.json\n\npersistanceMode: default\n\nrelpClients:\n\n  - format: syslog\n\n    host: 127.0.0.1\n\n    name: rsyslog\n\n    port: 20514\n\nrelpServer:\n\n  bindHost: 127.0.0.1\n\n  bindPort: 9320\n\n  idleTimeout: 1h\n\nrole: aggregator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548677115180
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                        "title": "per.leino"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " remind me of the 'problem solved' here. Is this a machine which allows the logs to be brought to one point before rsyslog out to some 3rd party?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Can we have more than one?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What sre they configured by - Site, Appliance, Function ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1549888036072
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2672",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2672"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1549889714011
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'll let per answer the question :)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1549889724547
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You can see this is a replacement for the rsyslog solution. If you have a external log-system, using a logAggregator will be a much more convenient way to setup the logging system. A logAggregator you can configure for ONE or SEVERAL sites. And then the appliances will use that as their logging destination. Much in the same way, as if it was a logserver."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The logAggregator can be then configured to have log destination and support:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " TCP (syslog or json format) and plain text or TLS.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " Elasticsearch (plain, or using AWS role, or AWS credentials)",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since its using websockets, you also when configuring ports, only need to allow 444 between the appliances and the logAggregator."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It also solves a special problem that "
                },
                {
                  "type": "text",
                  "text": "Marc Schneider",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/marc.schneider",
                        "title": "marc.schneider"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " had, were in appgate as a service, you want to send the logs within the appgate system.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Its hard a clumbersum to setup a solution (with rsyslog) when in appgate as a service you have gateways on customersite but want to collect the logs of these"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "systems into something we control."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549890055681
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, i think for appgate insight this will be a much more workable solution compare to the rsyslog alternative"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549891002911
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "in AppGate as a service (== hosted controllers), where we do not offer a hosted logging, we want to be able to deliver (safe and guaranteed) all logs into the customers log-sink (SIEM, log etc.) This can be achieved with a a log-aggregator which can is positioned in customer's environment, collects the the controller's logs and forwards them to the customer's log-sink, as a in-band traffic."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "marc.schneider",
        "created": 1549891723783
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If we need to provide hosted logging, we can extend the portfolio: We could offer (==charge for) a hosted logging service with all the fancy features, and it could just scale up as much as we like. This could be a tierd system where frontend, backend and storage is separated (tenant and architecture wise). The logstream (namespace) however needs to plugin, hence we can have log-aggregators as the connector to customer's AppGate (in our environment), and this does not necessary has to be Agaas customers. There might be many more features and services added upon this, such as analytics (brainspace)etc...(basically anything that can be leveraged from logs)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "marc.schneider",
        "created": 1549892292206
      }
    ]
  },
  {
    "key": "SA-10179",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So logAggregator will be a new role in 4.3. The purpose of a logAggregator is to collect logs from other appliances and forwards them to 1 or several destinations."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548669430053
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So...First thing, The dashboard must be able to show logAggregator somehow. It will not be possible to use a logServer and a logAggregator at the same time."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548669542367
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So something here.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548669635485
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It should also be possible to create a logAggregator in the appliances/create."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So here it will be possible to combine the logAggregator with a Controller or Gateway. If the system has a logServer, then it should not be possible to create a logAggregator. And you can ofcource not combine a logserver with a logAggregator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548669839576
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In case a LogAggregator is created, Then it should be possible to add forwarding destinations. They can currently be :"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Elasticsearch. (0 or 1)"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "In case of elasticsearch it should be possible to configure a URL to elasticsearch. It could look something like: ("
                        },
                        {
                          "type": "text",
                          "text": "https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com"
                              }
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ")."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "There a currently 3 different ways todo authentication towards elasticsearch. And they can not be combined:"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "UseInstanceCredentials (If the appliance is in AWS it can do auto authentication to elasticsearch, if this has been enabled."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Supply AwsSecret, AwsId or AwsToken and AwsRegion"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "This is if the appliance is outside aws but should authenticate towards aws."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "No authentication. (If for example a allow IP is used in AWS then this mode can be used)."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "TCP clients (0 to many)."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "In case of TCP it should be possible to choose a hostname or ip + a port to connect to."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "It should also be possible to choose the format. Json or syslog."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "It would also make sence to be able to set a name on the destination, then we can use that name to relate to the connection, in case the connection does not work.."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "There should also be possible to choose authentication."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "No authentication."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "TLS"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "TLS with a clientCert, clientKey + CACert"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Relp Clients (0 to many)"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "This should have the same options as the TCP clients."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548670431814
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I guess the same options should be available in the \"Editing Appliance - General\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548670521074
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If there is a LogAggregator in the system. It should be possible for \"none-logAggreators\" appliances to choose witch LogAggregator/s to use. (the system could be distributed with appliances in AWS/azure/vsphere) and in many situations you probably want to specify what logAggreators a appliance should use."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I suggest that by default there should be a list with all of the logAggreators in the system. And that is should be possible to remove one of several of them. (and also add)."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If a new logAggreator is added to the system, it should automaticly be added to the list (if not the list has been modified, in that case the list should stay as it was)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548670804796
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, the following is what I gathered so far."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When you specify a Log Aggregator you are required to chose one or many sites to which the aggregator applies. By doing so that aggregator will become the default logging service for any appliance belonging to that site. So if setting up an aggregator in AWS and connecting it to the AWS site all appliances in AWS will log its data locally to that aggregator."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A Log Aggregator can use Elasticsearch, TCP clients or Relp clients to connect to an external log server. The configuration for these alternatives are given when a user choses to add one or many in their respective lists. Note that at the moment only one Elasticsearch entry can be made, so that list can only contain one entry for now. It's being implemented as a list from the start for consistency."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There can be only one LogServer OR one/many Log Aggregators in the same system. The UI logic for this is handled at the point of saving the form so it will not be possible to add a Log Aggregator when there is already a LogServer present."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.svensson",
        "created": 1549440333516
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nice =)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549441437494
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I need two confirmations:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Can you apply multiple sites to one LogAggregator?"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Can you have a system with one LogServer and multiple LogAggregators (on different appliances)? Or is it one or the other?"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549442828858
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Can you apply multiple sites to one LogAggregator? > YES"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Can you have a system with one LogServer and multiple LogAggregators > NO. You eigher have logserver or logAggregators"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549450397661
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Can you apply multiple sites to one LogAggregator? > YES"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok, then it needs to be a new field for LogAggregator as the regular site assignment is singular. And we can't change that to a list as that would be confusing for the gateway."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549457693678
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, we will skip the Relp client alternative for now. Here is a new mockup without it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.svensson",
        "created": 1549631380090
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "splendid"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549636518353
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "elastic search is a list there. I think we support only one though, right "
                },
                {
                  "type": "text",
                  "text": "Per Leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                        "title": "per.leino"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549636850107
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes only one.. but this is a special case.. its a list that only allowes one value. Its to make it look more optional then mandatory"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549637063543
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ah ok."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549637153900
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In the LogAggregator section, there should be a section for a Site list that the aggregator applies to."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549889774952
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is the latest version with the option to turn on log retention for Elasticsearch and chose a custom retention period."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.svensson",
        "created": 1549982246079
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "still needs a \"Sites\" list"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549985393765
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think it is the first of the 3 lists under Log Aggregator, "
                },
                {
                  "type": "text",
                  "text": "Sites to log",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1549985559466
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "oh sorry. That's me being blind :D. I assumed it was \"elasticsearch\", \"tcp clients\" and \"relp clients\". But relp clients is not there, and I guess that's intentional."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549985676812
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes. I was trying out relp/TLS.. And there are some problems. The idea was so only in this first case support certificates that exist in the system CA-store... This works well for TCP, but relp does not support it.. So you actually need to specify a client-key + client-cert.. So.. i tried to add the appliance-key + appliance-cert + system-CA ... But that did not work, because a bug in rsyslog (i used that as a server, and if any customer want to do relp, then most likely it will be rsyslog as server). So, since i could not prove a working system with ubuntu 18.04 as a server... i decided to not include relp as a option for now... (it how ever works if you generate your own key/cert ... but then we would need to support that in the UI.... maybe next version)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550044928775
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe I should remove it from the controller too then.. Or at least from the API documentation."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1550045783539
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yep.. true"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550045840096
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Will appliance be OK not seeing the "
                },
                {
                  "type": "text",
                  "text": "relpClients",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " in the configuration?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1550045982827
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think so.. It was optional<> right now right? So you java does not include it, if its not there?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550047149087
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "No, it's a list. We always send empty list in that case."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1550047357958
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ah, yes now i remember, you have a thing against optional lists =) Anyway.. just remove it. if it does not work, we fix it"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550048269489
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Posting an example of the expected json here to not loose it "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  \"logAggregator\": {\n    \"enabled\": true,\n    \"sites\": [\"siteId123\"],\n    \"elasticsearch\": {\n      \"url\": \""
                },
                {
                  "type": "text",
                  "text": "https://aws.com/elasticsearch/instance/asdaxllkmda64\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n      \"awsId\": \"abcdefg\",\n      \"awsSecret\": \"bcvjsdjksad86121244,11242\",\n      \"awsRegion\": \"us-east-1a\",\n      \"useInstanceCredentials\": false,\n      \"retentionDays\": 5\n    },\n    \"tcpClients\": [{\n      \"name\": \"splunk\",\n      \"host\": \"192.168.0.1\",\n      \"port\": 12345,\n      \"format\": \"json\",\n      \"useTLS\": true\n    }]\n  },"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Note elasticsearch is not an array, so we need to limit the list to 1 entity in the frontend"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1550133727507
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "it's missing "
                },
                {
                  "type": "text",
                  "text": "logAggregator.enabled",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and "
                },
                {
                  "type": "text",
                  "text": "logAggregator.sites",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1550133905901
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thanks :) I updated the json"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1550134191446
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In case you missed it, \"awsSecret\" is a password."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1550140360690
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-frontend/pull/2319",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-frontend/pull/2319"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1550498157822
      }
    ]
  },
  {
    "key": "SA-10180",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Make installer have one flag with URL instead of all individual parts. Makes much more sense and we can streamline the URL to be the only param instead of 100 different ones :D"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-10178",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-10178"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The fronend configuration shall be forwarded to configd."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1548673839975
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[Per Leino]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"per.leino\") "
                },
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " could you summarize the stuff here with JSON example?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549287626138
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n\n\"logAggregator\": {\n\n\"elasticsearch\": {\n\n\"url\": \"["
                },
                {
                  "type": "text",
                  "text": "https://aws.com/elasticsearch/instance/asdaxllkmda64](https://aws.com/elasticsearch/instance/asdaxllkmda64)\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\n\"awsId\": \"abcdefg\",\n\n\"awsSecret\": \"bcvjsdjksad86121244,11242\",\n\n\"awsRegion\": \"us-east-1a\",\n\n\"useInstanceCredentials\": false\n\n},\n\n\"tcpClients\": \\[{\n\n\"name\": \"splunk\",\n\n\"host\": \"192.168.0.1\",\n\n\"port\": 12345,\n\n\"format\": \"json\",\n\n\"useTLS\": true\n\n}\\],\n\n\"relpClients\": \\[{\n\n\"name\": \"external rsyslog\",\n\n\"host\": \"192.168.0.1\",\n\n\"port\": 20415,\n\n\"format\": \"syslog\",\n\n\"useTLS\": false\n\n}\\]\n\n}\n\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549288389569
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "at least one has to be defined, or?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549288499992
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes.. that would make sense =)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549288655562
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "is there no \"enabled\" field? I think for consistency with other roles, there should be an \"enabled\" field."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549555601168
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "also, what are the options for "
                },
                {
                  "type": "text",
                  "text": "format",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "? I'll make it enum."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549556551071
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "elasticsearch:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "if "
                },
                {
                  "type": "text",
                  "text": "useInstanceCredentials",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is true, is awsSecret still required?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549556689973
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, I guess I'd need to assign "
                },
                {
                  "type": "text",
                  "text": "sites",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to logAggregator, but of course will not send it to the appliance. Does that sound right?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549557026074
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "format : syslog or json"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549615412294
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "if you use useInstanceCredentials, then you only need to specify the URL, and nothing else."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549615441942
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If you specify awsKey + awsSecret + region , goes hand in hand"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549615476005
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"Also, I guess I'd need to assign sites to logAggregator, but of course will not send it to the appliance. Does that sound right?\" I dont know how strikt it needs to be.. its only supposed to be convenient for the admin. So that the appliances in the sites get the logAggregator configured"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549616247194
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549617979956
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I came to think of something.. suppose a appliance is a logAggregator... then it should not use other logAggregators ofcource.. that would just be strange"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549622095639
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so if it's a log aggregator itself, it shouldn't have peer.logServers?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549622344429
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, it should not use it to anything since we dont do logAggregator to logAggregator..... but should configd or controller do the filtration"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549623113103
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "you could leet configd make that filtration actually... maybe we need that info for something else in the future"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1549623154403
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, I'd like that :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549623328870
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Updated exemple:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n\n    \"logAggregator\": {\n\n        \"elasticsearch\": {\n\n            \"url\": \"["
                },
                {
                  "type": "text",
                  "text": "https://aws.com/elasticsearch/instance/asdaxllkmda64](https://aws.com/elasticsearch/instance/asdaxllkmda64)\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\n            \"awsId\": \"abcdefg\",\n\n            \"awsSecret\": \"bcvjsdjksad86121244,11242\",\n\n            \"awsRegion\": \"us-east-1a\",\n\n            \"useInstanceCredentials\": false,\n\n            \"retentionDays\": 5\n\n        },\n\n        \"tcpClients\": \\[{\n\n            \"name\": \"splunk\",\n\n            \"host\": \"192.168.0.1\",\n\n            \"port\": 12345,\n\n            \"format\": \"json\",\n\n            \"useTLS\": true\n\n        }\\]\n\n    }\n\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550067712066
      }
    ]
  },
  {
    "key": "SA-10187",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Turns out we are building named with 2 cached wheels that no longer exist on pypy."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Collecting vapi-client-bindings==2.7.0 (from -r requirements.txt (line 60))\n  Downloading "
            },
            {
              "type": "text",
              "text": "https://akira.ad.cryptzone.com:8443/repository/pypi/packages/vapi-client-bindings/2.7.0/vapi_client_bindings-2.7.0-py2.py3-none-any.whl"
            },
            {
              "type": "text",
              "text": " (268kB)\n    100% |################################| 276kB 22.5MB/s \nCollecting vapi-runtime==2.7.0 (from -r requirements.txt (line 61))\n  Downloading "
            },
            {
              "type": "text",
              "text": "https://akira.ad.cryptzone.com:8443/repository/pypi/packages/vapi-runtime/2.7.0/vapi_runtime-2.7.0-py2.py3-none-any.whl"
            },
            {
              "type": "text",
              "text": " (269kB)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The highest version there is 2.5.0."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It was manually added to the internal cache but had never been published."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I made the contrib repo generate two .deb files from them "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-contrib/pull/288",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-contrib/pull/288"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In a far future that work might be removed because "
                },
                {
                  "type": "text",
                  "text": "pypi2deb",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " has future plans of doing this automatically. However for the moment that is it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1548834330628
      }
    ]
  },
  {
    "key": "SA-10247",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "make debian",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Causes this."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "wget "
            },
            {
              "type": "text",
              "text": "https://akira.ad.cryptzone.com:8443/repository/root/client_chroot/debian_v4.tar"
            },
            {
              "type": "text",
              "text": "\n--2019-02-06 12:07:38--  "
            },
            {
              "type": "text",
              "text": "https://akira.ad.cryptzone.com:8443/repository/root/client_chroot/debian_v4.tar"
            },
            {
              "type": "text",
              "text": "\nRisoluzione di akira.ad.cryptzone.com (akira.ad.cryptzone.com)... 172.17.40.36\nConnessione a akira.ad.cryptzone.com (akira.ad.cryptzone.com)|172.17.40.36|:8443... connesso.\nRichiesta HTTP inviata, in attesa di risposta... 404 client_chroot/debian_v4.tar\n2019-02-06 12:07:38 ERRORE 404: client_chroot/debian_v4.tar."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, it seems that debian"
                },
                {
                  "type": "text",
                  "text": "v3.tar is actually an ubuntu image just named ",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "debian",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". -"
                },
                {
                  "type": "text",
                  "text": "-'",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1549451671273
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Set it \"No Fix versions\" as it's not a product issue. Feel free to move it to the current sprint if you want to fix it. Though it might be a good idea to migrate to docker."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1551952451889
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm sticking to a 4.2 build that still works for the time being."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1551953997554
      }
    ]
  },
  {
    "key": "SA-10265",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Make installer have one flag with URL instead of all individual parts. Makes much more sense and we can streamline the URL to be the only param instead of 100 different ones :D"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Don't delete the old parameters right away though. We need to deprecate them slowly. We can remove it from the help directly but still accept them, or mark them as \"Deprecated\" in help."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jamie Bodley-Scott",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/jamie.bodley-scott",
                        "title": "jamie.bodley-scott"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " how do you think we should do this?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549618137131
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Please explain or give examples."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1549888335133
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "here is the current installer help"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "USAGE:\n\n   AppGate Installer \\[/H | /?\\] | \\[OPTION\\]...\n\n   Options: (required)\n\n   (required) means the option only works in combination with the required option specifid within parentheses.\n\n   If no required option is specified the option will work with any combination of flags.\n\n      /S                    Run silent installer (no gui).\n\n      /A                    Make silent installer start client when installation is completed. (/S)\n\n      /W                    Set autostart for all users (not just current).\n\n      /Q                    Skip adding client to autostart.\n\n      /R                    Set \"Keep me signed in\" option to be on by default.\n\n      /M                    Install client as a multi-user client.\n\n      /E                    Install client as a headless system service.\n\n                            OPTIONAL PARAMS: /U=\\[url\\] /P=\\[provider\\] /C=\\[certificate path\\]\n\n                            EXAMPLE: /E /U=\"["
                },
                {
                  "type": "text",
                  "text": "https://url.com](https://url.com)\""
                },
                {
                  "type": "text",
                  "text": " /P=local /C=\"C:\\\\certs\\\\trustedCert.pem\"\n\n      /L                    Install client as a PLAP service.\n\n                            OPTIONAL PARAMS: /U=\\[url\\] /P=\\[provider\\] /C=\\[certificate path\\]\n\n                            EXAMPLE: /L /U=\"["
                },
                {
                  "type": "text",
                  "text": "https://url.com](https://url.com)\""
                },
                {
                  "type": "text",
                  "text": " /P=local /C=\"C:\\\\certs\\\\trustedCert.pem\"\n\n      /G                    Do not show privacy notice the first time the client starts\n\n      /N                    Disable user access checks (only when run as normal client)\n\n      /U=\\[url\\]              Set a controller \\[url\\] that will be used for all fresh installation of the client.\n\n                            Quote the url to make sure it will be correctly parsed.\n\n                            EXAMPLE: /U=\"["
                },
                {
                  "type": "text",
                  "text": "https://url.com](https://url.com)\""
                },
                {
                  "type": "text",
                  "text": "\n\n      /P=\\[provider\\]         Set a \\[provider\\] that will be automatically chosen if found in client.\n\n                            EXAMPLE: /P=local\n\n      /C=\\[certificate path\\] Set absolute path to trusted certificate. (only available for Headless and PLAP installations)\n\n                            EXAMPLE: /C=C:\\\\certs\\\\trustedCert.pem\n\n   NOTE: Parameter value should be contained within quotes e.g. /P=\"value\".\n\n   When using PowerShell the parameter value must be contained within a single and double quote e.g. /P='\"value\"'."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " on 4.3, the controller URL will have spa, certificate and the identity provider included. That makes "
                },
                {
                  "type": "text",
                  "text": "/P=[provider]",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and to some extent "
                },
                {
                  "type": "text",
                  "text": "/C=[certificate path]",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " redundant. If you use them both, which should take precedence for example?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In order to avoid the confusion and also to make this massive help smaller, we want to remove those redundant parameters. But we can't just remove them as there may be scripts depending on them. So my question to you is how we should do this."
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  One way is to remove them from help but still actually accept the parameters; and somehow inform the admins that they will be eventually removed."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Another is to put "
                        },
                        {
                          "type": "text",
                          "text": "[DEPRECATED]",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " next to them and explain what the alternative is and remove them eventually after a few releases."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1549888996960
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I favour splitting into 2 sections 'options' and 'old options'. In the latter help we start with a sentence \"These options will be deprecate in a future release.\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1549969675715
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I like the "
                },
                {
                  "type": "text",
                  "text": "[DEPRECATED]",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " sign and having the installer display a warning in the logs and maybe a popup (if not silent) that they are using deprecated flags."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1550133126161
      }
    ]
  },
  {
    "key": "SA-10324",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so... In case logd is configured for instance credentials.. and the instance for example is not setup correctly.. Then the status changes to something like:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Unable to request health from elasticsearch: Get ["
                },
                {
                  "type": "text",
                  "text": "https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com/\\_cluster/health](https://search-testerdomain-xvz4krnfhofrtpg3e24kjkqndi.us-east-1.es.amazonaws.com/_cluster/health)"
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": " EC2RoleRequestError: no EC2 instance role found\n\ncaused by: EC2MetadataError: failed to make EC2Metadata request\n\ncaused by: <?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\n          \"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd](http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n <html xmlns=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)\""
                },
                {
                  "type": "text",
                  "text": " xml:lang=\"en\" lang=\"en\">\n\n <head>\n\n   <title>404 - Not Found</title>\n\n  </head>\n\n  <body>\n\n   <h1>404 - Not Found</h1>\n\n  </body>\n\n </html>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550141426964
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is ofcourse correct.. but way to detailed to show in the ui.. so it would be better if it showed."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"no EC2 instance role found\" for example"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1550141477603
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2702",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2702"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1551175944968
      }
    ]
  },
  {
    "key": "SA-10417",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Seems that we have 3 disks in every appliance we create in environments. This third disk seems not be used at all and it's 30G size."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Raising the prio since we are constantly running out of disk space."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1551093076927
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The template only contains 2 disks so probably envy assumes only one disks and creates a new one. I will delete the extra disk from the template and see if it's fixed."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1551096582063
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed and tested."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "atuin  haskell.cyxtera.com  ~  aitorbot --dev-mode env show                                                                                                                                                                                                          00\naitor-iturri [] | 2019-02-25 12:29:55\n        id:      5d6c91f3-6684-4165-ae97-d4249971c53c\n        appliance build from master[#13061] "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=369912&buildTypeId=StratusAppliance_BuildStratusAppliance_2"
                },
                {
                  "type": "text",
                  "text": "\n        scenario: simple_v4\n        keep on error: False\n        nodes:\n                controller\n                        roles:   controller, logserver\n                        web ui:  "
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-102-1.devops:444"
                },
                {
                  "type": "text",
                  "text": "\n                        connect: appgate://envy-172-17-102-1.devops\n                        status:  Running\n                        ip:      172.17.102.1\n                        network: 172.17.102.0/24\n                        hostname: envy-172-17-102-1.devops\n                        admin username: admin\n                        admin password: admin\n                gateway\n                        roles:   gateway\n                        status:  Post Provisioning\n                        ip:      172.17.102.2\n                        network: 172.17.102.0/24\n                        hostname: envy-172-17-102-2.devops\n                endpoint\n                        roles:   endpoint\n                        status:  Running\n                        ip:      172.17.103.2\n                        network: 172.17.103.0/24\n                        hostname: envy-172-17-103-2.devops"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1551098688811
      }
    ]
  },
  {
    "key": "SA-10441",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Available to the controller."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "There should be 2 modes: with resolver configuration, with current configuration."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "With current configuraiton is equivalent to the existing "
            },
            {
              "type": "text",
              "text": "cz-names resolve",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " command, but accessible remotely."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "With resolver configuration should allow testing new resolver configurations, we should also report any errors we encounter when resolving instead of just returning an empty resolution like when operating normally."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The API looks like this:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The endpoint is "
                },
                {
                  "type": "text",
                  "text": "[POST] /resolver/names",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and it gets a json data as this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n      'names': ['name1', 'name2'],\n      'partial': false\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "where names is a a list of names to be resolved and partial is a boolean"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The response is a json document:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n     'results': {},\n     'errors': {},\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "where results contains the list of resolutions and errors the list of errors"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-10441",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-10441"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-112-2:~# curl -H \"Content-Type: application/json\" -XPOST -d '{\"names\": [\"dns://www.google.com\"]}' --unix-socket /run/cz-configd/configd.socket "
                },
                {
                  "type": "text",
                  "text": "http://localhost/resolver/names"
                },
                {
                  "type": "text",
                  "text": "\n{\"errors\":{},\"results\":{\"dns://www.google.com\":[\"172.217.20.36\",\"2a00:1450:400f:808::2004\"]}}\nroot@envy-172-17-112-2:~# curl -H \"Content-Type: application/json\" -XPOST -d '{\"names\": [\"dns://www.google.com\"]}' --unix-socket /run/cz-configd/configd.socket "
                },
                {
                  "type": "text",
                  "text": "http://localhost/resolver/names|jq"
                },
                {
                  "type": "text",
                  "text": " .\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   129  100    94  100    35  18800   7000 --:--:-- --:--:-- --:--:-- 25800\n{\n  \"errors\": {},\n  \"results\": {\n    \"dns://www.google.com\": [\n      \"172.217.20.36\",\n      \"2a00:1450:400f:808::2004\"\n    ]\n  }\n}"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-112-2:~# curl -H \"Content-Type: application/json\" -XPOST -d '{\"names\": [\"dns://www.google.com\"]}' --unix-socket /run/cz-configd/configd.socket "
                },
                {
                  "type": "text",
                  "text": "http://localhost/resolver/names|jq"
                },
                {
                  "type": "text",
                  "text": " .\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   195  100   160  100    35  12307   2692 --:--:-- --:--:-- --:--:-- 15000\n{\n  \"errors\": {\n    \"dns://www.google.com\": \"DNS name resolution error for ipv4, pycares errno 11: Could not contact DNS servers\"\n  },\n  \"results\": {\n    \"dns://www.google.com\": []\n  }\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1560169960996
      }
    ]
  },
  {
    "key": "SA-10446",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When envy fails to create an environment and it has no logs helevetest still report the logs into testrail even if they were never uploaded into nexus"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Feb 27 10:06:33 helvetest-prod helvetest[58]: [939be107-648d-4319-94ec-0f9e3de6d874] [ActionRunner] Unhandled error while running action DownloadUploadEnvyLogs(execution_id='939be107-648d-4319-94ec-0f9e3de6d874', env_id='939be107-648d-4319-94ec-0f9e3de6d874', envy=Envy(ur\nFeb 27 10:06:33 helvetest-prod helvetest[58]: Traceback (most recent call last):\nFeb 27 10:06:33 helvetest-prod helvetest[58]:   File \"/usr/lib/python3/dist-packages/themachine/action_runner.py\", line 116, in arun\nFeb 27 10:06:33 helvetest-prod helvetest[58]:     action_result = await action.arun()\nFeb 27 10:06:33 helvetest-prod helvetest[58]:   File \"/usr/share/helvetest/helvetest/services/testsd/actions.py\", line 344, in arun\nFeb 27 10:06:33 helvetest-prod helvetest[58]:     remote_path=[test_data_config.directory, self.env_id, envy_log.name])\nFeb 27 10:06:33 helvetest-prod helvetest[58]:   File \"/usr/share/helvetest/clients/nexus.py\", line 33, in upload_file\nFeb 27 10:06:33 helvetest-prod helvetest[58]:     with open(file, 'rb') as f:\nFeb 27 10:06:33 helvetest-prod helvetest[58]: FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpngjvyo1x'"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "atuin  haskell.cyxtera.com  ~  curl "
            },
            {
              "type": "text",
              "text": "https://envy.devops/envy/logs/939be107-648d-4319-94ec-0f9e3de6d874"
            },
            {
              "type": "text",
              "text": " -k                                                                                                                                                           600\n{\n  \"Error\": \"Resource not found\"\n}%"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think this should be fixed with this PR "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/helvetest/pull/275",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/helvetest/pull/275"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So i will mark it as fixed and if it appears again i will reopen."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1570699307302
      }
    ]
  },
  {
    "key": "SA-10447",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[15:17:37]\n[Step 1/1] Scanning copyright file for \"cz-elasticsearch\"\n[15:17:37]\n[Step 1/1]   File \"/tmp/license_collector\", line 98, in generate_report\n[15:17:37]\n[Step 1/1] License field is missing in block\n[15:17:37]\n[Step 1/1]     raise KeyError('License')\n[15:17:37]\n[Step 1/1] {'Licese': Value(short='Apache License 2.0', long=None), 'Sources': Value(short='"
            },
            {
              "type": "text",
              "text": "https://github.com/apache/commons-codec'"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " long=None), 'Files': Value(short='/usr/cz-elasticsearch/modules/reindex/commons-codec-1.10.jar', long=None)}\n[15:17:37]\n[Step 1/1] KeyError: 'License'"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-logging/pull/257",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-logging/pull/257"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1551279827171
      }
    ]
  },
  {
    "key": "SA-10538",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We could unify appgate-upgrade, appgate-backup and appgate-autoscale under a single appgate-admin command. A lot of the code is already shared or copy/pasted today. This could even based on a single appgate SDK module which we could use in tests. Since this is already the case today it can continue to have 0 dependencies other than python3.5+."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Examples for existing commands: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "python3 appgate-admin.pyz install controller "
            },
            {
              "type": "text",
              "text": "https://some/url"
            },
            {
              "type": "text",
              "text": "  # replaces appgate-upgrade\npython3 appgate-admin.pyz backup some-controller # replaces appgate-backup\npython3 appgate-admin.pyz seed controller site ... # replaces appgate-autoscale"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "New possibilties: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "python3 appgate-admin.pyz status controller # Get appliances status\npython3 appgate-admin.pyz customization install controller somedir someappliance # Manage customizations\netc..."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://docs.python.org/3/library/zipapp.html#creating-standalone-applications-with-zipapp",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.python.org/3/library/zipapp.html#creating-standalone-applications-with-zipapp"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1554292895950
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/appgate-sdk",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/appgate-sdk"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1554292911815
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well the autoscale is going away? And the backup one maybe better done with some slight API enhancements. So we are back to one script!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1625498929426
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Let's not go down this route while the 3 areas are all in flux!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1625559723163
      }
    ]
  },
  {
    "key": "SA-10560",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Since GetCloudDataAction is supposed to forward the state machine to the next state this makes configd fail completely to initialize!"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Mar 14 23:41:52.607151 controller1.sdpdemo.com cz-configd[729]: WARNING [cloud-aws] Got userdata but it is not in json format, using it as rc_script\nMar 14 23:41:52.610626 controller1.sdpdemo.com cz-configd[729]: ERROR [ActionsRunner] Unhandled error while running action GetCloudDataAction(next_state='multi_controller_ready', cloud_service=AwsCloudService(cloud_init_url='"
            },
            {
              "type": "text",
              "text": "http://169.254.169.254'"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " name='EC2', has_userdata=True)), carry on...\n                                                                Traceback (most recent call last):\n                                                                  File \"/usr/lib/python3.5/base64.py\", line 37, in _bytes_from_decode_data\n                                                                    return s.encode('ascii')\n                                                                UnicodeEncodeError: 'ascii' codec can't encode character '\\xa0' in position 237: ordinal not in range(128)\n\n                                                                During handling of the above exception, another exception occurred:\n\n                                                                Traceback (most recent call last):\n                                                                  File \"/usr/cz-configd/configd/action/actions_runner.py\", line 155, in run\n                                                                    action_result = action()\n                                                                  File \"/usr/cz-configd/configd/cloud/actions.py\", line 137, in __call__\n                                                                    script = base64.b64decode(cloud_startup_script).decode()\n                                                                  File \"/usr/lib/python3.5/base64.py\", line 81, in b64decode\n                                                                    s = _bytes_from_decode_data(s)\n                                                                  File \"/usr/lib/python3.5/base64.py\", line 39, in _bytes_from_decode_data\n                                                                    raise ValueError('string argument should contain only ASCII characters')\n                                                                ValueError: string argument should contain only ASCII characters\nMar 14 23:41:52.610810 controller1.sdpdemo.com cz-configd[729]: INFO [ActionsRunner] Running action FinishCloudServiceAction(cloud_service=AwsCloudService(cloud_init_url='"
            },
            {
              "type": "text",
              "text": "http://169.254.169.254'"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " name='EC2', has_userdata=True)) ..."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "as "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "harish.dinne",
                    "text": "@harish.dinne",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " mentioned in #sdp-support we are not catching UnicodeEncodeError here "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/blob/release/configd/configd/cloud/actions.py#L137",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/blob/release/configd/configd/cloud/actions.py#L137"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1552657714914
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We want a fix to release and master for this. I think for release it's enough to catch the missing exception. For master, we should make sure that GetCloudDataAction always eventually advances to the next state."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1552895743243
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "PR to release: "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2783",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2783"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "i'll create another pr to master."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "harish.dinne",
        "created": 1552896667535
      }
    ]
  },
  {
    "key": "SA-10592",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[Step 1/1] Get:8 "
            },
            {
              "type": "text",
              "text": "http://security.ubuntu.com/ubuntu"
            },
            {
              "type": "text",
              "text": " bionic-security/restricted i386 Packages [4,280 B]"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "it seems that the test agents have i386 arch enabled disable it."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Meh, I don't care. Slight waste of time at every run"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1610717037712
      }
    ]
  },
  {
    "key": "SA-10613",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. I talked with jim.anthony, and he was having problems with the tilemaps in kibana. The maps are downloaded by kibana when you are showing a map."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "By default right now is that kibana uses a free service elastic is using.. But its possible to use others."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The default one was not downloading for jim fast enough. so what he did was to register for another service. and then change the configuration in kibana /etc/cz-kibana/config.yaml"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "from :"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "tilemap.url: ["
                },
                {
                  "type": "text",
                  "text": "https://tiles.elastic.co/v2/default/{z}/{x}/{y}.png](https://tiles.elastic.co/v2/default/{z}/{x}/{y}.png)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "to:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "tilemap.url: ["
                },
                {
                  "type": "text",
                  "text": "https://maps.tilehosting.com/styles/hybrid/{z}/{x}/{y}@2x.jpg?key=qRoXByrAkGZuUgVjSb62](https://maps.tilehosting.com/styles/hybrid/{z}/{x}/{y}@2x.jpg?key=qRoXByrAkGZuUgVjSb62)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. it would be good to be able to set the custom tilemap through the logserver configuration in the UI."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So this would require frontend-work, controller-work and configd work. But probably quite minor work in all of them."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1553153962765
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since we now adays are unable to use maps in kibana,.. then i guess this is not going to happen"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1641892223914
      }
    ]
  },
  {
    "key": "SA-10622",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Mar 21 14:08:00 purple10.cryptzone.com rsyslogd[1498]: could not load module '/usr/lib/x86_64-linux-gnu/rsyslog/lmnsd_gtls.so', dlopen: /usr/lib/x86_64-linux-gnu/rsyslog/lmnsd_gtls.so: cannot open shared object file: No such file or directory  [v8.32.0 try "
            },
            {
              "type": "text",
              "text": "http://www.rsyslog.com/e/2066"
            },
            {
              "type": "text",
              "text": " ]"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2802",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/2802"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1553244604838
      }
    ]
  },
  {
    "key": "SA-11122",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2) After the first of the above gateways failed to upgrade and the upgrade script timed out I attempted to rerun the upgrade script to continue upgrading the rest of our appliances. While re-running the upgrade I got the following error:\nfraa@UK-T-0026:~$ python3 appgate-upgrade.pyz complete --log-level info --cacert AppGate_SDP_agcb1.tessella.co.uk_CA.cer agcb1.tessella.com\n12:37:33 Discovering peer API version for "
            },
            {
              "type": "text",
              "text": "https://agcb1.tessella.com:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n12:37:33 Peer API version is 9\nEnter password for username admin and provider name local:\n12:37:39 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://agcb1.tessella.com:444"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n12:37:39 Authentication succeeded\n12:37:39 Authorizing...\n12:37:54 7 appliances are not in the expected upgrade status ready: AGCA1, AGCB1, AGGWA1, AGGWAWS1, AGGWB1, AGGWBO1, AGLSB1\n12:37:54 They will be excluded from the upgrade!\n12:37:54\n12:37:54 Upgrade plan:\n12:37:54 1. Install prepared upgrade on gateways: AGGWB2, AGGWDH1\n12:37:54 2. Install prepared upgrade on gateway: AGGWA2\n12:37:54 Appliances will be upgraded to version 4.2.3\n12:37:54\nDo you want to continue [y/N]? y\n12:38:01 1. Install prepared upgrade on gateways: AGGWB2, AGGWDH1\n12:38:14 Upgrade status for AGGWDH1 changed to installing: AppGate-SDP-4.2.3.img.zip\n12:38:14 Upgrade status for AGGWB2 changed to installing: AppGate-SDP-4.2.3.img.zip\n12:39:30 Upgrade status for AGGWDH1 reached expected value success: a reboot is required for the upgrade to go into effect\n12:40:03 Upgrade status for AGGWB2 reached expected value success: a reboot is required for the upgrade to go into effect\n12:40:23 Upgrade failed: (SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:645)'),)\n\nThe upgrade was applied successfully on AGGWB2. \nAGGWDH1 was left awaiting a reboot. (This is the second gateway from point 1 that failed to boot.)\n\nApart from the error encountered, could the script more gracefully handle failures? Specifically, if appliances are to be upgraded in parallel the script should try to ensure that interruptions to one server's upgrade don't affect another servers upgrade in progress."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think what happened here is actually that the controller was still busy upgrading when the script was restarted. I will add a more detailed status in this: 12{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "37}}54 7 appliances are not in the expected upgrade status ready: AGCA1, AGCB1, AGGWA1, AGGWAWS1, AGGWB1, AGGWBO1, AGLSB1"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1558011140951
      }
    ]
  },
  {
    "key": "SA-11301",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This was useful when transitioning from the old jsonrpc code to the state machine, it's now just an overcomplex additional layer."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Alright so the url access module now has its structures to be able to do the filtering so the piece remaining is to add connectivity with sessiond to get those data"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thought it would end today as we already have all the IPC code in a library which gateway daemons use to talk to sessiond BUT nginx had a surprise..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You cannot have a thread or whatever running \"on the side\" doing its business. The module is just functions that you can hook in the asych cycle of nginx. You can create stuff \"on the side\" but they will vanish as nginx is spawning/destroying worker processes and other magic stuff. The nginx\\"
                },
                {
                  "type": "text",
                  "text": "thread idea is just to offload tasks (called from the hooks of the cycle) in case that is needed",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sooo the best way from the ways PoCed so far is to work with nginx not against it... Follow its model."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sessiond can send the json data in simple POST call! nginx is already a dude that you can send data to it so the side channel was actually a really bad idea anyways"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Works really nice (so far in the PoC) as you can hook properly to the cycle read the POST and do whatever you want with the data"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "simulating sessiond sending stuff"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -d '{\"key1\":\"value1\", \"key2\":\"value2\"}' -H \"Content-Type: application/json\" -X POST ["
                },
                {
                  "type": "text",
                  "text": "http://localhost:1234/data](http://localhost:1234/data)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nginx"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[emerg\\] 8819#8819: \\*1 sessiond send us a POST, client: 127.0.0.1, server: , request: \"POST /data HTTP/1.1\", host: \"localhost:1234\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1560439082144
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Writing down a problem: Nginx is multi process in case you set it with "
                },
                {
                  "type": "text",
                  "text": "worker_processes auto",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " this means that when sessiond does a POST only the filter of that processes will get updated leaving other worker processes with stale filter. Nginx uses shared memory for the worker processes to share data between them but that it is not something dynamic. Moreover the HashTables are Glib and they use the heap. We would need to implement HashTable wih nginx memory management so it can be shaved in the shared memory segment and also take care for the expansian. Major PITA. Let's start with having 1 worker process to get the feature done."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1560590205181
      }
    ]
  },
  {
    "key": "SA-11323",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "PR: "
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com/appgate/stratus-tests/pull/1943",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://code.cyxtera.com/appgate/stratus-tests/pull/1943"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " PR #2: "
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com/appgate/helvetest/pull/269",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://code.cyxtera.com/appgate/helvetest/pull/269"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " PR #3: "
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com/appgate/testy/pull/266",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://code.cyxtera.com/appgate/testy/pull/266"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " PR #4: "
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com/appgate/testy/pull/267",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://code.cyxtera.com/appgate/testy/pull/267"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This will be a special case that will run as the very last test to analyze logs for anomalies (excess warnings, unexpected errors, etc.) in comparison to previous test runs. We'll have to store analysis data in Akira so last ~30 runs can be stored and compared to current run to detect standard deviation & anomalies."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Pettor also suggest we can look into other anomalies like logged passwords etc."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Couldn't find the ancient task on this subject so created this one instead. There were several good Python cmd tools for this but will have to research again."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I managed to train a basic model using "
                },
                {
                  "type": "text",
                  "text": "https://github.com/logpai/loglizer",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/logpai/loglizer"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " along with a Linux client nightly test run logs from TeamCity using following:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "git clone "
                },
                {
                  "type": "text",
                  "text": "https://github.com/logpai/loglizer.git"
                },
                {
                  "type": "text",
                  "text": "\ndocker run --name loglizer -v $(pwd)/loglizer:/loglizer -it logpai/anaconda:py3.6 bash\npython PCA_demo_without_labels.py"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1560866973240
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For the interested folk, tried "
                },
                {
                  "type": "text",
                  "text": "https://github.com/logpai/loglizer",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/logpai/loglizer"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " with our Client test logs from TeamCity and below is the result of training the ML model with one successful test and comparing it to subsequent test logs:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "====== Input data summary ======\nTrain data: "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/downloadBuildLog.html?buildId=400920"
                },
                {
                  "type": "text",
                  "text": "\nTest data: "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/downloadBuildLog.html?buildId=400903"
                },
                {
                  "type": "text",
                  "text": "\nData len: 7940\nTotal: 7940 instances, train: 3970 instances, test: 3970 instances\n\n====== Trained model summary ======\nn_components: 1\nProject matrix shape: 14-by-14\nSPE threshold: 14.862112341059666\n\n====== Test data summary ======\nTest: 3970 instances, 5 anomaly, 3965 normal\n\n====== Evaluation summary ======\nPrecision: 0.9987"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Precision is only high if your criteria is very specific, i.e. frequency of the logs lines that contain the word: "
                },
                {
                  "type": "text",
                  "text": "connected",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Fun to play with but requires major changes to the data extraction logic to format the logs and only select the information targeted since internally tool uses time series of events and irrelevant data destroys the precision."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1560942385123
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I am preparing a presentation for this in action. Just need to organize ton of research that I did for this into a tidy <10min presentation. Should be ready next month or so."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1575885272380
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Will put the test back into service (even with low accuracy) and prepare the presentation for it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1582187326404
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " presentation is ready. it's about 5 mins long + 2 min of animations. shall we deploy it during a MM or after it?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "![](image1583158724712.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1583158726817
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, make a meeting for all.staff.gothenburg.office"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "appgate.com",
                    "text": "@appgate.com",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " whatever time is best for you so it's not dropped suddenly. Could be after morning meeting."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If you want, you can make it a little longer and it could be a lunch&learn thing. But if it's 5 minutes, probably not."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1583161647270
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok I'll add a very basic \"Intro to ML\" section so I can make it 15/20 min meeting + some questions for a lunch presentation."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1583162781083
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, that will probably make it easier to follow for peasants like us. Check with Camilla, she can arrange/help you arrange the logistics for lunch stuff."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1583163059666
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Camilla advised we do this in the new office so all set. Will arrange food part a week before the presentation."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1583316068855
      }
    ]
  },
  {
    "key": "SA-11351",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Fresh env, local upgrade file. Logs:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2019-06-20T12:13:16.736Z] Info : Starting downloading package to '/Users/teo/.appgatesdp/updates/ag.dmg' from '"
            },
            {
              "type": "text",
              "text": "http://localhost:8000/ag.dmg'"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n[2019-06-20T12:13:16.790Z] Info : Updating vpn certificate.\n[2019-06-20T12:13:16.790Z] Info : Retrieving VPN certificate.\n[2019-06-20T12:13:16.794Z] Info : VPN certificate found in secure storage for 'CN=21699501face5d21a6ef20b3fff51b56,CN=bob,OU=local'.\n[2019-06-20T12:13:16.867Z] Info : Connecting to TUN driver.\n[2019-06-20T12:13:16.873Z] Info : Setting log level of TUN driver to Info.\n[2019-06-20T12:13:17.074Z] Info : Checking next CA certificate.\n[2019-06-20T12:13:17.081Z] Info : No next CA certificate in the system.\n[2019-06-20T12:13:17.233Z] Info : Download completed, file is in '/Users/teo/.appgatesdp/updates/ag.dmg'\n[2019-06-20T12:13:17.757Z] Info : TUN connected on site 'simple_setup Site'. \n[2019-06-20T12:13:17.808Z] Info : Creating a new gateway connection to 'envy-172-17-142-2.devops'.\n[2019-06-20T12:13:17.814Z] Info : Logging in to gateway 'envy-172-17-142-2.devops'.\n[2019-06-20T12:13:17.824Z] Warn : Installer was downloaded but not verified\n[2019-06-20T12:13:17.887Z] Info : Connected and logged into all sites.\n[2019-06-20T12:13:17.923Z] Info : Successfully logged into gateway 'envy-172-17-142-2.devops'."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "silvercast.nguyen",
                    "text": "@silvercast.nguyen",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " does the auto-upgrade work on your machine?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1561362681621
      }
    ]
  },
  {
    "key": "SA-11367",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "./cz-gcp /tmp/q/appgate-4.3.2-14444-release.img.zip \nCreating bootstrap instance appgate-bootstrap-instance...\nWARNING: You have selected a disk size of under [200GB]. This may result in poor I/O performance. For more information, see: "
            },
            {
              "type": "text",
              "text": "https://developers.google.com/compute/docs/disks#performance"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\nCreated ["
            },
            {
              "type": "text",
              "text": "https://www.googleapis.com/compute/v1/projects/appgate-dev/zones/europe-west3-c/instances/appgate-bootstrap-instance]"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\nWARNING: Some requests generated warnings:\n - Disk size: '20 GB' is larger than image size: '10 GB'. You might need to resize the root repartition manually if the operating system does not support automatic resizing. See "
            },
            {
              "type": "text",
              "text": "https://cloud.google.com/compute/docs/disks/add-persistent-disk#resize_pd"
            },
            {
              "type": "text",
              "text": " for details.\n - The resource 'projects/ubuntu-os-cloud/global/images/ubuntu-1604-xenial-v20181114' is deprecated. A suggested replacement is 'projects/ubuntu-os-cloud/global/images/ubuntu-1604-xenial-v20190617'.\n\nNAME                        ZONE            MACHINE_TYPE   PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP    STATUS\nappgate-bootstrap-instance  europe-west3-c  n1-standard-1               10.156.0.32  35.246.244.70  RUNNING\nCreating image disk appgate-image-disk...\nFor the following disk:\n - [appgate-image-disk]\nchoose a region or a zone:\n [1] region: asia-east1\n [2] region: asia-east2\n [3] region: asia-northeast1\n [4] region: asia-northeast2\n [5] region: asia-south1\n [6] region: asia-southeast1\n [7] region: australia-southeast1\n [8] region: europe-north1\n [9] region: europe-west1\n [10] region: europe-west2\n [11] region: europe-west3\n [12] region: europe-west4\n [13] region: europe-west6\n [14] region: northamerica-northeast1\n [15] region: southamerica-east1\n [16] region: us-central1\n [17] region: us-east1\n [18] region: us-east4\n [19] region: us-west1\n [20] region: us-west2\n [21] zone: asia-east1-a\n [22] zone: asia-east1-b\n [23] zone: asia-east1-c\n [24] zone: asia-east2-a\n [25] zone: asia-east2-b\n [26] zone: asia-east2-c\n [27] zone: asia-northeast1-a\n [28] zone: asia-northeast1-b\n [29] zone: asia-northeast1-c\n [30] zone: asia-northeast2-a\n [31] zone: asia-northeast2-b\n [32] zone: asia-northeast2-c\n [33] zone: asia-south1-a\n [34] zone: asia-south1-b\n [35] zone: asia-south1-c\n [36] zone: asia-southeast1-a\n [37] zone: asia-southeast1-b\n [38] zone: asia-southeast1-c\n [39] zone: australia-southeast1-a\n [40] zone: australia-southeast1-b\n [41] zone: australia-southeast1-c\n [42] zone: europe-north1-a\n [43] zone: europe-north1-b\n [44] zone: europe-north1-c\n [45] zone: europe-west1-b\n [46] zone: europe-west1-c\n [47] zone: europe-west1-d\n [48] zone: europe-west2-a\n [49] zone: europe-west2-b\n [50] zone: europe-west2-c\nDid not print [31] options.\nToo many options [81]. Enter \"list\" at prompt to print choices fully.\nPlease enter your numeric choice:  50\n\nWARNING: You have selected a disk size of under [200GB]. This may result in poor I/O performance. For more information, see: "
            },
            {
              "type": "text",
              "text": "https://developers.google.com/compute/docs/disks#performance"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\nCreated ["
            },
            {
              "type": "text",
              "text": "https://www.googleapis.com/compute/v1/projects/appgate-dev/zones/europe-west2-c/disks/appgate-image-disk]"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\nNAME                ZONE            SIZE_GB  TYPE         STATUS\nappgate-image-disk  europe-west2-c  20       pd-standard  READY\n\nNew disks are unformatted. You must format and mount a disk before it\ncan be used. You can find instructions on how to do this at:\n\n"
            },
            {
              "type": "text",
              "text": "https://cloud.google.com/compute/docs/disks/add-persistent-disk#formatting"
            },
            {
              "type": "text",
              "text": "\n\nAttaching image disk appgate-image-disk to appgate-bootstrap-instance...\nERROR: (gcloud.compute.instances.attach-disk) Could not fetch resource:\n - The resource 'projects/appgate-dev/zones/europe-west3-c/disks/appgate-image-disk' was not found\n\nERROR: Failed to attach disk appgate-image-disk to instance appgate-bootstrap-instance\nAfter you exit this console the env will be destroyed!\n"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It seems that the version of the script in release branch does not work. I'm retesting using the version from master."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1561538622888
      }
    ]
  },
  {
    "key": "SA-11426",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Seems to be unsafe"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "tmp/virtualenv_85294291-e3b9-4a0c-a0c5-734de789c86d/lib/python3.6/site-packages/testy/settings.py:44: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read "
            },
            {
              "type": "text",
              "text": "https://msg.pyyaml.org/load"
            },
            {
              "type": "text",
              "text": " for full details.\n[16:01:12]\n[Step 1/1]   values = SettingsValues(yaml.load(f))"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We have one instance of it in appliance, and some in other places."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The only instance in appliance seems to be in "
                },
                {
                  "type": "text",
                  "text": "cloud-templates/gcp/marketplace/common/common.py:def GenerateEmbeddableYaml(yaml_string)",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " which seems to never be used anywhere."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, probably safe to remove that, but for another task I guess."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1562750082360
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/testy/pull/268",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/testy/pull/268"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1562750086404
      }
    ]
  },
  {
    "key": "SA-11439",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "According to the latest docs of nginx the proper/best way when there is any configuration change is to reload nginx "
            },
            {
              "type": "text",
              "text": "nginx -s reload",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ". We have updated to the latest version of nginx so we should try again if it works as expected now"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[Thomas Cellerier]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"thomas.cellerier\") "
                },
                {
                  "type": "text",
                  "text": "Salvatore Tomaselli",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                        "title": "salvatore.tomaselli"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1562061792718
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "aitorbot test create --execution 153e7dc0-2106-4dcc-b191-3ae7cf2b41a3 \nsalvatore-tomaselli [] | 2019-07-03 13:35:27\n        id:   95b999ce-9b55-4987-9e3b-2349d16f249d\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/627846"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Env with manually applied changes."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1562160995224
      }
    ]
  },
  {
    "key": "SA-11557",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Well, it could be controller (no changes there though) or python download library issue also. But nginx error looked serious, so.."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2019/07/17 12:25:49 \\[crit\\] 8161#8161: \\*1168 pwritev() \"/var/spool/nginx/0000000009\" has written only 4096 of 8192 while reading upstream, client: 35.156.54.81, server: \\_,  request: \"GET /peer/files/appgate-5.0.0-14766-master.img.zip HTTP/1.1\", upstream: \"["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:9130/peer/files/appgate-5.0.0-14766-master.img.zip](http://127.0.0.1:9130/peer/files/appgate-5.0.0-14766-master.img.zip)\""
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " host: \"purple10.cryptzone.com:444\""
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "it seems to work for the second controller upgrade, then 4 gateways try to download it at the same time and then fails with \"Invalid upgrade file, file is not a zip file\"."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Possibly related: "
            },
            {
              "type": "text",
              "text": "https://pydio.com/forum/f/topic/download-systematically-fails-in-the-middle-of-a-download/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://pydio.com/forum/f/topic/download-systematically-fails-in-the-middle-of-a-download/"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed "
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-appliance/pull/3142",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-appliance/pull/3142"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1566566425121
      }
    ]
  },
  {
    "key": "SA-11709",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This was useful when transitioning from the old jsonrpc code to the state machine, it's now just an overcomplex additional layer."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\`\\`\\`Aug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]: WARN \\[2019-08-08T12:49:40.298Z\\] \\[TokenRevocationService\\] Exception while trying to get token revocation list from url: ["
                },
                {
                  "type": "text",
                  "text": "https://35.242.243.138:444/peer/revocation-list](https://35.242.243.138:444/peer/revocation-list)"
                },
                {
                  "type": "text",
                  "text": " trying next..\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]: ERROR \\[2019-08-08T12:49:40.299Z\\] \\[TokenRevocationService\\]  Throwable : javax.ws.rs.ProcessingException message:javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: Certificate signature validation failed stacktrace: javax.ws.rs.ProcessingException: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: Certificate signature validation failed\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.internal.HttpUrlConnector.apply(HttpUrlConnector.java:287)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.ClientRuntime.invoke(ClientRuntime.java:252)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.JerseyInvocation$1.call(JerseyInvocation.java:684)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.JerseyInvocation$1.call(JerseyInvocation.java:681)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:315)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:297)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:228)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:444)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.JerseyInvocation.invoke(JerseyInvocation.java:681)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.JerseyInvocation$Builder.method(JerseyInvocation.java:411)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.JerseyInvocation$Builder.get(JerseyInvocation.java:311)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at com.cyxtera.gateway.sessiondaemon.revocations.TokenRevocationService.run(TokenRevocationService.java:95)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at java.lang.Thread.run(Thread.java:748)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]: Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: Certificate signature validation failed\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.Alerts.getSSLException(Alerts.java:192)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1946)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:316)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.Handshaker.fatalSE(Handshaker.java:310)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1639)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:223)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.Handshaker.processLoop(Handshaker.java:1037)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.Handshaker.process\\_record(Handshaker.java:965)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:1064)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1367)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1395)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1379)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:559)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:185)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1564)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1492)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:347)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.internal.HttpUrlConnector.\\_apply(HttpUrlConnector.java:399)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at org.glassfish.jersey.client.internal.HttpUrlConnector.apply(HttpUrlConnector.java:285)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         ... 12 more\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]: Caused by: sun.security.validator.ValidatorException: Certificate signature validation failed\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.validator.SimpleValidator.engineValidate(SimpleValidator.java:215)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.validator.Validator.validate(Validator.java:262)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.X509TrustManagerImpl.validate(X509TrustManagerImpl.java:324)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.X509TrustManagerImpl.checkTrusted(X509TrustManagerImpl.java:229)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:124)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1621)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         ... 27 more\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]: Caused by: java.security.SignatureException: Signature does not match.\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.x509.X509CertImpl.verify(X509CertImpl.java:424)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.x509.X509CertImpl.verify(X509CertImpl.java:392)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         at sun.security.validator.SimpleValidator.engineValidate(SimpleValidator.java:213)\n\nAug 08 12:49:40 corelogiccontroller.com cz-sessiond\\[2049\\]:         ... 32 more"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1565268843028
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. this exception could be caught in a nicer way."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1565268865078
      }
    ]
  },
  {
    "key": "SA-7606",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This was useful when transitioning from the old jsonrpc code to the state machine, it's now just an overcomplex additional layer."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "plan=test plan?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1521711807268
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yup"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521712422002
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The issue is this, with helvetest:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot --dev-mode test create --appliance-branch beta --client-branch beta -d stratus-appliance 1937 -t helvetest\n\nthomas-cellerier \\['helvetest'\\] | 2018-03-22 09:21:21\n\nid:   43cc2039-4ba1-4fa1-b7e9-d06ebafb2a74\n\nurl:  None"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When we expect this, as with testyd:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot test create --appliance-branch beta --client-branch beta -d stratus-appliance 1937 -t testyd\n\nthomas-cellerier \\['testyd'\\] | 2018-03-22 09:54:18\n\nid:   f480de45-197c-409c-a894-7dcac9edc32f\n\nurl:  ["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com:443/index.php?/plans/view/407069](https://testrail.ad.cryptzone.com:443/index.php?/plans/view/407069)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521712481815
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/113",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/113"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521716678775
      }
    ]
  },
  {
    "key": "SA-7622",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This was useful when transitioning from the old jsonrpc code to the state machine, it's now just an overcomplex additional layer."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is already code for this, so I need to debug why it doesn't work."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521617210329
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ah the classic asyncio bug :)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[9cda9ebc-3f2e-4ab6-8795-508455daccc5\\] \\[ActionsRunner\\] Running action CancelTeamCityBuildAction(execution\\_id='9cda9ebc-3f2e-4ab6-8795-508455daccc5', reason='Deleted by owner thomas-cellerier', queued\\_build=QueuedBuild(id=279332, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=279332'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=279332')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\n/opt/helvetest/lib/python3.6/site-packages/helvetest/services/testsd/actions.py:117: RuntimeWarning: coroutine 'TeamCityClient.cancel\\_build' was never awaited\n\n  c.cancel\\_build(build\\_id=self.queued\\_build.id, reason=self.reason)\n\n\\[9cda9ebc-3f2e-4ab6-8795-508455daccc5\\] \\[ActionsRunner\\] CancelTeamCityBuildAction done \\[in logger.info\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521618182853
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/107",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/107"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521618308559
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/108",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/108"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521619721114
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "One more error:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[af655700-d958-4f00-982e-33faead02fef\\] \\[ActionsRunner\\] Unhandled error while running action CancelTeamCityBuildAction(execution\\_id='af655700-d958-4f00-982e-33faead02fef', reason='Deleted by owner thomas-cellerier', queued\\_build=Que\n\nuedBuild(id=279360, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=279360'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=279360')))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " carry on... \\[in logger.exception\\]\n\nTraceback (most recent call last):\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/state\\_machine/action/actions\\_runner.py\", line 129, in run\n\n    action\\_result = await action.run(action\\_data)\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/helvetest/services/testsd/actions.py\", line 117, in run\n\n    await teamcity\\_client.cancel\\_build(build\\_id=self.queued\\_build.id, reason=self.reason)\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/clients/teamcity.py\", line 255, in cancel\\_build\n\n    await self.cancel\\_queued\\_build(build\\_id=build\\_id, reason=reason)\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/clients/teamcity.py\", line 247, in cancel\\_queued\\_build\n\n    await self.\\_cancel\\_build(build\\_id, reason, 'buildQueue')\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/clients/teamcity.py\", line 242, in \\_cancel\\_build\n\n    resp = await self.request(method='POST', path=method, data=json.dumps(cb.\\_asdict()).encode())\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/clients/base\\_client.py\", line 108, in request\n\n    return await self.\\_request(method, path, data, json, headers)\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/clients/base\\_client.py\", line 90, in \\_request\n\n    json=json) as resp:\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/aiohttp/client.py\", line 690, in \\_\\_aenter\\_\\_\n\n    self.\\_resp = yield from self.\\_coro\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/aiohttp/client.py\", line 345, in \\_request\n\n    resp.raise\\_for\\_status()\n\n  File \"/opt/helvetest/lib/python3.6/site-packages/aiohttp/client\\_reqrep.py\", line 718, in raise\\_for\\_status\n\n    headers=self.headers)\n\naiohttp.client\\_exceptions.ClientResponseError: 415, message='None'"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521621192173
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/109",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/109"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1521621937723
      }
    ]
  },
  {
    "key": "SA-7834",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This was useful when transitioning from the old jsonrpc code to the state machine, it's now just an overcomplex additional layer."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm thinking about how to do this once we switch to themachine since it doesn't provide a built-in RPC."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also we want to move the request id away from the event objects since they should be pure data related to the event. The extra Json layer is also superfluous since it's all in memory so we can build an RPC layer dealing with python objects directly."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If we want to keep a clean separation between the state machine layer and the \"RPC\" layer."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The RPC layer will be exposed only via the rest API, since seeding can be done just by reading the current state and pushing seed events."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "One option is defining a Request class instead of directly using events."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The request event would contain a request id, a reference to the response queue and an event."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We probably don't even need to expose them"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So for example if you want to do start an upgrade, imaging an simple upgrade event:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "class UpgradeEvent(Event):\n\n    image\\_url: str"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "you would instantiate a request on top of it:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "class Request:\n\n    event: Event\n\n    request\\_id: str\n\n    response\\_queue: Queue\\[Response\\]\n\ndef request(event: Event) -> Request:\n\n    rq = thread local response queue\n\n    rid = uuid.uuid4()\n\n    return Request(event, rid, rq)\n\nrequest = request(event=UpgradeEvent(image\\_url='["
                },
                {
                  "type": "text",
                  "text": "https://some/url'](https://some/url')))"
                },
                {
                  "type": "text",
                  "text": "  # automatically assigns a request id and a response queue"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The request helper would automatically set the response queue and return a Request object."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The RPC layer would then consume incoming requests one by one, unpack the events and feed them to the state machine."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "def rpc\\_loop():\n\n    while running:\n\n        requests = {}\n\n        for request in request\\_queue:\n\n            requests\\[request.id\\] = request.response\\_queue\n\n            state\\_machine.put\\_event(request.event)\n\n        for response in response\\_queue:\n\n            response\\_queue = requests\\[response.request\\_id\\]\n\n            response\\_queue.put(response.value)\n\n            del requests\\[response.request\\_id\\]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Now I'm still missing the piece where you send a response from the state machine..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1525437635922
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another option here is to ditch RPC in general and go full async."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "That is make all write operations async with a way to query the status later."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Read operations can use the state and status views and return directly."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This would actually match for the following things:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  pushing config -> The controller already treats that as async"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  upgrading -> We have an async API in the form of do API call + check upgrade status. The upgrade script works like that already"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  backup -> We have an async API already"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1525438300398
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So let's say we dump the whole synchronous request/response thing."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Then we make all APIs do basic validations and fire an event. There should then be a way to query for the status of that particular operation."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1525438705994
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed in ["
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2080](https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2080)",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2080](https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2080)"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " while implementing "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-8083",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-8083"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1527843000719
      }
    ]
  },
  {
    "key": "SA-7868",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Right now I get this beauty:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ python3 appgate-backup.pyz envy-172-17-100-1.devops\n\nEnter password for username admin and provider name local:\n\nAuthenticating to ["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-100-1.devops:444..](https://envy-172-17-100-1.devops:444..)"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\nTraceback (most recent call last):\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 1254, in do\\_open\n\n    h.request(req.get\\_method(), req.selector, req.data, headers)\n\n  File \"/usr/lib/python3.5/http/client.py\", line 1106, in request\n\n    self.\\_send\\_request(method, url, body, headers)\n\n  File \"/usr/lib/python3.5/http/client.py\", line 1151, in \\_send\\_request\n\n    self.endheaders(body)\n\n  File \"/usr/lib/python3.5/http/client.py\", line 1102, in endheaders\n\n    self.\\_send\\_output(message\\_body)\n\n  File \"/usr/lib/python3.5/http/client.py\", line 934, in \\_send\\_output\n\n    self.send(msg)\n\n  File \"/usr/lib/python3.5/http/client.py\", line 877, in send\n\n    self.connect()\n\n  File \"/usr/lib/python3.5/http/client.py\", line 1260, in connect\n\n    server\\_hostname=server\\_hostname)\n\n  File \"/usr/lib/python3.5/ssl.py\", line 377, in wrap\\_socket\n\n    \\_context=self)\n\n  File \"/usr/lib/python3.5/ssl.py\", line 752, in \\_\\_init\\_\\_\n\n    self.do\\_handshake()\n\n  File \"/usr/lib/python3.5/ssl.py\", line 988, in do\\_handshake\n\n    self.\\_sslobj.do\\_handshake()\n\n  File \"/usr/lib/python3.5/ssl.py\", line 633, in do\\_handshake\n\n    self.\\_sslobj.do\\_handshake()\n\nssl.SSLError: \\[SSL: CERTIFICATE\\_VERIFY\\_FAILED\\] certificate verify failed (\\_ssl.c:645)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n\n  File \"appgate-backup.pyz/appgate\\_backup/admin.py\", line 256, in request\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 163, in urlopen\n\n    return opener.open(url, data, timeout)\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 466, in open\n\n    response = self.\\_open(req, data)\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 484, in \\_open\n\n    '\\_open', req)\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 444, in \\_call\\_chain\n\n    result = func(\\*args)\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 1297, in https\\_open\n\n    context=self.\\_context, check\\_hostname=self.\\_check\\_hostname)\n\n  File \"/usr/lib/python3.5/urllib/request.py\", line 1256, in do\\_open\n\n    raise URLError(err)\n\nurllib.error.URLError: <urlopen error \\[SSL: CERTIFICATE\\_VERIFY\\_FAILED\\] certificate verify failed (\\_ssl.c:645)>\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n\n  File \"/usr/lib/python3.5/runpy.py\", line 184, in \\_run\\_module\\_as\\_main\n\n    \"\\_\\_main\\_\\_\", mod\\_spec)\n\n  File \"/usr/lib/python3.5/runpy.py\", line 85, in \\_run\\_code\n\n    exec(code, run\\_globals)\n\n  File \"appgate-backup.pyz/\\_\\_main\\_\\_.py\", line 2, in <module>\n\n  File \"appgate-backup.pyz/appgate\\_backup/\\_\\_init\\_\\_.py\", line 171, in main\n\n  File \"appgate-backup.pyz/appgate\\_backup/admin.py\", line 335, in authenticate\n\n  File \"appgate-backup.pyz/appgate\\_backup/admin.py\", line 299, in \\_authenticate\n\n  File \"appgate-backup.pyz/appgate\\_backup/admin.py\", line 263, in request\n\nappgate\\_backup.admin.SSLError: (SSLError(1, '\\[SSL: CERTIFICATE\\_VERIFY\\_FAILED\\] certificate verify failed (\\_ssl.c:645)'),)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1974"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1523438376438
      }
    ]
  },
  {
    "key": "SA-7973",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is the example given by "
                },
                {
                  "type": "text",
                  "text": "Teoman Soygul",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/teoman.soygul",
                        "title": "teoman.soygul"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "pr "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2904",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2904"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "test "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/423282",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://testrail.ad.cryptzone.com/index.php?/plans/view/423282"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And the relevant logs:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 25 07:53:58 helvetest-prod helvetest\\[61\\]: Got github webhook event of type issue\\_comment \\[in service.github\\_forwarder\\]\n\nApr 25 07:53:58 helvetest-prod helvetest\\[61\\]: 169.254.240.30 \\[25/Apr/2018:07:53:58 +0000\\] \"POST /api/github HTTP/1.0\" 204 157 \"-\" \"GitHub-Hookshot/a809fd7\" \\[in helpers.log\\]\n\nApr 25 07:53:58 helvetest-prod helvetest\\[61\\]: \\[stratus-client-shared-2904\\] \\[ActionsRunner\\] PullRequestIssueCommentAction done \\[in logger.info\\]\n\nApr 25 07:53:58 helvetest-prod helvetest\\[61\\]: \\[stratus-client-shared-2904\\] \\[ActionsRunner\\] Running action CreateTestAction(execution\\_id='stratus-client-shared-2904', event=CreateTest(purpose='commit', cas\n\ne\\_ids=\\[\\], scenario='simple\\_v4', test\\_project\\_id=7, appliance=ApplianceBuildNumberDependencyRequest(branch='master', build\\_number=None, build\\_id=None), environment=None, testy=TestyDependencyRequest(defaul\n\nt\\_branch='master', dependencies=\\[ArtifactDependencyRequest(name='testyd', branch='master', build\\_number=None, build\\_id=None), ArtifactDependencyRequest(name='stratus-client-shared', branch='2904', build\\_n\n\number=None, build\\_id=None), ArtifactDependencyRequest(name='testy', branch='master', build\\_number=None, build\\_id=None), ArtifactDependencyRequest(name='stratus-tests', branch='master', build\\_number=None, \n\nbuild\\_id=None)\\]), pullrequest=PullRequest(id=14216, number=2904, state='open', title=\"Don't require notifications on mobile\", body='Fixes ["
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-7980](https://youtrack.ad.cryptzone.com/issue/SA-7980)\\\\r\\\\n'"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " html\\_url='ht\n\ntps://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2904', user=User(id=20, login='soygul'), head=Head(label='cryptzone:mobile-notifications', ref='mobile-notifications', sha='03f42718427bb\n\nad0a3147d4d48f0a5037d1ac6f7', repo=Repository(id=143, name='stratus-client-shared')), base=Base(label='cryptzone:master', ref='master', sha='eff799b006f1ec62e429355e1a2ad1ed3905c5df')), client='android', \n\nlevel='STREAM', tags=\\['pullrequest', 'stratus-client-shared', 'soygul'\\], environment\\_vars=\\[\\], use\\_agent=True, keep\\_environment\\_on\\_spawn\\_error=False, keep\\_environment\\_on\\_test\\_error=False, custom\\_envy=None,\n\n log\\_levels=\\[\\], allow\\_subnets=\\[\\]), user='soygul') ... \\[in logger.info\\]\n\nApr 25 07:53:58 helvetest-prod helvetest\\[61\\]: \\[CreateTestAction\\] Creating test execution stratus-client-shared-2904! \\[in base.log\\]\n\nApr 25 07:53:58 helvetest-prod helvetest\\[61\\]: \\[6eb61903-dff6-4dc3-b247-b1ee012c4c0a\\] Creating execution: CreateTest(purpose='commit', case\\_ids=\\[\\], scenario='simple\\_v4', test\\_project\\_id=7, appliance=ApplianceBuildNumberDependencyRequest(branch='master', build\\_number=None, build\\_id=None), environment=None, testy=TestyDependencyRequest(default\\_branch='master', dependencies=\\[ArtifactDependencyRequest(name='testyd', branch='master', build\\_number=None, build\\_id=None), ArtifactDependencyRequest(name='stratus-client-shared', branch='2904', build\\_number=None, build\\_id=None), ArtifactDependencyRequest(name='testy', branch='master', build\\_number=None, build\\_id=None), ArtifactDependencyRequest(name='stratus-tests', branch='master', build\\_number=None, build\\_id=None)\\]), pullrequest=PullRequest(id=14216, number=2904, state='open', title=\"Don't require notifications on mobile\", body='Fixes ["
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-7980](https://youtrack.ad.cryptzone.com/issue/SA-7980)\\\\r\\\\n'"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " html\\_url='["
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2904'](https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2904')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " user=User(id=20, login='soygul'), head=Head(label='cryptzone:mobile-notifications', ref='mobile-notifications', sha='03f42718427bbad0a3147d4d48f0a5037d1ac6f7', repo=Repository(id=143, name='stratus-client-shared')), base=Base(label='cryptzone:master', ref='master', sha='eff799b006f1ec62e429355e1a2ad1ed3905c5df')), client='android', level='STREAM', tags=\\['pullrequest', 'stratus-client-shared', 'soygul'\\], environment\\_vars=\\[\\], use\\_agent=True, keep\\_environment\\_on\\_spawn\\_error=False, keep\\_environment\\_on\\_test\\_error=False, custom\\_envy=None, log\\_levels=\\[\\], allow\\_subnets=\\[\\]) \\[in logger.info\\]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We can see that the client dependency was specified correctly by prsd:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "ArtifactDependencyRequest(name='stratus-client-shared', branch='2904', build\\_number=None, build\\_id=None)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The client is correctly set to android:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "client='android'"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The teamcity build creation:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[6eb61903-dff6-4dc3-b247-b1ee012c4c0a\\] \\[ActionsRunner\\] Running action CreateTestBuildAction(execution\\_id='6eb61903-dff6-4dc3-b247-b1ee012c4c0a', name='test-bu\n\nild', properties=\\[Property(name='teamcity.build.branch', value='423282'), Property(name='env.E2E\\_UUID', value='6eb61903-dff6-4dc3-b247-b1ee012c4c0a'), Property(name='env.AITORBOT\\_DEV\\_MODE', value='0'), Pr\n\noperty(name='env.E2E\\_KEEP\\_ENV\\_ON\\_FAILURE', value='0')\\], dependencies=\\[Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testyd', id='Testyd\\_TestydBuild'), dependency\\_type='artifact\\_dependency', id=\n\n'0', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>C:\\\\\\\\\\\\\\\\Users\\\\\\\\admin\\\\\\\\artifacts'), Property(name='revisionName', value='buildNumber'), Proper\n\nty(name='revisionValue', value='1856')\\]), Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testy', id='Testy\\_TestyBuild'), dependency\\_type='artifact\\_dependency', id='1', properties=\\[Property(name=\n\n'cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>C:\\\\\\\\\\\\\\\\Users\\\\\\\\admin\\\\\\\\artifacts'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value=\n\n'417')\\]), Dependency(source\\_build\\_type=SourceBuildType(project\\_id='StratusClient', id='StratusClient\\_Android'), dependency\\_type='artifact\\_dependency', id='2', properties=\\[Property(name='cleanDestinationDi\n\nrectory', value='false'), Property(name='pathRules', value='\\*=>C:\\\\\\\\\\\\\\\\Users\\\\\\\\admin\\\\\\\\artifacts\\\\\\\\android'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='9213')\\]),\n\n Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testy\\_StratusTests', id='Testy\\_StratusTests\\_StratusTestsBuild'), dependency\\_type='artifact\\_dependency', id='3', properties=\\[Property(name='cleanDe\n\nstinationDirectory', value='false'), Property(name='pathRules', value='\\*=>C:\\\\\\\\\\\\\\\\Users\\\\\\\\admin\\\\\\\\artifacts'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='4799')\\]\n\n)\\], build\\_type\\_id='QaBuildConfigurations\\_EndToEnd\\_E2eTestyAndroidRunner') ... \\[in logger.info\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: 169.254.240.30 \\[25/Apr/2018:08:07:13 +0000\\] \"POST /api/executions/e1517e2a-7cd5-4925-8eb3-a59488b02780/running-testplan/finished-testcase HTTP/1.0\" 202 155 \"-\n\n\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[e1517e2a-7cd5-4925-8eb3-a59488b02780\\] \\[StateMachine\\] Received event FinishedTestCase(actual\\_tags=\\['867663'\\], result=None, test\\_id=6666, case\\_id=867663, time=\n\n'2018-04-25T08:07:13,692080Z', ident='testy', suite\\_id=423277, test\\_uuid='e1517e2a-7cd5-4925-8eb3-a59488b02780', start\\_time='2018-04-25T08:06:33,912394Z', running\\_time=39, status='PASSED', exception\\_strin\n\ng=None, stack\\_trace=None, module\\_name='client/login\\_logout/login\\_correct\\_credential', purpose='commit', reason=None), staying in state running-testplan \\[in logger.info\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[e1517e2a-7cd5-4925-8eb3-a59488b02780\\] Report test case 867663 status TestCasePassed \\[in logger.info\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[e1517e2a-7cd5-4925-8eb3-a59488b02780\\] \\[ActionsRunner\\] Running action ReportTestCaseAction(execution\\_id='e1517e2a-7cd5-4925-8eb3-a59488b02780', test\\_case=Test\n\nResult(type='TestCasePassed', suite\\_id=423277, case\\_id=867663), comment='Test case succeeded!') ... \\[in logger.info\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[e1517e2a-7cd5-4925-8eb3-a59488b02780\\] \\[ActionsRunner\\] ReportTestCaseAction done \\[in logger.info\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[e1517e2a-7cd5-4925-8eb3-a59488b02780\\] \\[ActionsRunner\\] Running action SaveToMongoAction(log=<state\\_machine.action.base.ActionLogger object at 0x7fa28093a908>,\n\n execution\\_id='e1517e2a-7cd5-4925-8eb3-a59488b02780', logger=<ExecutionLogger helvetest (NOTSET)>, state\\_label='running-testplan') ... \\[in logger.info\\]\n\nApr 25 08:07:13 helvetest-prod helvetest\\[61\\]: \\[e1517e2a-7cd5-4925-8eb3-a59488b02780\\] \\[ActionsRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nApr 25 08:07:14 helvetest-prod helvetest\\[61\\]: \\[6eb61903-dff6-4dc3-b247-b1ee012c4c0a\\] \\[ActionsRunner\\] CreateTestBuildAction done \\[in logger.info\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1524650615964
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The bug is not there when using aitorbot:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot test create -d stratus-client-linux 2893\n\nthomas-cellerier \\[\\] | 2018-04-25 10:11:10\n\nid:   a4d3ba15-b9b1-48a9-a7d8-70eb5f81a3ce\n\nurl:  ["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/423350](https://testrail.ad.cryptzone.com/index.php?/plans/view/423350)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "testyd [master | #1856] "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=286295&buildTypeId=Testyd\\_TestydBuild"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "testy [master | #417] "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=270118&buildTypeId=Testy\\_TestyBuild",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=270118&buildTypeId=Testy_TestyBuild"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "stratus-client-linux [2893 | #10560] "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=286710&buildTypeId=StratusClient\\_Linux",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=286710&buildTypeId=StratusClient_Linux"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "stratus-tests [master | #4799] "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=287800&buildTypeId=Testy\\_StratusTests\\_StratusTestsBuild",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=287800&buildTypeId=Testy_StratusTests_StratusTestsBuild"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The create test event for comparison:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 25 10:11:07 helvetest-prod helvetest\\[61\\]: \\[a4d3ba15-b9b1-48a9-a7d8-70eb5f81a3ce\\] Creating execution: CreateTest(purpose='commit', case\\_ids=\\[\\], scenario='simple\\_v4', test\\_project\\_id=7, appliance=ApplianceBuildNumberDependencyRequest(branch='master', build\\_number=None, build\\_id=None), environment=None, testy=TestyDependencyRequest(default\\_branch='master', dependencies=\\[ArtifactDependencyRequest(name='stratus-client-linux', branch='2893', build\\_number=None, build\\_id=None)\\]), pullrequest=None, client='linux', level='STREAM', tags=\\[\\], environment\\_vars=\\[\\], use\\_agent=True, keep\\_environment\\_on\\_spawn\\_error=False, keep\\_environment\\_on\\_test\\_error=False, custom\\_envy=None, log\\_levels=\\[\\], allow\\_subnets=\\[\\]) \\[in logger.info\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1524651177980
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Found the difference."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Broken:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "ArtifactDependencyRequest(name='stratus-client-shared', branch='2904', build\\_number=None, build\\_id=None)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Working:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "ArtifactDependencyRequest(name='stratus-client-linux', branch='2893', build\\_number=None, build\\_id=None)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So prsd needs to map the client to the dependency name."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1524651381066
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/166",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/helvetest/pull/166"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1524664538568
      }
    ]
  },
  {
    "key": "SA-8048",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Attempt to access endpoints fail with "
            },
            {
              "type": "text",
              "text": "General Failure",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ". Win10 seems to work. Have not tried Win 7 x64. 4.0.0 seems to work but not 4.0.1."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This seems to happen on systems with only SP1 installed - some later patch fixes this."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "4.0.1 contains a fix to retain the TAP IP address, and it is most likely this that causes the difference between 4.0.0 and 4.0.1 here."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hmm, let me try Win7 x64: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "aitorbot test create --client-branch release --client windows\nnatan-abolafya [] | 2018-05-02 15:41:40\n        id:   9e2d5186-e8ec-4a4e-8a00-524216b6eb04\n        url:  "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/427156"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1525274303074
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Works fine for me, both against purple (EBR) and local envy env (no EBR)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1525338495839
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It works after you install \"Internet Explorer 11 for Windows 7\" from Windows Update."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1525348433186
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "More specifically, the required hotfix is this one:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://support.microsoft.com/en-us/help/2888049/update-is-available-that-improves-the-network-performance-of-internet"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1525352065949
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "patches: doesn't work vs work"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1525352439953
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Installer needs to be updated with KB requirements/checks. Which will be very hairy and require lots of testing and pain."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1525355261817
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Is that a "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "petter.gustafsson",
                    "text": "@petter.gustafsson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " task?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1525428188114
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Let the pain begin!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1529929685547
      }
    ]
  },
  {
    "key": "SA-8298",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We want to capture the hostnames user tries to access but fails due to lack of entitlement, and present them in Controller UI as a list."
            }
          ]
        },
        {
          "type": "orderedList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "In order to limit number of hostnames to manageable size, we'll let administrators to configure App Discovery Domains in the Site form such as \\"
                    },
                    {
                      "type": "text",
                      "text": ".devops.ad.cryptzone.com",
                      "marks": [
                        {
                          "type": "em"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "For all the configured dns servers under Identity Providers, vpnd will listen all dns queries that are under \\"
                    },
                    {
                      "type": "text",
                      "text": ".devops.ad.cryptzone.com and collect them IF they are dropped (with no matching IPs in rules)",
                      "marks": [
                        {
                          "type": "em"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Controller UI will have an Discovered Apps page, possibly linked from the Site, that queries all Gateways under that site and lists all discovered domains.  As a bonus, we may have a button to create entitlement directly from that page."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Would be nice to threat this in a similar way as some of the stats. Group the dns names by most common ones. Like top 20 or so (or maybe all) and keep track of the number of hits for each"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kurt.glazemakers",
        "created": 1531916103351
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There will always be mis-types so might be good to drop the 1s totally."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1532005780750
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Typos will only be included if they actually resolve to an ip."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1532006007555
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ah good point...."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1532006040422
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We need to parse DNS responses not queries. A DNS response verifies first of all that the host name requested is valid so we don't spend time and resources on crap. Moreover we get the IP(s) of that host name! Hence an entitlement can be created with using either the host name or the IP(s)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "DNS responses parsing"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[tests\\] INFO    \\[2018-08-02T15:34:03.886Z\\] Starting \"test\\_app\\_discovery\"\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.904Z\\] app\\_discovery\\_parse\\_dns(): Flags 0x8081\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.905Z\\] app\\_discovery\\_parse\\_dns(): 1 Questions\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.905Z\\] app\\_discovery\\_parse\\_dns(): 4 Answers\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.907Z\\] app\\_discovery\\_parse\\_dns(): Label: \\[4\\] skai\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.909Z\\] app\\_discovery\\_parse\\_dns(): Label: \\[2\\] gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.911Z\\] app\\_discovery\\_parse\\_dns(): Queries: name: skai.gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.912Z\\] app\\_discovery\\_parse\\_dns(): Queries: Type 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.912Z\\] app\\_discovery\\_parse\\_dns(): Queries: Class 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.913Z\\] app\\_discovery\\_parse\\_dns(): Answers: name: skai.gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.913Z\\] app\\_discovery\\_parse\\_dns(): Answers: Type 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.914Z\\] app\\_discovery\\_parse\\_dns(): Answers: Class 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.914Z\\] app\\_discovery\\_parse\\_dns(): Answers: Length 0x4\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.916Z\\] app\\_discovery\\_parse\\_dns(): Answers: IP 151.101.128.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.918Z\\] app\\_discovery\\_parse\\_dns(): Inserting: Name \"skai.gr\" IP \"151.101.128.204\"\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.918Z\\] app\\_discovery\\_parse\\_dns(): Answers: name: skai.gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.918Z\\] app\\_discovery\\_parse\\_dns(): Answers: Type 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.918Z\\] app\\_discovery\\_parse\\_dns(): Answers: Class 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.918Z\\] app\\_discovery\\_parse\\_dns(): Answers: Length 0x4\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.918Z\\] app\\_discovery\\_parse\\_dns(): Answers: IP 151.101.64.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.919Z\\] app\\_discovery\\_parse\\_dns(): Adding: IP \"151.101.64.204\"\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.919Z\\] app\\_discovery\\_parse\\_dns(): Answers: name: skai.gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.919Z\\] app\\_discovery\\_parse\\_dns(): Answers: Type 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.919Z\\] app\\_discovery\\_parse\\_dns(): Answers: Class 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.919Z\\] app\\_discovery\\_parse\\_dns(): Answers: Length 0x4\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.919Z\\] app\\_discovery\\_parse\\_dns(): Answers: IP 151.101.192.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.920Z\\] app\\_discovery\\_parse\\_dns(): Adding: IP \"151.101.192.204\"\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.920Z\\] app\\_discovery\\_parse\\_dns(): Answers: name: skai.gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.920Z\\] app\\_discovery\\_parse\\_dns(): Answers: Type 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.920Z\\] app\\_discovery\\_parse\\_dns(): Answers: Class 0x1\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.920Z\\] app\\_discovery\\_parse\\_dns(): Answers: Length 0x4\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.928Z\\] app\\_discovery\\_parse\\_dns(): Answers: IP 151.101.0.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.928Z\\] app\\_discovery\\_parse\\_dns(): Adding: IP \"151.101.0.204\"\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.931Z\\] A name part of domain \"skai\" has been found\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.932Z\\] Name: skai.gr\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.932Z\\] IP: 151.101.128.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.932Z\\] IP: 151.101.64.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.932Z\\] IP: 151.101.192.204\n\n\\[tests\\] DEBUG   \\[2018-08-02T15:34:03.932Z\\] IP: 151.101.0.204"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1533224435572
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Logic summary"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "You need at least an entitlement with an Action that allows access to a DNS server"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "cz-vpnd is configured by cz-configd through Admin UI (Site settings) with some pre-configured domains"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "When cz-vpnd sees a DNS response as return traffic (i.e. a DNS request has been sent) it parses the packet and extracts hostnames-IPs"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "The IPs are checked against the tompf binary radix tree and if the IP exists the entry is dropped as it means we already have some IP rule for it"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "The hostname is checked against a cache, that works as statistics as well, to see if we have already discovered this app. If it is already seen entry is dropped"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If we haven't seen it and no IP rule in the tree then vpnd's user-session inform cz-sessiond for the new entry"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "cz-sessiond accumulates all these entries and fine tunes his \"report\". Throws away any duplicate reports (as many sessions can find same App etc etc)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "sessiond can be queried with a GET to return this report"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "curl -H 'Accept: application/vnd.appgate.peer-v9+json' -XGET ["
                        },
                        {
                          "type": "text",
                          "text": "http://localhost:9200/hostnames](http://localhost:9200/hostnames)"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1534755481926
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When you say throw away dupes......are we counting the number of users requesting a discovered app? So we end up with our top 10 most requests?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1536578064066
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " So in terms of output......"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If the user tries youtrack.ad.cryptzone.com"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And I configured"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "1> com"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "2> cryptzone.com"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "3> ad.cryptzone.com"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I guess the table shows "
                },
                {
                  "type": "text",
                  "text": "youtrack.ad.cryptzone.com",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " in all cases."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And the word cloud shows just the word "
                },
                {
                  "type": "text",
                  "text": "youtrack",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 3 times in different colours."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And my app.here.cryptzone.com would only be shown in case 1 and 2."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And youtrack.cryptzone.com would only be shown in case 1 and 2."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1539619936690
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since that would create confusion, we added a validation to the controller so that it won't allow conflicting domain names like that. I think you were in the discussion even when we decided to do that."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1539674651794
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " just checking the eventual outcome (yes I followed the discussion) - so the Controller filters - and will only show one result for youtrack in the above case. But would show it twice (different colours) if it discovered youtrack.cyxtera and youtrack.cryptzone."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1539676227958
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "you can't have the above case."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If you try to set"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\- com\n\n\\- cryptzone.com\n\n\\- ad.cryptzone.com"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " as the app discovery list, controller will say no.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But would show it twice (different colours) if it discovered youtrack.cyxtera and youtrack.cryptzone."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is correct regardless."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1539676405205
      }
    ]
  },
  {
    "key": "SA-8582",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "4.0.1"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[10:32:49\\]\\[sessiond\\] :compileJava\n\n\\[10:32:49\\]\\[sessiond\\] :processResources UP-TO-DATE\n\n\\[10:32:49\\]\\[sessiond\\] :classes\n\n\\[10:32:50\\]\\[sessiond\\] :jar\n\n\\[10:32:50\\]\\[sessiond\\] :startScripts\n\n\\[10:32:51\\]\\[sessiond\\] :distTar\n\n\\[10:32:54\\]\\[sessiond\\] :distZip\n\n\\[10:32:54\\]\\[sessiond\\] :assemble\n\n\\[10:33:07\\]\\[sessiond\\] :fatJarPrepareFiles\n\n\\[10:33:14\\]\\[sessiond\\] :fatJar\n\n\\[10:33:14\\]\\[sessiond\\] \n\n\\[10:33:14\\]\\[sessiond\\] BUILD SUCCESSFUL\n\n\\[10:33:51\\]\\[sessiond\\] Scanning archives (5 / 5)\n\n\\[10:33:51\\]\\[sessiond\\] 2 analysis passes to perform\n\n\\[10:33:54\\]\\[sessiond\\] Pass 1: Analyzing classes (800 / 800) - 100% complete\n\n\\[10:34:05\\]\\[sessiond\\] Pass 2: Analyzing classes (373 / 373) - 100% complete\n\n\\[10:34:05\\]\\[sessiond\\] Done with analysis"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "master"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "..........\n\n\\[18:10:25\\]\\[sessiond\\] Download ["
            },
            {
              "type": "text",
              "text": "https://akira.ad.cryptzone.com:8443/repository/central/org/yaml/snakeyaml/1.18/snakeyaml-1.18.jar](https://akira.ad.cryptzone.com:8443/repository/central/org/yaml/snakeyaml/1.18/snakeyaml-1.18.jar)"
            },
            {
              "type": "text",
              "text": "\n\n\\[18:10:38\\]\\[sessiond\\] :processResources NO-SOURCE\n\n\\[18:10:38\\]\\[sessiond\\] :classes\n\n\\[18:10:45\\]\\[sessiond\\] :shadowJar\n\n\\[18:10:45\\]\\[sessiond\\] \n\n\\[18:10:45\\]\\[sessiond\\] Deprecated Gradle features were used in this build, making it incompatible with Gradle 5.0.\n\n\\[18:10:45\\]\\[sessiond\\] See ["
            },
            {
              "type": "text",
              "text": "https://docs.gradle.org/4.6/userguide/command\\_line\\_interface.html#sec:command\\_line\\_warnings](https://docs.gradle.org/4.6/userguide/command_line_interface.html#sec:command_line_warnings)"
            },
            {
              "type": "text",
              "text": "\n\n\\[18:10:45\\]\\[sessiond\\] \n\n\\[18:10:45\\]\\[sessiond\\] BUILD SUCCESSFUL in 33s\n\n\\[18:10:45\\]\\[sessiond\\] 2 actionable tasks: 2 executed\n\n\\[18:10:46\\]\\[sessiond\\] make\\[3\\]: Leaving directory '/home/builderbob/buildAgent/work/90bd72f62fc75cc4/sessiond'\n\n\\[18:10:46\\]\\[sessiond\\] \\[WARNING\\] Emitted 0 Java compilation units (0%) successfully"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Digging notes: Last ever successful master was on 18th April 2018. It broke on 23rd of April 2018. Let's see what was committed in between"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1528970009383
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Bullshit. I don't see any commit in these dates that would cause it"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "kosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-gateway$ git log --since=\"2018-04-18\" --until=\"2018-04-25\" --pretty=oneline\n\ncbbd1aa9f966a88c4c6bd49a799b8debfe7dfb35 Merge pull request #1665 from cryptzone/beta\n\n989755c5e8a16dbfc9dd0417e8a89412e923cd06 Merge pull request #1664 from cryptzone/fix\\_reload\\_multicast\\_join\\_beta\n\n6986b3e2a0865e8536f897dfb0d613d743655fb4 cz-had Fix Daemon was not rejoining the multicast groups after reload\n\n3200cca5896955d7985b081be0108eae3375bdd7 Merge pull request #1663 from cryptzone/merge-beta-to-master\n\n9b11bd28081a13d3b7ce8e59f6848a868756993e Merge remote-tracking branch 'upstream/beta'\n\n79b2c78d95059117ff18af82b244f238bc5d768f Merge pull request #1658 from cryptzone/feature/vpnd-packet-batches\n\n1cdac7767cd9aa97f168f32058332af959056d6c vpnd: update expired test certs\n\nf18b5602f7b3db34e3e6ab3583a2c575c350c668 bump VERSION to 4.0.1\n\n22872b26c2e526757fc98f47232fb3d678769e27 vpnd: add support for writing packet batches\n\nbd77ff9559aa551f78f9a658ed532a775c02cb2a Merge pull request #1662 from cryptzone/proxyd\\_console\\_netfilter\n\ncbc4a085a79adda069a5adfa6ef9cf2479d314a6 cz-proxyd Add SYN segments dropped on 443 in the console output\n\nkosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-gateway$ "
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe looking the wrong dates"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1528970856555
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The only interesting is that in the 4.0.1 building output it says"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[10:32:49\\]\\[sessiond\\] :compileJava\n\n\\[10:32:49\\]\\[sessiond\\] :processResources UP-TO-DATE\n\n\\[10:32:49\\]\\[sessiond\\] :classes\n\n..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " i.e. classes => compilation units to be analysed"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "while the problematic master case doesn't mention this... (check description)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Anyways no super quick way to fix this as I hope for. Needs gradle doc reading to what is doing with the classes :/"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1528971072067
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed itself by upgrading to latest coverity"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1541428124016
      }
    ]
  },
  {
    "key": "SA-8583",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "GCE purple logs:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 14 11:17:25 purple30.cryptzone.com cz-dhcp.start\\[881\\]: bound to 10.132.0.2 -- renewal in 39139 seconds.\n\nJun 14 11:17:25 purple30.cryptzone.com cz-ntpd-restart\\[1010\\]: Running one-shot time synchronization\n\nJun 14 11:17:25 purple30.cryptzone.com cz-ntpd-restart\\[1013\\]: Stopping ntp and running ntpdate\n\nJun 14 11:17:25 purple30.cryptzone.com systemd\\[1\\]: Stopped LSB: Start NTP daemon.\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: ERROR \\[ActionsRunner\\] Unhandled error while running action ApplyServicesAction(force=True), carry on...\n\n                                                        Traceback (most recent call last):\n\n                                                          File \"/usr/cz-configd/configd/action/actions\\_runner.py\", line 122, in run\n\n                                                            action\\_result = action()\n\n                                                          File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 171, in \\_\\_call\\_\\_\n\n                                                            force\\_f=lambda name: should\\_restart\\_services.get(name, False))\n\n                                                          File \"/usr/cz-configd/configd/role/base.py\", line 35, in apply\n\n                                                            service.apply(enabled\\_f=enabled, checksum\\_f=checksum\\_f, force\\_f=forced)\n\n                                                          File \"/usr/cz-configd/configd/service/services.py\", line 163, in apply\n\n                                                            reload\\_action=self.reload\\_action, message=', '.join(messages)):\n\n                                                          File \"/usr/cz-configd/configd/ntp.py\", line 58, in control\\_job\n\n                                                            with utils.flock(Path('/run/lock/ntpdate'), timeout=0):\n\n                                                          File \"/usr/lib/python3.5/contextlib.py\", line 59, in \\_\\_enter\\_\\_\n\n                                                            return next(self.gen)\n\n                                                          File \"/usr/cz-configd/configd/utils.py\", line 514, in flock\n\n                                                            fd = acquire\\_lock(file=file, timeout=timeout)\n\n                                                          File \"/usr/cz-configd/configd/utils.py\", line 502, in acquire\\_lock\n\n                                                            raise Exception('Failed to acquire {} lock after {} seconds'.format(file, timeout))\n\n                                                        Exception: Failed to acquire /run/lock/ntpdate lock after 0 seconds\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action InitCloudServiceAction(cloud\\_service=GceCloudService(name='GCE', cloud\\_init\\_url='["
            },
            {
              "type": "text",
              "text": "http://metadata.google.internal/computeMetadata/v1'](http://metadata.google.internal/computeMetadata/v1')))"
            },
            {
              "type": "text",
              "text": " ...\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[InitCloudServiceAction\\] Initializing cloud service\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] InitCloudServiceAction done\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action CreateCloudSSHKeysAction(cloud\\_service=GceCloudService(name='GCE', cloud\\_init\\_url='["
            },
            {
              "type": "text",
              "text": "http://metadata.google.internal/computeMetadata/v1'](http://metadata.google.internal/computeMetadata/v1'))"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " next\\_sta\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[CreateCloudSSHKeysAction\\] Getting OpenSSH public key\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] CreateCloudSSHKeysAction done\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Chaining event UserCredentialsEvent(user\\_credentials=(cz, \\*\\*\\*\\*\\*\\*), next\\_state=APPLIANCE\\_READY)\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[transition\\] Found an OpenSSH public key, applying it\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[transition\\] Enabling ssh server\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[StateMachine\\] Received event UserCredentialsEvent(user\\_credentials=(cz, \\*\\*\\*\\*\\*\\*), next\\_state=APPLIANCE\\_READY), staying in state cloud\\_initializing\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO Initializing user credentials on GCE\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action CommitConfigAction ...\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[CommitConfigAction\\]  Configuration unchanged, skipping commit\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] CommitConfigAction done\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action ApplyServicesAction(force=False) ...\n\nJun 14 11:17:26 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ApplyServicesAction\\] Applying services configuration with current configuration /mnt/state/config/20180612-133803-s72sqog9 and previous configuration /mnt/state/config/2018061\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: ERROR \\[ActionsRunner\\] Unhandled error while running action ApplyServicesAction(force=False), carry on...\n\n                                                        Traceback (most recent call last):\n\n                                                          File \"/usr/cz-configd/configd/action/actions\\_runner.py\", line 122, in run\n\n                                                            action\\_result = action()\n\n                                                          File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 171, in \\_\\_call\\_\\_\n\n                                                            force\\_f=lambda name: should\\_restart\\_services.get(name, False))\n\n                                                          File \"/usr/cz-configd/configd/role/base.py\", line 35, in apply\n\n                                                            service.apply(enabled\\_f=enabled, checksum\\_f=checksum\\_f, force\\_f=forced)\n\n                                                          File \"/usr/cz-configd/configd/service/services.py\", line 163, in apply\n\n                                                            reload\\_action=self.reload\\_action, message=', '.join(messages)):\n\n                                                          File \"/usr/cz-configd/configd/ntp.py\", line 58, in control\\_job\n\n                                                            with utils.flock(Path('/run/lock/ntpdate'), timeout=0):\n\n                                                          File \"/usr/lib/python3.5/contextlib.py\", line 59, in \\_\\_enter\\_\\_\n\n                                                            return next(self.gen)\n\n                                                          File \"/usr/cz-configd/configd/utils.py\", line 514, in flock\n\n                                                            fd = acquire\\_lock(file=file, timeout=timeout)\n\n                                                          File \"/usr/cz-configd/configd/utils.py\", line 502, in acquire\\_lock\n\n                                                            raise Exception('Failed to acquire {} lock after {} seconds'.format(file, timeout))\n\n                                                        Exception: Failed to acquire /run/lock/ntpdate lock after 0 seconds\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action GetCloudDataAction(cloud\\_service=GceCloudService(name='GCE', cloud\\_init\\_url='["
            },
            {
              "type": "text",
              "text": "http://metadata.google.internal/computeMetadata/v1'](http://metadata.google.internal/computeMetadata/v1'))"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " next\\_state='ap\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[GetCloudDataAction\\] We are running in the cloud: GCE\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[GetCloudDataAction\\] Verifying cloud instance...\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[GetCloudDataAction\\] Getting license type if available\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[GetCloudDataAction\\] No license type found\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] GetCloudDataAction done\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Chaining event CloudSeedConfigEvent(next\\_state=<StratusStateLabel.APPLIANCE\\_READY: 'appliance\\_ready'>, rc\\_script=None, license\\_type=None)\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action FinishCloudServiceAction(cloud\\_service=GceCloudService(name='GCE', cloud\\_init\\_url='["
            },
            {
              "type": "text",
              "text": "http://metadata.google.internal/computeMetadata/v1'](http://metadata.google.internal/computeMetadata/v1')))"
            },
            {
              "type": "text",
              "text": " ...\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[FinishCloudServiceAction\\] Finishing cloud service\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] FinishCloudServiceAction done\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[StateMachine\\] Received event CloudSeedConfigEvent(next\\_state=<StratusStateLabel.APPLIANCE\\_READY: 'appliance\\_ready'>, rc\\_script=None, license\\_type=None), transitioning from sta\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action CommitConfigAction ...\n\n.....\n\n....\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: ERROR \\[ActionsRunner\\] Unhandled error while running action ApplyBasicServicesAction(force=False), carry on...\n\n                                                        Traceback (most recent call last):\n\n                                                          File \"/usr/cz-configd/configd/action/actions\\_runner.py\", line 122, in run\n\n                                                            action\\_result = action()\n\n                                                          File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 200, in \\_\\_call\\_\\_\n\n                                                            extra\\_enabled\\_f=lambda name: enabled\\_services.get(name, True))\n\n                                                          File \"/usr/cz-configd/configd/role/base.py\", line 35, in apply\n\n                                                            service.apply(enabled\\_f=enabled, checksum\\_f=checksum\\_f, force\\_f=forced)\n\n                                                          File \"/usr/cz-configd/configd/service/services.py\", line 163, in apply\n\n                                                            reload\\_action=self.reload\\_action, message=', '.join(messages)):\n\n                                                          File \"/usr/cz-configd/configd/ntp.py\", line 58, in control\\_job\n\n                                                            with utils.flock(Path('/run/lock/ntpdate'), timeout=0):\n\n                                                          File \"/usr/lib/python3.5/contextlib.py\", line 59, in \\_\\_enter\\_\\_\n\n                                                            return next(self.gen)\n\n                                                          File \"/usr/cz-configd/configd/utils.py\", line 514, in flock\n\n                                                            fd = acquire\\_lock(file=file, timeout=timeout)\n\n                                                          File \"/usr/cz-configd/configd/utils.py\", line 502, in acquire\\_lock\n\n                                                            raise Exception('Failed to acquire {} lock after {} seconds'.format(file, timeout))\n\n                                                        Exception: Failed to acquire /run/lock/ntpdate lock after 0 seconds\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: INFO \\[ActionsRunner\\] Running action ApplianceStartedAction() ...\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: {\"event\\_type\": \"appliance\\_started\", \"id\": \"6bf9fbe4-f9ec-4ed2-84cc-fd768f60824c\", \"timestamp\": \"2018-06-14T11:17:27.345558Z\", \"hostname\": \"purple30.cryptzone.com\", \"version\": 8, \"ap\n\nJun 14 11:17:27 purple30.cryptzone.com cz-configd\\[622\\]: \\[logc\\] \\[WARNING\\]: Could not connect to logc on socket: /run/cz-log/cz-logd.socket errno: 2, str: No such file or directory uid: 0\n\nJun 14 11:17:57 purple30.cryptzone.com cz-dhcp.start\\[881\\]: 14 Jun 11:17:57 ntpdate\\[1039\\]: adjust time server 94.143.184.140 offset 0.137800 sec\n\nJun 14 11:17:57 purple30.cryptzone.com systemd\\[1\\]: Starting LSB: Start NTP daemon...\n\nJun 14 11:17:57 purple30.cryptzone.com ntp\\[1295\\]:  \\* Starting NTP server ntpd\n\nJun 14 11:17:58 purple30.cryptzone.com ntpd\\[1302\\]: ntpd 4.2.8p4@1.3265-o Wed Feb 14 14:56:29 UTC 2018 (1): Starting\n\nJun 14 11:17:58 purple30.cryptzone.com ntpd\\[1302\\]: Command line: /usr/sbin/ntpd -p /var/run/ntpd.pid -g -u 105:108\n\nJun 14 11:17:58 purple30.cryptzone.com ntp\\[1295\\]:    ...done."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2149",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2149"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530693150893
      }
    ]
  },
  {
    "key": "SA-8596",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@helvetest-prod:~# cat file\n\n\\-- Logs begin at Sun 2018-04-29 05:25:26 CEST, end at Fri 2018-06-15 11:33:59 CEST. --\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: Authenticated hadrien-luttiau \\[in resthelpers.wrapper\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Creating execution: CreateEnvironment(scenario='simple\\_v4', test\\_project\\_id=7, appliance=ApplianceBuildNumberDependencyRequest(branch='master', build\\_number=None, build\\_id=None), tags=\\['test SAML'\\], keep\\_environment\\_on\\_spawn\\_error=False, custom\\_envy=None, log\\_levels=\\[\\], allow\\_subnets=\\[\\]) \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Validating scenario \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Validating appliance and tests config \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: Authenticated per-leino as devops \\[in resthelpers.wrapper\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:57:04 +0000\\] \"GET /api/executions HTTP/1.0\" 200 1835 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Validating appliance artifacts \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:57:03 +0000\\] \"POST /api/executions HTTP/1.0\" 200 1090 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Starting the machine \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Received event QueuedExecution() \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Transitioning from state TestsdStateLabel.EXECUTION\\_INITIALIZING to TestsdStateLabel.EXECUTION\\_INITIALIZED \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Running action ChainEventAction(event=InitializedExecution(), delay=None, priority=None) ... \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] ChainEventAction done \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Chaining event InitializedExecution() \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', state\\_label='execution-initialized') ... \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Received event InitializedExecution() \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Transitioning from state TestsdStateLabel.EXECUTION\\_INITIALIZED to TestsdStateLabel.QUEUING\\_ENVIRONMENT\\_CREATION \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Running action CreateEnvironmentAction(execution\\_id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', appliance\\_build=Build(id=303078, number=10358, web\\_url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303078&buildTypeId=StratusAppliance\\_BuildStratusAppliance\\_2'](https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303078&buildTypeId=StratusAppliance_BuildStratusAppliance_2'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " log\\_levels={}, authorized\\_key=None, who='hadrien-luttiau', id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', scenario=Scenario(id='simple\\_v4', nodes=\\[ScenarioNode(name='controller', roles=\\['controller', 'logserver'\\]), ScenarioNode(name='gateway', roles=\\['gateway'\\]), ScenarioNode(name='endpoint', roles=\\['endpoint'\\])\\]), allow\\_subnets=\\[\\], branch='master', project\\_id=7, envy=Envy(url='["
                },
                {
                  "type": "text",
                  "text": "https://envy.devops'](https://envy.devops')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] queueing environment creation \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] CreateEnvironmentAction done \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Chaining event QueuedEnvironmentCreation(environment=Environment(id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', nodes=\\[\\], scenario=Scenario(id='simple\\_v4', nodes=\\[ScenarioNode(name='controller', roles=\\['controller', 'logserver'\\]), ScenarioNode(name='gateway', roles=\\['gateway'\\]), ScenarioNode(name='endpoint', roles=\\['endpoint'\\])\\]))) \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', state\\_label='queuing-environment-creation') ... \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Received event QueuedEnvironmentCreation(environment=Environment(id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', nodes=\\[\\], scenario=Scenario(id='simple\\_v4', nodes=\\[ScenarioNode(name='controller', roles=\\['controller', 'logserver'\\]), ScenarioNode(name='gateway', roles=\\['gateway'\\]), ScenarioNode(name='endpoint', roles=\\['endpoint'\\])\\]))) \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] Transitioning from state TestsdStateLabel.QUEUING\\_ENVIRONMENT\\_CREATION to TestsdStateLabel.BUILDING\\_ENVIRONMENT \\[in logger.info\\]\n\nJun 14 15:57:04 helvetest-prod helvetest\\[57\\]: \\[0b9b4128-50c3-4103-91ba-8d75ab7bbdbd\\] \\[ActionRunner\\] Running action OpenWebsocketClientAction(execution\\_id='0b9b4128-50c3-4103-91ba-8d75ab7bbdbd', scenario=Scenario(id='simple\\_v4', nodes=\\[ScenarioNode(name='controller', roles=\\['controller', 'logserver'\\]), ScenarioNode(name='gateway', roles=\\['gateway'\\]), ScenarioNode(name='endpoint', roles=\\['endpoint'\\])\\]), envy=Envy(url='["
                },
                {
                  "type": "text",
                  "text": "https://envy.devops'](https://envy.devops')))"
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303058'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303058')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: Authenticated aitorbot as devops \\[in resthelpers.wrapper\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Cancelling event with reason Deleted by owner aitorbot github\\_report: True statsd\\_report: True testrail\\_report True \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:18 +0000\\] \"DELETE /api/executions/142916a9-c4ef-470b-bba2-225374bb0a54?report-statsd=True&report-github=True&report-testrail=True HTTP/1.0\" 200 149 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Received event CancelledExecution(reason='Deleted by owner aitorbot', report\\_to\\_github=True, report\\_to\\_testrail=True, report\\_to\\_statsd=True) \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Transitioning from state TestsdStateLabel.RUNNING\\_TESTPLAN to TestsdStateLabel.STOPPED\\_EXECUTION \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action CancelTeamCityBuildAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', reason='Deleted by owner aitorbot', queued\\_build=QueuedBuild(id=303075, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303075'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303075')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] CancelTeamCityBuildAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action UpdateTestResultsAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', test\\_cases=\\[TestResult(type='TestCaseCancelled', suite\\_id=450253, case\\_id=867662), TestResult(type='TestCaseCancelled', suite\\_id=450253, case\\_id=867663), TestResult(type='TestCaseCancelled', suite\\_id=450253, case\\_id=27752253)\\], comment='') ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] Reporting test results: test run: 450253, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450253, case\\_id=867662), TestResult(type='TestCaseCancelled', suite\\_id=450253, case\\_id=867663), TestResult(type='TestCaseCancelled', suite\\_id=450253, case\\_id=27752253)\\] \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] UpdateTestResultsAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action UpdateTestPlanCommentAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', state\\_label='stopped-execution') ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] Updating TestPlan id: 450251 \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] CancelTeamCityBuildAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action UpdateTestResultsAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', test\\_cases=\\[TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=34825832), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=867662), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=867663), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=6129266), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=867670), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=2150543), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=63383057), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=82328831), TestResult(type='TestCaseCancelled', suite\\_id=450268, case\\_id=16505594), TestResult(type='TestCaseCancelled', suite\\_id=450268, case\\_id=23689716), TestResult(type='TestCaseCancelled', suite\\_id=450268, case\\_id=23689719)\\], comment='') ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Reporting test results: test run: 450268, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=34825832), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=867662), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=867663), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=6129266), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=867670), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=2150543), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=63383057), TestResult(type='TestCaseCancelled', suite\\_id=450267, case\\_id=82328831)\\] \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: Authenticated aitorbot as devops \\[in resthelpers.wrapper\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Cancelling event with reason Deleted by owner aitorbot github\\_report: True statsd\\_report: True testrail\\_report True \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:18 +0000\\] \"DELETE /api/executions/8fe68702-efb8-45f1-a2ec-79edcc552086?report-statsd=True&report-github=True&report-testrail=True HTTP/1.0\" 200 149 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Received event CancelledExecution(reason='Deleted by owner aitorbot', report\\_to\\_github=True, report\\_to\\_testrail=True, report\\_to\\_statsd=True) \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Transitioning from state TestsdStateLabel.RUNNING\\_TESTPLAN to TestsdStateLabel.STOPPED\\_EXECUTION \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] \\[ActionRunner\\] Running action CancelTeamCityBuildAction(execution\\_id='8fe68702-efb8-45f1-a2ec-79edcc552086', reason='Deleted by owner aitorbot', queued\\_build=QueuedBuild(id=303088, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303088'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303088')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] UpdateTestPlanCommentAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action CloseTestRailTestPlanAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', plan\\_id=450251) ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] Closing TestPlan 450251 \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Reporting test results: test run: 450268, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450268, case\\_id=16505594), TestResult(type='TestCaseCancelled', suite\\_id=450268, case\\_id=23689716), TestResult(type='TestCaseCancelled', suite\\_id=450268, case\\_id=23689719)\\] \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: Got TeamCity WebHook event: TeamCityWebHookEvent(branch\\_name='450251', branch\\_display\\_name='450251', branch\\_is\\_default='false', timestamp='2018-06-14T15:58:18.846+02:00', build\\_event=<TeamCityWebHookEventType.BUILD\\_INTERRUPTED: 'buildInterrupted'>, build\\_name='E2E testy Android (runner)', build\\_status\\_url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyAndroidRunner&buildId=303058'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner&buildId=303058')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " build\\_number='6973', triggered\\_by='testyd', build\\_result=<TeamCityWebHookBuildResult.RUNNING: 'running'>, build\\_result\\_previous=<TeamCityWebHookBuildResult.FAILURE: 'failure'>, build\\_result\\_delta='unknown') \\[in service.\\_teamcity\\_webhook\\_event\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] Got test build failed notification, queuing event:: CancelledExecution(reason='Teamcity test build cancelled: ["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyAndroidRunner&buildId=303058'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner&buildId=303058')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " report\\_to\\_github=True, report\\_to\\_testrail=True, report\\_to\\_statsd=True) \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:18 +0000\\] \"POST /api/project/7/test-project/build/status HTTP/1.0\" 202 155 \"-\" \"Apache-HttpClient/4.5.4 (Java/1.8.0\\_111)\" \\[in helpers.log\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] UpdateTestResultsAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action UpdateTestPlanCommentAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', state\\_label='stopped-execution') ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Updating TestPlan id: 450265 \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] UpdateTestPlanCommentAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action CloseTestRailTestPlanAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', plan\\_id=450265) ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Closing TestPlan 450265 \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] CloseTestRailTestPlanAction done \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action ReportStatsdOngoingAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', ongoing=False, purpose='commit', client='android', user='aitorbot', tags=\\['hourly\\_android'\\]) ... \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: Got TeamCity WebHook event: TeamCityWebHookEvent(branch\\_name='450265', branch\\_display\\_name='450265', branch\\_is\\_default='false', timestamp='2018-06-14T15:58:19.033+02:00', build\\_event=<TeamCityWebHookEventType.BUILD\\_INTERRUPTED: 'buildInterrupted'>, build\\_name='E2E testy Windows (runner)', build\\_status\\_url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyWindowsRunner&buildId=303075'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyWindowsRunner&buildId=303075')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " build\\_number='22397', triggered\\_by='testyd', build\\_result=<TeamCityWebHookBuildResult.RUNNING: 'running'>, build\\_result\\_previous=<TeamCityWebHookBuildResult.SUCCESS: 'success'>, build\\_result\\_delta='unknown') \\[in service.\\_teamcity\\_webhook\\_event\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Got test build failed notification, queuing event:: CancelledExecution(reason='Teamcity test build cancelled: ["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyWindowsRunner&buildId=303075'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyWindowsRunner&buildId=303075')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " report\\_to\\_github=True, report\\_to\\_testrail=True, report\\_to\\_statsd=True) \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:18 +0000\\] \"POST /api/project/7/test-project/build/status HTTP/1.0\" 202 155 \"-\" \"Apache-HttpClient/4.5.4 (Java/1.8.0\\_111)\" \\[in helpers.log\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: Got TeamCity WebHook event: TeamCityWebHookEvent(branch\\_name='450269', branch\\_display\\_name='450269', branch\\_is\\_default='false', timestamp='2018-06-14T15:58:19.038+02:00', build\\_event=<TeamCityWebHookEventType.BUILD\\_INTERRUPTED: 'buildInterrupted'>, build\\_name='E2E testy Linux (runner)', build\\_status\\_url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=303088'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=303088')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " build\\_number='35213', triggered\\_by='testyd', build\\_result=<TeamCityWebHookBuildResult.RUNNING: 'running'>, build\\_result\\_previous=<TeamCityWebHookBuildResult.SUCCESS: 'success'>, build\\_result\\_delta='unknown') \\[in service.\\_teamcity\\_webhook\\_event\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Got test build failed notification, queuing event:: CancelledExecution(reason='Teamcity test build cancelled: ["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2&buildId=303088'](https://teamcity.ad.cryptzone.com/viewLog.html?buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyLinuxRunner2&buildId=303088')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " report\\_to\\_github=True, report\\_to\\_testrail=True, report\\_to\\_statsd=True) \\[in logger.info\\]\n\nJun 14 15:58:18 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:18 +0000\\] \"POST /api/project/7/test-project/build/status HTTP/1.0\" 202 155 \"-\" \"Apache-HttpClient/4.5.4 (Java/1.8.0\\_111)\" \\[in helpers.log\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] CloseTestRailTestPlanAction done \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action ReportStatsdOngoingAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', ongoing=False, purpose='commit', client='windows', user='aitorbot', tags=\\['hourly\\_windows'\\]) ... \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] ReportStatsdOngoingAction done \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action ReportStatsdResultAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', purpose='commit', client='android', user='aitorbot', tags=\\['hourly\\_android'\\], passed=12, failed=5) ... \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] ReportStatsdOngoingAction done \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action ReportStatsdResultAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', purpose='commit', client='windows', user='aitorbot', tags=\\['hourly\\_windows'\\], passed=15, failed=12) ... \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] ReportStatsdResultAction done \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action DestroyEnvironmentAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', envy=Envy(url='["
                },
                {
                  "type": "text",
                  "text": "https://envy.devops'](https://envy.devops')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] DestroyEnvironmentAction done \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='63ab82ff-68ff-42ee-b1dc-7733039cff54', state\\_label='stopped-execution') ... \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:19 helvetest-prod helvetest\\[57\\]: \\[63ab82ff-68ff-42ee-b1dc-7733039cff54\\] Reached final state, stopping state machine \\[in logger.info\\]\n\nJun 14 15:58:20 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] ReportStatsdResultAction done \\[in logger.info\\]\n\nJun 14 15:58:20 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action DestroyEnvironmentAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', envy=Envy(url='["
                },
                {
                  "type": "text",
                  "text": "https://envy.devops'](https://envy.devops')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:58:20 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] DestroyEnvironmentAction done \\[in logger.info\\]\n\nJun 14 15:58:20 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='142916a9-c4ef-470b-bba2-225374bb0a54', state\\_label='stopped-execution') ... \\[in logger.info\\]\n\nJun 14 15:58:20 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:20 helvetest-prod helvetest\\[57\\]: \\[142916a9-c4ef-470b-bba2-225374bb0a54\\] Reached final state, stopping state machine \\[in logger.info\\]\n\nJun 14 15:58:24 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:24 +0000\\] \"POST /api/executions/35058cbb-9ee0-42db-9d8b-86039968616b/running-testplan/finished-testcase HTTP/1.0\" 202 155 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:24 helvetest-prod helvetest\\[57\\]: \\[35058cbb-9ee0-42db-9d8b-86039968616b\\] Received event FinishedTestCase(actual\\_tags=\\['3721425'\\], result=None, test\\_id=6666, case\\_id=3721425, time='2018-06-14T13:58:24,949233Z', ident='testy', suite\\_id=450263, test\\_uuid='35058cbb-9ee0-42db-9d8b-86039968616b', start\\_time='2018-06-14T13:58:13,333563Z', running\\_time=11, status='PASSED', exception\\_string=None, stack\\_trace=None, module\\_name='foundation1/foundation1\\_dtls', purpose='commit', reason=None) \\[in logger.info\\]\n\nJun 14 15:58:24 helvetest-prod helvetest\\[57\\]: \\[35058cbb-9ee0-42db-9d8b-86039968616b\\] Staying in state TestsdStateLabel.RUNNING\\_TESTPLAN: Report test case 3721425 status TestCasePassed \\[in logger.info\\]\n\nJun 14 15:58:24 helvetest-prod helvetest\\[57\\]: \\[35058cbb-9ee0-42db-9d8b-86039968616b\\] \\[ActionRunner\\] Running action ReportTestCaseAction(execution\\_id='35058cbb-9ee0-42db-9d8b-86039968616b', test\\_case=TestResult(type='TestCasePassed', suite\\_id=450263, case\\_id=3721425), comment='Test case succeeded!') ... \\[in logger.info\\]\n\nJun 14 15:58:25 helvetest-prod helvetest\\[57\\]: \\[35058cbb-9ee0-42db-9d8b-86039968616b\\] \\[ActionRunner\\] ReportTestCaseAction done \\[in logger.info\\]\n\nJun 14 15:58:25 helvetest-prod helvetest\\[57\\]: \\[35058cbb-9ee0-42db-9d8b-86039968616b\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='35058cbb-9ee0-42db-9d8b-86039968616b', state\\_label='running-testplan') ... \\[in logger.info\\]\n\nJun 14 15:58:25 helvetest-prod helvetest\\[57\\]: \\[35058cbb-9ee0-42db-9d8b-86039968616b\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:27 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:27 +0000\\] \"GET /api/project/7/master/clients HTTP/1.0\" 200 212 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: Authenticated salvatore-tomaselli as devops \\[in resthelpers.wrapper\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:27 +0000\\] \"GET /api/executions/3f066e4d-7809-445c-903b-fb96d0ec2071 HTTP/1.0\" 200 8690 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:28 +0000\\] \"GET /api/scenarios/simple\\_v4 HTTP/1.0\" 200 338 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:28 +0000\\] \"GET /api/executions-ips HTTP/1.0\" 200 878 \"-\" \"AppGate Policy Evaluator/1.0\" \\[in helpers.log\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:28 +0000\\] \"GET /api/executions-ips HTTP/1.0\" 200 878 \"-\" \"AppGate Policy Evaluator/1.0\" \\[in helpers.log\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: Authenticated salvatore-tomaselli as devops \\[in resthelpers.wrapper\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Creating execution: CreateTest(purpose='custom', case\\_ids=\\[19625268\\], scenario='simple\\_v4', test\\_project\\_id=7, appliance=ApplianceBuildNumberDependencyRequest(branch='master', build\\_number=None, build\\_id=None), environment=EnvironmentSpec(id='3f066e4d-7809-445c-903b-fb96d0ec2071', nodes=\\[VMNode(name='controller', status='Running', roles=\\['controller', 'logserver'\\], ip='172.17.124.1', network='172.17.124.0/24', hostname='envy-172-17-124-1.devops', admin\\_username='admin', admin\\_password='admin', ssh\\_key=None), VMNode(name='gateway', status='Running', roles=\\['gateway'\\], ip='172.17.124.2', network='172.17.124.0/24', hostname='envy-172-17-124-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None), VMNode(name='endpoint', status='Running', roles=\\['endpoint'\\], ip='172.17.121.2', network='172.17.121.0/24', hostname='envy-172-17-121-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None)\\]), testy=TestyDependencyRequest(default\\_branch='master', dependencies=\\[\\]), pullrequest=None, client='linux', level='STREAM', tags=\\[\\], environment\\_vars=\\[\\], use\\_agent=True, keep\\_environment\\_on\\_spawn\\_error=False, keep\\_environment\\_on\\_test\\_error=False, custom\\_envy=None, log\\_levels=\\[\\], allow\\_subnets=\\[\\]) \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating scenario \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating appliance and tests config \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating appliance artifacts \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating custom environment \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating client \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating purpose \\[in logger.info\\]\n\nJun 14 15:58:28 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating test cases \\[in logger.info\\]\n\nJun 14 15:58:29 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Got test suites \\[TestSuite(id=196, project\\_id=7, name='Controller - AppGate Secure Access', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/196'](https://testrail.ad.cryptzone.com/index.php?/suites/view/196'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=197, project\\_id=7, name='Gateway - AppGate Secure Access', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/197'](https://testrail.ad.cryptzone.com/index.php?/suites/view/197'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=198, project\\_id=7, name='Client - AppGate Secure Access', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/198'](https://testrail.ad.cryptzone.com/index.php?/suites/view/198'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=199, project\\_id=7, name='System - AppGate Secure Access', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/199'](https://testrail.ad.cryptzone.com/index.php?/suites/view/199'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=210, project\\_id=7, name='Admin UI - AppGate Secure Access', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/210'](https://testrail.ad.cryptzone.com/index.php?/suites/view/210'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=225, project\\_id=7, name='LogServer - AppGate Secure Access', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/225'](https://testrail.ad.cryptzone.com/index.php?/suites/view/225'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=21684, project\\_id=7, name='Documentation', url='["
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "Roy.nard",
        "created": 1529402199470
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/21684'](https://testrail.ad.cryptzone.com/index.php?/suites/view/21684'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=33958, project\\_id=7, name='Release Test - Appliance', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/33958'](https://testrail.ad.cryptzone.com/index.php?/suites/view/33958'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=33959, project\\_id=7, name='Release Test - Client', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/33959'](https://testrail.ad.cryptzone.com/index.php?/suites/view/33959'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=33960, project\\_id=7, name='Release Test - Controller', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/33960'](https://testrail.ad.cryptzone.com/index.php?/suites/view/33960'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=33961, project\\_id=7, name='Release Test - Gateway', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/33961'](https://testrail.ad.cryptzone.com/index.php?/suites/view/33961'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " TestSuite(id=33962, project\\_id=7, name='Release Test - Logging', url='["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/suites/view/33962'](https://testrail.ad.cryptzone.com/index.php?/suites/view/33962'))\\]"
                },
                {
                  "type": "text",
                  "text": " \\[in logger.info\\]\n\nJun 14 15:58:30 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Validating test config \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Starting the machine \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Received event QueuedExecution() \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Transitioning from state TestsdStateLabel.EXECUTION\\_INITIALIZING to TestsdStateLabel.EXECUTION\\_INITIALIZED: Creating test plan \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action ReportStatsdOngoingAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', ongoing=True, purpose='custom', client='linux', user='salvatore-tomaselli', tags=\\[\\]) ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] ReportStatsdOngoingAction done \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action CreateTestPlanAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', execution=Execution(id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', version=2, user='salvatore-tomaselli', time='1528984711108.8767', tags=\\[\\], test\\_project\\_id=7, environment\\_data=EnvironmentData(keep\\_environment\\_on\\_spawn\\_error=False, environment=Environment(id='3f066e4d-7809-445c-903b-fb96d0ec2071', nodes=\\[VMNode(name='controller', status='Running', roles=\\['controller', 'logserver'\\], ip='172.17.124.1', network='172.17.124.0/24', hostname='envy-172-17-124-1.devops', admin\\_username='admin', admin\\_password='admin', ssh\\_key=None), VMNode(name='gateway', status='Running', roles=\\['gateway'\\], ip='172.17.124.2', network='172.17.124.0/24', hostname='envy-172-17-124-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None), VMNode(name='endpoint', status='Running', roles=\\['endpoint'\\], ip='172.17.121.2', network='172.17.121.0/24', hostname='envy-172-17-121-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None)\\], scenario=Scenario(id='simple\\_v4', nodes=\\[ScenarioNode(name='controller', roles=\\['controller', 'logserver'\\]), ScenarioNode(name='gateway', roles=\\['gateway'\\]), ScenarioNode(name='endpoint', roles=\\['endpoint'\\])\\])), allow\\_subnets=\\[\\], envy=Envy(url='["
                },
                {
                  "type": "text",
                  "text": "https://envy.devops'](https://envy.devops'))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " appliance\\_build=ApplianceBuild(appliance\\_build\\_resolved=ApplianceBuildNumberDependencyResolved(branch='master', build\\_number=10358, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303078&buildTypeId=StratusAppliance\\_BuildStratusAppliance\\_2'](https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303078&buildTypeId=StratusAppliance_BuildStratusAppliance_2')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " type='ApplianceBuildNumberResolved'), queued\\_build=None), log\\_levels=\\[\\]), test\\_data=TestData(purpose='custom', test\\_build=TestBuild(testy\\_build\\_resolved=TestsArtifactsDependencyResolved(artifacts=\\[ArtifactDependency(project='testyd', branch='master', build\\_number=1923, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=301678&buildTypeId=Testyd\\_TestydBuild'](https://teamcity.ad.cryptzone.com/viewLog.html?buildId=301678&buildTypeId=Testyd_TestydBuild')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " artifacts=\\[BuildArtifact(name='aitorbot-5.2.1-py3-none-any.whl', content=Content(href='/httpAuth/app/rest/9.1/builds/id:301678/artifacts/content/aitorbot-5.2.1-py3-none-any.whl'), size=75179), BuildArtifact(name='aitorbot\\_5.2.1\\_all.deb', content=Content(href='/httpAuth/app/rest/9.1/builds/id:301678/artifacts/content/aitorbot\\_5.2.1\\_all.deb'), size=47970)\\], dependency=Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testyd', id='Testyd\\_TestydBuild'), dependency\\_type='artifact\\_dependency', id='0', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='1923')\\])), ArtifactDependency(project='testy', branch='master', build\\_number=444, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=294453&buildTypeId=Testy\\_TestyBuild'](https://teamcity.ad.cryptzone.com/viewLog.html?buildId=294453&buildTypeId=Testy_TestyBuild')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " artifacts=\\[BuildArtifact(name='cz-testy.bz2', content=Content(href='/httpAuth/app/rest/9.1/builds/id:294453/artifacts/content/cz-testy.bz2'), size=1489419), BuildArtifact(name='testy-1.8.1-py3-none-any.whl', content=Content(href='/httpAuth/app/rest/9.1/builds/id:294453/artifacts/content/testy-1.8.1-py3-none-any.whl'), size=34685)\\], dependency=Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testy', id='Testy\\_TestyBuild'), dependency\\_type='artifact\\_dependency', id='1', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='444')\\])), ArtifactDependency(project='stratus-client-linux', branch='master', build\\_number=11175, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303011&buildTypeId=StratusClient\\_Linux'](https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303011&buildTypeId=StratusClient_Linux')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " artifacts=\\[BuildArtifact(name='appgate-headless\\_4.1.0+11175+master\\_amd64.deb', content=Content(href='/httpAuth/app/rest/9.1/builds/id:303011/artifacts/content/appgate-headless\\_4.1.0+11175+master\\_amd64.deb'), size=8372408), BuildArtifact(name='appgate\\_4.1.0+11175+master\\_amd64.deb', content=Content(href='/httpAuth/app/rest/9.1/builds/id:303011/artifacts/content/appgate\\_4.1.0+11175+master\\_amd64.deb'), size=46129106), BuildArtifact(name='cyxtera.pub', content=Content(href='/httpAuth/app/rest/9.1/builds/id:303011/artifacts/content/cyxtera.pub'), size=1718)\\], dependency=Dependency(source\\_build\\_type=SourceBuildType(project\\_id='StratusClient', id='StratusClient\\_Linux'), dependency\\_type='artifact\\_dependency', id='2', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp/linux'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='11175')\\])), ArtifactDependency(project='stratus-tests', branch='master', build\\_number=5035, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303066&buildTypeId=Testy\\_StratusTests\\_StratusTestsBuild'](https://teamcity.ad.cryptzone.com/viewLog.html?buildId=303066&buildTypeId=Testy_StratusTests_StratusTestsBuild')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " artifacts=\\[BuildArtifact(name='cz-stratus-tests.bz2', content=Content(href='/httpAuth/app/rest/9.1/builds/id:303066/artifacts/content/cz-stratus-tests.bz2'), size=1944790), BuildArtifact(name='stratus\\_tests-1.1.0.5035-py3-none-any.whl', content=Content(href='/httpAuth/app/rest/9.1/builds/id:303066/artifacts/content/stratus\\_tests-1.1.0.5035-py3-none-any.whl'), size=2260729)\\], dependency=Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testy\\_StratusTests', id='Testy\\_StratusTests\\_StratusTestsBuild'), dependency\\_type='artifact\\_dependency', id='3', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='5035')\\]))\\], type='TestsArtifactDependenciesResolved'), queued\\_build=None), pullrequest=None, test\\_plan\\_url=None, keep\\_environment\\_on\\_test\\_error=False, results=\\[TestResult(type='TestCaseQueued', suite\\_id=199, case\\_id=19625268)\\], client='linux', level=<TestyLogLevel.STREAM: 'STREAM'>, environment\\_vars=\\[\\]), execution\\_type=<ExecutionType.TestAutoWithEnvironment: 'TEST\\_TYPE\\_AUTO\\_ENVIRONMENT'>, files=\\[\\]), state\\_label='execution-initialized') ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Creating test plan: \\[salvatore-tomaselli\\] \\[custom | linux | simple\\_v4\\] \\[\\] - 14 Jun 13:58 \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Created test plan, url is: ["
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/450277](https://testrail.ad.cryptzone.com/index.php?/plans/view/450277)"
                },
                {
                  "type": "text",
                  "text": " \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] CreateTestPlanAction done \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Chaining event InitializedExecution() \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', state\\_label='execution-initialized') ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Running automated test with environment provided by user \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Received event InitializedExecution() \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Transitioning from state TestsdStateLabel.EXECUTION\\_INITIALIZED to TestsdStateLabel.QUEUING\\_TEST\\_BUILD \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action CreateTestBuildAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', name='test-build', properties=\\[Property(name='teamcity.build.branch', value='450277'), Property(name='env.E2E\\_UUID', value='f36bbe2f-75f4-43b2-b57a-68baf9f48baf'), Property(name='env.AITORBOT\\_DEV\\_MODE', value='0'), Property(name='env.E2E\\_KEEP\\_ENV\\_ON\\_FAILURE', value='0')\\], dependencies=\\[Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testyd', id='Testyd\\_TestydBuild'), dependency\\_type='artifact\\_dependency', id='0', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='1923')\\]), Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testy', id='Testy\\_TestyBuild'), dependency\\_type='artifact\\_dependency', id='1', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='444')\\]), Dependency(source\\_build\\_type=SourceBuildType(project\\_id='StratusClient', id='StratusClient\\_Linux'), dependency\\_type='artifact\\_dependency', id='2', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp/linux'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='11175')\\]), Dependency(source\\_build\\_type=SourceBuildType(project\\_id='Testy\\_StratusTests', id='Testy\\_StratusTests\\_StratusTestsBuild'), dependency\\_type='artifact\\_dependency', id='3', properties=\\[Property(name='cleanDestinationDirectory', value='false'), Property(name='pathRules', value='\\*=>/tmp'), Property(name='revisionName', value='buildNumber'), Property(name='revisionValue', value='5035')\\])\\], build\\_type\\_id='QaBuildConfigurations\\_EndToEnd\\_E2eTestyLinuxRunner2') ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] CreateTestBuildAction done \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Chaining event QueuedBuildEvent(build\\_type='test-build', build=QueuedBuild(id=303090, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303090'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303090')))"
                },
                {
                  "type": "text",
                  "text": " \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', state\\_label='queuing-test-build') ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Received event QueuedBuildEvent(build\\_type='test-build', build=QueuedBuild(id=303090, url='["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303090'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303090')))"
                },
                {
                  "type": "text",
                  "text": " \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Transitioning from state TestsdStateLabel.QUEUING\\_TEST\\_BUILD to TestsdStateLabel.RUNNING\\_TESTPLAN \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action UpdateTestPlanCommentAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', state\\_label='running-testplan') ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] Updating TestPlan id: 450277 \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] UpdateTestPlanCommentAction done \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='f36bbe2f-75f4-43b2-b57a-68baf9f48baf', state\\_label='running-testplan') ... \\[in logger.info\\]\n\nJun 14 15:58:31 helvetest-prod helvetest\\[57\\]: \\[f36bbe2f-75f4-43b2-b57a-68baf9f48baf\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:32 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[14/Jun/2018:13:58:28 +0000\\] \"POST /api/executions HTTP/1.0\" 200 6026 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\nJun 14 15:58:33 helvetest-prod helvetest\\[57\\]: \\[d243f72b-5ead-4ae3-bc6f-c564be2c2e8e\\] Received event UpdatedEnvironmentNode(nodes=\\[VMNode(name='controller', status='Ready for provisioning', roles=\\['controller', 'logserver'\\], ip='172.17.106.1', network='172.17.106.0/24', hostname='envy-172-17-106-1.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None), VMNode(name='gateway', status='Ready for provisioning', roles=\\['gateway'\\], ip='172.17.106.2', network='172.17.106.0/24', hostname='envy-172-17-106-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None), VMNode(name='endpoint', status='Ready for provisioning', roles=\\['endpoint'\\], ip='172.17.105.2', network='172.17.105.0/24', hostname='envy-172-17-105-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None)\\]) \\[in logger.info\\]\n\nJun 14 15:58:33 helvetest-prod helvetest\\[57\\]: \\[d243f72b-5ead-4ae3-bc6f-c564be2c2e8e\\] Staying in state TestsdStateLabel.BUILDING\\_ENVIRONMENT: Environment is still not ready \\[in logger.info\\]\n\nJun 14 15:58:33 helvetest-prod helvetest\\[57\\]: \\[d243f72b-5ead-4ae3-bc6f-c564be2c2e8e\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='d243f72b-5ead-4ae3-bc6f-c564be2c2e8e', state\\_label='building-environment') ... \\[in logger.info\\]\n\nJun 14 15:58:33 helvetest-prod helvetest\\[57\\]: \\[d243f72b-5ead-4ae3-bc6f-c564be2c2e8e\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:58:33 helvetest-prod helvetest\\[57\\]: \\[d243f72b-5ead-4ae3-bc6f-c564be2c2e8e\\] Received event UpdatedEnvironmentNode(nodes=\\[VMNode(name='controller', status='Ready for provisioning', roles=\\['controller', 'logserver'\\], ip='172.17.106.1', network='172.17.106.0/24', hostname='envy-172-17-106-1.devops', admin\\_username='admin', admin\\_password='admin', ssh\\_key=None), VMNode(name='gateway', status='Ready for provisioning', roles=\\['gateway'\\], ip='172.17.106.2', network='172.17.106.0/24', hostname='envy-172-17-106-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None), VMNode(name='endpoint', status='Ready for provisioning', roles=\\['endpoint'\\], ip='172.17.105.2', network='172.17.105.0/24', hostname='envy-172-17-105-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None)\\]) \\[in logger.info\\]\n\nJun 14 15:58:33 helvetest-prod helvetest\\[57\\]: "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303088'](https://teamcity.ad.cryptzone.com/viewQueued.html?itemId=303088')))"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " carry on... \\[in logger.exception\\]\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 219, in \\_cancel\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     'Origin': '["
                },
                {
                  "type": "text",
                  "text": "https://\\_:443'](https://_:443')"
                },
                {
                  "type": "text",
                  "text": "\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 111, in request\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     return await self.\\_request(method, path, data, json\\_, headers)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 93, in \\_request\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     async with self.session.request(method=method, url=request\\_url, data=data, headers=headers, json=json\\_) as resp:\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 779, in \\_\\_aenter\\_\\_\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     self.\\_resp = await self.\\_coro\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 408, in \\_request\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     resp.raise\\_for\\_status()\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client\\_reqrep.py\", line 772, in raise\\_for\\_status\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     headers=self.headers)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: aiohttp.client\\_exceptions.ClientResponseError: 404, message='None'\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: During handling of the above exception, another exception occurred:\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 236, in cancel\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     await self.cancel\\_queued\\_build(build\\_id=build\\_id, reason=reason)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 228, in cancel\\_queued\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     await self.\\_cancel\\_build(build\\_id, reason, 'buildQueue')\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 223, in \\_cancel\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     raise BuildNotFoundError(f'Build {build\\_id} not found')\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: clients.teamcity.BuildNotFoundError: Build 303088 not found\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: During handling of the above exception, another exception occurred:\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 219, in \\_cancel\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     'Origin': '["
                },
                {
                  "type": "text",
                  "text": "https://\\_:443'](https://_:443')"
                },
                {
                  "type": "text",
                  "text": "\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 111, in request\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     return await self.\\_request(method, path, data, json\\_, headers)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/base\\_client.py\", line 93, in \\_request\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     async with self.session.request(method=method, url=request\\_url, data=data, headers=headers, json=json\\_) as resp:\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 779, in \\_\\_aenter\\_\\_\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     self.\\_resp = await self.\\_coro\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client.py\", line 408, in \\_request\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     resp.raise\\_for\\_status()\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/client\\_reqrep.py\", line 772, in raise\\_for\\_status\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     headers=self.headers)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: aiohttp.client\\_exceptions.ClientResponseError: 504, message='Gateway Time-out'\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: The above exception was the direct cause of the following exception:\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/themachine/action\\_runner.py\", line 116, in arun\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     action\\_result = await action.arun()\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/actions.py\", line 151, in arun\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     await teamcity\\_client.cancel\\_build(build\\_id=self.queued\\_build.id, reason=self.reason)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 239, in cancel\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     await self.cancel\\_running\\_build(build\\_id=build\\_id, reason=reason)\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 231, in cancel\\_running\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     await self.\\_cancel\\_build(build\\_id, reason, 'builds')\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 225, in \\_cancel\\_build\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]:     raise TeamCityError(f'Failed to cancel build {build\\_id} with reason {reason}') from e\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: clients.teamcity.TeamCityError: Failed to cancel build 303088 with reason Deleted by owner aitorbot\n\nJun 14 15:59:18 helvetest-prod systemd-journald\\[17\\]: Forwarding to syslog missed 1 messages.\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] \\[ActionRunner\\] Running action UpdateTestResultsAction(execution\\_id='8fe68702-efb8-45f1-a2ec-79edcc552086', test\\_cases=\\[TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=867655), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10343), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10344), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10345), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=9477), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=9932), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10101), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=3721512), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=2150542), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=10422), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=10382), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=847076), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=847077), TestResult(type='TestCaseCancelled', suite\\_id=450272, case\\_id=867670), TestResult(type='TestCaseCancelled', suite\\_id=450272, case\\_id=42699719), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=17637708), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689715), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689716), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689717), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689718), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689719), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689721), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689722), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=23689723), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=32039388), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=34825829), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=9400), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=21221960), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=41740281), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=57970937), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=21221961), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=42699718), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=3721425), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=2150541), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10128), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10129), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=13985413), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10131), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=867625), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10139), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10140), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10347), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10381), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=10180), TestResult(type='TestCaseCancelled', suite\\_id=450273, case\\_id=32039387), TestResult(type='TestCaseCancelled', suite\\_id=450274, case\\_id=10116)\\], comment='') ... \\[in logger.info\\]\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Reporting test results: test run: 450274, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=867655), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10343), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10344), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10345), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=9477), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=9932), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=10101), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=3721512), TestResult(type='TestCaseCancelled', suite\\_id=450270, case\\_id=2150542)\\] \\[in logger.info\\]\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Reporting test results: test run: 450274, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=10422), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=10382), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=847076), TestResult(type='TestCaseCancelled', suite\\_id=450271, case\\_id=847077)\\] \\[in logger.info\\]\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Reporting test results: test run: 450274, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450272, case\\_id=867670), TestResult(type='TestCaseCancelled', suite\\_id=450272, case\\_id=42699719)\\] \\[in logger.info\\]\n\nJun 14 15:59:18 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Reporting test results: test run: 450274, test cases: \\[TestResult(type='TestCaseCancelled', suite\\_id=450273,"
                },
                {
                  "type": "text",
                  "text": "https://envy.devops'](https://envy.devops')))"
                },
                {
                  "type": "text",
                  "text": " ... \\[in logger.info\\]\n\nJun 14 15:59:20 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] \\[ActionRunner\\] DestroyEnvironmentAction done \\[in logger.info\\]\n\nJun 14 15:59:20 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='8fe68702-efb8-45f1-a2ec-79edcc552086', state\\_label='stopped-execution') ... \\[in logger.info\\]\n\nJun 14 15:59:20 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 14 15:59:20 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] Reached final state, stopping state machine \\[in logger.info\\]\n\nJun 14 15:59:33 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] websocket error: Error. WebSocket closed. Environment: 8fe68702-efb8-45f1-a2ec-79edcc552086 \\[in logger.error\\]\n\nJun 14 15:59:33 helvetest-prod helvetest\\[57\\]: \\[8fe68702-efb8-45f1-a2ec-79edcc552086\\] closing websocket \\[in logger.info\\]\n\nJun 14 15:59:40 helvetest-prod helvetest\\[57\\]: Garbage collecting 1 state machines \\[in statemachinesdict.garbage\\_collect\\]\n\nJun 14 15:59:40 helvetest-prod helvetest\\[57\\]: Garbage collecting state machine, id: 8fe68702-efb8-45f1-a2ec-79edcc552086 \\[in statemachinesdict.garbage\\_collect\\]\n\nJun 14 15:59:40 helvetest-prod helvetest\\[57\\]: Archiving test execution with id: 8fe68702-efb8-45f1-a2ec-79edcc552086 \\[in statemachinesdict.garbage\\_collect\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "Roy.nard",
        "created": 1529402199470
      }
    ],
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "just saw this raised.."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "making a ticket so i wont forget about it."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-8610",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "we call "
            },
            {
              "type": "text",
              "text": "https://dploeger.github.io/teamcity-rest-api/#getChildren",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://dploeger.github.io/teamcity-rest-api/#getChildren"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "in "
            },
            {
              "type": "text",
              "text": "teamcity.py::get_artifacts_list_by_build_id",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1600",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1600"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " gave a key error on "
            },
            {
              "type": "text",
              "text": "content",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " key when an #e2e trigger was made."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "ALL JSON keys are optionals according to swagger documention but helvetest assumes it is already there. Hence Key Error:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The "
            },
            {
              "type": "text",
              "text": "CreateTestAction",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " (and therefore "
            },
            {
              "type": "text",
              "text": "CreateTest",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ") object:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": " \\[stratus-tests-1600\\] \\[ActionRunner\\] Unhandled error while running action \n\nCreateTestAction(\n\n    execution\\_id='stratus-tests-1600', \n\n    event=CreateTest(\n\n        purpose='commit', \n\n        case\\_ids=\\[\\], \n\n        scenario='simple\\_v4', \n\n        test\\_project\\_id=7, \n\n        appliance=ApplianceBuildNumberDependencyRequest(\n\n            branch='master', \n\n            build\\_number=None, \n\n            build\\_id=None\n\n        ), \n\n        environment=None, \n\n        testy=TestyDependencyRequest(\n\n            default\\_branch='master', \n\n            dependencies=\\[\n\n                ArtifactDependencyRequest(\n\n                    name='testyd', \n\n                    branch='master', \n\n                    build\\_number=None, \n\n                    build\\_id=None\n\n                ), \n\n                ArtifactDependencyRequest(\n\n                    name='stratus-tests', \n\n                    branch='1600', \n\n                    build\\_number=None, \n\n                    build\\_id=None\n\n                ), ArtifactDependencyRequest(\n\n                    name='stratus-client-windows', \n\n                    branch='master', \n\n                    build\\_number=None, \n\n                    build\\_id=None\n\n                ), ArtifactDependencyRequest(\n\n                    name='testy', \n\n                    branch='master', \n\n                    build\\_number=None, \n\n                    build\\_id=None)\n\n                \\]\n\n            ), \n\n            pullrequest=PullRequest(\n\n                id=14914, \n\n                number=1600, \n\n                state='open', \n\n                title='skip user approval on old clients', \n\n                body='every damn time', \n\n                html\\_url='["
            },
            {
              "type": "text",
              "text": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1600'](https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1600')"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " \n\n                user=User(id=19, login'natan-abolafya'), \n\n                head=Head(\n\n                    label='cryptzone:fix/backward-compatibility', \n\n                    ref='fix/backward-compatibility', \n\n                    sha='89d82c972bf868fcfd8502af3113bc39622bad07', \n\n                    repo=Repository(id=208, name='stratus-tests')\n\n                ), \n\n                base=Base(\n\n                    label='cryptzone:master', \n\n                    ref='master', \n\n                    sha='6f4ea1a7a66c638e9b7641459a1f6d85aebff7dc')\n\n            ), \n\n            client='windows', \n\n            level='STREAM', \n\n            tags=\\['pullrequest', 'stratus-tests', 'natan-abolafya'\\], \n\n            environment\\_vars=\\[\\], \n\n            use\\_agent=True, \n\n            keep\\_environment\\_on\\_spawn\\_error=False, \n\n            keep\\_environment\\_on\\_test\\_error=False, \n\n            custom\\_envy=None, log\\_levels=\\[\\], \n\n            allow\\_subnets=\\[\\]\n\n), \n\nuser='natan-abolafya'\n\n)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Partial Logs for above PR:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 18 11:29:28 helvetest-prod helvetest\\[57\\]: \\[stratus-tests-1600\\] \\[ActionRunner\\] Unhandled error while running action CreateTestAction(execution\\_id='stratus-tests-1600', eve \\[...\\]\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/themachine/action\\_runner.py\", line 116, in arun\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     action\\_result = await action.arun()\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/pullrequestsd/actions.py\", line 27, in arun\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     test\\_execution = await executions\\_create(event=self.event, user=self.user)\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 564, in executions\\_create\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     teamcity\\_client)\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 278, in resolve\\_test\\_dependency\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     default\\_branch=test\\_dependencies.default\\_branch)\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 260, in resolve\\_dependencies\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     artifacts = await teamcity\\_client.get\\_artifacts\\_list\\_by\\_build\\_id(build.id)\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 296, in get\\_artifacts\\_list\\_by\\_build\\_id\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     for artifact in data\\['file'\\]\\]  # type: ignore\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 296, in <listcomp>\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]:     for artifact in data\\['file'\\]\\]  # type: ignore\n\nJun 18 11:29:28 helvetest-prod helvetest\\[57\\]: KeyError: 'content'"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Mysterious part is that same code is efficiently used. i.e. "
            },
            {
              "type": "text",
              "text": "testsd::executions_create",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " whether or not it is from aitorbot or prsd."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Is prsd sending wrong params?"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Because this worked:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "aitorbot test create -d stratus-tests 1600 --client window\n\ns\n\nnatan-abolafya \\[\\] | 2018-06-18 10:05:31\n\nid: 12fa2684-863e-4a85-8ce6-b6c95651aff7\n\nurl: ["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/452295](https://testrail.ad.cryptzone.com/index.php?/plans/view/452295)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "and created the "
            },
            {
              "type": "text",
              "text": "CreateTest",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " instance:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": " Jun 18 12:05:28 helvetest-prod helvetest\\[57\\]: \\[12fa2684-863e-4a85-8ce6-b6c95651aff7\\] \n\n Creating execution: \n\n CreateTest(\n\npurpose='commit', \n\ncase\\_ids=\\[\\], \n\nscenario='simple\\_v4', \n\ntest\\_project\\_id=7, \n\nappliance=ApplianceBuildNumberDependencyRequest(branch='master', build\\_number=None, build\\_id=None), \n\nenvironment=None, \n\ntesty=TestyDependencyRequest(\n\ndefault\\_branch='master', \n\ndependencies=\\[\n\nArtifactDependencyRequest(\n\nname='stratus-tests', \n\nbranch='1600', \n\nbuild\\_number=None, \n\nbuild\\_id=None)\n\n\\]\n\n), \n\npullrequest=None, \n\nclient='windows', \n\nlevel='STREAM', \n\ntags=\\[\\], \n\nenvironment\\_vars=\\[\\], \n\nuse\\_agent=True, \n\nkeep\\_environment\\_on\\_spawn\\_error=False, \n\nkeep\\_environment\\_on\\_test\\_error=False, \n\ncustom\\_envy=None, \n\nlog\\_levels=\\[\\], \n\nallow\\_subnets=\\[\\]) \\[in logger.info\\]"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "WHICH IS OBVIOUSLY VERY DIFFERENT. Not knowing more on details for how this usually works lets see what we will come up with..."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Not same execution but another KeyError (and Logging Error):"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 18 10:16:04 helvetest-prod helvetest\\[57\\]: \\[81663c68-fee3-485a-b567-b975ac744e21\\] Validating test config \\[in logger.info\\]\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: --- Logging error ---\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/resthelpers.py\", line 72, in wrapper\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     is\\_devops=is\\_devops\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 671, in \\_executions\\_post\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     execution = await executions\\_create(event, user=user\\_data.username)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 564, in executions\\_create\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     teamcity\\_client)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 278, in resolve\\_test\\_dependency\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     default\\_branch=test\\_dependencies.default\\_branch)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/services/testsd/service.py\", line 260, in resolve\\_dependencies\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     artifacts = await teamcity\\_client.get\\_artifacts\\_list\\_by\\_build\\_id(build.id)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 296, in get\\_artifacts\\_list\\_by\\_build\\_id\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     for artifact in data\\['file'\\]\\]  # type: ignore\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/clients/teamcity.py\", line 296, in <listcomp>\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     for artifact in data\\['file'\\]\\]  # type: ignore\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: KeyError: 'content'\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: During handling of the above exception, another exception occurred:\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: Traceback (most recent call last):\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/logging/\\_\\_init\\_\\_.py\", line 992, in emit\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     msg = self.format(record)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/logging/\\_\\_init\\_\\_.py\", line 838, in format\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     return fmt.format(record)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/logging/\\_\\_init\\_\\_.py\", line 575, in format\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     record.message = record.getMessage()\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/logging/\\_\\_init\\_\\_.py\", line 338, in getMessage\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     msg = msg % self.args\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: TypeError: not all arguments converted during string formatting\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: Call stack:\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/runpy.py\", line 193, in \\_run\\_module\\_as\\_main\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     \"\\_\\_main\\_\\_\", mod\\_spec)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/runpy.py\", line 85, in \\_run\\_code\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     exec(code, run\\_globals)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/\\_\\_main\\_\\_.py\", line 3, in <module>\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     main()\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/\\_\\_init\\_\\_.py\", line 42, in main\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     rest.start\\_rest(args.host or helvetest\\_config.host, args.port or helvetest\\_config.port)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/rest.py\", line 91, in start\\_rest\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     loop.run\\_forever()\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/asyncio/base\\_events.py\", line 422, in run\\_forever\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     self.\\_run\\_once()\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/asyncio/base\\_events.py\", line 1432, in \\_run\\_once\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     handle.\\_run()\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3.6/asyncio/events.py\", line 145, in \\_run\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     self.\\_callback(\\*self.\\_args)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/web\\_protocol.py\", line 376, in start\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     resp = await self.\\_request\\_handler(request)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/lib/python3/dist-packages/aiohttp/web\\_app.py\", line 310, in \\_handle\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     resp = await handler(request)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:   File \"/usr/share/helvetest/helvetest/resthelpers.py\", line 78, in wrapper\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]:     log.exception('Unexpected error', e)\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: Message: 'Unexpected error'\n\nJun 18 10:16:04 helvetest-prod helvetest\\[57\\]: Arguments: (KeyError('content',),)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Seems like "
                },
                {
                  "type": "text",
                  "text": "TeamCity",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " was failing at that particular moment."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Recreated same call with both "
                },
                {
                  "type": "text",
                  "text": "CreateTest",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " running through "
                },
                {
                  "type": "text",
                  "text": "resolve_test_dependency",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to "
                },
                {
                  "type": "text",
                  "text": "get_artifacts_list_by_build_id",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and got a successful response."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Better error handling from Helvetest must be done in the case of TC response failure."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "Roy.nard",
        "created": 1529402199470
      }
    ]
  },
  {
    "key": "SA-8619",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For standalone logserver we have added the following in order the logserver to communicate with controller."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "    location /authorization-service {\n\n        proxy\\_set\\_header X-Real-IP $remote\\_addr;\n\n        proxy\\_set\\_header Host $host;\n\n        proxy\\_set\\_header X-Forwarded-For $proxy\\_add\\_x\\_forwarded\\_for;\n\n        proxy\\_pass ["
            },
            {
              "type": "text",
              "text": "https://test4b688f23cee.uksouth.cloudapp.azure.com:444/admin/authorization/kibana](https://test4b688f23cee.uksouth.cloudapp.azure.com:444/admin/authorization/kibana)",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://test4b688f23cee.uksouth.cloudapp.azure.com:444/admin/authorization/kibana](https://test4b688f23cee.uksouth.cloudapp.azure.com:444/admin/authorization/kibana)"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ";"
            },
            {
              "type": "text",
              "text": "\n\n    }"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When nginx is started, it tries to resolve the given hostname in proxy\\"
            },
            {
              "type": "text",
              "text": "pass and if it fails, the service rejects to start.",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 19 09:52:41 test4b688f23cee.uksouth.cloudapp.azure.com systemd\\[1\\]: Starting nginx http daemon...\n\nJun 19 09:52:41 test4b688f23cee.uksouth.cloudapp.azure.com nginx\\[1125\\]: nginx: \\[emerg\\] host not found in upstream \"test4b688f23cee.uksouth.cloudapp.azure.com\" in /etc/nginx/sites-enabled/peer:432\n\nJun 19 09:52:41 test4b688f23cee.uksouth.cloudapp.azure.com nginx\\[1125\\]: nginx: configuration file /etc/nginx/nginx.conf test failed\n\nJun 19 09:52:41 test4b688f23cee.uksouth.cloudapp.azure.com systemd\\[1\\]: cz-nginx.service: Control process exited, code=exited status=1\n\nJun 19 09:52:41 test4b688f23cee.uksouth.cloudapp.azure.com systemd\\[1\\]: Failed to start nginx http daemon."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I'll make an improvement on configd so if it's a controller itself, it will directly go to the internal controller service, but this still needs some improvement as nginx not starting is bad."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "https://stackoverflow.com/questions/32845674/setup-nginx-not-to-crash-if-host-in-upstream-is-not-found",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://stackoverflow.com/questions/32845674/setup-nginx-not-to-crash-if-host-in-upstream-is-not-found"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2136",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2136"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1529417100806
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2141",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2141"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1529921753525
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "failed. explanation at the last PR"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1529939032229
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In that case the configuration contains the hostname of the controller."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If nginx is started before DHCP has applied the DNS configuration nginx startup will fail."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The fix for this should be the same as for "
                },
                {
                  "type": "text",
                  "text": "SA-5391",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-5391"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We should wait for the DHCP lease before leaving apply network configuration."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This way everything should be in place when we apply the services configuration."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530621254866
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "While I have seen nginx failing to start on AWS it eventually resolves itself as configd does several restart during init on cloud platforms. Since cloud platforms are the only ones where we would deploy a standalone log server using DHCP we can consider this an acceptable known issue for 4.1 and fix it properly for 4.2."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530621355880
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed by waiting for the DHCP configuration to be applied before continuing"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2213",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2213"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1533203447839
      }
    ]
  },
  {
    "key": "SA-8628",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "create and env, and error occured (broken env) will not close websocket connection"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Currently, we use the "
            },
            {
              "type": "text",
              "text": "with",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\-clause which causes python to still have a reference to the envy object -> Connection isnt closed."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "we cant just "
            },
            {
              "type": "text",
              "text": "_replace",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " that envy to "
            },
            {
              "type": "text",
              "text": "None",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " because:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "class Execution(NamedTuple):\n\n    id: str\n\n    version: int\n\n    user: str\n\n    time: str\n\n    tags: List\\[str\\]\n\n    test\\_project\\_id: int\n\n    environment\\_data: EnvironmentData\n\n    test\\_data: Optional\\[TestData\\]\n\n    execution\\_type: ExecutionType\n\n    files: List\\[str\\]\n\n    @property\n\n    def envy(self) -> Envy:\n\n        if self.environment\\_data.envy is None:\n\n            raise FatalHelvetestTransitionError('Envy configuration should always be set')\n\n        return self.environment\\_data.envy"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "example:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Leino:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\"Here we go: d3576c98-2f80-493a-9863-7b2589f82df5 caused a leftover in envy. The enviroment creation reported error on \"jun 15 11{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "44}}38\" then at \"jun 15 21{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "44}}39\" helvetes test reconnected the websocket.. and then nothing.... did a manual clean of it today"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "here is probably the 10 hours ... so helvetestest was probably disconnected by nginx after 10 hours of inactivity"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I did run a \"delete\\"
            },
            {
              "type": "text",
              "text": "leftover\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "envs.py\" .. there was 2 leftovers.."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "d3576c98-2f80-493a-9863-7b2589f82df5 was one of them..\""
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "halp ? "
            },
            {
              "type": "text",
              "text": "journalctl -u helvetest --since '2018-06-15 11:19:14 CEST'keep_environment_on_spawn_error=False,",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jun 15 11:43:42 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] Received event UpdatedEnvironmentNode(nodes=\\[VMNode(name='controller', status='Running', roles=\\['controller', 'logserver'\\], ip='172.17.124.1', network='172.17.124.0/24', hostname='envy-172-17-124-1.devops', admin\\_username='admin', admin\\_password='admin', ssh\\_key=None), VMNode(name='controller2', status='Provisioning', roles=\\['controller'\\], ip='172.17.124.2', network='172.17.124.0/24', hostname='envy-172-17-124-2.devops', admin\\_username='admin', admin\\_password='admin', ssh\\_key=None), VMNode(name='gateway', status='Error occurred', roles=\\['gateway'\\], ip='172.17.124.3', network='172.17.124.0/24', hostname='envy-172-17-124-3.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None), VMNode(name='endpoint', status='Running', roles=\\['endpoint'\\], ip='172.17.121.2', network='172.17.121.0/24', hostname='envy-172-17-121-2.devops', admin\\_username=None, admin\\_password=None, ssh\\_key=None)\\]) \\[in logger.info\\]\n\nJun 15 11:43:42 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] Transitioning from state TestsdStateLabel.BUILDING\\_ENVIRONMENT to TestsdStateLabel.STOPPED\\_EXECUTION: Environment reported failed by envy \\[in logger.info\\]\n\nJun 15 11:43:42 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] \\[ActionRunner\\] Running action DownloadUploadEnvyLogs(execution\\_id='d3576c98-2f80-493a-9863-7b2589f82df5', env\\_id='d3576c98-2f80-493a-9863-7b2589f82df5', envy=Envy(url='["
            },
            {
              "type": "text",
              "text": "https://envy.devops'](https://envy.devops'))"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " filename='envy-d3576c98-2f80-493a-9863-7b2589f82df5.log.gz') ... \\[in logger.info\\]\n\nJun 15 11:43:43 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] \\[ActionRunner\\] DownloadUploadEnvyLogs done \\[in logger.info\\]\n\nJun 15 11:43:43 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] \\[ActionRunner\\] Running action SaveToMongoAction(execution\\_id='d3576c98-2f80-493a-9863-7b2589f82df5', state\\_label='stopped-execution') ... \\[in logger.info\\]\n\nJun 15 11:43:43 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] \\[ActionRunner\\] SaveToMongoAction done \\[in logger.info\\]\n\nJun 15 11:43:43 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] Reached final state, stopping state machine \\[in logger.info\\]\n\nJun 15 11:43:48 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[15/Jun/2018:09:43:48 +0000\\] \"GET /api/executions-ips HTTP/1.0\" 200 1199 \"-\" \"AppGate Policy Evaluator/1.0\" \\[in helpers.log\\]\n\nJun 15 11:43:49 helvetest-prod helvetest\\[57\\]: Garbage collecting 1 state machines \\[in statemachinesdict.garbage\\_collect\\]\n\nJun 15 11:43:49 helvetest-prod helvetest\\[57\\]: Garbage collecting state machine, id: d3576c98-2f80-493a-9863-7b2589f82df5 \\[in statemachinesdict.garbage\\_collect\\]\n\nJun 15 11:43:49 helvetest-prod helvetest\\[57\\]: Archiving test execution with id: d3576c98-2f80-493a-9863-7b2589f82df5 \\[in statemachinesdict.garbage\\_collect\\]\n\nJun 15 11:43:50 helvetest-prod helvetest\\[57\\]: 169.254.240.30 \\[15/Jun/2018:09:43:50 +0000\\] \"POST /api/executions/643ab87c-389f-40db-9769-e76fbbc9a2be/running-testplan/finished-testcase HTTP/1.0\" 202 155 \"-\" \"python-requests/2.18.4\" \\[in helpers.log\\]\n\n\\[........................\\]\n\nJun 15 21:44:38 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] websocket error: Error. WebSocket closed. Environment: d3576c98-2f80-493a-9863-7b2589f82df5 \\[in logger.error\\]\n\nJun 15 21:44:38 helvetest-prod helvetest\\[57\\]: \\[d3576c98-2f80-493a-9863-7b2589f82df5\\] closing websocket \\[in logger.info\\]"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "trying hackish pr to break to loop "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/2138"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "Roy.nard",
        "created": 1529927535148
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK.. so doing a REST "
                },
                {
                  "type": "text",
                  "text": "DELETE",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " closed the connection. no lingering i.e. == not leftover."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "problem is that it isnt graceful. we get "
                },
                {
                  "type": "text",
                  "text": "WSMsgType.ERROR",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " for some reason."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "Roy.nard",
        "created": 1530007360554
      }
    ]
  },
  {
    "key": "SA-8711",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Could be a controller or appliance bug."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The verification of the next appliance certificate fails on all appliances when this happens:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jul 04 12:33:46 envy-172-17-124-1.devops nginx\\[21238\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:46 +0000\\] \"GET /admin/certificate-authority/ca/pem HTTP/2.0\" 200 2596 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devops:444/ui](https://envy-172-17-124-1.devops:444/ui)"
            },
            {
              "type": "text",
              "text": "\n\nJul 04 12:33:46 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:46 +0000\\] \"GET /peer/certificate-authority/ca/pem HTTP/1.0\" 200 2596 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devop](https://envy-172-17-124-1.devop)"
            },
            {
              "type": "text",
              "text": "\n\nJul 04 12:33:46 envy-172-17-124-1.devops nginx\\[21238\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:46 +0000\\] \"GET /admin/license/next HTTP/2.0\" 404 63 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devops:444/ui/ca](https://envy-172-17-124-1.devops:444/ui/ca)\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 \n\nJul 04 12:33:46 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:46 +0000\\] \"GET /peer/license/next HTTP/1.0\" 404 63 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devops:444/ui/ca](https://envy-172-17-124-1.devops:444/ui/ca)\""
            },
            {
              "type": "text",
              "text": " \"Mozi\n\nJul 04 12:33:46 envy-172-17-124-1.devops nginx\\[21238\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:46 +0000\\] \"GET /admin/certificate-authority/ca/next HTTP/2.0\" 404 63 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devops:444/ui/](https://envy-172-17-124-1.devops:444/ui/)"
            },
            {
              "type": "text",
              "text": "\n\nJul 04 12:33:46 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:46 +0000\\] \"GET /peer/certificate-authority/ca/next HTTP/1.0\" 404 63 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.devops](https://envy-172-17-124-1.devops)"
            },
            {
              "type": "text",
              "text": "\n\nJul 04 12:34:00 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: INFO \\[ApplianceManager\\] Pushing configuration to appliance 'gateway-c26fe247-87dc-43be-8192-8140e49ebcfa-site1'\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: INFO \\[ApplianceManager\\] Pushing configuration to appliance 'controller2-c26fe247-87dc-43be-8192-8140e49ebcfa-site1'\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: INFO \\[ApplianceManager\\] Pushing configuration to appliance 'controller-c26fe247-87dc-43be-8192-8140e49ebcfa-site1'\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: {\"id\":\"6ec5aa0c-de2b-47df-a766-047c130de7d1\",\"timestamp\":\"2018-07-04T12:34:01.041Z\",\"version\":8,\"certificate\":{\"version\":3,\"serial\":\"1530707\n\nJul 04 12:34:01 envy-172-17-124-1.devops nginx\\[21238\\]: 192.168.111.220 - - \\[04/Jul/2018:12:34:01 +0000\\] \"POST /admin/certificate-authority/ca/next/generate HTTP/2.0\" 200 3395 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-124-1.de](https://envy-172-17-124-1.de)"
            },
            {
              "type": "text",
              "text": "\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 192.168.111.220 - - \\[04/Jul/2018:12:33:58 +0000\\] \"POST /peer/certificate-authority/ca/next/generate HTTP/1.0\" 200 3395 \"["
            },
            {
              "type": "text",
              "text": "https://envy-172-17-](https://envy-172-17-)"
            },
            {
              "type": "text",
              "text": "\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[change\\] Change a2049cc6-d21a-49c9-81ba-5e8b3ea0bc8c submitted\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[rest\\] \"POST /configuration HTTP/1.0\" 202 50 \"\" \"Service.Controller (appliance-connector)\" 0\n\nJul 04 12:34:01 envy-172-17-124-1.devops nginx\\[21237\\]: 127.0.0.1 - - \\[04/Jul/2018:12:34:01 +0000\\] \"POST /appliance/configuration HTTP/1.1\" 202 50 \"-\" \"Service.Controller (appliance-connector)\"\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: INFO \\[ApplianceManager\\] Appliance controller2-c26fe247-87dc-43be-8192-8140e49ebcfa-site1:921848a8-bfa8-46d4-7ec3-71bc0a6138cf configuration \n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: INFO \\[ApplianceManager\\] Appliance controller-c26fe247-87dc-43be-8192-8140e49ebcfa-site1:5b06c2aa-c078-490e-aefa-634288a610ae configuration h\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: INFO \\[ApplianceManager\\] Appliance gateway-c26fe247-87dc-43be-8192-8140e49ebcfa-site1:21b10d3f-933c-47f0-6929-b10435eaaf7e configuration has \n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[StateMachine\\] Received event ConfigCommittedEvent(config={'remote'}), staying in state multi\\_controller\\_ready\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[change\\] Change a2049cc6-d21a-49c9-81ba-5e8b3ea0bc8c running\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] Running action CommitConfigAction ...\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[CommitConfigAction\\] Current configuration directory is 20180704-123401-jpx4fch6\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] CommitConfigAction done\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] Running action ApplyServicesAction(force=False) ...\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ApplyServicesAction\\] Applying services configuration with current configuration /mnt/state/config/20180704-123401-jpx4fch6 and previous conf\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] ApplyServicesAction done\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] Running action WritePkiFilesAction(do\\_convert=True) ...\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[WritePkiFilesAction\\] Writing PKI files: nextCaCert...\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] WritePkiFilesAction done\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] Running action SignNextApplianceCertificateAction(controller=Controller(enabled=True, multicontroller=True, hostname='envy-17\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[SignNextApplianceCertificateAction\\] Signing next appliance certificate...\n\nJul 04 12:34:01 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[SignNextApplianceCertificateAction\\] Generating key pair for next appliance certificate...\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: ERROR \\[SignNextApplianceCertificateAction\\] Unknown error while trying to sign next appliance certificate on \"envy-172-17-124-2.devops:444\"\n\n                                                          Traceback (most recent call last):\n\n                                                            File \"/usr/cz-configd/configd/pki.py\", line 283, in verify\\_cert\\_str\n\n                                                              return \\_cmd\\_in\\_out(cmd, cert.encode()).decode()\n\n                                                            File \"/usr/cz-configd/configd/pki.py\", line 60, in \\_cmd\\_in\\_out\n\n                                                              raise subprocess.CalledProcessError(p.returncode, list2cmdline(cmd), output=out, stderr=err)\n\n                                                          subprocess.CalledProcessError: Command 'openssl verify -CAfile /mnt/state/pki/next-ca-cert.pem' returned non-zero exit status 2\n\n                                                          \n\n                                                          The above exception was the direct cause of the following exception:\n\n                                                          \n\n                                                          Traceback (most recent call last):\n\n                                                            File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 699, in \\_sign\\_next\n\n                                                              next\\_appliance\\_cert\\_pem = self.\\_try\\_sign\\_next(peer\\_controller.hostname, peer\\_controller.port, public\\_key\\_der\\_b64)\n\n                                                            File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 684, in \\_try\\_sign\\_next\n\n                                                              pki.verify\\_cert\\_str(cert=next\\_appliance\\_cert\\_pem, ca\\_cert=next\\_ca\\_cert\\_file)\n\n                                                            File \"/usr/cz-configd/configd/pki.py\", line 286, in verify\\_cert\\_str\n\n                                                              ca\\_cert, e.stderr.decode())) from e\n\n                                                          configd.pki.PKIError: Certificate verification using CA cert /mnt/state/pki/next-ca-cert.pem failed: \n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: {\"id\":\"87ee5acf-9aec-4d9b-8eee-16848e633603\",\"timestamp\":\"2018-07-04T12:34:03.288Z\",\"version\":8,\"entity\\_id\":\"921848a8-bfa8-46d4-7ec3-71bc0a6\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: {\"id\":\"8aa25bbd-abfb-4e74-bd7a-dd4e53e086d9\",\"timestamp\":\"2018-07-04T12:34:03.288Z\",\"version\":8,\"entity\\_id\":\"5b06c2aa-c078-490e-aefa-634288a\n\nJul 04 12:34:03 envy-172-17-124-1.devops nginx\\[21236\\]: 127.0.0.1 - - \\[04/Jul/2018:12:34:03 +0000\\] \"POST /admin/certificate-authority/ca/next/sign HTTP/1.1\" 200 2932 \"-\" \"python-requests/2.14.2\"\n\nJul 04 12:34:03 envy-172-17-124-1.devops nginx\\[21238\\]: 172.17.124.2 - - \\[04/Jul/2018:12:34:03 +0000\\] \"POST /admin/certificate-authority/ca/next/sign HTTP/1.1\" 200 2932 \"-\" \"python-requests/2.14.2\"\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 127.0.0.1 - - \\[04/Jul/2018:12:34:03 +0000\\] \"POST /peer/certificate-authority/ca/next/sign HTTP/1.0\" 200 2932 \"-\" \"python-requests/2.14.2\" 13\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 127.0.0.1 - - \\[04/Jul/2018:12:34:03 +0000\\] \"POST /peer/certificate-authority/ca/next/sign HTTP/1.0\" 200 2932 \"-\" \"python-requests/2.14.2\" 13\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: ERROR \\[SignNextApplianceCertificateAction\\] Unknown error while trying to sign next appliance certificate on \"envy-172-17-124-1.devops:444\"\n\n                                                          Traceback (most recent call last):\n\n                                                            File \"/usr/cz-configd/configd/pki.py\", line 283, in verify\\_cert\\_str\n\n                                                              return \\_cmd\\_in\\_out(cmd, cert.encode()).decode()\n\n                                                            File \"/usr/cz-configd/configd/pki.py\", line 60, in \\_cmd\\_in\\_out\n\n                                                              raise subprocess.CalledProcessError(p.returncode, list2cmdline(cmd), output=out, stderr=err)\n\n                                                          subprocess.CalledProcessError: Command 'openssl verify -CAfile /mnt/state/pki/next-ca-cert.pem' returned non-zero exit status 2\n\n                                                          \n\n                                                          The above exception was the direct cause of the following exception:\n\n                                                          \n\n                                                          Traceback (most recent call last):\n\n                                                            File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 699, in \\_sign\\_next\n\n                                                              next\\_appliance\\_cert\\_pem = self.\\_try\\_sign\\_next(peer\\_controller.hostname, peer\\_controller.port, public\\_key\\_der\\_b64)\n\n                                                            File \"/usr/cz-configd/configd/stratus\\_actions.py\", line 684, in \\_try\\_sign\\_next\n\n                                                              pki.verify\\_cert\\_str(cert=next\\_appliance\\_cert\\_pem, ca\\_cert=next\\_ca\\_cert\\_file)\n\n                                                            File \"/usr/cz-configd/configd/pki.py\", line 286, in verify\\_cert\\_str\n\n                                                              ca\\_cert, e.stderr.decode())) from e\n\n                                                          configd.pki.PKIError: Certificate verification using CA cert /mnt/state/pki/next-ca-cert.pem failed: \n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] SignNextApplianceCertificateAction done\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] Running action GetNextCABundleAction() ...\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[GetNextCABundleAction\\] Getting next CA certificate bundle\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[ActionsRunner\\] GetNextCABundleAction done\n\nJul 04 12:34:03 envy-172-17-124-1.devops cz-configd\\[944\\]: INFO \\[change\\] Change a2049cc6-d21a-49c9-81ba-5e8b3ea0bc8c completed with result success after 2.063 seconds\n\nJul 04 12:34:04 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: {\"id\":\"376fb02a-2310-4fe8-b204-edeb38efa74f\",\"timestamp\":\"2018-07-04T12:34:04.003Z\",\"version\":8,\"entity\\_id\":\"21b10d3f-933c-47f0-6929-b10435e\n\nJul 04 12:34:04 envy-172-17-124-1.devops nginx\\[21237\\]: 172.17.124.3 - - \\[04/Jul/2018:12:34:04 +0000\\] \"POST /admin/certificate-authority/ca/next/sign HTTP/1.1\" 200 2864 \"-\" \"python-requests/2.14.2\"\n\nJul 04 12:34:04 envy-172-17-124-1.devops cz-controllerd\\[21335\\]: 127.0.0.1 - - \\[04/Jul/2018:12:34:03 +0000\\] \"POST /peer/certificate-authority/ca/next/sign HTTP/1.0\" 200 2864 \"-\" \"python-requests/2.14.2\" 43\n\nJul 04 12:34:39 envy-172-17-124-1.devops systemd-journald\\[447\\]: Forwarding to syslog missed 40 messages."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Seems to happen when you bash the OK button :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530708641665
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok it becaause the controller is doing several changes in a row."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530708679582
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The source of the problem is that you can click the OK button many times and it will send as many queries to the controller."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1530708916574
      }
    ]
  },
  {
    "key": "SA-266",
    "comments": [],
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Logs coming from the Azure Gateway to the log server hosted at Connect (log.sa.cryptzone.com) time out from now and then."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Here is a better description of this from a conversation between Per Leino and Kristinn:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Per Leino \\[16:13\\] \n\nhi Kristinn... when you setup azure.. did you specify any tcp source port range ?\n\nPer Leino \\[16:14\\]\n\nwhen azure gw is connecting to logserver , i usually see a port like 1081 -> 1087 ..\n\nPer Leino \\[16:14\\]\n\nbut at some times, it does a port reuse, when a new tcp connection is made...\n\nPer Leino \\[16:14\\]\n\nand at those times i can see that there is a delay to connect..\n\nKristinn rn Sigursson \\[16:17\\] \n\nhm nope not to my knowledge\n\nKristinn rn Sigursson \\[16:17\\]\n\nthat's weird\n\nKristinn rn Sigursson \\[16:17\\]\n\nso it's trying to reuse a port that is already in use or?\n\nPer Leino \\[16:26\\] \n\ni dont know..  it is strange..    from azure i just do a simple connect to the logging server...\n\nPer Leino \\[16:26\\]\n\nall goes ok...\n\nPer Leino \\[16:26\\]\n\ni can see that azure is using ports\n\nPer Leino \\[16:26\\]\n\nlike 1080\n\nPer Leino \\[16:26\\]\n\n1081\n\nPer Leino \\[16:26\\]\n\n1082\n\nPer Leino \\[16:27\\]\n\n1083\n\nPer Leino \\[16:27\\]\n\netc etc..\n\nPer Leino \\[16:27\\]\n\nbut then all the sudden it uses 1064\n\nPer Leino \\[16:27\\]\n\nand for some reason the SYN fails.\n\nPer Leino \\[16:27\\]\n\nit does not get any responce from the log server\n\nPer Leino \\[16:27\\]\n\nsame pattern every time\n\nKristinn rn Sigursson \\[16:27\\] \n\nI'm wondering if it has something to do with the natting of the log server\n\nKristinn rn Sigursson \\[16:28\\]\n\nor does it work from aws?\n\nPer Leino \\[16:28\\] \n\nit allways work from amazon\n\nKristinn rn Sigursson \\[16:28\\] \n\nok\n\nKristinn rn Sigursson \\[16:28\\]\n\nhm\n\nKristinn rn Sigursson \\[16:28\\]\n\nlet me look into it\n\nKristinn rn Sigursson \\[16:28\\]\n\nneed to google and stuff, not sure what it can be\n\nPer Leino \\[16:29\\] \n\ni reproduce it like:\n\nPer Leino \\[16:29\\]\n\nnc -vz log.sa.cryptzone.com 5000      <-- on azure\n\nPer Leino \\[16:29\\]\n\nsudo tcpdump -i eth0 tcp port 5000 -n -X  <-- on logging server\n\nKristinn rn Sigursson \\[16:29\\] \n\nok cool\n\nKristinn rn Sigursson \\[16:29\\]\n\nI will investigate this now\n\nKristinn rn Sigursson \\[16:29\\]\n\nthanks\n\nPer Leino \\[16:30\\] \n\nnp\n\nPer Leino \\[17:01\\] \n\nthere is a article @ ["
            },
            {
              "type": "text",
              "text": "https://msdn.microsoft.com/en-us/library/azure/dn848316.aspx](https://msdn.microsoft.com/en-us/library/azure/dn848316.aspx)"
            },
            {
              "type": "text",
              "text": "   where the number of source ports can be configured?\n\nKristinn rn Sigursson \\[17:02\\] \n\nmaybe we will need to use the security groups feature. It isn't available in the GUI (at least I haven't found it) so we didn't know about it, that's the reason we use the SNAT hack\n\nKristinn rn Sigursson \\[17:02\\]\n\nbut if this can be fixed by using security groups then we might need to do that\n\nKristinn rn Sigursson \\[17:23\\] \n\nI think it just uses the next available port. I don't know why this would be an issue\n\nKristinn rn Sigursson \\[17:24\\]\n\nweird\n\nKristinn rn Sigursson \\[17:24\\]\n\nit's using 1024-1040 ca. for me now and it's working\n\nKristinn rn Sigursson \\[17:24\\]\n\nfrom a different azure vm\n\nKristinn rn Sigursson \\[17:24\\]\n\nwe should investigate this further after RSA\n\nKristinn rn Sigursson \\[17:24\\]\n\nI can't do any good tests now\n\nKristinn rn Sigursson \\[17:28\\]\n\nI'll add this to the devops backlog in youtrack\n\nKristinn rn Sigursson \\[17:28\\]\n\nwe'll take a better look after RSA, unless this is a showstopper for RSA"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-964",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "There are two Test Cases that seem to regularly fail:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "cases/subconditions/group/group\\"
            },
            {
              "type": "text",
              "text": "pass\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "or.py (C10139)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "cases/subconditions/group/group\\"
            },
            {
              "type": "text",
              "text": "pass\\",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "and.py (C10140)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is the message we get."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Attached is the full log from one of the tests (the other one is basically the same)"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[EXCEPTION\\] \\[Command '\\['client\\_cli', 'login', '--username', 'stratus1000', '--password', 'Sema2007!', '--provider\\_name', 'Sub\\_Cond', '--controller\\_url', '["
            },
            {
              "type": "text",
              "text": "https://172.17.116.1'](https://172.17.116.1')"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " '-u', 'ws://127.0.0.1:29005'\\]' returned non-zero exit status 1\\] "
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Both TC create a complex condition whihc result i quite a big entitlement"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2015-09-01T12:00:10,754423Z \\[INFO\\] \\[cases/subconditions/group/group\\_pass\\_or\\] Conditions \\[{'updated': '2015-09-01T11:59:10.244Z', 'expression': \"if ( inTimeRange(11, 0, 13, 0)\\\\n || claims.user.username === 'stratus1000'\\\\n || claims.user.firstName === 'stratus1000\\_F'\\\\n || claims.user.lastName === 'stratus1000\\_L'\\\\n || claims.user.emails.indexOf('stratus1000@securedemail.com') != -1 \\\\n || claims.user.groups.indexOf('CN=Dev,OU=stratususers,DC=securedemail,DC=com') != -1 \\\\n || claims.user.distinguishedName === 'CN=stratus1000,OU=stratususers,DC=securedemail,DC=com' ) {\\\\n return true;\\\\n} \\\\n\\\\nreturn false;\", 'taggable': True, 'id': '4f5d7775-26b9-4360-a827-af52c3358f79', 'name': 'Sub\\_Cond\\_Group\\_Pass', 'editable': True, 'repeatSchedules': \\[\\], 'remedyMethods': \\[\\], 'created': '2015-09-01T11:59:10.244Z', 'tags': \\[\\], 'context': 'Other', 'deletable': True}\\]\n\n    2015-09-01T12:00:11,047211Z \\[INFO\\] \\[cases/subconditions/group/group\\_pass\\_or\\] Policies \\[{'updated': '2015-09-01T06:34:16.607561Z', 'editable': True, 'taggable': True, 'id': '172143a0-7ed4-11e4-b4a9-0800200c9a66', 'name': 'Builtin Administrator Policy', 'entitlements': \\['b0adbc60-7ed4-11e4-b4a9-0800200c9a66'\\], 'created': '2015-09-01T06:34:16.607561Z', 'tags': \\['builtin'\\], 'entitlementLinks': \\[\\], 'filters': \\['5da6e4f0-7ed5-11e4-b4a9-0800200c9a66'\\], 'filterLinks': \\[\\], 'deletable': True}, {'updated': '2015-09-01T11:59:10.534Z', 'editable': True, 'taggable': True, 'id': 'a971758c-4059-458e-bc44-2e6bee0be744', 'name': 'Sub\\_Cond\\_Policy', 'entitlements': \\['bab7d285-4bf9-49d3-8ca1-58a69d4621d5', 'fe31e69a-d440-472c-a8b6-be6e9814daa9', '7b906622-64c0-4bab-9d39-1e0d6f75f48d', '5ad4d6ac-4e45-4136-b193-fbd5ca231303', '7b726505-53c8-46ac-98cb-3660a3ee6807', 'a21a4be2-e841-48fa-ad99-5bb41ab84a7d', '04570d66-fb49-450d-a4cc-325512f3c5da', 'd5171b56-b8b1-4a88-b022-38745232360f', '29463b06-6b87-4a75-bbb2-a4d201a0407c', 'c00c72e7-428d-49ac-b009-d7eba3453c7c', 'a0365e4b-5bea-4355-9d2c-098a4d72f937', '47a755f7-40ef-4a4a-a255-a65597fbe611', '671fb979-2f18-4c63-8845-d5663fbd9c96', 'b7f8e1be-fcbc-4fbc-83a2-9f02f6e1704c', '6d5c366a-3fcd-4be5-9b1c-b880c6819ca0'\\], 'created': '2015-09-01T11:59:10.534Z', 'tags': \\[\\], 'entitlementLinks': \\[\\], 'filters': \\['979513aa-0ca0-4910-b1b8-1b9e15253f2e'\\], 'filterLinks': \\[\\], 'deletable': True}\\]\n\n    2015-09-01T12:00:11,066725Z \\[INFO\\] \\[cases/subconditions/group/group\\_pass\\_or\\] Entitlements \\[{'conditions': \\[\\], 'updated': '2015-09-01T06:34:17.078865Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\['builtin'\\], 'actions': \\[{'type': 'View', 'target': 'Policy', 'scope': \\['\\*'\\]}, {'defaultTags': \\['#api-created'\\], 'type': 'Create', 'target': 'Policy'}, {'type': 'Edit', 'target': 'Policy', 'scope': \\['\\*'\\]}, {'type': 'Delete', 'target': 'Policy', 'scope': \\['\\*'\\]}, {'type': 'View', 'target': 'Filter', 'scope': \\['\\*'\\]}, {'defaultTags': \\['#api-created'\\], 'type': 'Create', 'target': 'Filter'}, {'type': 'Edit', 'target': 'Filter', 'scope': \\['\\*'\\]}, {'type': 'Delete', 'target': 'Filter', 'scope': \\['\\*'\\]}, {'type': 'View', 'target': 'Entitlement', 'scope': \\['\\*'\\]}, {'defaultTags': \\['#api-created'\\], 'type': 'Create', 'target': 'Entitlement'}, {'type': 'Edit', 'target': 'Entitlement', 'scope': \\['\\*'\\]}, {'type': 'Delete', 'target': 'Entitlement', 'scope': \\['\\*'\\]}, {'type': 'View', 'target': 'Condition', 'scope': \\['\\*'\\]}, {'defaultTags': \\['#api-created'\\], 'type': 'Create', 'target': 'Condition'}, {'type': 'Edit', 'target': 'Condition', 'scope': \\['\\*'\\]}, {'type': 'Delete', 'target': 'Condition', 'scope': \\['\\*'\\]}, {'type': 'View', 'target': 'Network', 'scope': \\['\\*'\\]}\\], 'created': '2015-09-01T06:34:17.078865Z', 'id': '72cbe03c-4e35-4ff8-9e2b-9bcf88e689f5', 'name': 'Api Access', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.293Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.293Z', 'id': 'bab7d285-4bf9-49d3-8ca1-58a69d4621d5', 'name': 'Sub\\_Cond\\_Ent\\_1', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.443Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.443Z', 'id': 'c00c72e7-428d-49ac-b009-d7eba3453c7c', 'name': 'Sub\\_Cond\\_Ent\\_10', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.458Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.458Z', 'id': 'a0365e4b-5bea-4355-9d2c-098a4d72f937', 'name': 'Sub\\_Cond\\_Ent\\_11', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.473Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.473Z', 'id': '47a755f7-40ef-4a4a-a255-a65597fbe611', 'name': 'Sub\\_Cond\\_Ent\\_12', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.489Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.489Z', 'id': '671fb979-2f18-4c63-8845-d5663fbd9c96', 'name': 'Sub\\_Cond\\_Ent\\_13', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.504Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.504Z', 'id': 'b7f8e1be-fcbc-4fbc-83a2-9f02f6e1704c', 'name': 'Sub\\_Cond\\_Ent\\_14', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.518Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.518Z', 'id': '6d5c366a-3fcd-4be5-9b1c-b880c6819ca0', 'name': 'Sub\\_Cond\\_Ent\\_15', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.308Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.308Z', 'id': 'fe31e69a-d440-472c-a8b6-be6e9814daa9', 'name': 'Sub\\_Cond\\_Ent\\_2', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.325Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.325Z', 'id': '7b906622-64c0-4bab-9d39-1e0d6f75f48d', 'name': 'Sub\\_Cond\\_Ent\\_3', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.341Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.341Z', 'id': '5ad4d6ac-4e45-4136-b193-fbd5ca231303', 'name': 'Sub\\_Cond\\_Ent\\_4', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.356Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.356Z', 'id': '7b726505-53c8-46ac-98cb-3660a3ee6807', 'name': 'Sub\\_Cond\\_Ent\\_5', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.374Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.374Z', 'id': 'a21a4be2-e841-48fa-ad99-5bb41ab84a7d', 'name': 'Sub\\_Cond\\_Ent\\_6', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.393Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.393Z', 'id': '04570d66-fb49-450d-a4cc-325512f3c5da', 'name': 'Sub\\_Cond\\_Ent\\_7', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.411Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.411Z', 'id': 'd5171b56-b8b1-4a88-b022-38745232360f', 'name': 'Sub\\_Cond\\_Ent\\_8', 'deletable': True, 'taggable': True}, {'conditions': \\['4f5d7775-26b9-4360-a827-af52c3358f79'\\], 'updated': '2015-09-01T11:59:10.427Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\[\\], 'actions': \\[{'hosts': \\['172.17.117.164'\\], 'type': 'IpAccess', 'types': \\['0-255'\\], 'log': 'none', 'action': 'allow', 'subtype': 'icmp\\_up', 'alert': 'none'}\\], 'created': '2015-09-01T11:59:10.427Z', 'id': '29463b06-6b87-4a75-bbb2-a4d201a0407c', 'name': 'Sub\\_Cond\\_Ent\\_9', 'deletable': True, 'taggable': True}, {'conditions': \\[\\], 'updated': '2015-09-01T06:34:16.607561Z', 'editable': True, 'conditionLinks': \\[\\], 'tags': \\['builtin'\\], 'actions': \\[{'type': 'All', 'target': 'All', 'scope': \\['\\*'\\]}\\], 'created': '2015-09-01T06:34:16.607561Z', 'id': 'b0adbc60-7ed4-11e4-b4a9-0800200c9a66', 'name': 'System Administration', 'deletable': True, 'taggable': True}\\]"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "These are the only 2 test cases failing in the last \"nightly\" test run"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "anders.larsson",
        "created": 1441109636028
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "New logs taken with the custom build #729"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "andrea.fantini",
        "created": 1441270782449
      }
    ]
  },
  {
    "key": "SA-1375",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The URL paths, as configured in Nginx, suffer from a lack of inconsistency and quirks for historical reasons. This task is go through them and make them sensible and consistent."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Suggested changes below."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Client port"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Old URL"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "New URL"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Internal URL"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/authentication"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authentication"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/authentication/enter-password"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authentication/password"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/enter-password]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/enter-password)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/authentication/otp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authentication/otp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/otp]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/otp)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/authentication/otp/initialize"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authentication/otp/initialize"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/otp/initialize]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/otp/initialize)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/authentication/saml"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authentication/saml"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/saml]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/saml)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/authorization"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authorization"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/authorization]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/authorization)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/certificate-authority/ca"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/certificate-authority/ca"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/certificate-authority/ca]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/certificate-authority/ca)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/certificate-authority/csr/client"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/certificate-authority/csr/client"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/certificate-authority/csr/client]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/certificate-authority/csr/client)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/client/identity-providers"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/identity-providers"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(identitydPort)d/identity-providers/names]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(identitydPort)d/identity-providers/names)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/login"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/login"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/login]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/login)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/logout"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/logout"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/logout]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/logout)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/claims/token/update"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/claims/token"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/session/claims/token/update]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/session/claims/token/update)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/claims/untrusted/update"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/claims/untrusted"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/session/claims/untrusted/update]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/session/claims/untrusted/update)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/entitlement/token/update"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/entitlements/token"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/session/entitlement/token/update]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/session/entitlement/token/update)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/ws/session"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/session/ws"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/ws/session]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/ws/session)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Peer port"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Old URL"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "New URL"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Internal URL"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/actions"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/actions"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/actions]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/actions)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/appliances"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/appliances"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/appliances]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/appliances)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/admin]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/admin)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication/otp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication/otp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/admin/otp]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/admin/otp)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication/otp/initialize"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication/otp/initialize"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/admin/otp/initialize]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/admin/otp/initialize)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication/saml"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authentication/saml"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication/admin/saml]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication/admin/saml)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authorization"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authorization"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/authorization/admin]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/authorization/admin)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authorization/policy-evaluator/test"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/authorization/policy-evaluator/test"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/authorization/policy-evaluator/test]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/authorization/policy-evaluator/test)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/blacklist"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/blacklist"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(identitydPort)d/blacklist]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(identitydPort)d/blacklist)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/certificate-authority"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/certificate-authority"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/certificate-authority]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/certificate-authority)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/conditions"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/conditions"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/conditions]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/conditions)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/entitlements"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/entitlements"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/entitlements]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/entitlements)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/filters"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/filters"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/filters]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/filters)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/identity-providers"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/identity-providers"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(identitydPort)d/identity-providers]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(identitydPort)d/identity-providers)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/ip-pools"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/ip-pools"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(identitydPort)d/ip-pools]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(identitydPort)d/ip-pools)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/login"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/login"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/login]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/login)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/sites"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/sites"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/sites]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/sites)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/otp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/otp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(identitydPort)d/otp]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(identitydPort)d/otp)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/policies"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/policies"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/policies]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/policies)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/stats"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/stats"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/stats]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/stats)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/token-records"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/token-records"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/token-records]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/token-records)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/users"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/users"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(identitydPort)d/local-users]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(identitydPort)d/local-users)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance/activate"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/appliance/activate"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/appliances/activate]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/appliances/activate)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance/configuration"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/appliance/configuration"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/appliances/configuration]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/appliances/configuration)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance-control/configuration"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance/configuration"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(configdPort)d/configuration]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(configdPort)d/configuration)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance-control/status"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance/status"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(configdPort)d/status]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(configdPort)d/status)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance-control/upgrade"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance/upgrade"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(configdPort)d/upgrade]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(configdPort)d/upgrade)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/appliance/revoked-tokens"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/admin/appliance/revoked-tokens"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(managedPort)d/token-records/revocation-list]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(managedPort)d/token-records/revocation-list)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authproxy"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authproxy"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authproxydPort)d/auth]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authproxydPort)d/auth)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/controller/authentication"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authentication-service"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authdPort)d/authentication]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authdPort)d/authentication)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/controller/authorization"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/authorization-service"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(authordPort)d/authorization/kibana]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(authordPort)d/authorization/kibana)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/logrelay"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/logrelay"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(logdRelayPort)d]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(logdRelayPort)d)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/logs/"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/logs/"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(kibanaPort)d/]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(kibanaPort)d/)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/sessions"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/sessions"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/sessions]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/sessions)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/tokens/revocations"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/sessions/revocations"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(sessiondPort)d/sessions/revocations]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(sessiondPort)d/sessions/revocations)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/troubleviewer"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/troubleviewer"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":%(troubleViewerPort)d/troubleviewer]("
            },
            {
              "type": "text",
              "text": "http://127.0.0.1",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://127.0.0.1"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "%(troubleViewerPort)d/troubleviewer)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/ui"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/ui"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "N/A"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The reason for "
                },
                {
                  "type": "text",
                  "text": "/appliance-control",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is that "
                },
                {
                  "type": "text",
                  "text": "/appliance",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " was already taken by the controller but the controller actually uses "
                },
                {
                  "type": "text",
                  "text": "/admin/appliance",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So I'm fine with "
                },
                {
                  "type": "text",
                  "text": "/appliance",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " or "
                },
                {
                  "type": "text",
                  "text": "/config",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " or any better suggestion"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1443793850617
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The /controller stuff seems related to Kibana, so perhaps it should be called something else."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is related to authproxy which is used by kibana and troubleviewer but might be used by more in the future. Its basically a HTTP basic auth -> Controller auth proxy which can work with remote controllers."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The URL per initially used was "
                },
                {
                  "type": "text",
                  "text": "/external/controller/authorization",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1443794027965
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is my new proposal, the new URLs are to the right, with \\"
                },
                {
                  "type": "text",
                  "text": " marking changes.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Client port:\n\n/client/authentication                     \\* /authentication\n\n/client/authentication/enter-password      \\* /authentication/password\n\n/client/authentication/otp                 \\* /authentication/otp\n\n/client/authentication/otp/initialize      \\* /authentication/otp/initialize\n\n/client/authentication/saml                \\* /authentication/saml\n\n/client/authorization                      \\* /authorization\n\n/client/certificate-authority/ca           \\* /certificate-authority/ca\n\n/client/certificate-authority/csr/client   \\* /certificate-authority/csr/client\n\n/client/identity-providers                 \\* /identity-providers\n\n/login                                     \\* /session/login\n\n/logout                                    \\* /session/logout\n\n/session/claims/token/update               \\* /session/claims/token\n\n/session/claims/untrusted/update           \\* /session/claims/untrusted\n\n/session/entitlement/token/update          \\* /session/entitlements\n\n/ws/session                                \\* /session/ws\n\nPeer port:\n\n/admin/actions                               /admin/actions\n\n/admin/appliances                            /admin/appliances\n\n/admin/authentication                        /admin/authentication\n\n/admin/authentication/otp                    /admin/authentication/otp\n\n/admin/authentication/otp/initialize         /admin/authentication/otp/initialize\n\n/admin/authentication/saml                   /admin/authentication/saml\n\n/admin/authorization                         /admin/authorization\n\n/admin/authorization/policy-evaluator/test   /admin/authorization/policy-evaluator/test\n\n/admin/blacklist                             /admin/blacklist\n\n/admin/certificate-authority                 /admin/certificate-authority\n\n/admin/conditions                            /admin/conditions\n\n/admin/entitlements                          /admin/entitlements\n\n/admin/filters                               /admin/filters\n\n/admin/identity-providers                    /admin/identity-providers\n\n/admin/ip-pools                              /admin/ip-pools\n\n/admin/login                                 /admin/login\n\n/admin/networks                              /admin/networks\n\n/admin/otp                                   /admin/otp\n\n/admin/policies                              /admin/policies\n\n/admin/stats                                 /admin/stats\n\n/admin/token-records                         /admin/token-records\n\n/admin/users                                 /admin/users\n\n/appliance/activate                        \\* /admin/appliance/activate\n\n/appliance/configuration                   \\* /admin/appliance/configuration\n\n/appliance/revoked-tokens                  \\* /admin/appliance/revoked-tokens\n\n/appliance-control/configuration           \\* /appliance/configuration\n\n/appliance-control/status                  \\* /appliance/status\n\n/appliance-control/upgrade                 \\* /appliance/upgrade\n\n/authproxy                                   /authproxy\n\n/controller/authentication                 \\* /authentication-service\n\n/controller/authorization                  \\* /authorization-service/kibana\n\n/logd                                        /logd\n\n/logs                                        /logs\n\n/sessions                                  \\* /sessions/list\n\n/tokens/revocations                        \\* /sessions/revoke\n\n/troubleviewer                               /troubleviewer\n\n/ui                                          /ui"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Changes summarized:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Drop /client from client-port URLs."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  /authentication/enter-password sounds stupid, renamed to /authentication/password."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  All client-port URLs going to sessiond are prefixed with /session."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  The /update suffixes such as in /session/claims/token/update are unnecessary, doing PUT on an URL like /session/claims/token should be self-descriptive."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  All peer-port administration URLs are still prefixed with /admin, but /appliance was not."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Now that /appliance is /admin/appliance, we can rename /appliance-control to simply /appliance."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Renamed /controller/authentication to /authentication-service."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Renamed /controller/authorization to /authorization-service/kibana, since it's kibana-specific."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Gave the peer-port sessiond URLs the prefix /sessions, renamed /sessions to /sessions/list."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  I suppose /tokens/revocations is for pushing revocations, but it sounds like it's for querying for revocations. Renamed to /sessions/revoke."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1444067504956
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Renamed /controller/authorization to /authorization-service/kibana, since it's kibana-specific."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Its not kibana specific since it's used at least by troubleviewer and could be used by more in the future."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I suppose /tokens/revocations is for pushing revocations, but it sounds like it's for querying for revocations. Renamed to /sessions/revoke."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Why not use /session here as well (so /session/revoke)?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I agree with all the other changes."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1444116822650
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Its not kibana specific since it's used at least by troubleviewer and could be used by more in the future."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, the location looks like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "    location /controller/authorization {\n\n        proxy\\_set\\_header X-Forwarded-For $remote\\_addr;\n\n        proxy\\_pass ["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:%(authordPort)d/authorization/kibana](http://127.0.0.1:%\\(authordPort\\)d/authorization/kibana)"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n\n    }"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So maybe the URL to authord should be changed, if it's not Kibana-specific."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Why not use /session here as well (so /session/revoke)?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session makes sense for the client, since it handles the client's session. But that's misleading on the peer port, since there we handle all sessions, so I chose /sessions. For instance, /sessions/list makes more sense than /session/list. I don't want a daemon name there such as /sessiond."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1444121872173
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So maybe the URL to authord should be changed, if it's not Kibana-specific."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Agreed, [Gokhan Berberoglu]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/gokhan.berberoglu",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/gokhan.berberoglu"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"gokhan.berberoglu\") or "
                },
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " needs to update the URL there."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session makes sense for the client, since it handles the client's session. But that's misleading on the peer port, since there we handle all sessions, so I chose /sessions. For instance, /sessions/list makes more sense than /session/list. I don't want a daemon name there such as /sessiond."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Makes sense."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1444122690750
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/tom.weber",
                        "title": "tom.weber"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", can you come up with 3 column (instead of 2 column above) list by adding what is it rewritten to ?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "old-public"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "new-public"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "internal-with-port"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "localhost:9020/authentication/client"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "that would help us to review this better.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "gokhan.berberoglu",
        "created": 1444123023727
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client port"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Old URL"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "New URL"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Internal URL"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authentication/enter-password"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication/password"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/enter-password]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/enter-password)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authentication/otp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication/otp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/otp]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/otp)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authentication/otp/initialize"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication/otp/initialize"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/otp/initialize]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/otp/initialize)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authentication/saml"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication/saml"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/saml]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/saml)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/authorization"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authorization"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/authorization]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/authorization)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/certificate-authority/ca"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/certificate-authority/ca"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/certificate-authority/ca]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/certificate-authority/ca)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/certificate-authority/csr/client"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/certificate-authority/csr/client"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/certificate-authority/csr/client]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/certificate-authority/csr/client)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/client/identity-providers"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/identity-providers"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(identitydPort)d/identity-providers/names]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(identitydPort)d/identity-providers/names)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/login"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/login"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/login]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/login)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/logout"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/logout"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/logout]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/logout)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/claims/token/update"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/claims/token"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/session/claims/token/update]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/session/claims/token/update)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/claims/untrusted/update"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/claims/untrusted"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/session/claims/untrusted/update]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/session/claims/untrusted/update)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/entitlement/token/update"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/entitlements"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/session/entitlement/token/update]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/session/entitlement/token/update)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/ws/session"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/session/ws"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/ws/session]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/ws/session)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Peer port"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Old URL"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "New URL"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Internal URL"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/actions"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/actions"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/actions]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/actions)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/appliances"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/appliances"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/appliances]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/appliances)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/admin]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/admin)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication/otp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication/otp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/admin/otp]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/admin/otp)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication/otp/initialize"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication/otp/initialize"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/admin/otp/initialize]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/admin/otp/initialize)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication/saml"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authentication/saml"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication/admin/saml]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication/admin/saml)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authorization"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authorization"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/authorization/admin]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/authorization/admin)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authorization/policy-evaluator/test"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/authorization/policy-evaluator/test"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/authorization/policy-evaluator/test]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/authorization/policy-evaluator/test)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/blacklist"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/blacklist"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(identitydPort)d/blacklist]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(identitydPort)d/blacklist)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/certificate-authority"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/certificate-authority"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/certificate-authority]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/certificate-authority)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/conditions"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/conditions"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/conditions]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/conditions)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/entitlements"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/entitlements"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/entitlements]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/entitlements)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/filters"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/filters"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/filters]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/filters)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/identity-providers"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/identity-providers"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(identitydPort)d/identity-providers]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(identitydPort)d/identity-providers)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/ip-pools"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/ip-pools"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(identitydPort)d/ip-pools]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(identitydPort)d/ip-pools)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/login"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/login"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/login]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/login)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/sites"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/sites"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/sites]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/sites)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/otp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/otp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(identitydPort)d/otp]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(identitydPort)d/otp)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/policies"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/policies"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/policies]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/policies)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/stats"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/stats"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/stats]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/stats)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/token-records"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/token-records"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/token-records]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/token-records)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/users"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/users"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(identitydPort)d/local-users]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(identitydPort)d/local-users)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance/activate"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/appliance/activate"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/appliances/activate]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/appliances/activate)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance/configuration"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/appliance/configuration"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/appliances/configuration]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/appliances/configuration)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance-control/configuration"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance/configuration"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(configdPort)d/configuration]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(configdPort)d/configuration)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance-control/status"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance/status"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(configdPort)d/status]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(configdPort)d/status)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance-control/upgrade"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance/upgrade"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(configdPort)d/upgrade]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(configdPort)d/upgrade)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/appliance/revoked-tokens"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/admin/appliance/revoked-tokens"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(managedPort)d/token-records/revocation-list]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(managedPort)d/token-records/revocation-list)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authproxy"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authproxy"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authproxydPort)d/auth]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authproxydPort)d/auth)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/controller/authentication"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authentication-service"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authdPort)d/authentication]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authdPort)d/authentication)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/controller/authorization"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/authorization-service"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(authordPort)d/authorization/kibana]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(authordPort)d/authorization/kibana)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/logd"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/logd"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(logdRelayPort)d]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(logdRelayPort)d)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/logs/"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/logs/"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(kibanaPort)d/]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(kibanaPort)d/)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/sessions"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/sessions/list"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/sessions]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/sessions)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/tokens/revocations"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/sessions/revoke"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(sessiondPort)d/tokens/revocations]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(sessiondPort)d/tokens/revocations)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/troubleviewer"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/troubleviewer"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":%(troubleViewerPort)d/troubleviewer]("
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "%(troubleViewerPort)d/troubleviewer)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/ui"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/ui"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "N/A"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "edited by gokhan to change networks to sites",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1444127274419
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Any feedback?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1444299171040
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "/sessions/sessions/list"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this does not make sense for the rest convention.. urls do not indicate basic CRUD operations.. http methods do. GET is a LIST operation in rest.. it should stay as /sessions"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "gokhan.berberoglu",
        "created": 1444642766960
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this does not make sense for the rest convention.. urls do not indicate basic CRUD operations.. http methods do. GET is a LIST operation in rest.. it should stay as /sessions"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "+1 to that"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1444642973790
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber 11:53 AM if we agree on the changes, we have to:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "change the nginx config (that is the easiest part)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "change the client"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "change the admin frontend"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "change the controller services which talk to other nodes"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "change authproxyd and perhaps other services which talk to other nodes"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "and for bonus points, we could"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "change the URLs in the services accordingly, such as /tokens/revocations to /sessions/revoke"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Thomas Cellerier 11:54 AM 7) change the tests"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1444650530522
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here we have "
                },
                {
                  "type": "text",
                  "text": "/logd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " as a public URL. I don't think we should have implementation details in the URL, how about "
                },
                {
                  "type": "text",
                  "text": "/logrelay",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1445428762989
      }
    ]
  },
  {
    "key": "SA-1591",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We want to support Okta as a SAML provider with AD backend, and see if we can retrieve AD attributes via SAML token."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We have an Okta developer account now:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://dev-764072.oktapreview.com/login/login.htm",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://dev-764072.oktapreview.com/login/login.htm"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "user ~ jamie.bodley-scott"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "cryptzone.com",
                    "text": "@cryptzone.com",
                    "accessLevel": ""
                  }
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "pass ~ Drakegatan7"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Useful stuff is here: "
                },
                {
                  "type": "text",
                  "text": "http://developer.okta.com/docs/api/getting\\_started/design\\_principles.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://developer.okta.com/docs/api/getting_started/design_principles.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1460738081555
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Created an app where it returns the following SAML snippet:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<saml2:Conditions xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" NotBefore=\"2016-04-18T14:56:15.645Z\" NotOnOrAfter=\"2016-04-18T15:06:15.645Z\">\n\n    <saml2:AudienceRestriction>\n\n        <saml2:Audience>okta\\_test</saml2:Audience>\n\n    </saml2:AudienceRestriction>\n\n</saml2:Conditions>\n\n<saml2:AuthnStatement xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" AuthnInstant=\"2016-04-18T15:01:15.645Z\" SessionIndex=\"id1460991675645.1856427122\">\n\n    <saml2:AuthnContext>\n\n        <saml2:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport</saml2:AuthnContextClassRef>\n\n    </saml2:AuthnContext>\n\n</saml2:AuthnStatement>\n\n<saml2:AttributeStatement xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n\n    <saml2:Attribute Name=\"username\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">jamie.bodley-scott@cryptzone.com</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"id\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">jamie.bodley-scott@cryptzone.com</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"firstName\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">Jamie</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"lastName\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">Bodley-Scott</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"emails\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">jamie.bodley-scott@cryptzone.com</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"groups\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">test</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n</saml2:AttributeStatement>"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " It has encryption etc. support which may be helpful for different implementation in the future."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1460992107863
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Full example for future use:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<saml2p:Response xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " Destination=\"["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:29001/saml](http://127.0.0.1:29001/saml)\""
                },
                {
                  "type": "text",
                  "text": " ID=\"id40057630506690131583725617\" IssueInstant=\"2016-04-19T10:10:36.107Z\" Version=\"2.0\">\n\n<saml2:Issuer xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\">["
                },
                {
                  "type": "text",
                  "text": "http://www.okta.com/exk67telgvNxuVCid0h7](http://www.okta.com/exk67telgvNxuVCid0h7)</saml2:Issuer>"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:Signature xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:SignedInfo>\n\n    <ds:CanonicalizationMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:SignatureMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256](http://www.w3.org/2001/04/xmldsig-more#rsa-sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:Reference URI=\"#id40057630506690131583725617\">\n\n        <ds:Transforms>\n\n            <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#enveloped-signature](http://www.w3.org/2000/09/xmldsig#enveloped-signature)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n            <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n            <ec:InclusiveNamespaces xmlns:ec=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\""
                },
                {
                  "type": "text",
                  "text": " PrefixList=\"xs\"/>\n\n        </ds:Transform>\n\n    </ds:Transforms>\n\n    <ds:DigestMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#sha256](http://www.w3.org/2001/04/xmlenc#sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:DigestValue>CkcASENEOXggt42HS3aeUFKTn76+uwYfgCN3Boxh38Q=</ds:DigestValue>\n\n</ds:Reference>\n\n</ds:SignedInfo>\n\n<ds:SignatureValue>ewHP8Lb40+HIWgN09guXNHIyvydm2r9QRJ0aTdAoroozRp3tS5641R1uXLIpMQ1tGwzTMK4rTy9TgOoFNN7ZBAc31OMICU5wcxTW0H6HmkkiPPiKPFEGE1gcfV3ZSK5tvhQPs29Fjgo/bXOQh9aldBSEx9cmhJ7nNhHYxDthKSLUoXrxRw883temzNov5xzgTschdY/JpMq0yrU3QnwhCunRxhans77olDrIOAOsTwEOpI5yCW3mk40VaPHr1YUwrchK31AiwmqeLTpzUjCycTBDajjQCpMBHJmowj3Dy/o4ETc750kHcRwDAqbOKpjLK95cyYb32X0rRyeNrlk+aQ==</ds:SignatureValue>\n\n<ds:KeyInfo>\n\n    <ds:X509Data>\n\n        <ds:X509Certificate>MIIDpDCCAoygAwIBAgIGAVNCM9YkMA0GCSqGSIb3DQEBBQUAMIGSMQswCQYDVQQGEwJVUzETMBEG\n\n        A1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzENMAsGA1UECgwET2t0YTEU\n\n        MBIGA1UECwwLU1NPUHJvdmlkZXIxEzARBgNVBAMMCmRldi03NjQwNzIxHDAaBgkqhkiG9w0BCQEW\n\n        DWluZm9Ab2t0YS5jb20wHhcNMTYwMzA0MTUxNTQ2WhcNMjYwMzA0MTUxNjQ2WjCBkjELMAkGA1UE\n\n        BhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xDTALBgNV\n\n        BAoMBE9rdGExFDASBgNVBAsMC1NTT1Byb3ZpZGVyMRMwEQYDVQQDDApkZXYtNzY0MDcyMRwwGgYJ\n\n        KoZIhvcNAQkBFg1pbmZvQG9rdGEuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA\n\n        ld5EMTbyYx0L9YYo3wsWFL5Jq1CpULqpNhAUiPiMI+zfISSWco6SlFnbhEpaVl3rDILNHLEKYPOc\n\n        8pyDtQbrsvkxR402lpu94R0mFw1a/BO5oBvKoY0VnEDpYHMw65oq/TM3qw0pB3Qc3ZtihSjNZqpz\n\n        CD7WF6uIWJ3oDXCmPp/1ZJBxs6/rhfiGwvJCH/uu4PreBsuE7IgPnKrpxLD0F4yJS+h1Ypdb2B3o\n\n        TocPKvW9sAnITqKOZTrNKskTp0o6W1lO57s3cgtdWZLeuqR86UXvS5kBy3qiMoWxG7vRU70/7a7c\n\n        fxvD7DjUEXxf6IcS/soAXzHTAbkOAXoGDBvyqwIDAQABMA0GCSqGSIb3DQEBBQUAA4IBAQAVY69Y\n\n        uDLP6ByhGS5fy7ZYT3+JkAmPzK1A5lhVod9VIs+YfFvoLd3GsCulw7m4mzEjTm2uwy6rkXpGe1pv\n\n        rh+bpfrgNs91c0cBReFcUkVgNl1Dq1jMFJpuf7GsJgdbckGfysdiSevWpq/LOqXzp4vApNskTyC1\n\n        SQUTcIbPvjeeuXbvsI7oAeU49RhmTFDJLs2F6IaPA85mZjYBdHZo6UUrfJQsRHfZuJXt0fagfEO/\n\n        kbV9s2har4XGj/oKrhcVvEIaEirDWNoNjW3AF5+wmTFb5949Mh4Y5GBnUYXwrKM4zr0e7YMeUivj\n\n        MOpoLxDkgQBUjOj51iF/tR15jX17PbEg</ds:X509Certificate>\n\n    </ds:X509Data>\n\n</ds:KeyInfo>\n\n</ds:Signature>\n\n<saml2p:Status xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\">\n\n    <saml2p:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n\n</saml2p:Status>\n\n<saml2:Assertion xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " ID=\"id4005763050747628696997251\" IssueInstant=\"2016-04-19T10:10:36.107Z\" Version=\"2.0\">\n\n<saml2:Issuer xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\">["
                },
                {
                  "type": "text",
                  "text": "http://www.okta.com/exk67telgvNxuVCid0h7](http://www.okta.com/exk67telgvNxuVCid0h7)</saml2:Issuer>"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:Signature xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:SignedInfo>\n\n    <ds:CanonicalizationMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:SignatureMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256](http://www.w3.org/2001/04/xmldsig-more#rsa-sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:Reference URI=\"#id4005763050747628696997251\">\n\n        <ds:Transforms>\n\n            <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#enveloped-signature](http://www.w3.org/2000/09/xmldsig#enveloped-signature)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n            <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n            <ec:InclusiveNamespaces xmlns:ec=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\""
                },
                {
                  "type": "text",
                  "text": " PrefixList=\"xs\"/>\n\n        </ds:Transform>\n\n    </ds:Transforms>\n\n    <ds:DigestMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#sha256](http://www.w3.org/2001/04/xmlenc#sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:DigestValue>so2a1RxBAA2rApCcF1c7HTbNKRzNuGQ/i0jR4ivGZcM=</ds:DigestValue>\n\n</ds:Reference>\n\n</ds:SignedInfo>\n\n<ds:SignatureValue>WpLXdwH4/KnXbBb6qvV3bod30qnYgNEUJt3Va1uegzik582C+uAlvTW2db5z6s1ZTa8xYxyy6ob3W/3Pa6Eg4AjLe1sVpAs7EfuEYEq5h9QN/1SxuomXlyWVJbtUX1TVCRXS3EX40AtEMSA3/kl/KjHDXVRPQcn1wHJmxI+iEPxjyuwjOpGWOGSZUcJ5At86UdKXoI2EvqBMSCysJT/UEK/dYsg7HRfbNgxFSUpf2jz1fmCJsJMD9IwAf6C/x0d0AsXQBdyI7AW/LpHlhmAQaXn9mAJgudv1KvR19bQNTyPvhJ0/6vVniEa3miT1YJqhIAN96OA4siqpT+RGpbi5qA==</ds:SignatureValue>\n\n<ds:KeyInfo>\n\n    <ds:X509Data>\n\n        <ds:X509Certificate>MIIDpDCCAoygAwIBAgIGAVNCM9YkMA0GCSqGSIb3DQEBBQUAMIGSMQswCQYDVQQGEwJVUzETMBEG\n\n        A1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzENMAsGA1UECgwET2t0YTEU\n\n        MBIGA1UECwwLU1NPUHJvdmlkZXIxEzARBgNVBAMMCmRldi03NjQwNzIxHDAaBgkqhkiG9w0BCQEW\n\n        DWluZm9Ab2t0YS5jb20wHhcNMTYwMzA0MTUxNTQ2WhcNMjYwMzA0MTUxNjQ2WjCBkjELMAkGA1UE\n\n        BhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xDTALBgNV\n\n        BAoMBE9rdGExFDASBgNVBAsMC1NTT1Byb3ZpZGVyMRMwEQYDVQQDDApkZXYtNzY0MDcyMRwwGgYJ\n\n        KoZIhvcNAQkBFg1pbmZvQG9rdGEuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA\n\n        ld5EMTbyYx0L9YYo3wsWFL5Jq1CpULqpNhAUiPiMI+zfISSWco6SlFnbhEpaVl3rDILNHLEKYPOc\n\n        8pyDtQbrsvkxR402lpu94R0mFw1a/BO5oBvKoY0VnEDpYHMw65oq/TM3qw0pB3Qc3ZtihSjNZqpz\n\n        CD7WF6uIWJ3oDXCmPp/1ZJBxs6/rhfiGwvJCH/uu4PreBsuE7IgPnKrpxLD0F4yJS+h1Ypdb2B3o\n\n        TocPKvW9sAnITqKOZTrNKskTp0o6W1lO57s3cgtdWZLeuqR86UXvS5kBy3qiMoWxG7vRU70/7a7c\n\n        fxvD7DjUEXxf6IcS/soAXzHTAbkOAXoGDBvyqwIDAQABMA0GCSqGSIb3DQEBBQUAA4IBAQAVY69Y\n\n        uDLP6ByhGS5fy7ZYT3+JkAmPzK1A5lhVod9VIs+YfFvoLd3GsCulw7m4mzEjTm2uwy6rkXpGe1pv\n\n        rh+bpfrgNs91c0cBReFcUkVgNl1Dq1jMFJpuf7GsJgdbckGfysdiSevWpq/LOqXzp4vApNskTyC1\n\n        SQUTcIbPvjeeuXbvsI7oAeU49RhmTFDJLs2F6IaPA85mZjYBdHZo6UUrfJQsRHfZuJXt0fagfEO/\n\n        kbV9s2har4XGj/oKrhcVvEIaEirDWNoNjW3AF5+wmTFb5949Mh4Y5GBnUYXwrKM4zr0e7YMeUivj\n\n        MOpoLxDkgQBUjOj51iF/tR15jX17PbEg</ds:X509Certificate>\n\n    </ds:X509Data>\n\n</ds:KeyInfo>\n\n</ds:Signature>\n\n<saml2:Subject xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n\n    <saml2:NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\">jamie.bodley-scott@cryptzone.com</saml2:NameID>\n\n    <saml2:SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\">\n\n        <saml2:SubjectConfirmationData NotOnOrAfter=\"2016-04-19T10:15:36.107Z\" Recipient=\"["
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:29001/saml](http://127.0.0.1:29001/saml)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    </saml2:SubjectConfirmation>\n\n</saml2:Subject>\n\n<saml2:Conditions xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" NotBefore=\"2016-04-19T10:05:36.107Z\" NotOnOrAfter=\"2016-04-19T10:15:36.107Z\">\n\n    <saml2:AudienceRestriction>\n\n        <saml2:Audience>okta\\_test</saml2:Audience>\n\n    </saml2:AudienceRestriction>\n\n</saml2:Conditions>\n\n<saml2:AuthnStatement xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" AuthnInstant=\"2016-04-19T10:10:36.107Z\" SessionIndex=\"id1461060636107.1022104153\">\n\n    <saml2:AuthnContext>\n\n        <saml2:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport</saml2:AuthnContextClassRef>\n\n    </saml2:AuthnContext>\n\n</saml2:AuthnStatement>\n\n<saml2:AttributeStatement xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n\n    <saml2:Attribute Name=\"username\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">jamie.bodley-scott@cryptzone.com</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"id\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">jamie.bodley-scott@cryptzone.com</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"firstName\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">Jamie</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"lastName\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">Bodley-Scott</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"emails\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">jamie.bodley-scott@cryptzone.com</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n    <saml2:Attribute Name=\"groups\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\">\n\n        <saml2:AttributeValue xmlns:xs=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema](http://www.w3.org/2001/XMLSchema)\""
                },
                {
                  "type": "text",
                  "text": " xmlns:xsi=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)\""
                },
                {
                  "type": "text",
                  "text": " xsi:type=\"xs:string\">test</saml2:AttributeValue>\n\n    </saml2:Attribute>\n\n</saml2:AttributeStatement>\n\n</saml2:Assertion>\n\n</saml2p:Response>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1461061021442
      }
    ]
  },
  {
    "key": "SA-1621",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Since we moved all the daemons to non root users troubleviewer does not have rights to the log files and is therefore quite useless."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The important ones are:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/var/log/upstart/\\"
            },
            {
              "type": "text",
              "text": " now owned by root",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "/var/log/syslog now owned by syslog"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "adm: Group adm is used for system monitoring tasks. Members of this group can read many log files in /var/log, and can use xconsole. Historically, /var/log was /usr/adm (and later /var/adm), thus the name of the group."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Adding our "
                },
                {
                  "type": "text",
                  "text": "czd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " user to that group will get the job done, looks like it, for "
                },
                {
                  "type": "text",
                  "text": "syslog",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " logs however I notice that "
                },
                {
                  "type": "text",
                  "text": "upstart",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " logs are "
                },
                {
                  "type": "text",
                  "text": "root:root",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " i.e. the group is not "
                },
                {
                  "type": "text",
                  "text": "adm",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1445849253949
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Write now we have:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Our daemons write to "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and under "
                        },
                        {
                          "type": "text",
                          "text": "/var/log/upstart/cz-DAEMON.log",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " (same logs in 2 places...)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "troubled can look at "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and per "
                        },
                        {
                          "type": "text",
                          "text": "cz-DAEMON.log",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " file"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "The proposal is:"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "No change to our daemons. They keep writing to "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "troubled starts as "
                        },
                        {
                          "type": "text",
                          "text": "czd:czd",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " where "
                        },
                        {
                          "type": "text",
                          "text": "czd",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " user is member of the harmful \"log/monitoring\" group "
                        },
                        {
                          "type": "text",
                          "text": "adm",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " ("
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " user is already member of "
                        },
                        {
                          "type": "text",
                          "text": "adm",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ")"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "At this point troubled has access to ALL logs as all daemon write explicitly to "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " (if not, they shall be instructed to)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "The "
                        },
                        {
                          "type": "text",
                          "text": "$KLogPermitNonKernelFacility on",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " in the "
                        },
                        {
                          "type": "text",
                          "text": "rsyslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " configuration is a BONUS where we get in "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " all the PURE upstart logs that we right now lose. For example if the job has not started for X reason or whatever the upstart process has created i.e. NO duplication, nothing to do with the logs produced by our daemons which are spawned by upstart"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Conclusion: "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " will now contain ALL logs from all processes as we already log to "
                        },
                        {
                          "type": "text",
                          "text": "syslog",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " INCLUDING the process "
                        },
                        {
                          "type": "text",
                          "text": "upstart",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " because of step 4 and all of that as "
                        },
                        {
                          "type": "text",
                          "text": "czd:czd",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " user. Files under "
                        },
                        {
                          "type": "text",
                          "text": "/var/log/upstart/cz-DAEMON.log",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " won't be accessible from troubled (of course from console it will work)"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [2:59 PM]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "okay as long as there is no duplication..."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1445868617127
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Logs that successfully end up in "
                },
                {
                  "type": "text",
                  "text": "syslog",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " from the process "
                },
                {
                  "type": "text",
                  "text": "upstart",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " that before were getting totally lost:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "initctl log-priority info",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "]:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Oct 26 14:22:58 test-appliance rsyslogd: \\[origin software=\"rsyslogd\" swVersion=\"7.4.4\" x-pid=\"3163\" x-info=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.rsyslog.com](http://www.rsyslog.com)\"\\]"
                },
                {
                  "type": "text",
                  "text": " start\n\nOct 26 14:22:58 test-appliance rsyslogd: rsyslogd's groupid changed to 104\n\nOct 26 14:22:58 test-appliance rsyslogd: rsyslogd's userid changed to 101\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.730493\\] init: rsyslog main process (2566) exited normally\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.730525\\] init: rsyslog state changed from killed to post-stop\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.730579\\] init: rsyslog state changed from post-stop to starting\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.730608\\] init: Handling starting event\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.730704\\] init: rsyslog state changed from starting to security\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.730724\\] init: rsyslog state changed from security to pre-start\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.733438\\] init: rsyslog pre-start process (3157)\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.733533\\] init: Connection from private client\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.734419\\] init: rsyslog pre-start process (3157) exited normally\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.734447\\] init: rsyslog state changed from pre-start to spawned\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.734951\\] init: rsyslog main process (3162)\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.735315\\] init: rsyslog main process (3162) executable changed\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.736974\\] init: rsyslog main process (3162) became new process (3163)\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.736982\\] init: rsyslog state changed from spawned to post-start\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737114\\] init: rsyslog state changed from post-start to running\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737266\\] init: Handling started event\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737434\\] init: startpar-bridge (rsyslog--started) goal changed from stop to start\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737539\\] init: startpar-bridge (rsyslog--started) state changed from waiting to starting\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737704\\] init: Handling starting event\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737733\\] init: startpar-bridge (rsyslog--started) state changed from starting to security\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.737834\\] init: startpar-bridge (rsyslog--started) state changed from security to pre-start\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.739327\\] init: startpar-bridge (rsyslog--started) state changed from pre-start to spawned\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.740625\\] init: startpar-bridge (rsyslog--started) main process (3175)\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.740635\\] init: startpar-bridge (rsyslog--started) state changed from spawned to post-start\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.740771\\] init: startpar-bridge (rsyslog--started) state changed from post-start to running\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.740993\\] init: Handling started event\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741284\\] init: startpar-bridge (rsyslog--started) main process (3175) exited normally\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741313\\] init: startpar-bridge (rsyslog--started) goal changed from start to stop\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741444\\] init: startpar-bridge (rsyslog--started) state changed from running to stopping\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741549\\] init: Handling stopping event\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741578\\] init: startpar-bridge (rsyslog--started) state changed from stopping to killed\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741689\\] init: startpar-bridge (rsyslog--started) state changed from killed to post-stop\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.741783\\] init: startpar-bridge (rsyslog--started) state changed from post-stop to waiting\n\nOct 26 14:22:58 test-appliance kernel: \\[ 5856.742273\\] init: Handling stopped event\n\nOct 26 14:23:21 test-appliance kernel: \\[ 5879.148891\\] init: Connection from private client\n\nOct 26 14:23:21 test-appliance kernel: \\[ 5879.149609\\] init: Handling hello event\n"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1445869490711
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.cryptzone.ad/cryptzone/stratus-appliance/pull/294",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.cryptzone.ad/cryptzone/stratus-appliance/pull/294"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1445879012586
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Notes about the bonus fixed here which is getting upstart's logs itself in syslog"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "apparently Upstart (1.5) does not log to syslog, that is, it doesn't call the glibc function syslog(). Instead, Upstart logs to the kernel ring buffer, which is what dmesg reads. Now, I didn't think it was possible for user space processes to write to that buffer, but apparently they can by writing to /dev/kmsg, and that's exactly what Upstart does. So that's the first part of the puzzle."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The second part is that there's a widely-held belief that messages written to the kernel ring buffer are automatically copied to syslog by the kernel (at least that's what I always thought). Turns out this is actually done by a user space daemon, traditionally klogd, which operates in tandem with syslogd. Obviously rsyslogd replaces syslogd but apparently it replaces klogd as well (sort of: see notes at the end)."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The third part is that messages written to the kernel ring buffer from user space actually look different from messages written from kernel space: they have a different facility. dmesg has a few options that interact with this: -x will show the facility (and the priority), while -u and -k tell dmesg to show only user facility messages and kernel facility messages, respectively."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Now here's the clincher: by default, rsyslogd ignores messages with a non-kernel facility when it's reading messages from the kernel ring buffer. The relevant config option is $KLogPermitNonKernelFacility, which is off by default and needs to be turned on if you want rsyslogd to process these messages. Note that the rest of rsyslogd's config will treat all messages from the kernel ring buffer as having the kern facility, irrespective of the facility they had in the kernel ring buffer."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1445879110440
      }
    ]
  },
  {
    "key": "SA-1646",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When starting up on an AMI there will be a marker on the filesystem."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "If configd finds it it should create an initial config setting DHCP on eth0 and opening that port up for SSH."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It should then retrieve the ssh keys from the amazon environment."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "As a first step DURING DEVELOPMENT it can set a default username and password as well to ease debugging."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Currently we have /mnt/state/disk-device as metadata about the environment, but it's not a per-image setting, so I'm going to create the directory /mnt/boot/metadata/ which will contain the files disk-device, is-aws if running under AWS and is-azure if running under Azure."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When configd starts and finds that it has no config, it will check if /mnt/boot/metadata/is-aws exists, and if it does, it will enable DHCP on eth0 (either manually or by seeding itself), then it will download "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/user-data",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://169.254.169.254/latest/user-data"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " (seed.json) to seed itself properly."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As a bonus, if ["
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/user-data](http://169.254.169.254/latest/user-data)",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://169.254.169.254/latest/user-data](http://169.254.169.254/latest/user-data)"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " isn't found, it can check the stuff under "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/meta-data/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://169.254.169.254/latest/meta-data/"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " instead to construct a seed automatically. However, this might not always be desired since we can't add hostnames to the cert later."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1445946430762
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is a guide for the magic URLs: "
                },
                {
                  "type": "text",
                  "text": "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1445946480455
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Alternatively, if the user-data blob isn't found, we can create a config which does nothing more than enabling DHCP, SSH and setting the public key of cz from the metadata, so you can make a safe SSH login to create a seed interactively."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "By the way, it's becoming harder and harder to know whether the appliance is seeded or not. What if it's powered on, creates a remote config automatically to have DHCP, then it's power-cycled and finds it has a remote config - will it still accept the seed? So I think it's time to include a seed marker in the config. I think it belongs in the local config, and it will come as part of the self-registration or exported seed. Then maybe configd could remove the marker from a seed config if the appliance fails to self-register, or remove the config entirely?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1445947341750
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "then it will download "
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/user-data",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://169.254.169.254/latest/user-data"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " (seed.json) to seed itself properly."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Is that always the same IP?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1445951225640
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So I think it's time to include a seed marker in the config."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I agree, it would make the stratus startup code simpler."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1445951309572
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Is that always the same IP?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, according to the AWS manual."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1445956229928
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:21]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "i'm working on pseudocode where I try to figure out the correct startup sequence for configd"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:21]"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "::: Startup sequence\n\nIf current config exists:\n\n  Apply current config\n\nIf config in inbox (includes postgresql etc):\n\n  Upgrade and commit config from inbox\n\nIf seed in inbox:\n\n  If policy allows seed:\n\n    Commit config from seed\n\nIf anything in inbox:\n\n  Remove inbox\n\nFor each directory where we watch for seeds:\n\n  If seed in directory:\n\n    If policy allows seed:\n\n      Commit config from seed\n\n    Put path and checksum of file in \"seen-list\"\n\nIf no current config, and running under AWS:\n\n  Commit config which enables IPv4 DHCP on eth0, disables SSH, and allows seed\n\n  Wait until ["
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254](http://169.254.169.254)"
                },
                {
                  "type": "text",
                  "text": " is reachable (retry a few times)\n\n  If ["
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/user-data](http://169.254.169.254/latest/user-data)"
                },
                {
                  "type": "text",
                  "text": " returns JSON data:\n\n    Commit config from seed\n\nIf local.users\\[cz\\].authorized\\_keys not defined, and running under AWS:\n\n  # TODO: Get all public keys, not just number 0\n\n  If ["
                },
                {
                  "type": "text",
                  "text": "http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key](http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key)"
                },
                {
                  "type": "text",
                  "text": " returns data:\n\n    Commit config with SSH enabled and local.users\\[cz\\].authorized\\_keys set to returned data\n\nStart watcher thread(s) for seed files in certain directories:\n\n  When seed file found which is not in \"seen-list\":\n\n    If policy allows seed:\n\n      Commit config from seed\n\n    Put path and checksum of file in \"seen-list\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:21]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "something like that"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:24]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm working on similar pseudocode for committing a config"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:24]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I want to get rid of this:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:24]"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "def validate\\_sshd\\_config(remote: dict, local: dict):\n\n    if not local\\['sshServer'\\]\\['hostkeys'\\]:\n\n        remote\\['sshServer'\\]\\['enabled'\\] = False"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:25]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Instead, when you try to commit a config with "
                },
                {
                  "type": "text",
                  "text": "remote['sshServer']['enabled'] and not local['sshServer']['hostkeys']",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", it will generate and insert hostkeys automatically"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:26]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "then that should be saved in local.json, even if it wasn't in the local.json we got, or had"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:27]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Actually, after that change, there would be no more difference between \"input\" and \"final\" files, so we could get rid of the \"final\" files and just use local, remote, remote\\"
                },
                {
                  "type": "text",
                  "text": "override as inputs in commit and apply",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:28]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but right now it's too close to friday for such a change"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:28]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also I suppose my suggested \"seen-list\" above would be a change"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:29]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So I suggest we just fix the AWS parts this week and the rest maybe next week?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1446108035607
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:41]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hmm, the seen-list wouldn't work across restarts of configd, and I really don't want it to take the same seed multiple times"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:42]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "perhaps it should delete the seed file after handling it (or not handling it)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [09:42]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and if that fails, try to unmount the containing directory (if under /mnt)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1446108219924
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Currently we have /mnt/state/disk-device as metadata about the environment, but it's not a per-image setting, so I'm going to create the directory /mnt/boot/metadata/ which will contain the files disk-device, is-aws if running under AWS and is-azure if running under Azure."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What about a file like "
                },
                {
                  "type": "text",
                  "text": "image-environment",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " that would contain "
                },
                {
                  "type": "text",
                  "text": "default",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", "
                },
                {
                  "type": "text",
                  "text": "aws",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " or "
                },
                {
                  "type": "text",
                  "text": "azure",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1446194307468
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I just thought that these:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "if \\[ -f /mnt/boot/metadata/is-aws \\]; then \n\n  ...\n\nif Path('/mnt/boot/metadata/is-aws').exists(): \n\n  ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "are easier than these:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "if \\[ -f /mnt/boot/metadata/environment-type -a $(cat /mnt/boot/metadata/environment-type) = aws \\]; then       \n\n  ...\n\nif Path('/mnt/boot/metadata/environment-type').exists():\n\n  with Path('/mnt/boot/metadata/environment-type').open() as f:\n\n    if f.read() == \"aws\":\n\n      ..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1446199793884
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Okay, I guess having a file like environment-type is most future-proof, it allows us to have many different choices, and avoid guessing based on the existence of files."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1446202789909
      }
    ]
  },
  {
    "key": "SA-1685",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Create a regular ubuntu 14.04 instance, create a volume, attach it to the instance. Run cz-install from the instance to the volume."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Things I know about Azure that we might have to keep in mind"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We've been using Azure a bit so we already have some knowledge about its workings. I'm going to list some of the points I've learned that we might have to take into consideration when we start supporting Azure."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Keep in mind that I do not have any idea on how the Azure marketplace works."
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Azure does not have the "
                        },
                        {
                          "type": "text",
                          "text": "user data",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " concept. They recommend (and possibly require) us to use the "
                        },
                        {
                          "type": "text",
                          "text": "Azure Linux Agent",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " - provisioning agent developed by them. "
                        },
                        {
                          "type": "text",
                          "text": "More info about the Azure Linux Agent",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://azure.microsoft.com/en-us/documentation/articles/virtual-machines-linux-agent-user-guide/"
                              }
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ". I will paste a list of what this agent is capable of (copied from the previously mentioned link)."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  AWS AMI are in fact just images of volume snapshots. Azure requires us to upload a "
                        },
                        {
                          "type": "text",
                          "text": "VHD",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " ("
                        },
                        {
                          "type": "text",
                          "text": "Virtual Hard Drive",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ") file, which is just a disk image, to our data storage. From there we can launch instances using it."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  We should boot up an Azure instance in North Europe and copy the appliance image to it and from there create the "
                        },
                        {
                          "type": "text",
                          "text": "VHD",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " file. The reason is that we will need to upload the whole hard drive to the data storage. That is, we will not be able to take a 20GB image and gzip the zeros from the end. So in fact, the creation of new images will be very similar to what we do with AWS. :-)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  The support for multiple NICs at Azure, at least was, a bit weird. That needs to be looked at. "
                        },
                        {
                          "type": "text",
                          "text": "More info about multiple NICs",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://azure.microsoft.com/en-us/documentation/articles/virtual-networks-multiple-nics/"
                              }
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  We need to figure out a nice way to seed the appliance, since Azure doesn't have the "
                        },
                        {
                          "type": "text",
                          "text": "user data",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " concept. The "
                        },
                        {
                          "type": "text",
                          "text": "Azure Linux Agent",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " might come in handy."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "I might add more points later since I might be forgetting something."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Here is a copy/paste list of what the "
                        },
                        {
                          "type": "text",
                          "text": "Azure Linux Agent",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " is capable of:"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Introduction"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The Azure Linux Agent (/usr/sbin/waagent) manages interaction between a virtual machine and the Azure Fabric Controller. It does the following:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Image Provisioning"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Create a user account"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Configure SSH authentication types"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Deploy SSH public keys and key pairs"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Sets the host name"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Publishes the host name to the platform DNS"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Reports SSH host key fingerprint to the platform"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Manages the resource disk"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Formats and mounts the resource disk"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Configures swap space"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Networking"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Manages routes to improve compatibility with platform DHCP servers"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Ensures the stability of the network interface name"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Kernel"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Configures virtual NUMA"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Consumes Hyper-V entropy for /dev/random"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Configures SCSI timeouts for the root device (which could be remote)"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Diagnostics"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Redirects the console to the serial port"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  SCVMM Deployments"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Detects and bootstraps the VMM agent for Linux when running in a System Center Virtual Machine Manager 2012 R2 environment"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  VM Extension"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  Inject component authored by Microsoft and Partners into Linux VM (IaaS) to enable software and configuration automation"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  VM Extension reference implementation on "
                                },
                                {
                                  "type": "text",
                                  "text": "https://github.com/Azure/azure-linux-extensions",
                                  "marks": [
                                    {
                                      "type": "link",
                                      "attrs": {
                                        "href": "https://github.com/Azure/azure-linux-extensions"
                                      }
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Communication"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The information flow from the platform to the agent occurs via two channels:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  A boot-time attached DVD for IaaS deployments. This DVD includes an OVF-compliant configuration file that includes all provisioning information other than the actual SSH keypairs."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  A TCP endpoint exposing a REST API used to obtain deployment and topology configuration."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "One thing to mention about the "
                        },
                        {
                          "type": "text",
                          "text": "Azure Linux Agent",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ". As far as I can see, Azure uses that software to provision the instance with the data provided by the user/customer. When you create an instance in Azure, you are always required to provide an username and a password. I think the "
                        },
                        {
                          "type": "text",
                          "text": "Azure Linux Agent",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " provisions the instance with the provided information."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1448277683740
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I had found this article about azure and cloud init last time I look at it "
                },
                {
                  "type": "text",
                  "text": "https://azure.microsoft.com/en-us/blog/custom-data-and-cloud-init-on-windows-azure/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://azure.microsoft.com/en-us/blog/custom-data-and-cloud-init-on-windows-azure/"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For me we should avoid the azure linux agent as much as possible because it means doing some big adaptations to our image just for azure and having that agent there for that only purpose. If we can get away with something like cloud init it is much better."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1448281482431
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hm I saw that link and thought it was just something about Windows. I'll read it and get back to you. :-)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1448287728071
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok that looks good. Let's try it with cloud init. Good find "
                },
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " !"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1448289139541
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Azure recently made a lot of changes, one of them is that the \"Azure Resource Manager (arm)\" stack is now the default."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I set out to test if we now can do most of the work from the web portal interface, but quickly found out the portal interface is way too limited."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So I installed the Azure CLI to get the work done. Azure Powershell has not been needed so far."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "From the portal interface I launched a standard ubuntu 14.04 VM, uploaded the installation files and added a new disk."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I installed with this command"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "sudo apt-get install lvm2 unzip\n\nsudo ./cz-install --partition --boot-device /dev/sda --device /dev/sdc --archive appgate-xdp-1.0.1.1461-master.img.zip"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " The installation took well over 40 minutes. I used a Standard\\"
                },
                {
                  "type": "text",
                  "text": "A1 machine which is quite weak.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I did not add the initial seed at this stage. I did it later, like this"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "sudo mount /dev/czvg/image1 /media\n\n./cz-seed --dhcp-ipv4 eth0 --hostname acapulco --password cz secretpassword > /media/home/cz/seed.json"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Now to add that disk to a new VM. This cannot be done from the portal as there is no way to create an \"empty\" vm"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "from there and Azure treats OS disks as a special case, they cannot be detached or replaced."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I created it with these command"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "azure network public-ip create Group-1 testip1 northeurope\n\nazure network nic set --network-security-group-name ubuntu-kasper Group-1 kasper-nic1\n\nazure vm create --verbose --vm-size Standard\\_A1 --resource-group Group-1 --name kasper-try1 --location northeurope --os-type Linux --nic-name kasper-nic1 --os-disk-vhd ["
                },
                {
                  "type": "text",
                  "text": "https://group17642.blob.core.windows.net/vhds/ubuntu-kasper-20160112-172449.vhd](https://group17642.blob.core.windows.net/vhds/ubuntu-kasper-20160112-172449.vhd)"
                },
                {
                  "type": "text",
                  "text": " --vnet-name Group-1 --vnet-subnet-name default --public-ip-name testip1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And that's all there is to get it running!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kasper.gustavsson",
        "created": 1452786560503
      }
    ]
  },
  {
    "key": "SA-1736",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This task involves the research required to find the best key-value store that suits our needs and a small PoC that demonstrates its usage and how it will fit our needs"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Redis"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Sentinel capabilities at a macroscopical level (i.e. the big picture)"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Monitoring. Sentinel constantly checks if your master and slave instances are working as expected.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Notification. Sentinel can notify the system administrator, another computer programs, via an API, that something is wrong with one of the monitored Redis instances.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Automatic failover. If a master is not working as expected, Sentinel can start a failover process where a slave is promoted to master, the other additional slaves are reconfigured to use the new master, and the applications using the Redis server informed about the new address to use when connecting.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Configuration provider. Sentinel acts as a source of authority for clients service discovery: clients connect to Sentinels in order to ask for the address of the current Redis master responsible for a given service. If a failover occurs, Sentinels will report the new address.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Redis Sentinel is a distributed system"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sentinel itself is designed to run in a configuration where there are multiple Sentinel processes cooperating together. The advantage of having multiple Sentinel processes cooperating are the following:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Failure detection is performed when multiple Sentinels agree about the fact a given master is no longer available. This lowers the probability of false positives."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Sentinel works even if not all the Sentinel processes are working, making the system robust against failures. There is no fun in having a fail over system which is itself a single point of failure, after all."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Fundamental things to know about Sentinel before to deploy"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  You need at least three Sentinel instances for a robust deployment."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  The three Sentinel instances should be placed into computers or virtual machines that are believed to fail in an independent way. So for example different physical servers or Virtual Machines executed on different availability zones."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Sentinel + Redis distributed system does not guarantee that acknowledged writes are retained during failures, since Redis uses asynchronous replication. However there are ways to deploy Sentinel that make the window to lose writes limited to certain moments, while there are other less secure ways to deploy it."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "PoC:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "       +----+\n\n       | M1 |\n\n       | S1 |\n\n       +----+\n\n          |\n\n+----+    |    +----+\n\n| R2 |----+----| R3 |\n\n| S2 |         | S3 |\n\n+----+         +----+\n\nConfiguration: quorum = 2"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Masters are called M1, M2, M3, ..., Mn."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Slaves are called R1, R2, R3, ..., Rn (R stands for replica)."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Sentinels are called S1, S2, S3, ..., Sn."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is a very simple setup, that has the advantage to be simple to tune for additional safety. It is based on three boxes, each box running both a Redis process and a Sentinel process. If the master M1 fails, S2 and S3 will agree about the failure and will be able to authorize a failover, making clients able to continue."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Note: In every Sentinel setup, being Redis asynchronously replicated, there is always the risk of losing some write because a given acknowledged write may not be able to reach the slave which is promoted to master"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "M1(master)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ sudo ./redis-server ./redis.conf\n\n11291:M 25 Nov 07:39:32.389 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in standalone mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 6379\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11291\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11291:M 25 Nov 07:39:32.393 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11291:M 25 Nov 07:39:32.393 # Server started, Redis version 3.0.5\n\n11291:M 25 Nov 07:39:32.393 # WARNING overcommit\\_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit\\_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit\\_memory=1' for this to take effect.\n\n11291:M 25 Nov 07:39:32.393 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent\\_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting aftecz@localhost:~$ sudo ./redis-server ./redis.conf\n\n11303:S 25 Nov 07:43:37.699 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in standalone mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 6380\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11303\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11303:S 25 Nov 07:43:37.702 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11303:S 25 Nov 07:43:37.703 # Server started, Redis version 3.0.5\n\n11303:S 25 Nov 07:43:37.703 # WARNING overcommit\\_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit\\_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit\\_memory=1' for this to take effect.\n\n11303:S 25 Nov 07:43:37.703 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent\\_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.\n\n11303:S 25 Nov 07:43:37.703 \\* The server is now ready to accept connections on port 6380\n\n11303:S 25 Nov 07:43:38.702 \\* Connecting to MASTER 192.168.111.46:6379\n\n11303:S 25 Nov 07:43:38.702 \\* MASTER <-> SLAVE sync started\n\n11303:S 25 Nov 07:43:38.702 \\* Non blocking connect for SYNC fired the event.\n\n11303:S 25 Nov 07:43:38.702 \\* Master replied to PING, replication can continue...\n\n11303:S 25 Nov 07:43:38.703 \\* Partial resynchronization not possible (no cached master)\n\n11303:S 25 Nov 07:43:38.705 \\* Full resync from master: e8b987b4b399e027eb46d8b513b8a33738a33267:127\n\n11303:S 25 Nov 07:43:38.769 \\* MASTER <-> SLAVE sync: receiving 18 bytes from master\n\n11303:S 25 Nov 07:43:38.770 \\* MASTER <-> SLAVE sync: Flushing old data\n\n11303:S 25 Nov 07:43:38.770 \\* MASTER <-> SLAVE sync: Loading DB in memory\n\n11303:S 25 Nov 07:43:38.770 \\* MASTER <-> SLAVE sync: Finished with success\n\nr a reboot. Redis must be restarted after THP is disabled.\n\n11291:M 25 Nov 07:39:32.393 \\* The server is now ready to accept connections on port 6379\n\n11291:M 25 Nov 07:40:31.734 \\* Slave 192.168.111.48:6380 asks for synchronization\n\n11291:M 25 Nov 07:40:31.734 \\* Full resync requested by slave 192.168.111.48:6380\n\n11291:M 25 Nov 07:40:31.734 \\* Starting BGSAVE for SYNC with target: disk\n\n11291:M 25 Nov 07:40:31.735 \\* Background saving started by pid 11302\n\n11302:C 25 Nov 07:40:31.736 \\* DB saved on disk\n\n11302:C 25 Nov 07:40:31.736 \\* RDB: 4 MB of memory used by copy-on-write\n\n11291:M 25 Nov 07:40:31.778 \\* Background saving terminated with success\n\n11291:M 25 Nov 07:40:31.778 \\* Synchronization with slave 192.168.111.48:6380 succeeded\n\n11291:M 25 Nov 07:42:04.110 \\* Slave 192.168.111.50:6380 asks for synchronization\n\n11291:M 25 Nov 07:42:04.110 \\* Full resync requested by slave 192.168.111.50:6380\n\n11291:M 25 Nov 07:42:04.110 \\* Starting BGSAVE for SYNC with target: disk\n\n11291:M 25 Nov 07:42:04.111 \\* Background saving started by pid 11317\n\n11317:C 25 Nov 07:42:04.112 \\* DB saved on disk\n\n11317:C 25 Nov 07:42:04.112 \\* RDB: 6 MB of memory used by copy-on-write\n\n11291:M 25 Nov 07:42:04.176 \\* Background saving terminated with success\n\n11291:M 25 Nov 07:42:04.176 \\* Synchronization with slave 192.168.111.50:6380 succeeded"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "S1(sentinel monitor)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ sudo ./redis-server ./sentinel.conf --sentinel\n\n\\[sudo\\] password for cz: \n\n11328:X 25 Nov 07:43:13.850 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in sentinel mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 5000\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11328\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11328:X 25 Nov 07:43:13.853 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11328:X 25 Nov 07:43:13.853 # Sentinel runid is f2e03fef0a2df0b1b094cb798d50104fbd909caa\n\n11328:X 25 Nov 07:43:13.853 # +monitor master mymaster 192.168.111.46 6379 quorum 2\n\n11328:X 25 Nov 07:43:14.853 \\* +slave slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.46 6379\n\n11328:X 25 Nov 07:43:14.853 \\* +slave slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11328:X 25 Nov 07:44:03.639 \\* +sentinel sentinel 192.168.111.48:5001 192.168.111.48 5001 @ mymaster 192.168.111.46 6379\n\n11328:X 25 Nov 07:44:55.514 \\* +sentinel sentinel 192.168.111.50:5002 192.168.111.50 5002 @ mymaster 192.168.111.46 6379"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " Notice the auto-discovery of the slave nodes"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "R2(slave)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ sudo ./redis-server ./redis.conf\n\n11553:S 25 Nov 08:02:41.769 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in standalone mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 6380\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11553\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11553:S 25 Nov 08:02:41.772 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11553:S 25 Nov 08:02:41.773 # Server started, Redis version 3.0.5\n\n11553:S 25 Nov 08:02:41.773 # WARNING overcommit\\_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit\\_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit\\_memory=1' for this to take effect.\n\n11553:S 25 Nov 08:02:41.773 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent\\_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.\n\n11553:S 25 Nov 08:02:41.773 \\* The server is now ready to accept connections on port 6380\n\n11553:S 25 Nov 08:02:42.771 \\* Connecting to MASTER 192.168.111.46:6379\n\n11553:S 25 Nov 08:02:42.772 \\* MASTER <-> SLAVE sync started\n\n11553:S 25 Nov 08:02:42.772 \\* Non blocking connect for SYNC fired the event.\n\n11553:S 25 Nov 08:02:42.772 \\* Master replied to PING, replication can continue...\n\n11553:S 25 Nov 08:02:42.773 \\* Partial resynchronization not possible (no cached master)\n\n11553:S 25 Nov 08:02:42.774 \\* Full resync from master: e8b987b4b399e027eb46d8b513b8a33738a33267:1\n\n11553:S 25 Nov 08:02:42.817 \\* MASTER <-> SLAVE sync: receiving 18 bytes from master\n\n11553:S 25 Nov 08:02:42.817 \\* MASTER <-> SLAVE sync: Flushing old data\n\n11553:S 25 Nov 08:02:42.817 \\* MASTER <-> SLAVE sync: Loading DB in memory\n\n11553:S 25 Nov 08:02:42.817 \\* MASTER <-> SLAVE sync: Finished with success"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " Notice the synchronization messages with the master"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "S2(sentinel monitor)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ sudo ./redis-server ./sentinel.conf --sentinel\n\n\\[sudo\\] password for cz: \n\n11588:X 25 Nov 08:06:12.556 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in sentinel mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 5001\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11588\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11588:X 25 Nov 08:06:12.561 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11588:X 25 Nov 08:06:12.561 # Sentinel runid is 6c2a1c09bef69c9370f5db2ae0fb44adbe98b728\n\n11588:X 25 Nov 08:06:12.561 # +monitor master mymaster 192.168.111.46 6379 quorum 2\n\n11588:X 25 Nov 08:06:13.560 \\* +slave slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.46 6379\n\n11588:X 25 Nov 08:06:13.561 \\* +slave slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11588:X 25 Nov 08:06:14.823 \\* +sentinel sentinel 192.168.111.46:5000 192.168.111.46 5000 @ mymaster 192.168.111.46 6379\n\n11588:X 25 Nov 08:07:06.553 \\* +sentinel sentinel 192.168.111.50:5002 192.168.111.50 5002 @ mymaster 192.168.111.46 6379"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "R3(slave)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ sudo ./redis-server ./redis.conf\n\n11303:S 25 Nov 07:43:37.699 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in standalone mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 6380\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11303\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11303:S 25 Nov 07:43:37.702 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11303:S 25 Nov 07:43:37.703 # Server started, Redis version 3.0.5\n\n11303:S 25 Nov 07:43:37.703 # WARNING overcommit\\_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit\\_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit\\_memory=1' for this to take effect.\n\n11303:S 25 Nov 07:43:37.703 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never > /sys/kernel/mm/transparent\\_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.\n\n11303:S 25 Nov 07:43:37.703 \\* The server is now ready to accept connections on port 6380\n\n11303:S 25 Nov 07:43:38.702 \\* Connecting to MASTER 192.168.111.46:6379\n\n11303:S 25 Nov 07:43:38.702 \\* MASTER <-> SLAVE sync started\n\n11303:S 25 Nov 07:43:38.702 \\* Non blocking connect for SYNC fired the event.\n\n11303:S 25 Nov 07:43:38.702 \\* Master replied to PING, replication can continue...\n\n11303:S 25 Nov 07:43:38.703 \\* Partial resynchronization not possible (no cached master)\n\n11303:S 25 Nov 07:43:38.705 \\* Full resync from master: e8b987b4b399e027eb46d8b513b8a33738a33267:127\n\n11303:S 25 Nov 07:43:38.769 \\* MASTER <-> SLAVE sync: receiving 18 bytes from master\n\n11303:S 25 Nov 07:43:38.770 \\* MASTER <-> SLAVE sync: Flushing old data\n\n11303:S 25 Nov 07:43:38.770 \\* MASTER <-> SLAVE sync: Loading DB in memory\n\n11303:S 25 Nov 07:43:38.770 \\* MASTER <-> SLAVE sync: Finished with success"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " Same as the other slave"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "S3(sentinel monitor)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ sudo ./redis-server ./sentinel.conf --sentinel\n\n\\[sudo\\] password for cz: \n\n11332:X 25 Nov 07:46:28.011 \\* Increased maximum number of open files to 10032 (it was originally set to 1024).\n\n                \\_.\\_                                                  \n\n           \\_.-\\`\\`\\_\\_ ''-.\\_                                             \n\n      \\_.-\\`\\`    \\`.  \\`\\_.  ''-.\\_           Redis 3.0.5 (00000000/0) 64 bit\n\n  .-\\`\\` .-\\`\\`\\`.  \\`\\`\\`\\\\/    \\_.,\\_ ''-.\\_                                   \n\n (    '      ,       .-\\`  | \\`,    )     Running in sentinel mode\n\n |\\`-.\\_\\`-...-\\` \\_\\_...-.\\`\\`-.\\_|'\\` \\_.-'|     Port: 5002\n\n |    \\`-.\\_   \\`.\\_    /     \\_.-'    |     PID: 11332\n\n  \\`-.\\_    \\`-.\\_  \\`-./  \\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |           ["
                },
                {
                  "type": "text",
                  "text": "http://redis.io](http://redis.io)"
                },
                {
                  "type": "text",
                  "text": "        \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n |\\`-.\\_\\`-.\\_    \\`-.\\_\\_.-'    \\_.-'\\_.-'|                                  \n\n |    \\`-.\\_\\`-.\\_        \\_.-'\\_.-'    |                                  \n\n  \\`-.\\_    \\`-.\\_\\`-.\\_\\_.-'\\_.-'    \\_.-'                                   \n\n      \\`-.\\_    \\`-.\\_\\_.-'    \\_.-'                                       \n\n          \\`-.\\_        \\_.-'                                           \n\n              \\`-.\\_\\_.-'                                               \n\n11332:X 25 Nov 07:46:28.015 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.\n\n11332:X 25 Nov 07:46:28.016 # Sentinel runid is 5bd59281e509e83d74ad64d6d5a072dc26ed38dd\n\n11332:X 25 Nov 07:46:28.016 # +monitor master mymaster 192.168.111.46 6379 quorum 2\n\n11332:X 25 Nov 07:46:29.014 \\* +slave slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 07:46:29.014 \\* +slave slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 07:46:30.221 \\* +sentinel sentinel 192.168.111.46:5000 192.168.111.46 5000 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 07:46:30.266 \\* +sentinel sentinel 192.168.111.48:5001 192.168.111.48 5001 @ mymaster 192.168.111.46 6379"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Action - Set a value"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "After everything is up, by using the redis-cli we connect to master and set a key-value: "
                },
                {
                  "type": "text",
                  "text": "set foo bar",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". Immediately in all the nodes [M1, R2, R3] we see the following:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "11291:M 25 Nov 08:15:18.467 \\* 1 changes in 900 seconds. Saving...\n\n11291:M 25 Nov 08:15:18.468 \\* Background saving started by pid 11619\n\n11619:C 25 Nov 08:15:18.470 \\* DB saved on disk\n\n11619:C 25 Nov 08:15:18.470 \\* RDB: 4 MB of memory used by copy-on-write\n\n11291:M 25 Nov 08:15:18.569 \\* Background saving terminated with success"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Action - Make master to hang"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We make the master sentinel process to hang deliberately for some seconds:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "redis-cli -p 6379 DEBUG sleep 30",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "All sentinel processes find out that the master redis process has hung and immediately they vote to elect a new leader! The new master becomes the redis process that lives on 192.168.111.50. We can see the realization of the hang, voting and election in the sentinel logs and we can verify it with the cli:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@localhost:~$ ./redis-cli -p 5000\n\n127.0.0.1:5000> SENTINEL get-master-addr-by-name mymaster\n\n1) \"192.168.111.50\"\n\n2) \"6380\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It should be noted that when the node with the redis process returns from the deliberate hang, it changes role to a slave as there is already a new boss in the hood! (can be seen in the logs as well)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "S1"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "11328:X 25 Nov 08:19:20.814 # +sdown master mymaster 192.168.111.46 6379\n\n11328:X 25 Nov 08:19:20.994 # +new-epoch 7\n\n11328:X 25 Nov 08:19:20.994 # +vote-for-leader 5bd59281e509e83d74ad64d6d5a072dc26ed38dd 7\n\n11328:X 25 Nov 08:19:21.891 # +odown master mymaster 192.168.111.46 6379 #quorum 3/2\n\n11328:X 25 Nov 08:19:21.891 # Next failover delay: I will not start a failover before Wed Nov 25 08:21:21 2015\n\n11328:X 25 Nov 08:19:22.076 # +config-update-from sentinel 192.168.111.50:5002 192.168.111.50 5002 @ mymaster 192.168.111.46 6379\n\n11328:X 25 Nov 08:19:22.076 # +switch-master mymaster 192.168.111.46 6379 192.168.111.50 6380\n\n11328:X 25 Nov 08:19:22.076 \\* +slave slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.50 6380\n\n11328:X 25 Nov 08:19:22.077 \\* +slave slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11328:X 25 Nov 08:19:27.114 # +sdown slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11328:X 25 Nov 08:19:45.631 # -sdown slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "S2"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "11588:X 25 Nov 08:41:32.033 # +new-epoch 7\n\n11588:X 25 Nov 08:41:32.033 # +vote-for-leader 5bd59281e509e83d74ad64d6d5a072dc26ed38dd 7\n\n11588:X 25 Nov 08:41:32.255 # +sdown master mymaster 192.168.111.46 6379\n\n11588:X 25 Nov 08:41:32.347 # +odown master mymaster 192.168.111.46 6379 #quorum 3/2\n\n11588:X 25 Nov 08:41:32.347 # Next failover delay: I will not start a failover before Wed Nov 25 08:43:32 2015\n\n11588:X 25 Nov 08:41:33.116 # +config-update-from sentinel 192.168.111.50:5002 192.168.111.50 5002 @ mymaster 192.168.111.46 6379\n\n11588:X 25 Nov 08:41:33.116 # +switch-master mymaster 192.168.111.46 6379 192.168.111.50 6380\n\n11588:X 25 Nov 08:41:33.117 \\* +slave slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.50 6380\n\n11588:X 25 Nov 08:41:33.117 \\* +slave slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11588:X 25 Nov 08:41:38.174 # +sdown slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11588:X 25 Nov 08:41:56.677 # -sdown slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "S3"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "11332:X 25 Nov 08:20:55.529 # +sdown master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:55.585 # +odown master mymaster 192.168.111.46 6379 #quorum 2/2\n\n11332:X 25 Nov 08:20:55.586 # +new-epoch 7\n\n11332:X 25 Nov 08:20:55.586 # +try-failover master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:55.586 # +vote-for-leader 5bd59281e509e83d74ad64d6d5a072dc26ed38dd 7\n\n11332:X 25 Nov 08:20:55.587 # 192.168.111.46:5000 voted for 5bd59281e509e83d74ad64d6d5a072dc26ed38dd 7\n\n11332:X 25 Nov 08:20:55.588 # 192.168.111.48:5001 voted for 5bd59281e509e83d74ad64d6d5a072dc26ed38dd 7\n\n11332:X 25 Nov 08:20:55.641 # +elected-leader master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:55.642 # +failover-state-select-slave master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:55.726 # +selected-slave slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:55.726 \\* +failover-state-send-slaveof-noone slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:55.802 \\* +failover-state-wait-promotion slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:56.593 # +promoted-slave slave 192.168.111.50:6380 192.168.111.50 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:56.593 # +failover-state-reconf-slaves master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:56.668 \\* +slave-reconf-sent slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:57.673 \\* +slave-reconf-inprog slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:57.674 \\* +slave-reconf-done slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:57.756 # -odown master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:57.757 # +failover-end master mymaster 192.168.111.46 6379\n\n11332:X 25 Nov 08:20:57.757 # +switch-master mymaster 192.168.111.46 6379 192.168.111.50 6380\n\n11332:X 25 Nov 08:20:57.757 \\* +slave slave 192.168.111.48:6380 192.168.111.48 6380 @ mymaster 192.168.111.50 6380\n\n11332:X 25 Nov 08:20:57.758 \\* +slave slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11332:X 25 Nov 08:21:02.796 # +sdown slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11332:X 25 Nov 08:21:20.178 # -sdown slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380\n\n11332:X 25 Nov 08:21:30.194 \\* +convert-to-slave slave 192.168.111.46:6379 192.168.111.46 6379 @ mymaster 192.168.111.50 6380"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1448441154486
      }
    ]
  },
  {
    "key": "SA-1763",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Connecting stratus to WIFI network pinging services on SA1 and SA2 and verify successful pings on TC, SALT and google"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "start ping 192.168.111.95 -t -w 500"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "start ping 172.17.93.20 -t -w 500"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "start ping google.com -t -w 500"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Disconnect WiFi connection"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Verify all ping fails"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "within 20-30 seconds add cable to external network (same network as WiFi)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Verify successful ping on TC, Salt and google"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Pinging Salt OR TC fails sometime and only one will succeed."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "logs attached."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client #465"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Works as intended on OS X. Can ping both IPs after switching to cable and then back to Wifi again."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "peter.bjorklund",
        "created": 1446548034997
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I was able to reproduce it after like 4-5 attempts. Can't see the problem yet though. My best guess at the moment is that sessiond-vpnd duo is killing the tun driver. Will investigate more."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1446554278898
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The relevant log entries from tun-service are these:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[10:53:43\\] Connection to TLS://212.16.176.139:443 closed: connection reset by peer\n\n\\[10:53:43\\] Connection to TLS://212.16.176.138:443 closed: connection reset by peer\n\n\\[10:53:45\\] Initiating connection to TLS://212.16.176.139:443\n\n\\[10:53:45\\] Connected to TLS://212.16.176.139:443"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "which means that the VPN connections were found to be dead at 10{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "53}}43, and then the Client initiated a new connection .139 at 10{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "53}}45 - but it did not try to connect to .138"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1446557237734
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "More logs from "
                },
                {
                  "type": "text",
                  "text": "Hkan Saxmo",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/hakan.saxmo",
                        "title": "hakan.saxmo"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "peter.bjorklund",
        "created": 1446561446653
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Strange logs from client"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "2015-11-03T14:31:44.250Z Trace : \\[TunDriver\\] \\[SynchronizeVpnState: vpnState 'Cryptzone.Stratus.Base.types.vpn.VpnState'\\]\n\n2015-11-03T14:31:44.327Z Debug : \\[JsonRpcWorker\\] Received notification \\[Notification:disconnected:System.Object\\[\\]\\]\n\n2015-11-03T14:31:44.330Z Trace : \\[JsonRpcReflection\\] Executing method:on\\_disconnected\n\n2015-11-03T14:31:44.332Z Debug : \\[TunDriver\\] OnDisconnected:\\[VpnId: 684ca2ce-c1f6-4088-b73c-43d623b99066\\] reason:\n\n2015-11-03T14:31:44.334Z Debug : \\[TunDriver\\] \\[HandleOnVpnDisconnected: vpn '\\[VpnConfigAndRoutes: Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
                },
                {
                  "type": "text",
                  "text": "https://sa1.cryptzone.com/'](https://sa1.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " AllocatedIpv4 '192.168.100.30', AllocatedIpv6 '2001:db8:0:0:0:0:1428:1d', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\]', disconnectionReason 'Disconnected by peer'\\]\n\n2015-11-03T14:31:44.335Z Debug : \\[TunDriverLogic\\] \\[HandleTunDriverDisconnectReason: disconnectReason 'DisconnectedByPeer'\\]\n\n2015-11-03T14:31:45.418Z Trace : \\[TunDriver\\] \\[SynchronizeVpnState: sync added\\]\n\n2015-11-03T14:31:45.423Z Trace : \\[TunDriver\\] \\[ConnectAndWait: started '\\[VpnConfigAndRoutes: Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
                },
                {
                  "type": "text",
                  "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " AllocatedIpv4 '192.168.100.30', AllocatedIpv6 '2001:db8:0:0:0:0:1428:1d', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\]'\\]\n\n2015-11-03T14:31:45.428Z Trace : \\[TunDriverCommunication\\] ConnectVpn()\n\n2015-11-03T14:31:45.433Z Trace : \\[TunDriverCommunication\\] \\_rpcWorker.Notification\n\n2015-11-03T14:31:45.702Z Trace : \\[TunDriverCommunication\\] Ping\n\n2015-11-03T14:31:45.950Z Debug : \\[JsonRpcWorker\\] Received notification \\[Notification:connected:System.Object\\[\\]\\]\n\n2015-11-03T14:31:45.954Z Trace : \\[JsonRpcReflection\\] Executing method:on\\_connected\n\n2015-11-03T14:31:45.956Z Debug : \\[TunDriver\\] OnConnected:\\[VpnId: 2079a8a5-b9d1-46f0-b6b2-430ef8ec3610\\]\n\n2015-11-03T14:31:45.959Z Debug : \\[TunDriver\\] \\[HandleOnVpnConnected: vpn '\\[VpnConfigAndRoutes: Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
                },
                {
                  "type": "text",
                  "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " AllocatedIpv4 '192.168.100.30', AllocatedIpv6 '2001:db8:0:0:0:0:1428:1d', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\]'\\]\n\n2015-11-03T14:31:45.962Z Trace : \\[TunDriver\\] \\[ConnectAndWait: done vpn '\\[VpnConfigAndRoutes: Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
                },
                {
                  "type": "text",
                  "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " AllocatedIpv4 '192.168.100.30', AllocatedIpv6 '2001:db8:0:0:0:0:1428:1d', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\]'\\]\n\n2015-11-03T14:31:45.964Z Trace : \\[TunDriver\\] \\[SyncRoutes: start '\\[VpnConfigAndRoutes: Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
                },
                {
                  "type": "text",
                  "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " AllocatedIpv4 '192.168.100.30', AllocatedIpv6 '2001:db8:0:0:0:0:1428:1d', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\], action 'Add'\\]\n\n2015-11-03T14:31:45.967Z Trace : \\[TunDriverCommunication\\] AddRoute\n\n2015-11-03T14:31:46.150Z Debug : \\[Vpn\\] Adding \\[Route: '\\[Cidr 172.17.20.0/24\\]'\\]\n\n2015-11-03T14:31:46.153Z Trace : \\[TunDriverCommunication\\] AddRoute\n\n2015-11-03T14:31:46.651Z Debug : \\[Vpn\\] Adding \\[Route: '\\[Cidr 172.17.40.0/24\\]'\\]\n\n2015-11-03T14:31:46.654Z Trace : \\[TunDriverCommunication\\] AddRoute\n\n2015-11-03T14:31:46.829Z Debug : \\[Vpn\\] Adding \\[Route: '\\[Cidr 172.17.64.0/18\\]'\\]\n\n2015-11-03T14:31:46.831Z Trace : \\[TunDriver\\] \\[SyncRoutes: ended '\\[VpnConfigAndRoutes: Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
                },
                {
                  "type": "text",
                  "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " AllocatedIpv4 '192.168.100.30', AllocatedIpv6 '2001:db8:0:0:0:0:1428:1d', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\], action 'Add'\\]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " Gets "
                },
                {
                  "type": "text",
                  "text": "disconnected",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " from tun-driver for sa1, then it connects to sa2 twice."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1446562007807
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client #606 contains fix for this."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1446645834113
      }
    ]
  },
  {
    "key": "SA-1781",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "If you have a fresh copy of stratus-appliance you cannot actually "
            },
            {
              "type": "text",
              "text": "make",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "kosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-appliance/configd$ make\n\n\\# Install all configd extra python module dependencies in virtualenv\n\npython3 -m venv --without-pip --system-site-packages virtualenv\n\n\\# Install dependencies virtualenv\n\nvirtualenv/bin/python3 -m pip install --ignore-installed --trusted-host pypi.cryptzone.ad --index ["
            },
            {
              "type": "text",
              "text": "http://pypi.cryptzone.ad:8080](http://pypi.cryptzone.ad:8080)"
            },
            {
              "type": "text",
              "text": " --upgrade -r requirements.txt\n\nCollecting typing>=3.5.0 (from -r requirements.txt (line 1))\n\n  Downloading ["
            },
            {
              "type": "text",
              "text": "http://pypi.cryptzone.ad:8080/packages/typing-3.5.0.tar.gz](http://pypi.cryptzone.ad:8080/packages/typing-3.5.0.tar.gz)"
            },
            {
              "type": "text",
              "text": "\n\nCollecting jsonschema>=2.5.1 (from -r requirements.txt (line 2))\n\n  Using cached jsonschema-2.5.1-py2.py3-none-any.whl\n\nInstalling collected packages: typing, jsonschema\n\n  Running setup.py install for typing\n\nSuccessfully installed jsonschema-2.5.1 typing-3.5.0\n\n\\# Install mypy in virtualenv\n\n(cd ../contrib/mypy/mypy; /home/kosmas/git/stratus-appliance/configd/virtualenv/bin/python3 setup.py -q install)\n\n/bin/sh: 1: cd: can't cd to ../contrib/mypy/mypy\n\n/home/kosmas/git/stratus-appliance/configd/virtualenv/bin/python3: can't open file 'setup.py': \\[Errno 2\\] No such file or directory\n\nmake: \\*\\*\\* \\[virtualenv\\] Error 2\n"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The make shall work and create whatever is needed. That is the point of it"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You need to build contrib/mypy first."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1446712458966
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think we shall update the Makefile to build it automatically"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1446713206173
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Good idea yes."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1446713349684
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.cryptzone.ad/cryptzone/stratus-appliance/pull/326",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.cryptzone.ad/cryptzone/stratus-appliance/pull/326"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1447059091552
      }
    ]
  },
  {
    "key": "SA-1803",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "POST "
            },
            {
              "type": "text",
              "text": "/admin/appliances/{appliance-id}/upgrade",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "{\n\n  \"imageUrl\": \"["
            },
            {
              "type": "text",
              "text": "http://teamcity/whatever](http://teamcity/whatever)\""
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": "\n\n  \"sha256Url\": \"["
            },
            {
              "type": "text",
              "text": "http://teamcity/whatever/sha256](http://teamcity/whatever/sha256)\""
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": "\n\n}"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Not so sure exactly how it works though. "
            },
            {
              "type": "text",
              "text": "Thomas Cellerier",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                    "title": "thomas.cellerier"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " can add a real example maybe."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You pass a url to the image file and the sha256 checksum. The appliance will download the image, verify the checksum, apply the upgrade and reboot."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The only issue i see right now is that it will attempt to verify the cert and fail to do so of course."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We could have a config option for our setup to skip the cert verification or have a way to add custom certs. Thats not in scope for this ui task though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1433425257778
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sha256Url is gone now."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1446831484665
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.cryptzone.ad/cryptzone/stratus-controller/pull/471",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.cryptzone.ad/cryptzone/stratus-controller/pull/471"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1447058667774
      }
    ]
  },
  {
    "key": "SA-1993",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Using this configuration in nginx we can get a route on the log server that returns 401:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "    location /logs/logout {\n\n        return 401;\n\n    }\n\n    location /logs/ {\n\n        set $authgroup \"kibana\";\n\n        access\\_by\\_lua\\_file /etc/nginx/auth.lua;\n\n        proxy\\_pass ["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:9310/](http://127.0.0.1:9310/)"
            },
            {
              "type": "text",
              "text": ";"
            },
            {
              "type": "text",
              "text": "\n\n        proxy\\_redirect ["
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:9310/](http://127.0.0.1:9310/)"
            },
            {
              "type": "text",
              "text": " /logs/;\n\n    }"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "If we patch kibana to add a logout button and clear the kibanaXToken cookie we can get a logout functionality."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Obsolete since the whole thing has changed."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1472055173541
      }
    ]
  },
  {
    "key": "SA-3162",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This task is to group some improvements in the UI and configuration of XDP to make it easier for customers to onboard a new installation."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When creating a new identity provider we should add following items:"
            },
            {
              "type": "text",
              "text": "\\- create automatically a new filter call \"All users for <name identity provider>"
            },
            {
              "type": "text",
              "text": "\\- create an entitlement called DNS that allows DNS port 53 (DNS IP's provided by identity provider) with filter All Users for <name identity provider>"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Fill in the same DNS as the controller appliance (customers can overrule)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Create a default filter called Everyone"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Fill in client and peer hostname with hostname of appliance and allow customers to overwrite"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  If GW is selected we should check if we find the NIC's with private IP ranges and add that interface to allowed sources. If only 1 NIC is used, add that NIC to allow sources by default"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  the log file filter Field in Controller should be much bigger"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Automatically revoke (spread over 5-10 min) Entitlements when one of them is updated"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Auto refresh Dashboard after X time"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  When scrolling right page, the left menu shouldn't scroll with it"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Basic server templates that you can assign in actions (like ICMP + Port 80/443)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Split this task to many."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-3446",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-3446"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-3447",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-3447"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-3448",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-3448"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-3449",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-3449"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-3450",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-3450"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-3451",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-3451"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Auto refresh Dashboard after X time"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this should be working like that already; every 15 minutes though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1472580089518
      }
    ]
  },
  {
    "key": "SA-3071",
    "description": {
      "type": "doc",
      "content": [],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Temporarily introduced 'Logout then Quit' as a solution but having the exact same desktop behavior on mobile would be nice too."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also on emulator, app crashes as services take more than 500ms to stop but we kill the app anyway."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1466166972425
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Collected sample crash log. Basically we're crashing due to auto-reconnect attempt after login: "
                },
                {
                  "type": "text",
                  "text": "[XDPService] Debug - [BusinessLogic - UpdateInternalState:288] [UpdateInternalState: newLogicState 'loggingin', prev 'disconnecting']",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " :"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[Mono\\] \\[0xaec51d00\\] hill climbing, change max number of threads 5\n\n\\[ThreadedRenderer\\] mThreadGroupCpuId 3 mRenderThreadCpuId 3 affinity\n\n\\[ThreadedRenderer\\] mThreadGroupCpuId 3 mRenderThreadCpuId 3 affinity\n\n\\[Mono\\] DllImport searching in: '\\_\\_Internal' ('(null)').\n\n\\[Mono\\] Searching for 'java\\_interop\\_jnienv\\_call\\_int\\_method'.\n\n\\[Mono\\] Probing 'java\\_interop\\_jnienv\\_call\\_int\\_method'.\n\n\\[Mono\\] Found as 'java\\_interop\\_jnienv\\_call\\_int\\_method'.\n\n\\[XDPService\\] Debug - \\[LiveRpc - logout:59\\] received logout\n\n\\[XDPService\\] Info - \\[LiveLogic - Logout\\] Logout request received from UI.\n\n\\[XDPService\\] Debug - \\[ActionCenter - Logout:118\\] \\[Logout\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - NotifyOnLogout:246\\] \\[NotifyOnLogout\\]\n\n\\[XDPService\\] Debug - \\[BusinessLogic - HandleOnLogout:266\\] Logout request with 'True'\n\n\\[XDPService\\] Debug - \\[BusinessLogic - Process:204\\] \\[ProcessLogic: \\_queuedState 'disconnecting'\\]\n\n\\[XDPService\\] Debug - \\[BusinessLogic - UpdateInternalState:288\\] \\[UpdateInternalState: newLogicState 'disconnecting', prev 'connected'\\]\n\n\\[XDPService\\] Debug - \\[LiveLogic - SendUiRootModel:256\\] \\[SendUiRootModel\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - GetPendingConsumerActions:144\\] \\[GetPendingConsumerActions\\]\n\n\\[XDPService\\] Debug - \\[LiveApp - Save:104\\] Sending Tasks: \\[\\], Status: disconnecting, User: Name: Teoman Soygul, Services: \\[Name: Gothenburg, Connected: True, Name: Azure Northern Europe, Connected: True, Name: AWS US East, Connected: True\\], Entitlements: \\[TokenId: c0fc0490-b98f-4e38-8328-e3616eb682ac, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.315Z, Site: Azure Northern Europe, Gateways: \\[Weight: 100, Id: 1ae48b24-c295-4bf7-8633-84d72c83c68f, ControlChannel: wss://turquoise-gw5.northeurope.cloudapp.azure.com:443/session/ws/, Vpnd: turquoise-gw5.northeurope.cloudapp.azure.com:443, VpnProtocol: DTLS\\], GatewayHostname: , Routes: \\[10.66.66.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 717836f5-5a60-453f-8071-c5aaf4ae8e8f, Name: Azure Finance, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\], Id: 216946c9-bf56-4284-98dc-c4ccbcfa8018, Name: Azure Endpoint 1, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\]\\], TokenId: ef599d07-f49d-4084-b5b4-940f4f109ee1, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.318Z, Site: AWS US East, Gateways: \\[Weight: 100, Id: e30a8183-66b1-45b9-b6c8-4352d5f385ad, ControlChannel: wss://turquoise-gw4.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw4.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, ControlChannel: wss://turquoise-gw3.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw3.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[10.0.0.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 8d379dd7-2544-45b1-9a23-2be579ff2684, Name: CatServe, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[\\]\\], TokenId: f808c4a7-6292-44e2-8649-c20d5d75beb6, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.310Z, Site: Gothenburg, Gateways: \\[Weight: 100, Id: f302e4dd-7067-4193-a9b2-9b379791b928, ControlChannel: wss://turquoise-gw1.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw1.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 966aa05a-a7c6-4c04-95fd-77bb8dfbb0ab, ControlChannel: wss://turquoise-gw2.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw2.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[172.17.20.0/24, fd00:ffff:a:60::/64, 172.17.40.0/24, 172.17.64.0/18, 192.168.111.0/24, 172.17.60.0/24, fd00:ffff:a:40::/64\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 781c62ce-21ac-4cd0-8e91-b67454194f73, Name: Test OTP, Actions: \\[Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[Id: 12bf2ff6-ca64-46b5-9e0c-7b629a8ba56c, Name: Require Regular OTP, Expression: //Generated by criteria builder, Operator: ||\n\n\\[XDPService\\] var result = false;\n\n\\[XDPService\\] if/\\*otp\\*/(claims.user.hasOtp('regular', '180'))/\\*end otp\\*/ { return true; }\n\n\\[XDPService\\] return result;, RepeatSchedules: System.Collections.Generic.List\\`1\\[System.String\\], RemedyMethods: System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Client.Controller.Rest.Contracts.RemedyMethod\\]\\], Id: ce08158a-08a0-4022-b7d1-282c1b0ccf90, Name: VM Subnet for Aitorbot Machines, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: \n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:223\\] Adding request with id '10', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:226\\] Sending RPC request 'smackbone.save' with I '10' to 'Smackbone'.\n\n\\[XDPService\\] Info - \\[BusinessLogic - Process\\] Disconnecting.\n\n\\[XDPService\\] Info - \\[BusinessLogic - Process\\] Removing client certificate.\n\n\\[XDPService\\] Info - \\[BusinessLogic - Process\\] Removing credentials.\n\n\\[chromium\\] \\[INFO:CONSOLE(17)\\] \"ipc.send called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (17)\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Dispose:197\\] REST  (turquoise.cryptzone.com:443) H-1811275776 \\[\\[7\\]\\] : Dispose REST\n\n\\[XDPService\\] Debug - \\[SiteStatusProvider - NotifyOnSiteConfigUpdated:123\\] ClientCertificateP12: MIIQegIBAzCCEEQGCSqGSIb3DQEHAaCCEDUEghAxMIIQLTCCBkcGCSqGSIb3DQEHBqCCBjgwggY0AgEAMIIGLQYJKoZIhvcNAQcBMBwGCiqGSIb3DQEMAQYwDgQISabEZZVvZLgCAggAgIIGAGGmXl9cLjgEtQxN+A7/5BFiq9kCwneADNwKxbJYEU/qu/i9n7lGECCCo9af4ZldJnwCzDMwXk9eG39cDu/gamVL/1LB9CFFFKxmGIn76np44Z5Qku99URIQ8b4ukypQDUE7DMrHTm6jp36J0LlAhwkadZ8xhNcHLuhN4j4qlA2SbjTGEB+68hXPUcTN1s1+99g6PuAWO3h//nAE6857Lm6n99PhTlnNkYDDVmhB+707oXkdxwwOwmw94nyL5Vg6uCBQ2CII9kRgslY4LJMHsBxgRGAojsoMrCslPetCybb2HVabfp1RjKXDTRn43KwnNYa3SBRzSmKITbQLJ+/vMDhMal0Gl8Ud/Z4lF2D4YWaT5SAFyaQ9+J5HB3rAm5E6FxrCdLSwDmgctu/pvE/gTjy6vpivutK7SmRruZfl1VfQTx8Ck8cy+edG77nXq/Y7aLaTkBYR9VU2OeGr2r6/Fmbo6z4sPTlFbBv81PFEvxIC8NYNcWDTGg1Gf+7nja9I4269XNprojCu2h6ZKFynLTI/YrUsBAaWLIAUUtYT8iUaCOzsjaSOI/zH4nqg5A/xRTi8Qh6AU/h+6ejfKTC363E6YVdfMeUcufATZkOh5n4GE1w3bfHIyd1TuuQOKKLoxAhjCkpuYCqrtB5SxWHWdjAy82W8oNXpDyXYGg5GZib3wt8IJa8u/39vj4K7+snXhQva++I3C3KxxsnNRU8dks7guRrN9uORoQP3Grpe9zKGjUXvOis0+GRCoJk+RXxAEP/QBjRYNgznldKL9rvsoaMYibZBQ5ZfnQsm8DV6HKDHbrjM+So9+TyfqWOWzBoTKzch7cPUUA3eD76QTfpr/VJS+r36/s+Wr+hL9PK7DWikLnqwyLvvl3SSrNqrri6tx/821rAl8lwX1HFTTQnmDCNrUguP7qN1O7LR503GxFUYRP6k7bQsYaFQTR8qeGWlpVLEt7r9HoRgbr9xWV8eu9yFWPpWK1Za8yINQZBDUpK2tDvsglnTJrYxGeQMgpXRPxpDBjsnNiDbIG67W2tu1fD2gZ2lq4mPB/E/DMKYR+R5nQg218D9NzzNwg/AH7bx3xSoFOXJeZGLPgL9eZP8ZQc9eyag7ZJT67khLAjmplAiRPShFxYqEQgRXaSwbR5Kb9+/d+rztLck3KdEHYpRmViRlu8zOicGCtjRPsZ+HNx6ZWGGWOD8bi0UQIHwPQLDguAMYoB0rvJ+IE7OUCi8yO2gVijXtXsPPol74FN6/0v3D4I7f+6Lspzofj3KnWcZ2jIIu8k8xfDoUwrmmPNZnirs6FzinbI4Empn56+Toqdiwwj3VoRPzsYn1A3aloO+UycrmU8vSd5r4GhznLsl6siComUESFZAlIpiVUkG1LB31Y0oEHTgH2/LPAbX9I7F9dKEWl6er1zslxyYQgjfHLvUHOdxH7UZaQYNkpRg5158oHn3eBULutx6XRCTMRanvEiRtt/hnvZZ6rL6kE5Yp5SAygZG1Stnkq2gd92EU0UABw9Y7qgvP9OjzgOVBvdznLfsls6532dY2O5BpU3K/87yKLU0qlhJgoHVUr4ENtmhmDQ4dkRfeWyBwho9GkLht40F4OVCN89VWffwih74R7EXP28qxPA9dgP2EG2RUmR5mfXzZCLRn+jxy9lM8+G+TJ6MicjRTXtb8LYKPKEr+GJYqH0jEr/PmRRqEw3Qa6gYXFxy+MgUoeKXpDs12clu+fFtwDAomRKyrMvtgTwJa5mIzO97yceiQSbGNKxUaRlm66BU5W8Y+5zzSC1/3iglRdk6rQHeiwmQ+VSiE1vnb0G1c/U0Wh1vQVwGjhTMeaQagCWFhu7R0SRzJLEhrTYv6q8h7p0eyc6yPDXEAjooqeTGgH224wMoAMvceOuqY+nFr8EPusUtW3Du3p9BYuucMMpL1ei4f7PTKAiIrwKgnnwsD06L8BNI+NtKMRhUymijkyshY5NUOVJ4sV8sqa8RCVdGMFcYHSp8wz8RPMJxV+O6P4F/T6VfleivWQT0KhKnkdwcX8kvUxMpwNTRa0glcTCCCd4GCSqGSIb3DQEHAaCCCc8EggnLMIIJxzCCCcMGCyqGSIb3DQEMCgECoIIJbjCCCWowHAYKKoZIhvcNAQwBAzAOBAhK9bqi6TFWGwICCAAEgglIYcaVbeDzaBTEGuuLKJIykK9ZyLjFqum4dR4emAu/kDeY2L1CQ+umYwyUQv6JXr8Fc5y7pSa/EtbyEfynJNKYmoOdMFpn+25rkEZfHiAxVibhvieIHxV/4eaKU9TLrLxxOrpPptLHRi+QI6Ml3n70fwMKtgPKzWv3dASWc1m4P4F7lWTQdnkKnhILt+5DYhZdyWMDbKiS2m2zcgCvz+Ufb/koO26LIUuwhrnEric9SwwbraqmgJk9zrsl+ocyBc1y+wYVJW9K2a3wDHv/x+Rr/M/Y4d04nZsCY8yROkzDwXKNBUwnu2ubNKDcQVSJ8UdCgMS7pVjdDEQ6M4/vn1C3InxY+IB2iTtewijMzcpt+cFA98BsyoOfTGq8mYFT4ikX3Cejkkf25dFQQO40VzPcPM2xtPlGezPiwIjekJIGX5XPHQFA6DyvvOnx1ReKcoNCXgZD2mixutCrqzihQwuZDJKDhaCjYLfsWrgmxK/iLC70kZ9h5zIBGiqNzvsMqaVdrpOyAd3DdDfWaq96lDR72iZPNo7hZk8lYXeL0WThIgrn35DrBBUxvHWss2jDwkIZkM40mhjzd/p8oBfSdBOU4vobp7U2MjrI8fuoLNE9ONIYUwsfp6RcbJVdbx1W7VBaivh5XOg8mSTkEAZFH3HXdt+3JMoLKOnsjqSoxNlSDkAF/RRwxl9tpU/e+lzjAkeQh+RpCBZlg1gAIef31I2llIrvnzWv7iWFKI73W9P0eFRjQ5ARb12jLYnXOp3EeX5Y27i3qbtN5KfTmHtAxOpxA9ZBtbg2Ms0veKgBV8dzRcKdq/7XTPPHLMEvK0/rX5nJxHbUtRDGzx+dkH3zhpBZhc9gKrlDumulBR3mAGhsraOvkqVoVBsoAokQp91G8WX2XglB8easCobZz8Tr+AP/Kn3th3yQj8M1PDI10JQkfVgDRIzSjh7iU6CVFj3J4Mum4JT4UJcqSwRfopnR8X06KC3gCRxhdTGzuRIOm2HVOnGSNuiSYOrC9PrZ3RjZWoPSIT2MWdT51kcRR237lOkesVuAMaGYvp1gl//GFmcDd7lg4pmfY/W7XZN4eaQaOr/Vn5f8jFowntC2iA3V383gwCM9kM6wwLB7sdDWenZRNRQI1mUVW8uR8cML41plZWw4WVylHZaGDCvPjkz73xcAUaAQ/9L92RXe4Zrrjd/Yo/587634h1aALUlk/gMYpB9IvQJAQYc5pIbKszepvJl0Kneyu16Xu9Ikbyz0Fu4CvALzP2MElnnHHdz89qHQUxzLhDV0dSfZGEJHUJbQrUoLWhznaoFJ91xvsYXj62cA6oZXAPUQoDaQjFlZ+xQKI00iDPnk+4MH88kyatt63gHvEVrNoik6AyJsb8RN78/W4xae+7N3oxxiSRVZLmR/z9razs6/IO1xNU2y95AAxHPA6wSWdN9c/UxcPSe+6/Gbteum1GuZE9ReQRm8LT/KwCr7lVxlPDQAV/Dum73tywEg3DllfVoaWud5cNe5ISdOte5b5b3JT7yQzfJcgwm4CHK6QLNbPC94bmhh/ofRfY29aO4Uw2MV8Kyc8F40GTGjevBtojlsfFpxukdzkaP3RUDXtbWsUDiam2kpTYJaHIPRGTC2+yd6mPIC+mrfPlNZbt/Q0NsFDdSoFdupvBmF+8F7yvRrj3/K\n\n\\[XDPService\\] Debug - \\[SiteStatusProvider - NotifyOnSiteConfigUpdated:123\\] ClientCertificateP12: , CaCert: , Sites: \\[Gateways: \\[Id: 1ae48b24-c295-4bf7-8633-84d72c83c68f, Address: turquoise-gw5.northeurope.cloudapp.azure.com:443, Protocol: dtls, Weight: 100\\], Routes: \\[10.66.66.0/24\\], AllocatedIpv4: 192.168.100.29, AllocatedIpv6: fd00:ffff:b:20:0:0:0:132, Id: Azure Northern Europe, State: Disconnected, Gateways: \\[Id: e30a8183-66b1-45b9-b6c8-4352d5f385ad, Address: turquoise-gw4.cryptzone.com:443, Protocol: tls, Weight: 100, Id: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, Address: turquoise-gw3.cryptzone.com:443, Protocol: tls, Weight: 100\\], Routes: \\[10.0.0.0/24\\], AllocatedIpv4: 192.168.100.29, AllocatedIpv6: fd00:ffff:b:20:0:0:0:132, Id: AWS US East, State: Disconnected, Gateways: \\[Id: f302e4dd-7067-4193-a9b2-9b379791b928, Address: turquoise-gw1.cryptzone.com:443, Protocol: tls, Weight: 100, Id: 966aa05a-a7c6-4c04-95fd-77bb8dfbb0ab, Address: turquoise-gw2.cryptzone.com:443, Protocol: tls, Weight: 100\\], Routes: \\[172.17.20.0/24, fd00:ffff:a:60::/64, 172.17.40.0/24, 172.17.64.0/18, 192.168.111.0/24, 172.17.60.0/24, fd00:ffff:a:40::/64\\], AllocatedIpv4: 192.168.100.29, AllocatedIpv6: fd00:ffff:b:20:0:0:0:132, Id: Gothenburg, State: Disconnected\\], Id: clientdeploy, DnsServers: \\[fd00:ffff:a:40:172:17:40:8, fd00:ffff:a:40:172:17:40:9, 172.17.40.8, 172.17.40.9\\], DnsSearchDomains: \\[cryptzone.ad, ad.cryptzone.com\\]\n\n\\[XDPService\\] Info - \\[GatewayLogic - HandleClaimsTokenUpdated\\] New claims token \\[#NULL#\\] supplied to controlchannel 'wss://13.69.242.121:443/session/ws/'. Will send it.\n\n\\[XDPService\\] Info - \\[GatewayLogic - HandleClaimsTokenUpdated\\] New claims token \\[#NULL#\\] supplied to controlchannel 'wss://52.87.20.171:443/session/ws/'. Will send it.\n\n\\[XDPService\\] Info - \\[GatewayLogic - HandleClaimsTokenUpdated\\] New claims token \\[#NULL#\\] supplied to controlchannel 'wss://212.16.176.143:443/session/ws/'. Will send it.\n\n\\[XDPService\\] Info - \\[GatewayLogic - HandleEntitlementTokensUpdated\\] New entitlement tokens supplied to controlchannel 'wss://13.69.242.121:443/session/ws/'. Will send it.\n\n\\[XDPService\\] Info - \\[GatewayLogic - HandleEntitlementTokensUpdated\\] New entitlement tokens supplied to controlchannel 'wss://52.87.20.171:443/session/ws/'. Will send it.\n\n\\[XDPService\\] Info - \\[GatewayLogic - HandleEntitlementTokensUpdated\\] New entitlement tokens supplied to controlchannel 'wss://212.16.176.143:443/session/ws/'. Will send it.\n\n\\[XDPService\\] Debug - \\[ActionCenter - NotifyOnDisplayNameUpdated:270\\] \\[NotifyOnDisplayNameUpdated\\]\n\n\\[XDPService\\] Debug - \\[LiveLogic - SendUiRootModel:256\\] \\[SendUiRootModel\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - GetPendingConsumerActions:144\\] \\[GetPendingConsumerActions\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - HandleOnResult:285\\] Received result \\[JsonRpcResult id=10 result=\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:27\\] Searching for Id '10' RequestsSent count '1', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:30\\] Took Id '10' in RequestsSent, name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[LiveApp - Save:104\\] Sending Tasks: \\[\\], Status: disconnecting, User: Name: , Services: \\[Name: Gothenburg, Connected: True, Name: Azure Northern Europe, Connected: True, Name: AWS US East, Connected: True\\], Entitlements: \\[TokenId: c0fc0490-b98f-4e38-8328-e3616eb682ac, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.315Z, Site: Azure Northern Europe, Gateways: \\[Weight: 100, Id: 1ae48b24-c295-4bf7-8633-84d72c83c68f, ControlChannel: wss://turquoise-gw5.northeurope.cloudapp.azure.com:443/session/ws/, Vpnd: turquoise-gw5.northeurope.cloudapp.azure.com:443, VpnProtocol: DTLS\\], GatewayHostname: , Routes: \\[10.66.66.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 717836f5-5a60-453f-8071-c5aaf4ae8e8f, Name: Azure Finance, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\], Id: 216946c9-bf56-4284-98dc-c4ccbcfa8018, Name: Azure Endpoint 1, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\]\\], TokenId: ef599d07-f49d-4084-b5b4-940f4f109ee1, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.318Z, Site: AWS US East, Gateways: \\[Weight: 100, Id: e30a8183-66b1-45b9-b6c8-4352d5f385ad, ControlChannel: wss://turquoise-gw4.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw4.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, ControlChannel: wss://turquoise-gw3.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw3.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[10.0.0.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 8d379dd7-2544-45b1-9a23-2be579ff2684, Name: CatServe, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[\\]\\], TokenId: f808c4a7-6292-44e2-8649-c20d5d75beb6, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.310Z, Site: Gothenburg, Gateways: \\[Weight: 100, Id: f302e4dd-7067-4193-a9b2-9b379791b928, ControlChannel: wss://turquoise-gw1.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw1.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 966aa05a-a7c6-4c04-95fd-77bb8dfbb0ab, ControlChannel: wss://turquoise-gw2.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw2.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[172.17.20.0/24, fd00:ffff:a:60::/64, 172.17.40.0/24, 172.17.64.0/18, 192.168.111.0/24, 172.17.60.0/24, fd00:ffff:a:40::/64\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 781c62ce-21ac-4cd0-8e91-b67454194f73, Name: Test OTP, Actions: \\[Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[Id: 12bf2ff6-ca64-46b5-9e0c-7b629a8ba56c, Name: Require Regular OTP, Expression: //Generated by criteria builder, Operator: ||\n\n\\[XDPService\\] var result = false;\n\n\\[XDPService\\] if/\\*otp\\*/(claims.user.hasOtp('regular', '180'))/\\*end otp\\*/ { return true; }\n\n\\[XDPService\\] return result;, RepeatSchedules: System.Collections.Generic.List\\`1\\[System.String\\], RemedyMethods: System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Client.Controller.Rest.Contracts.RemedyMethod\\]\\], Id: ce08158a-08a0-4022-b7d1-282c1b0ccf90, Name: VM Subnet for Aitorbot Machines, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Act\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:223\\] Adding request with id '11', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:226\\] Sending RPC request 'smackbone.save' with I '11' to 'Smackbone'.\n\n\\[XDPService\\] Info - \\[BusinessLogic - Logout\\] Logging out from the system.\n\n\\[XDPService\\] Debug - \\[SitesLogic - CleanUp:40\\] Dispose all 3 siteLogics\n\n\\[XDPService\\] Debug - \\[SiteLogic - CleanUp:36\\] Disposing gatewaylogic with id 'f302e4dd-7067-4193-a9b2-9b379791b928'\n\n\\[XDPService\\] Debug - \\[GatewayLogic - CleanUp:77\\] Disposing control channel client\n\n\\[XDPService\\] Info - \\[GatewayLogic - Logout\\] Logging out from 'wss://212.16.176.143:443/session/ws/'.\n\n\\[XDPService\\] Debug - \\[ControlChannelClient - Logout:132\\] \\[Logout: begin\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithoutResponse:194\\] Adding request with id '2', name '212.16.176.143 Control Channel'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithoutResponse:197\\] Sending RPC request 'logout' with I '2' to '212.16.176.143 Control Channel'.\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - Dispose:52\\] Dispose '212.16.176.143 Control Channel'\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Dispose:197\\] ControlChannel  (212.16.176.143:443) H-1812807680 \\[\\[7\\]\\] : Dispose ControlChannel\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Read:178\\] ControlChannel  (212.16.176.143:443) H0 \\[\\[24\\]\\] : Read: Connection failed: octetsRead '{0}'. closing...\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - StartProducerTask:148\\] Connection lost.\n\nThread finished: 212.16.176.143 Control Channel JSON RPC Worker Producer #22\n\nThread finished: 212.16.176.143 Control Channel JSON RPC Worker Consumer #23\n\n\\[CZVpnService\\] Gothenburg: Read, failed\n\n\\[CZVpnService\\] Gothenburg: loop, end\n\nThread finished: 212.16.176.143 Control Channel JSON RPC Connection #21\n\n\\[CZVpnService\\] Gothenburg: close tunnel\n\nThread finished: 212.16.176.143 Websocket Updater #20\n\n\\[XDPService\\] Debug - \\[ControlChannelClient - HandleDisconnect:259\\] Controlchannel is disconnected with reason 'General'\n\n\\[XDPService\\] Debug - \\[TunDriverLogic - HandleOnSiteStatusesChanged:139\\] \\[HandleOnSiteStatusesChanged\\] \\[Gothenburg, GatewayId: , Host: , Ip: , Status: disconnected, Error: , ErrorCode: 0, SiteState: Disconnected\\];\\[Azure Northern Europe, GatewayId: 1ae48b24-c295-4bf7-8633-84d72c83c68f, Host: , Ip: , Status: up, Error: , ErrorCode: 0, SiteState: Up\\];\\[AWS US East, GatewayId: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, Host: , Ip: , Status: up, Error: , ErrorCode: 0, SiteState: Up\\]\n\n\\[XDPService\\] Debug - \\[SiteLogic - CleanUp:36\\] Disposing gatewaylogic with id '1ae48b24-c295-4bf7-8633-84d72c83c68f'\n\n\\[XDPService\\] Debug - \\[GatewayLogic - CleanUp:77\\] Disposing control channel client\n\n\\[XDPService\\] Info - \\[GatewayLogic - Logout\\] Logging out from 'wss://13.69.242.121:443/session/ws/'.\n\n\\[XDPService\\] Debug - \\[ControlChannelClient - Logout:132\\] \\[Logout: begin\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithoutResponse:194\\] Adding request with id '2', name '13.69.242.121 Control Channel'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithoutResponse:197\\] Sending RPC request 'logout' with I '2' to '13.69.242.121 Control Channel'.\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - Dispose:52\\] Dispose '13.69.242.121 Control Channel'\n\nThread finished: 13.69.242.121 Websocket Updater #24\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - HandleOnResult:285\\] Received result \\[JsonRpcResult id=11 result=\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:27\\] Searching for Id '11' RequestsSent count '1', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:30\\] Took Id '11' in RequestsSent, name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Dispose:197\\] ControlChannel  (13.69.242.121:443) H-1812209664 \\[\\[7\\]\\] : Dispose ControlChannel\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Read:178\\] ControlChannel  (13.69.242.121:443) H0 \\[\\[28\\]\\] : Read: Connection failed: octetsRead '{0}'. closing...\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - StartProducerTask:148\\] Connection lost.\n\nThread finished: 13.69.242.121 Control Channel JSON RPC Worker Producer #26\n\nThread finished: 13.69.242.121 Control Channel JSON RPC Worker Consumer #27\n\nThread finished: 13.69.242.121 Control Channel JSON RPC Connection #25\n\n\\[XDPService\\] Debug - \\[ControlChannelClient - HandleDisconnect:259\\] Controlchannel is disconnected with reason 'General'\n\n\\[XDPService\\] Debug - \\[SiteLogic - CleanUp:36\\] Disposing gatewaylogic with id '5c63120b-e7f2-45b7-9eb2-84a5ba24846a'\n\n\\[XDPService\\] Debug - \\[GatewayLogic - CleanUp:77\\] Disposing control channel client\n\n\\[XDPService\\] Info - \\[GatewayLogic - Logout\\] Logging out from 'wss://52.87.20.171:443/session/ws/'.\n\n\\[XDPService\\] Debug - \\[ControlChannelClient - Logout:132\\] \\[Logout: begin\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithoutResponse:194\\] Adding request with id '2', name '52.87.20.171 Control Channel'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithoutResponse:197\\] Sending RPC request 'logout' with I '2' to '52.87.20.171 Control Channel'.\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - Dispose:52\\] Dispose '52.87.20.171 Control Channel'\n\nThread finished: 52.87.20.171 Websocket Updater #28\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Dispose:197\\] ControlChannel  (52.87.20.171:443) H-1812041728 \\[\\[7\\]\\] : Dispose ControlChannel\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Read:178\\] ControlChannel  (52.87.20.171:443) H0 \\[\\[32\\]\\] : Read: Connection failed: octetsRead '{0}'. closing...\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - StartProducerTask:148\\] Connection lost.\n\nThread finished: 52.87.20.171 Control Channel JSON RPC Worker Producer #30\n\nThread finished: 52.87.20.171 Control Channel JSON RPC Worker Consumer #31\n\nThread finished: 52.87.20.171 Control Channel JSON RPC Connection #29\n\n\\[CZVpnService\\] Azure Northern Europe: Read, failed\n\n\\[XDPService\\] Debug - \\[ControlChannelClient - HandleDisconnect:259\\] Controlchannel is disconnected with reason 'General'\n\n\\[CZVpnService\\] Azure Northern Europe: loop, end\n\n\\[CZVpnService\\] Azure Northern Europe: close tunnel\n\n\\[XDPService\\] Info - \\[TunDriverLogic - CleanUp\\] Closing connection to TUN driver.\n\n\\[XDPService\\] Debug - \\[ActionCenter - NotifyOnServiceUpdated:276\\] \\[NotifyOnServiceUpdated\\]\n\n\\[XDPService\\] Debug - \\[LiveLogic - SendUiRootModel:256\\] \\[SendUiRootModel\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - GetPendingConsumerActions:144\\] \\[GetPendingConsumerActions\\]\n\n\\[CZVpnService\\] OnRevoke\n\n\\[CZVpnService\\] Cleanup\n\n\\[CZVpnService\\] Azure Northern Europe: close\n\n\\[XDPService\\] Debug - \\[LiveApp - Save:104\\] Sending Tasks: \\[\\], Status: disconnecting, User: Name: , Services: \\[\\], Entitlements: \\[TokenId: c0fc0490-b98f-4e38-8328-e3616eb682ac, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.315Z, Site: Azure Northern Europe, Gateways: \\[Weight: 100, Id: 1ae48b24-c295-4bf7-8633-84d72c83c68f, ControlChannel: wss://turquoise-gw5.northeurope.cloudapp.azure.com:443/session/ws/, Vpnd: turquoise-gw5.northeurope.cloudapp.azure.com:443, VpnProtocol: DTLS\\], GatewayHostname: , Routes: \\[10.66.66.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 717836f5-5a60-453f-8071-c5aaf4ae8e8f, Name: Azure Finance, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\], Id: 216946c9-bf56-4284-98dc-c4ccbcfa8018, Name: Azure Endpoint 1, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\]\\], TokenId: ef599d07-f49d-4084-b5b4-940f4f109ee1, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.318Z, Site: AWS US East, Gateways: \\[Weight: 100, Id: e30a8183-66b1-45b9-b6c8-4352d5f385ad, ControlChannel: wss://turquoise-gw4.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw4.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, ControlChannel: wss://turquoise-gw3.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw3.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[10.0.0.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 8d379dd7-2544-45b1-9a23-2be579ff2684, Name: CatServe, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[\\]\\], TokenId: f808c4a7-6292-44e2-8649-c20d5d75beb6, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.310Z, Site: Gothenburg, Gateways: \\[Weight: 100, Id: f302e4dd-7067-4193-a9b2-9b379791b928, ControlChannel: wss://turquoise-gw1.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw1.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 966aa05a-a7c6-4c04-95fd-77bb8dfbb0ab, ControlChannel: wss://turquoise-gw2.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw2.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[172.17.20.0/24, fd00:ffff:a:60::/64, 172.17.40.0/24, 172.17.64.0/18, 192.168.111.0/24, 172.17.60.0/24, fd00:ffff:a:40::/64\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 781c62ce-21ac-4cd0-8e91-b67454194f73, Name: Test OTP, Actions: \\[Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[Id: 12bf2ff6-ca64-46b5-9e0c-7b629a8ba56c, Name: Require Regular OTP, Expression: //Generated by criteria builder, Operator: ||\n\n\\[XDPService\\] var result = false;\n\n\\[XDPService\\] if/\\*otp\\*/(claims.user.hasOtp('regular', '180'))/\\*end otp\\*/ { return true; }\n\n\\[XDPService\\] return result;, RepeatSchedules: System.Collections.Generic.List\\`1\\[System.String\\], RemedyMethods: System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Client.Controller.Rest.Contracts.RemedyMethod\\]\\], Id: ce08158a-08a0-4022-b7d1-282c1b0ccf90, Name: VM Subnet for Aitorbot Machines, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Por\n\n\\[CZVpnService\\] Azure Northern Europe: close tunnel\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:223\\] Adding request with id '12', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:226\\] Sending RPC request 'smackbone.save' with I '12' to 'Smackbone'.\n\n\\[CZVpnService\\] AWS US East: close\n\n\\[CZVpnService\\] AWS US East: close tunnel\n\n\\[CZVpnService\\] AWS US East: Read, failed\n\n\\[CZVpnService\\] AWS US East: loop, end\n\n\\[CZVpnService\\] AWS US East: close tunnel\n\n\\[CZVpnService\\] Gothenburg: close\n\n\\[CZVpnService\\] Gothenburg: close tunnel\n\n\\[XDPService\\] Info - \\[BusinessLogic - Logout\\] Logout done.\n\n\\[XDPService\\] Debug - \\[ActionCenter - NotifyOnPendingConsumerActionsUpdated:264\\] \\[NotifyOnPendingConsumerActionsUpdated\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - GetPendingConsumerActions:144\\] \\[GetPendingConsumerActions\\]\n\n\\[XDPService\\] Info - \\[NotificationHandler - HandleNotification\\] Cancel Android Notification\n\n\\[XDPService\\] Debug - \\[LiveLogic - SendUiRootModel:256\\] \\[SendUiRootModel\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - GetPendingConsumerActions:144\\] \\[GetPendingConsumerActions\\]\n\n\\[XDPService\\] Debug - \\[LiveApp - Save:104\\] Sending Tasks: \\[\\], Status: disconnecting, User: Name: , Services: \\[\\], Entitlements: \\[TokenId: c0fc0490-b98f-4e38-8328-e3616eb682ac, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.315Z, Site: Azure Northern Europe, Gateways: \\[Weight: 100, Id: 1ae48b24-c295-4bf7-8633-84d72c83c68f, ControlChannel: wss://turquoise-gw5.northeurope.cloudapp.azure.com:443/session/ws/, Vpnd: turquoise-gw5.northeurope.cloudapp.azure.com:443, VpnProtocol: DTLS\\], GatewayHostname: , Routes: \\[10.66.66.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 717836f5-5a60-453f-8071-c5aaf4ae8e8f, Name: Azure Finance, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\], Id: 216946c9-bf56-4284-98dc-c4ccbcfa8018, Name: Azure Endpoint 1, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\]\\], TokenId: ef599d07-f49d-4084-b5b4-940f4f109ee1, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.318Z, Site: AWS US East, Gateways: \\[Weight: 100, Id: e30a8183-66b1-45b9-b6c8-4352d5f385ad, ControlChannel: wss://turquoise-gw4.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw4.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, ControlChannel: wss://turquoise-gw3.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw3.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[10.0.0.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 8d379dd7-2544-45b1-9a23-2be579ff2684, Name: CatServe, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[\\]\\], TokenId: f808c4a7-6292-44e2-8649-c20d5d75beb6, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.310Z, Site: Gothenburg, Gateways: \\[Weight: 100, Id: f302e4dd-7067-4193-a9b2-9b379791b928, ControlChannel: wss://turquoise-gw1.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw1.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 966aa05a-a7c6-4c04-95fd-77bb8dfbb0ab, ControlChannel: wss://turquoise-gw2.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw2.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[172.17.20.0/24, fd00:ffff:a:60::/64, 172.17.40.0/24, 172.17.64.0/18, 192.168.111.0/24, 172.17.60.0/24, fd00:ffff:a:40::/64\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 781c62ce-21ac-4cd0-8e91-b67454194f73, Name: Test OTP, Actions: \\[Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[Id: 12bf2ff6-ca64-46b5-9e0c-7b629a8ba56c, Name: Require Regular OTP, Expression: //Generated by criteria builder, Operator: ||\n\n\\[XDPService\\] var result = false;\n\n\\[XDPService\\] if/\\*otp\\*/(claims.user.hasOtp('regular', '180'))/\\*end otp\\*/ { return true; }\n\n\\[XDPService\\] return result;, RepeatSchedules: System.Collections.Generic.List\\`1\\[System.String\\], RemedyMethods: System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Client.Controller.Rest.Contracts.RemedyMethod\\]\\], Id: ce08158a-08a0-4022-b7d1-282c1b0ccf90, Name: VM Subnet for Aitorbot Machines, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Por\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:223\\] Adding request with id '13', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:226\\] Sending RPC request 'smackbone.save' with I '13' to 'Smackbone'.\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - HandleOnResult:285\\] Received result \\[JsonRpcResult id=12 result=\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:27\\] Searching for Id '12' RequestsSent count '2', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:30\\] Took Id '12' in RequestsSent, name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[ActionCenter - NotifyOnPendingProviderActionsUpdated:258\\] \\[NotifyOnPendingProviderActionsUpdated\\]\n\n\\[XDPService\\] Debug - \\[BusinessLogic - UpdateInternalState:288\\] \\[UpdateInternalState: newLogicState 'loggingin', prev 'disconnecting'\\]\n\n\\[XDPService\\] Debug - \\[LiveLogic - SendUiRootModel:256\\] \\[SendUiRootModel\\]\n\n\\[XDPService\\] Debug - \\[ActionCenter - GetPendingConsumerActions:144\\] \\[GetPendingConsumerActions\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - HandleOnResult:285\\] Received result \\[JsonRpcResult id=13 result=\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:27\\] Searching for Id '13' RequestsSent count '1', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:30\\] Took Id '13' in RequestsSent, name 'Smackbone'\n\n\\[art\\] Explicit concurrent mark sweep GC freed 2254(221KB) AllocSpace objects, 33(1581KB) LOS objects, 39% free, 18MB/31MB, paused 1.172ms total 19.321ms\n\n\\[Mono\\] GC\\_OLD\\_BRIDGE num-objects 9 num\\_hash\\_entries 9 sccs size 9 init 0.00ms df1 0.18ms sort 0.01ms dfs2 0.56ms setup-cb 0.02ms free-data 0.05ms links 0/0/0/0 dfs passes 18/9\n\n\\[Mono\\] GC\\_MINOR: (Nursery full) pause 47.51ms, total 51.66ms, bridge 0.00ms promoted 32K major 1664K los 11684K\n\n\\[CZVpnService\\] OnDestroy\n\n\\[CZVpnService\\] OnRevoke\n\n\\[CZVpnService\\] Cleanup\n\n\\[XDPService\\] Debug - \\[LiveApp - Save:104\\] Sending Tasks: \\[\\], Status: idle, User: Name: , Services: \\[\\], Entitlements: \\[TokenId: c0fc0490-b98f-4e38-8328-e3616eb682ac, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.315Z, Site: Azure Northern Europe, Gateways: \\[Weight: 100, Id: 1ae48b24-c295-4bf7-8633-84d72c83c68f, ControlChannel: wss://turquoise-gw5.northeurope.cloudapp.azure.com:443/session/ws/, Vpnd: turquoise-gw5.northeurope.cloudapp.azure.com:443, VpnProtocol: DTLS\\], GatewayHostname: , Routes: \\[10.66.66.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 717836f5-5a60-453f-8071-c5aaf4ae8e8f, Name: Azure Finance, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\], Id: 216946c9-bf56-4284-98dc-c4ccbcfa8018, Name: Azure Endpoint 1, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\]\\], Conditions: \\[\\]\\], TokenId: ef599d07-f49d-4084-b5b4-940f4f109ee1, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.318Z, Site: AWS US East, Gateways: \\[Weight: 100, Id: e30a8183-66b1-45b9-b6c8-4352d5f385ad, ControlChannel: wss://turquoise-gw4.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw4.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 5c63120b-e7f2-45b7-9eb2-84a5ba24846a, ControlChannel: wss://turquoise-gw3.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw3.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[10.0.0.0/24\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 8d379dd7-2544-45b1-9a23-2be579ff2684, Name: CatServe, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[\\]\\], TokenId: f808c4a7-6292-44e2-8649-c20d5d75beb6, ClaimsTokenId: c3b334e9-531e-4e6f-b5b1-1a6abffa9e24, Expires: 2016-06-28T09:22:25.310Z, Site: Gothenburg, Gateways: \\[Weight: 100, Id: f302e4dd-7067-4193-a9b2-9b379791b928, ControlChannel: wss://turquoise-gw1.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw1.cryptzone.com:443, VpnProtocol: TLS, Weight: 100, Id: 966aa05a-a7c6-4c04-95fd-77bb8dfbb0ab, ControlChannel: wss://turquoise-gw2.cryptzone.com:443/session/ws/, Vpnd: turquoise-gw2.cryptzone.com:443, VpnProtocol: TLS\\], GatewayHostname: , Routes: \\[172.17.20.0/24, fd00:ffff:a:60::/64, 172.17.40.0/24, 172.17.64.0/18, 192.168.111.0/24, 172.17.60.0/24, fd00:ffff:a:40::/64\\], AllocatedIp: IpV4: 192.168.100.29, IpV6: fd00:ffff:b:20:0:0:0:132, Entitlements: \\[Id: 781c62ce-21ac-4cd0-8e91-b67454194f73, Name: Test OTP, Actions: \\[Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Conditions: \\[Id: 12bf2ff6-ca64-46b5-9e0c-7b629a8ba56c, Name: Require Regular OTP, Expression: //Generated by criteria builder, Operator: ||\n\n\\[XDPService\\] var result = false;\n\n\\[XDPService\\] if/\\*otp\\*/(claims.user.hasOtp('regular', '180'))/\\*end otp\\*/ { return true; }\n\n\\[XDPService\\] return result;, RepeatSchedules: System.Collections.Generic.List\\`1\\[System.String\\], RemedyMethods: System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Client.Controller.Rest.Contracts.RemedyMethod\\]\\], Id: ce08158a-08a0-4022-b7d1-282c1b0ccf90, Name: VM Subnet for Aitorbot Machines, Actions: \\[Type: IpAccess, Action: allow, SubType: tcp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: System.Collections.Generic.List\\`1\\[System.String\\], Type: IpAccess, Action: allow, SubType: icmp\\_up, Hosts: System.Collections.Generic.List\\`1\\[System.String\\], Log: first, Alert: none, Ports: \\], Co\n\n\\[CZVpnService\\] Azure Northern Europe: close\n\n\\[CZVpnService\\] Azure Northern Europe: close tunnel\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:223\\] Adding request with id '14', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:226\\] Sending RPC request 'smackbone.save' with I '14' to 'Smackbone'.\n\n\\[CZVpnService\\] AWS US East: close\n\n\\[CZVpnService\\] AWS US East: close tunnel\n\n\\[CZVpnService\\] Gothenburg: close\n\n\\[CZVpnService\\] Gothenburg: close tunnel\n\n\\[XDPService\\] Debug - \\[BusinessLogic - Process:252\\] \\[ProcessLogic: disconnect complete, internalstate 'loggingin'\\]\n\n\\[chromium\\] \\[INFO:CONSOLE(17)\\] \"ipc.send called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (17)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\] JNI DETECTED ERROR IN APPLICATION: JNI GetByteArrayRegion called with pending exception 'java.io.IOException' thrown in unknown throw location\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]     in call to GetByteArrayRegion\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\] \"Thread-1015\" prio=7 tid=49 Runnable\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   | group=\"main\" sCount=0 dsCount=0 obj=0x12cba100 self=0x94224400\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   | sysTid=23329 nice=-4 cgrp=default sched=0/0 handle=0x943cf400\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   | state=R schedstat=( 108275516 54350152 212 ) utm=7 stm=3 core=3 HZ=100\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   | stack=0x982b2000-0x982b4000 stackSize=1020KB\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   | held mutexes= \"mutator lock\"(shared held)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #00 pc 0000484c  /system/lib/libbacktrace\\_libc++.so (UnwindCurrent::Unwind(unsigned int, ucontext\\*)+23)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #01 pc 00003031  /system/lib/libbacktrace\\_libc++.so (Backtrace::Unwind(unsigned int, ucontext\\*)+8)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #02 pc 00243001  /system/lib/libart.so (art::DumpNativeStack(std::\\_\\_1::basic\\_ostream<char, std::\\_\\_1::char\\_traits<char> >&, int, char const\\*, art::mirror::ArtMethod\\*)+68)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #03 pc 002273a9  /system/lib/libart.so (art::Thread::Dump(std::\\_\\_1::basic\\_ostream<char, std::\\_\\_1::char\\_traits<char> >&) const+144)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #04 pc 000aff1b  /system/lib/libart.so (art::JniAbort(char const\\*, char const\\*)+582)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #05 pc 000b0661  /system/lib/libart.so (art::JniAbortF(char const\\*, char const\\*, ...)+60)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #06 pc 000b37a9  /system/lib/libart.so (art::ScopedCheck::ScopedCheck(\\_JNIEnv\\*, int, char const\\*)+1292)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #07 pc 000bc1bf  /system/lib/libart.so (art::CheckJNI::GetByteArrayRegion(\\_JNIEnv\\*, \\_jbyteArray\\*, int, int, signed char\\*)+30)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   native: #08 pc 0000cc18  /data/app/com.cryptzone.appgate.xdp-1/lib/arm/libmonodroid.so (java\\_interop\\_jnienv\\_get\\_byte\\_array\\_region+72)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/check\\_jni.cc:65\\] \n\n\\[XDPService\\] Debug - \\[JsonRpcWorker - HandleOnResult:285\\] Received result \\[JsonRpcResult id=14 result=\\]\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:27\\] Searching for Id '14' RequestsSent count '1', name 'Smackbone'\n\n\\[XDPService\\] Debug - \\[JsonRpcBase - FetchRequest:30\\] Took Id '14' in RequestsSent, name 'Smackbone'\n\n\\[chromium\\] \\[INFO:CONSOLE(17)\\] \"ipc.send called:\", source: [file:///android\\_asset/mobile/scripts/app.js](file:///android_asset/mobile/scripts/app.js) (17)\n\n\\[art\\] art/runtime/runtime.cc:289\\] Runtime aborting...\n\n\\[art\\] art/runtime/runtime.cc:289\\] Aborting thread:\n\n\\[art\\] art/runtime/runtime.cc:289\\] \"Thread-1015\" prio=7 tid=49 Native\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12cba100 self=0x94224400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=23329 nice=-4 cgrp=default sched=0/0 handle=0x943cf400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=R schedstat=( 131756928 69188220 246 ) utm=7 stm=6 core=3 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0x982b2000-0x982b4000 stackSize=1020KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes= \"abort lock\" \"mutator lock\"(shared held)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 0000484c  /system/lib/libbacktrace\\_libc++.so (UnwindCurrent::Unwind(unsigned int, ucontext\\*)+23)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 00003031  /system/lib/libbacktrace\\_libc++.so (Backtrace::Unwind(unsigned int, ucontext\\*)+8)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 00243001  /system/lib/libart.so (art::DumpNativeStack(std::\\_\\_1::basic\\_ostream<char, std::\\_\\_1::char\\_traits<char> >&, int, char const\\*, art::mirror::ArtMethod\\*)+68)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 002273a9  /system/lib/libart.so (art::Thread::Dump(std::\\_\\_1::basic\\_ostream<char, std::\\_\\_1::char\\_traits<char> >&) const+144)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 0021751f  /system/lib/libart.so (art::AbortState::DumpThread(std::\\_\\_1::basic\\_ostream<char, std::\\_\\_1::char\\_traits<char> >&, art::Thread\\*)+22)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00217785  /system/lib/libart.so (art::AbortState::Dump(std::\\_\\_1::basic\\_ostream<char, std::\\_\\_1::char\\_traits<char> >&)+364)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 00217951  /system/lib/libart.so (art::Runtime::Abort()+72)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #07 pc 000a63fb  /system/lib/libart.so (art::LogMessage::~LogMessage()+1322)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #08 pc 000b0109  /system/lib/libart.so (art::JniAbort(char const\\*, char const\\*)+1076)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #09 pc 000b0661  /system/lib/libart.so (art::JniAbortF(char const\\*, char const\\*, ...)+60)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #10 pc 000b37a9  /system/lib/libart.so (art::ScopedCheck::ScopedCheck(\\_JNIEnv\\*, int, char const\\*)+1292)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #11 pc 000bc1bf  /system/lib/libart.so (art::CheckJNI::GetByteArrayRegion(\\_JNIEnv\\*, \\_jbyteArray\\*, int, int, signed char\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #12 pc 0000cc18  /data/app/com.cryptzone.appgate.xdp-1/lib/arm/libmonodroid.so (java\\_interop\\_jnienv\\_get\\_byte\\_array\\_region+72)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] Pending exception java.io.IOException thrown by 'unknown throw location'\n\n\\[art\\] art/runtime/runtime.cc:289\\] java.io.IOException: read failed: EBADF (Bad file number)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int libcore.io.IoBridge.read(java.io.FileDescriptor, byte\\[\\], int, int) (IoBridge.java:482)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int java.io.FileInputStream.read(byte\\[\\], int, int) (FileInputStream.java:177)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int java.io.InputStream.read(byte\\[\\]) (InputStream.java:162)\n\n\\[art\\] art/runtime/runtime.cc:289\\] Caused by: android.system.ErrnoException: \n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int libcore.io.Posix.readBytes(java.io.FileDescriptor, java.lang.Object, int, int) (Posix.java:-2)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int libcore.io.Posix.read(java.io.FileDescriptor, byte\\[\\], int, int) (Posix.java:165)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int libcore.io.BlockGuardOs.read(java.io.FileDescriptor, byte\\[\\], int, int) (BlockGuardOs.java:230)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int libcore.io.IoBridge.read(java.io.FileDescriptor, byte\\[\\], int, int) (IoBridge.java:472)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int java.io.FileInputStream.read(byte\\[\\], int, int) (FileInputStream.java:177)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at int java.io.InputStream.read(byte\\[\\]) (InputStream.java:162)\n\n\\[art\\] art/runtime/runtime.cc:289\\] Dumping all threads without appropriate locks held: thread list lock mutator lock\n\n\\[art\\] art/runtime/runtime.cc:289\\] All threads:\n\n\\[art\\] art/runtime/runtime.cc:289\\] DALVIK THREADS (53):\n\n\\[art\\] art/runtime/runtime.cc:289\\] \"main\" prio=7 tid=1 Native\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x741a5698 self=0xb4827800\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22824 nice=-4 cgrp=default sched=0/0 handle=0xb6f0abec\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 2128315833 496247575 3806 ) utm=172 stm=40 core=3 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xbe1d2000-0xbe1d4000 stackSize=8MB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00037c4c  /system/lib/libc.so (\\_\\_epoll\\_pwait+20)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000121a7  /system/lib/libc.so (epoll\\_pwait+26)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 000121b5  /system/lib/libc.so (epoll\\_wait+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 00010f23  /system/lib/libutils.so (android::Looper::pollInner(int)+98)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 0001114d  /system/lib/libutils.so (android::Looper::pollOnce(int, int\\*, int\\*, void\\*\\*)+92)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 0007eb01  /system/lib/libandroid\\_runtime.so (android::NativeMessageQueue::pollOnce(\\_JNIEnv\\*, int)+22)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 000b3853  /data/dalvik-cache/arm/system@framework@boot.oat (Java\\_android\\_os\\_MessageQueue\\_nativePollOnce\\_\\_JI+102)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.MessageQueue.nativePollOnce(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.MessageQueue.next(MessageQueue.java:143)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.Looper.loop(Looper.java:123)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.app.ActivityThread.main(ActivityThread.java:5298)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.reflect.Method.invoke!(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.reflect.Method.invoke(Method.java:372)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:950)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:745)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"Heap thread pool worker thread 0\" prio=7 tid=2 Native (still starting up)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x0 self=0xaec3d400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22830 nice=0 cgrp=default sched=0/0 handle=0xb4918580\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 983177 2320626 11 ) utm=0 stm=0 core=3 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb429b000-0xb429d000 stackSize=1020KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010480  /system/lib/libc.so (syscall+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8dbf  /system/lib/libart.so (art::ConditionVariable::Wait(art::Thread\\*)+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 0023167f  /system/lib/libart.so (art::ThreadPool::GetTask(art::Thread\\*)+50)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 00231625  /system/lib/libart.so (art::ThreadPoolWorker::Run()+52)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 00231e61  /system/lib/libart.so (art::ThreadPoolWorker::Callback(void\\*)+52)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 00011f0b  /system/lib/libc.so (\\_\\_start\\_thread+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"Heap thread pool worker thread 1\" prio=7 tid=3 Native (still starting up)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x0 self=0xb4827400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22831 nice=0 cgrp=default sched=0/0 handle=0xb4918800\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 1170520 1604532 8 ) utm=0 stm=0 core=1 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb4199000-0xb419b000 stackSize=1020KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010480  /system/lib/libc.so (syscall+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8dbf  /system/lib/libart.so (art::ConditionVariable::Wait(art::Thread\\*)+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 0023167f  /system/lib/libart.so (art::ThreadPool::GetTask(art::Thread\\*)+50)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 00231625  /system/lib/libart.so (art::ThreadPoolWorker::Run()+52)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 00231e61  /system/lib/libart.so (art::ThreadPoolWorker::Callback(void\\*)+52)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 00011f0b  /system/lib/libc.so (\\_\\_start\\_thread+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"Heap thread pool worker thread 2\" prio=7 tid=4 Native (still starting up)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x0 self=0xaec3e400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22832 nice=0 cgrp=default sched=0/0 handle=0xb4918080\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 2484428 31459 5 ) utm=0 stm=0 core=1 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb4097000-0xb4099000 stackSize=1020KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010480  /system/lib/libc.so (syscall+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8dbf  /system/lib/libart.so (art::ConditionVariable::Wait(art::Thread\\*)+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 0023167f  /system/lib/libart.so (art::ThreadPool::GetTask(art::Thread\\*)+50)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 00231625  /system/lib/libart.so (art::ThreadPoolWorker::Run()+52)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 00231e61  /system/lib/libart.so (art::ThreadPoolWorker::Callback(void\\*)+52)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 00011f0b  /system/lib/libc.so (\\_\\_start\\_thread+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"Signal Catcher\" prio=7 tid=5 WaitingInMainSignalCatcherLoop\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c000a0 self=0xb4828c00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22833 nice=0 cgrp=default sched=0/0 handle=0xb4918300\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 956093 935833 1 ) utm=0 stm=0 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3f91000-0xb3f93000 stackSize=1012KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00037ba0  /system/lib/libc.so (\\_\\_rt\\_sigtimedwait+12)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 00015675  /system/lib/libc.so (sigwait+24)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 0021ad9b  /system/lib/libart.so (art::SignalCatcher::WaitForSignal(art::Thread\\*, art::SignalSet&)+66)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 0021c89d  /system/lib/libart.so (art::SignalCatcher::Run(void\\*)+196)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00011f0b  /system/lib/libc.so (\\_\\_start\\_thread+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"JDWP\" prio=7 tid=6 WaitingInMainDebuggerLoop\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c050a0 self=0xaec3f400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22834 nice=0 cgrp=default sched=0/0 handle=0xb4918a80\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 5122135 6970520 9 ) utm=0 stm=0 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3e8f000-0xb3e91000 stackSize=1012KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00037134  /system/lib/libc.so (\\_\\_pselect6+20)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 0001366f  /system/lib/libc.so (select+60)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 00282747  /system/lib/libart.so (art::JDWP::JdwpAdbState::ProcessIncoming()+186)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 0018f939  /system/lib/libart.so (art::JDWP::JdwpState::Run()+348)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 00190e63  /system/lib/libart.so (art::JDWP::StartJdwpThread(void\\*)+10)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 00011f0b  /system/lib/libc.so (\\_\\_start\\_thread+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"ReferenceQueueDaemon\" prio=7 tid=7 Waiting\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c070a0 self=0xb4829800\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22835 nice=0 cgrp=default sched=0/0 handle=0xb491ab00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 3098126 193541 14 ) utm=0 stm=0 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3d87000-0xb3d89000 stackSize=1036KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010480  /system/lib/libc.so (syscall+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8dbf  /system/lib/libart.so (art::ConditionVariable::Wait(art::Thread\\*)+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 001e987b  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, long long, int, bool, art::ThreadState)+998)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 001eac99  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, art::mirror::Object\\*, long long, int, bool, art::ThreadState)+120)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 001f7929  /system/lib/libart.so (art::Object\\_wait(\\_JNIEnv\\*, \\_jobject\\*)+32)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 000003df  /data/dalvik-cache/arm/system@framework@boot.oat (Java\\_java\\_lang\\_Object\\_wait\\_\\_+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Object.wait!(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - waiting on <0x0c10904d> (a java.lang.Class<java.lang.ref.ReferenceQueue>)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$ReferenceQueueDaemon.run(Daemons.java:134)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - locked <0x0c10904d> (a java.lang.Class<java.lang.ref.ReferenceQueue>)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.run(Thread.java:818)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"FinalizerDaemon\" prio=7 tid=8 Waiting\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c07100 self=0xb4829c00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22836 nice=0 cgrp=default sched=0/0 handle=0xb491ad80\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 11817136 3919895 21 ) utm=1 stm=0 core=1 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3c7f000-0xb3c81000 stackSize=1036KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010480  /system/lib/libc.so (syscall+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8dbf  /system/lib/libart.so (art::ConditionVariable::Wait(art::Thread\\*)+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 001e987b  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, long long, int, bool, art::ThreadState)+998)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 001eac99  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, art::mirror::Object\\*, long long, int, bool, art::ThreadState)+120)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 001f7901  /system/lib/libart.so (art::Object\\_waitJI(\\_JNIEnv\\*, \\_jobject\\*, long long, int)+36)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 0000060b  /data/dalvik-cache/arm/system@framework@boot.oat (Java\\_java\\_lang\\_Object\\_wait\\_\\_JI+102)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Object.wait!(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - waiting on <0x17931702> (a java.lang.ref.ReferenceQueue)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Object.wait(Object.java:422)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:101)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - locked <0x17931702> (a java.lang.ref.ReferenceQueue)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:72)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$FinalizerDaemon.run(Daemons.java:174)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.run(Thread.java:818)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"FinalizerWatchdogDaemon\" prio=7 tid=9 Sleeping\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c07160 self=0xb482a000\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22837 nice=0 cgrp=default sched=0/0 handle=0xb491b000\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 1237500 2586094 6 ) utm=0 stm=0 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3b77000-0xb3b79000 stackSize=1036KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010484  /system/lib/libc.so (syscall+32)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8b73  /system/lib/libart.so (art::ConditionVariable::TimedWait(art::Thread\\*, long long, int)+98)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 001e9669  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, long long, int, bool, art::ThreadState)+468)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 001eac99  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, art::mirror::Object\\*, long long, int, bool, art::ThreadState)+120)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 000732f1  /data/dalvik-cache/arm/system@framework@boot.oat (Java\\_java\\_lang\\_Thread\\_sleep\\_\\_Ljava\\_lang\\_Object\\_2JI+132)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.sleep!(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - sleeping on <0x282f9813> (a java.lang.Object)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.sleep(Thread.java:1031)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - locked <0x282f9813> (a java.lang.Object)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.sleep(Thread.java:985)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$FinalizerWatchdogDaemon.sleepFor(Daemons.java:258)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$FinalizerWatchdogDaemon.waitForFinalization(Daemons.java:269)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$FinalizerWatchdogDaemon.run(Daemons.java:217)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.run(Thread.java:818)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"HeapTrimmerDaemon\" prio=7 tid=10 Sleeping\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c071c0 self=0xb4834800\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22838 nice=0 cgrp=default sched=0/0 handle=0xb491b280\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 2260520 81146 9 ) utm=0 stm=0 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3a6f000-0xb3a71000 stackSize=1036KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 000387fc  /system/lib/libc.so (nanosleep+12)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000223c5  /system/lib/libc.so (usleep+36)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 0014206b  /system/lib/libart.so (art::gc::Heap::DoPendingTransitionOrTrim()+666)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 000003df  /data/dalvik-cache/arm/system@framework@boot.oat (Java\\_dalvik\\_system\\_VMRuntime\\_trimHeap\\_\\_+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at dalvik.system.VMRuntime.trimHeap(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - sleeping on an unknown object\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$HeapTrimmerDaemon.run(Daemons.java:313)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.run(Thread.java:818)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"GCDaemon\" prio=7 tid=11 Waiting\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c07220 self=0xb4834c00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22839 nice=0 cgrp=default sched=0/0 handle=0xb491b500\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 673958 0 4 ) utm=0 stm=0 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3967000-0xb3969000 stackSize=1036KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010480  /system/lib/libc.so (syscall+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000a8dbf  /system/lib/libart.so (art::ConditionVariable::Wait(art::Thread\\*)+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 001e987b  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, long long, int, bool, art::ThreadState)+998)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 001eac99  /system/lib/libart.so (art::Monitor::Wait(art::Thread\\*, art::mirror::Object\\*, long long, int, bool, art::ThreadState)+120)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 001f7929  /system/lib/libart.so (art::Object\\_wait(\\_JNIEnv\\*, \\_jobject\\*)+32)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 000003df  /data/dalvik-cache/arm/system@framework@boot.oat (Java\\_java\\_lang\\_Object\\_wait\\_\\_+82)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Object.wait!(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - waiting on <0x0e4bba50> (a java.lang.Daemons$GCDaemon)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Daemons$GCDaemon.run(Daemons.java:344)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   - locked <0x0e4bba50> (a java.lang.Daemons$GCDaemon)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.run(Thread.java:818)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"Binder\\_1\" prio=7 tid=12 Native\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12c680a0 self=0xaec40400\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22840 nice=0 cgrp=default sched=0/0 handle=0xb491b780\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 20949066 19634895 162 ) utm=1 stm=1 core=0 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xb3767000-0xb3769000 stackSize=1012KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00037c00  /system/lib/libc.so (\\_\\_ioctl+8)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 0004f5cd  /system/lib/libc.so (ioctl+14)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 0001cbaf  /system/lib/libbinder.so (android::IPCThreadState::talkWithDriver(bool)+138)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 0001d09f  /system/lib/libbinder.so (android::IPCThreadState::getAndExecuteCommand()+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #04 pc 0001d101  /system/lib/libbinder.so (android::IPCThreadState::joinThreadPool(bool)+48)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #05 pc 00021277  /system/lib/libbinder.so (???)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #06 pc 0000ef55  /system/lib/libutils.so (android::Thread::\\_threadLoop(void\\*)+112)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #07 pc 0005c7c9  /system/lib/libandroid\\_runtime.so (android::AndroidRuntime::javaThreadShell(void\\*)+72)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #08 pc 0000eac5  /system/lib/libutils.so (???)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #09 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #10 pc 00011f0b  /system/lib/libc.so (\\_\\_start\\_thread+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   (no managed stack frames)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #09 pc 00013ed7  /system/lib/libc.so (\\_\\_pthread\\_start(void\\*)+30)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12cbf0a0 self=0xb4b1f400\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"AsyncQueryWorker\" prio=7 tid=16 Native\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.MessageQueue.nativePollOnce(Native method)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.MessageQueue.next(MessageQueue.java:143)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.Looper.loop(Looper.java:123)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at android.os.HandlerThread.run(HandlerThread.java:61)\n\n\\[art\\] art/runtime/runtime.cc:289\\] \n\n\\[art\\] art/runtime/runtime.cc:289\\] \"RenderThread\" prio=7 tid=17 Native\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12d330a0 self=0xb4b29c00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22857 nice=-4 cgrp=default sched=0/0 handle=0xa53b4880\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 886134769 347814269 2238 ) utm=63 stm=25 core=2 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xa40ac000-0xa40ae000 stackSize=1012KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00037c4c  /system/lib/libc.so (\\_\\_epoll\\_pwait+20)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #01 pc 000121a7  /system/lib/libc.so (epoll\\_pwait+26)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 000121b5  /system/lib/libc.so (epoll\\_wait+6)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #03 pc 00010f23  /system/lib/libutils.so (android::Looper::pollInner(int)+98)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xa321c000-0xa321e000 stackSize=1020KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12d4f0a0 self=0xaec43c00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22860 nice=0 cgrp=default sched=0/0 handle=0xa53b5f00\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 175894222 100817854 467 ) utm=12 stm=5 core=1 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0xa3116000-0xa3118000 stackSize=1020KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | held mutexes=\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00010484  /system/lib/libc.so (syscall+32)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #02 pc 00013ded  /system/lib/libc.so (\\_\\_pthread\\_cond\\_timedwait(pthread\\_cond\\_t\\*, pthread\\_mutex\\_t\\*, timespec const\\*, int)+28)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12d9a220 self=0xa4558000\n\n\\[art\\] art/runtime/runtime.cc:289\\]   at java.lang.Thread.parkFor(Thread.java:1220)\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | sysTid=22869 nice=0 cgrp=default sched=0/0 handle=0xa4765d80\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | state=S schedstat=( 705835 393749 11 ) utm=0 stm=0 core=2 HZ=100\n\n\\[art\\] art/runtime/runtime.cc:289\\]   | stack=0x9f3dd000-0x9f3df000 stackSize=1012KB\n\n\\[art\\] art/runtime/runtime.cc:289\\]   native: #00 pc 00037c4c  /system/lib/libc.so (\\_\\_epoll\\_pwait+20)\n\n\\[XDPService\\] Info - \\[IdleStateHandler - HandleIdleState\\] Login process has started.\n\n\\[google-breakpad\\] ### ### ### ### ### ### ### ### ### ### ### ### ###\n\n\\[google-breakpad\\] Chrome build fingerprint:\n\n\\[google-breakpad\\] 1.0\n\n\\[google-breakpad\\] 1\n\n\\[google-breakpad\\] 7d26c012-4f20-450a-b207-c04dc7980276\n\n\\[google-breakpad\\] ### ### ### ### ### ### ### ### ### ### ### ### ###\n\n\\[XDPService\\] Debug - \\[LoginLogic - TrySetControllerUrl:163\\] \\[TrySetControllerUrl: LoggingIn\\]\n\n\\[XDPService\\] Info - \\[LoginLogic - TrySetControllerUrl\\] Setting controller URL ["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com/](https://turquoise.cryptzone.com/)"
                },
                {
                  "type": "text",
                  "text": "\n\n\\[XDPService\\] Debug - \\[ControllerLogic - SetControllerUrl:176\\] \\[SetControllerUrl: hostInfo '["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com/'](https://turquoise.cryptzone.com/')\\]"
                },
                {
                  "type": "text",
                  "text": "\n\n\\[XDPService\\] Debug - \\[ControllerLogic - SetupController:491\\] \\[SetupController: ShouldInitialize start\\]\n\n\\[XDPService\\] Info - \\[ControllerLogic - SetupController\\] Got CA certificate from storage.\n\n\\[XDPService\\] Info - \\[ControllerLogic - RetrieveProviderNames\\] Retrieving provider names from controller.\n\n\\[XDPService\\] Debug - \\[ControllerFetcher - GetProviderNames:228\\] \\[GetProviderNames\n\n\\[XDPService\\] Debug - \\[OpenSslSocket - Connect:73\\] REST  (turquoise.cryptzone.com:443) H0 \\[\\[7\\]\\] : Connect: Connecting to 'turquoise.cryptzone.com/212.16.176.142'\\]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1467104569629
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm giving up on this. I can't trace the native exception as stack always hits the wall on mono->jni border and also don't know the correct app state during a regular logout session so can't tell what we're doing wrong."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A good but labor-some approach would be to compare the logs between desktop and mobile and look for anomalies later."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1467203908029
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I can work on logging out gracefully instead?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1467204028765
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sure. Inspect: "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/blob/master/src/client/Stratus/AndroidClient/MainActivity.cs#L116",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/blob/master/src/client/Stratus/AndroidClient/MainActivity.cs#L116"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1467205391113
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "just for the record:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\] Runtime aborting...\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\] Aborting thread:\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\] \"Thread-913\" prio=10 tid=46 Native\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   | group=\"\" sCount=0 dsCount=0 obj=0x12cd9100 self=0xba7f1900\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   | sysTid=10332 nice=-11 cgrp=default sched=0/0 handle=0x9297f930\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   | state=R schedstat=( 74873738 11768392 124 ) utm=3 stm=4 core=1 HZ=100\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   | stack=0x92881000-0x92883000 stackSize=1022KB\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   | held mutexes= \"abort lock\"\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #00 pc 0035d32d  /system/lib/libart.so (\\_ZN3art15DumpNativeStackERNSt3\\_\\_113basic\\_ostreamIcNS0\\_11char\\_traitsIcEEEEiPKcPNS\\_9ArtMethodEPv+116)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #01 pc 0033de0b  /system/lib/libart.so (\\_ZNK3art6Thread4DumpERNSt3\\_\\_113basic\\_ostreamIcNS1\\_11char\\_traitsIcEEEE+138)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #02 pc 00321abd  /system/lib/libart.so (\\_ZNK3art10AbortState10DumpThreadERNSt3\\_\\_113basic\\_ostreamIcNS1\\_11char\\_traitsIcEEEEPNS\\_6ThreadE+20)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #03 pc 00321d31  /system/lib/libart.so (\\_ZN3art7Runtime5AbortEv+532)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #04 pc 000f3d7d  /system/lib/libart.so (\\_ZN3art10LogMessageD2Ev+2212)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #05 pc 002502b5  /system/lib/libart.so (\\_ZN3art9JavaVMExt8JniAbortEPKcS2\\_+1524)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #06 pc 00250657  /system/lib/libart.so (\\_ZN3art9JavaVMExt9JniAbortVEPKcS2\\_St9\\_\\_va\\_list+54)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #07 pc 000fc16b  /system/lib/libart.so (\\_ZN3art11ScopedCheck6AbortFEPKcz+30)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #08 pc 00101047  /system/lib/libart.so (\\_ZN3art11ScopedCheck5CheckERNS\\_18ScopedObjectAccessEbPKcPNS\\_12JniValueTypeE.constprop.95+5054)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #09 pc 0010bf8d  /system/lib/libart.so (\\_ZN3art8CheckJNI23GetPrimitiveArrayRegionEPKcNS\\_9Primitive4TypeEP7\\_JNIEnvP7\\_jarrayiiPv+444)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #10 pc 0010c3fb  /system/lib/libart.so (\\_ZN3art8CheckJNI18GetByteArrayRegionEP7\\_JNIEnvP11\\_jbyteArrayiiPa+22)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   native: #11 pc 0000cc18  /data/app/com.cryptzone.appgate.xdp-1/lib/arm/libmonodroid.so (java\\_interop\\_jnienv\\_get\\_byte\\_array\\_region+72)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   (no managed stack frames)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\] Pending exception java.io.IOException: read failed: EBADF (Bad file descriptor)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int libcore.io.IoBridge.read(java.io.FileDescriptor, byte\\[\\], int, int) (IoBridge.java:478)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int java.io.FileInputStream.read(byte\\[\\], int, int) (FileInputStream.java:177)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int java.io.InputStream.read(byte\\[\\]) (InputStream.java:162)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\] Caused by: android.system.ErrnoException: \n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int libcore.io.Posix.readBytes(java.io.FileDescriptor, java.lang.Object, int, int) (Posix.java:-2)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int libcore.io.Posix.read(java.io.FileDescriptor, byte\\[\\], int, int) (Posix.java:169)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int libcore.io.BlockGuardOs.read(java.io.FileDescriptor, byte\\[\\], int, int) (BlockGuardOs.java:230)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int libcore.io.IoBridge.read(java.io.FileDescriptor, byte\\[\\], int, int) (IoBridge.java:468)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int java.io.FileInputStream.read(byte\\[\\], int, int) (FileInputStream.java:177)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\]   at int java.io.InputStream.read(byte\\[\\]) (InputStream.java:162)\n\n07-01 10:36:41.364 F/art     ( 9737): art/runtime/runtime.cc:366\\] Dumping all threads without appropriate locks held: thread list lock mutator lock"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1467362286663
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed as in?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1468332512276
      }
    ]
  },
  {
    "key": "SA-3045",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The goal of this task is to get familiar with what single packet authorization is and play with software using it (e.g. "
            },
            {
              "type": "text",
              "text": "http://www.cipherdyne.org/fwknop/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://www.cipherdyne.org/fwknop/"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ") in preparation of implementing SPA on the gateway and tun-service."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Vidder"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "SPA message = UID, CTR, OTP, GMAC\n\nSeed = Shared secret for OTP\n\nUID  = Universal ID of the client - We can use the DN which the client produces\n\nCTR  = A counter which  is hashed with seed to create OTP\n\nOTP  = One time password created as HMAC(seed || CTR)\n\nGMAC = signature of the first 3 for data authentication using \\`E\\` which is a key used for the GMAC AES 256 - we can use the ephemeral key that controller calculates for each client and it is used so far for signing the IP states"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1465315663505
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As we dont have yet a way of delivering the seed we can use as seed a hard-coded value"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1465315836384
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In case TOTP is preffered"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "TOTP is based on HOTP with a timestamp replacing the incrementing counter."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "The current timestamp is turned into an integer time-counter (TC) by defining the start of an epoch (T0) and counting in units of a time step (TS). For example:\n\nTC = floor((unixtime(now)  unixtime(T0)) / TS),\n\nTOTP = HOTP(SecretKey, TC),\n\nTOTP-Value = TOTP mod 10d, where d is the desired number of digits of the one-time password."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1465316275364
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "SPA PoC using fwknop"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "General Info"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Single Packet Authorization mandates a similar architecture to port knocking. Both have client and server components, the server maintains control of a default-drop packet filter, and the server monitors packets passively. However, this is where the architectural similarities between port knocking and SPA diverge."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Single Packet Authorization moves the data transmission to where it belongsin the application layer. This implies that instead of being able to send only two bytes of data per packet, as in the case of port knocking, SPA is able to send up to the minimum MTU worth of data (1,500 bytes on Ethernet networks) between the client and the server in each packet."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "fwknop defines the following packet format at the application layer:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "16 bytes of random data\n\nClient username\n\nClient timestamp\n\nfwknop version\n\nMode (access or command)\n\nAccess (or command string)\n\nMD5 sum"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Many of the fields in the SPA packet format have a variable length, but are separated by a : character (fields are base64-encoded, so embedded colons cannot break this syntax). Once the fwknop client builds the packet format above, the entire packet is encrypted using one of two encryption algorithms: the Rijndael symmetric block cipher with a 128-bit shared key or the asymmetric ElGamal algorithm with up to a 2,048-bit public/private key pair generated by GnuPG. By default, the fwknop client sends SPA packets over UDP port 62201, but this easily can be changed from the command line;"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "PoC"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ubuntu server machine as the server in which we want the "
                },
                {
                  "type": "text",
                  "text": "sshd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " hidden"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ubuntu machine as the client"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Create keys in client"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "fwknop -A tcp/22 -a 192.168.56.1 -D 192.168.56.103 --key-gen --use-hmac --save-rc-stanza"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": " The above command creates in the client the following keys and settings:"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "\\[192.168.56.103\\]\n\nALLOW\\_IP                    192.168.56.1\n\nACCESS                      tcp/22\n\nSPA\\_SERVER                  192.168.56.103\n\nKEY\\_BASE64                  IfIBwBiPo52vvQSMdhqkBHjYTqfPxhtFEeErxD+4dO0=\n\nHMAC\\_KEY\\_BASE64             JnXU5VT96hH6vAMd6evGhtgDBdZ68XPw9GxEPfkHlVZ1xb1GXOpZcnr1nXsC4vWqU+hpcjDNdgqukqfviEhEBQ==\n\nUSE\\_HMAC                    Y"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Transfer the 2 keys to the server and put them in /etc/fwknop/access.conf"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "SOURCE                 ANY\n\nREQUIRE\\_SOURCE\\_ADDRESS Y\n\nKEY\\_BASE64             IfIBwBiPo52vvQSMdhqkBHjYTqfPxhtFEeErxD+4dO0=\n\nHMAC\\_KEY\\_BASE64        JnXU5VT96hH6vAMd6evGhtgDBdZ68XPw9GxEPfkHlVZ1xb1GXOpZcnr1nXsC4vWqU+hpcjDNdgqukqfviEhEBQ=="
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Iptables so that default policy is drop for SSH and only established connections are allowed4. Send the SPA UDP segment so that SSH can be established. Without it SSH cannot be established and the port is appearing as closed"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "kosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-gateway/vpnd$ sudo nmap -sS -p 22 192.168.56.103\n\nStarting Nmap 6.40 ( ["
                        },
                        {
                          "type": "text",
                          "text": "http://nmap.org](http://nmap.org)"
                        },
                        {
                          "type": "text",
                          "text": " ) at 2016-06-08 16:37 CEST\n\nNmap scan report for 192.168.56.103\n\nHost is up (0.00014s latency).\n\nPORT   STATE    SERVICE\n\n22/tcp filtered ssh\n\nMAC Address: 08:00:27:0D:D8:E8 (Cadmus Computer Systems)\n\nNmap done: 1 IP address (1 host up) scanned in 0.75 seconds\n\nkosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-gateway/vpnd$ fwknop -n 192.168.56.103 -v\n\nSPA Field Values:\n\n\\=================\n\n   Random Value: 1242323288750878\n\n       Username: kosmas\n\n      Timestamp: 1465396684\n\n    FKO Version: 2.0.1\n\n   Message Type: 1 (Access msg)\n\n Message String: 192.168.56.1,tcp/22\n\n     Nat Access: <NULL>\n\n    Server Auth: <NULL>\n\n Client Timeout: 0\n\n    Digest Type: 3 (SHA256)\n\n      HMAC Type: 3 (SHA256)\n\nEncryption Type: 1 (Rijndael)\n\nEncryption Mode: 2 (CBC)\n\n   Encoded Data: 1242323288750878:a29zbWFz:1465396684:2.0.1:1:MTkyLjE2OC41Ni4xLHRjcC8yMg\n\nSPA Data Digest: lL5AL1ph4BIW/4gZvLEi8UacAscJtCJ4a/1S75w3cgQ\n\n           HMAC: ydXZ4ocPFUiWiKaUxEjoTwjQBwtkuijAzadaF3H1HA0\n\n Final SPA Data: /xLsFumPl7zHin4CM+NPnUwRh/SDexhP+nXIB2uuu8DDVYy+wY/H4FLD4SF72mQW6kE5WAZ7DRTtOVUIniUIi5w4jaUpGWp/VCmXxGfer+tNN4ePmLrtNuXSjdwco2hHmQz3trEq/UcBdpHSogt8ve65uEcI80fa/DIbF78VTtOgLZtdrEjF/kydXZ4ocPFUiWiKaUxEjoTwjQBwtkuijAzadaF3H1HA0\n\nGenerating SPA packet:\n\n            protocol: udp\n\n         source port: <OS assigned>\n\n    destination port: 62201\n\n             IP/host: 192.168.56.103\n\nsend\\_spa\\_packet: bytes sent: 225\n\nkosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-gateway/vpnd$ ssh kosmas@192.168.56.103\n\nkosmas@192.168.56.103's password: \n\nWelcome to Ubuntu 14.04.3 LTS (GNU/Linux 3.19.0-56-generic x86\\_64)\n\n \\* Documentation:  ["
                        },
                        {
                          "type": "text",
                          "text": "https://help.ubuntu.com/](https://help.ubuntu.com/)"
                        },
                        {
                          "type": "text",
                          "text": "\n\n  System information as of Wed Jun  8 15:39:24 CEST 2016\n\n  System load:  0.0               Processes:           97\n\n  Usage of /:   24.2% of 6.75GB   Users logged in:     1\n\n  Memory usage: 11%               IP address for eth0: 192.168.56.103\n\n  Swap usage:   0%                IP address for eth1: 192.168.111.244\n\n  Graph this data and manage this system at:\n\n    ["
                        },
                        {
                          "type": "text",
                          "text": "https://landscape.canonical.com/](https://landscape.canonical.com/)"
                        },
                        {
                          "type": "text",
                          "text": "\n\nLast login: Wed Jun  8 15:39:20 2016 from 192.168.56.1"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1465317085118
      }
    ]
  },
  {
    "key": "SA-2905",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Seems revocation needs to be pressed twice in controller admin ui before client icons starts spinning and re-authenticate shows up."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I cant reproduce.. open chrome inspector and see the request even for the first time you press."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "gokhan.berberoglu",
        "created": 1463238077143
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yup, it works on controller side. So assuming it's client or gw bug."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "PUT /admin/token-records/revoked/by-dn/CN=21699501face5d21a6ef20b3fff51b56,CN=teoman.soygul,OU=Cryptzone HTTP/1.1\n\nHost: turquoise.cryptzone.com:444\n\nConnection: keep-alive\n\nContent-Length: 71\n\nAccept: application/vnd.cryptzone.peer-v2+json\n\nOrigin: ["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com:444](https://turquoise.cryptzone.com:444)"
                },
                {
                  "type": "text",
                  "text": "\n\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\\_11\\_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36\n\nAuthorization: Bearer xxxxxxxxxxxxxxxx\n\nContent-Type: application/json;charset=UTF-8\n\nReferer: ["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com:444/ui/users](https://turquoise.cryptzone.com:444/ui/users)"
                },
                {
                  "type": "text",
                  "text": "\n\nAccept-Encoding: gzip, deflate, sdch\n\nAccept-Language: en-US,en;q=0.8,tr;q=0.6\n\nCookie: \\_ga=GA1.2.1297519718.1439485890"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Response:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n\n  \"data\": \\[\n\n    {\n\n      \"tokenId\": \"e05a22c8-30fa-4180-98e9-b492b72e8dd6\",\n\n      \"tokenType\": \"Entitlement\",\n\n      \"distinguishedName\": \"CN=21699501face5d21a6ef20b3fff51b56,CN=teoman.soygul,OU=Cryptzone\",\n\n      \"issued\": \"2016-05-16T07:51:06.025Z\",\n\n      \"expires\": \"2016-05-16T10:51:06.018Z\",\n\n      \"revoked\": true,\n\n      \"revocationReason\": \"test\",\n\n      \"revocationTime\": \"2016-05-16T08:31:12.178Z\",\n\n      \"revokedAt\": \"2016-05-16T08:26:06.887403Z\"\n\n    },\n\n    {\n\n      \"tokenId\": \"d95a3b16-6806-4289-aa1d-59185b97bd14\",\n\n      \"tokenType\": \"Entitlement\",\n\n      \"distinguishedName\": \"CN=21699501face5d21a6ef20b3fff51b56,CN=teoman.soygul,OU=Cryptzone\",\n\n      \"issued\": \"2016-05-16T07:51:06.018Z\",\n\n      \"expires\": \"2016-05-16T10:51:06.014Z\",\n\n      \"revoked\": true,\n\n      \"revocationReason\": \"test\",\n\n      \"revocationTime\": \"2016-05-16T08:31:12.178Z\",\n\n      \"revokedAt\": \"2016-05-16T08:26:06.889947Z\"\n\n    },\n\n    {\n\n      \"tokenId\": \"d071b1f1-ea37-429d-b760-3bfc2c559d56\",\n\n      \"tokenType\": \"Claims\",\n\n      \"distinguishedName\": \"CN=21699501face5d21a6ef20b3fff51b56,CN=teoman.soygul,OU=Cryptzone\",\n\n      \"issued\": \"2016-05-16T07:51:05.646Z\",\n\n      \"expires\": \"2016-05-17T07:51:05.641Z\",\n\n      \"revoked\": true,\n\n      \"revocationReason\": \"test\",\n\n      \"revocationTime\": \"2016-05-16T08:31:12.178Z\",\n\n      \"revokedAt\": \"2016-05-16T08:26:06.891027Z\"\n\n    }\n\n  \\]\n\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1463387283986
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sorry for being unclear, but I ment this to be a client bug all the time ;)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Anyway, I know what the issue is and will be making PR soon."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1463399347350
      }
    ]
  },
  {
    "key": "SA-2789",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "adfs-test.czse.local"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Done."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Currently it redirects to turquoise, which redirects to localhost. Important part of the SAML:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<Conditions NotBefore=\"2016-04-18T14:37:25.831Z\" NotOnOrAfter=\"2016-04-18T15:37:25.831Z\">\n\n    <AudienceRestriction>\n\n        <Audience>adfs\\_test</Audience>\n\n    </AudienceRestriction>\n\n</Conditions>\n\n<AttributeStatement>\n\n    <Attribute Name=\"emails\">\n\n        <AttributeValue>test1@cryptzone.com</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"id\">\n\n        <AttributeValue>xiWdImmyMEKo8HqxLKWaHg==</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"username\">\n\n        <AttributeValue>test1</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"firstName\">\n\n        <AttributeValue>Test1</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"lastName\">\n\n        <AttributeValue>Lastname 1</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"groups\">\n\n        <AttributeValue>CN=test group,OU=adfstest,DC=czse,DC=local</AttributeValue>\n\n    </Attribute>\n\n</AttributeStatement>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1460990305523
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Relevant ADFS configurations are attached."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1460990395770
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "URL:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://adfs-test.czse.local/adfs/ls/idpinitiatedsignon",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://adfs-test.czse.local/adfs/ls/idpinitiatedsignon"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "test1"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "czse.local",
                    "text": "@czse.local",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " test2"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "czse.local",
                    "text": "@czse.local",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " test3"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "czse.local",
                    "text": "@czse.local",
                    "accessLevel": ""
                  }
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sema2007!  Kurt Glazemakers"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1461061094047
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Full toke for future use:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<?xml version=\"1.0\"?>\n\n<samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"\\_3a753188-0bdc-44c9-af49-f9218a2e0a27\" Version=\"2.0\" IssueInstant=\"2016-04-19T10:18:23.509Z\" Destination=\"["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com/saml](https://turquoise.cryptzone.com/saml)\""
                },
                {
                  "type": "text",
                  "text": " Consent=\"urn:oasis:names:tc:SAML:2.0:consent:unspecified\">\n\n<Issuer xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">["
                },
                {
                  "type": "text",
                  "text": "http://adfs-test.czse.local/adfs/services/trust](http://adfs-test.czse.local/adfs/services/trust)</Issuer>"
                },
                {
                  "type": "text",
                  "text": "\n\n<samlp:Status>\n\n    <samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n\n</samlp:Status>\n\n<Assertion xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\" ID=\"\\_d6f94926-fded-4157-a1d3-a1bacc9f4f06\" IssueInstant=\"2016-04-19T10:18:23.509Z\" Version=\"2.0\">\n\n    <Issuer>["
                },
                {
                  "type": "text",
                  "text": "http://adfs-test.czse.local/adfs/services/trust](http://adfs-test.czse.local/adfs/services/trust)</Issuer>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:Signature xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:SignedInfo>\n\n        <ds:CanonicalizationMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n        <ds:SignatureMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256](http://www.w3.org/2001/04/xmldsig-more#rsa-sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n        <ds:Reference URI=\"#\\_d6f94926-fded-4157-a1d3-a1bacc9f4f06\">\n\n            <ds:Transforms>\n\n                <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#enveloped-signature](http://www.w3.org/2000/09/xmldsig#enveloped-signature)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n                <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n            </ds:Transforms>\n\n            <ds:DigestMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#sha256](http://www.w3.org/2001/04/xmlenc#sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n            <ds:DigestValue>ihZOd0op/onEoHMsS+ALDkee9BGbHoYsqlbQ8OmP7J4=</ds:DigestValue>\n\n        </ds:Reference>\n\n    </ds:SignedInfo>\n\n    <ds:SignatureValue>ka1ZflX26Ad19Sqbx5gq7DMmin3DbMrPMZWdt5mwyrom7YsZKl8nCCRk8N3ygrVsx0VZpBrAFI8DS5zCg+5Cil963/wyTY1QzdvhzRzmA6iXnzqKhG7tdJN/WxMCgurJdWDvsVBJU3gJTu2Lxk8t7RlwQxIMzhB3zG4ovdYFnI7yPEKCDvzDfTm5TH5APguaUdF0d6xzVQJD2oTnpPiTQY+DoTeaTzcIidBB05Pz9Y4ZZfXqarqZy/kyz+h1DjV24UWncGAjLnc6iFxE2gD4qN6UHIugskrYc1IzVvJr6Ih4LsD+NLP3/cUDrJPEOsDmyjBW4bus4QQOQ7wUGmLCRQ==</ds:SignatureValue>\n\n    <KeyInfo xmlns=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:X509Data>\n\n        <ds:X509Certificate>MIIC5DCCAcygAwIBAgIQEOu46DWrZ5hDn60ZG9px1zANBgkqhkiG9w0BAQsFADAuMSwwKgYDVQQDEyNBREZTIFNpZ25pbmcgLSBhZGZzLXRlc3QuY3pzZS5sb2NhbDAeFw0xNTA5MDgwODQ1NDlaFw0xNjA5MDcwODQ1NDlaMC4xLDAqBgNVBAMTI0FERlMgU2lnbmluZyAtIGFkZnMtdGVzdC5jenNlLmxvY2FsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3c6j34fXJmguutMd1Qy6VoNr7T+62bI7JVgFvP12fJBCm1qB1sVM4gGoWqMhnsYozZyGTwn62t/Elt0+RFnqpdkRdCcUBGLSaXvdsybAeKwcOhChKilAYpTsYPEWejIQ5hXjJnwofu6DDCEbw04JAXMRFWV6v2Vz6khuKoDJMJ9mjaY4BHYpUQXS3nSjGn4HSmN42FQeW4dEwkpdbmsMuwsQTLtpKDouXbfbCgN/6adTASRKwQz5mPMsuemEjvoRQxMw3Mt0KcEL02G83llNiKceuIjnDaKQXzvoa1YeWK/unYod+ErhSnOR56udlG5i5LQr5cBr8xK9Ix6zLyg9KQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQDb+vNVXAluh7Evt8TSE1IyZYFJ1s3OIep57ClxlSvTkfUE4CVxpxjsKnizgEF/IXxm3iq6FVrTW22Vog0gThbpLlRGaJjDLYQllUCG2v1uh072EQUMnCdLTBrKbyX5bQa3evk+A0iRSRk/3PBNyULritmsrgaQp3wrqkgGvn/WHqzF6ItWtJfqI1iy/ls8HYjxeUt3c2i0rQSfsoU/JIsc2SkpM+59+O2eRozYEENNfLWZryUDMXCTgO5CgmO2g9GyyOwxKKdCXJlroBSUXmpqSuF8GYZtfLhRCYPa26Qgj+ZiB/YH8k2+JPeRDIVapHGfkLtH4YyBkqfK+VLLUQgS</ds:X509Certificate>\n\n    </ds:X509Data>\n\n</KeyInfo>\n\n</ds:Signature>\n\n<Subject>\n\n    <SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\">\n\n        <SubjectConfirmationData NotOnOrAfter=\"2016-04-19T10:23:23.509Z\" Recipient=\"["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com/saml](https://turquoise.cryptzone.com/saml)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    </SubjectConfirmation>\n\n</Subject>\n\n<Conditions NotBefore=\"2016-04-19T10:18:23.506Z\" NotOnOrAfter=\"2016-04-19T11:18:23.506Z\">\n\n    <AudienceRestriction>\n\n        <Audience>adfs\\_test</Audience>\n\n    </AudienceRestriction>\n\n</Conditions>\n\n<AttributeStatement>\n\n    <Attribute Name=\"emails\">\n\n        <AttributeValue>test1@cryptzone.com</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"id\">\n\n        <AttributeValue>xiWdImmyMEKo8HqxLKWaHg==</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"username\">\n\n        <AttributeValue>test1</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"firstName\">\n\n        <AttributeValue>Test1</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"lastName\">\n\n        <AttributeValue>Lastname 1</AttributeValue>\n\n    </Attribute>\n\n    <Attribute Name=\"groups\">\n\n        <AttributeValue>CN=test group,OU=adfstest,DC=czse,DC=local</AttributeValue>\n\n    </Attribute>\n\n</AttributeStatement>\n\n<AuthnStatement AuthnInstant=\"2016-04-19T10:18:23.445Z\">\n\n    <AuthnContext>\n\n        <AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport</AuthnContextClassRef>\n\n    </AuthnContext>\n\n</AuthnStatement>\n\n</Assertion>\n\n</samlp:Response>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1461061157388
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "added nameid by adding a claim mapping of SAM-Account-Name to NameID"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1461072643643
      }
    ]
  },
  {
    "key": "SA-2749",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "orderedList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Create a script that prepares emulators etc: "
                    },
                    {
                      "type": "text",
                      "text": "https://github.com/halvards/android-travis-spike/blob/master/initialize-android.sh",
                      "marks": [
                        {
                          "type": "link",
                          "attrs": {
                            "href": "https://github.com/halvards/android-travis-spike/blob/master/initialize-android.sh"
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Collect the apk and load it on the emulator"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Start the app and wait 60 secs and collect any exception messages"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "This is just to see that generated apk actually loads all assemblies and starts. Sometimes we break assembly loading so this should help with that."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Adding automated test cases that runs on an Android emulator can follow this task."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Emulator startup times are fluctuating a lot so predefined wait time even on my machine is failing half the time. Found a script to check emulator readiness in a loop though so will try that:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\# Emulator Management: Create, Start and Wait\n\nbefore\\_script:\n\n  - echo no | android create avd --force -n test -t android-21 --abi armeabi-v7a\n\n  - emulator -avd test -no-skin -no-audio -no-window &\n\n  - curl ["
                },
                {
                  "type": "text",
                  "text": "http://is.gd/android\\_wait\\_for\\_emulator](http://is.gd/android_wait_for_emulator)"
                },
                {
                  "type": "text",
                  "text": " > android-wait-for-emulator\n\n  - chmod u+x android-wait-for-emulator\n\n  - ./android-wait-for-emulator\n\n  - adb shell input keyevent 82 &"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Xamarin docs don't mention this issue directly so still researching."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1460966013605
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Dockerfile started PR: "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/723",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/723"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1461662427026
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Closing this in favor of "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-2993",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-2993"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " which contains this anyway."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1464790670114
      }
    ]
  },
  {
    "key": "SA-2735",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "First we need a provider that supports it so I can debug and see how we can do that."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Might need to add a new field to the provider for decryption key or something."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There seems to be a family of possibilities:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://www.samltool.com/generic\\_sso\\_res.php",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.samltool.com/generic_sso_res.php"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1461229464200
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes, OKTA and ADFS has the support."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1461229628643
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is how it looks like when encryption is used:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<saml2p:Response xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\" Destination=\"["
                },
                {
                  "type": "text",
                  "text": "http://localhost:9100/peer/authentication/saml](http://localhost:9100/peer/authentication/saml)\""
                },
                {
                  "type": "text",
                  "text": " ID=\"id52148859067410111766232492\" IssueInstant=\"2016-05-03T08:34:33.316Z\" Version=\"2.0\">\n\n<saml2:Issuer xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\" Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\">["
                },
                {
                  "type": "text",
                  "text": "http://www.okta.com/exk6b8dvzoWUftEEi0h7](http://www.okta.com/exk6b8dvzoWUftEEi0h7)</saml2:Issuer>"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:Signature xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:SignedInfo>\n\n    <ds:CanonicalizationMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:SignatureMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256](http://www.w3.org/2001/04/xmldsig-more#rsa-sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:Reference URI=\"#id52148859067410111766232492\">\n\n        <ds:Transforms>\n\n            <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#enveloped-signature](http://www.w3.org/2000/09/xmldsig#enveloped-signature)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n            <ds:Transform Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/10/xml-exc-c14n#](http://www.w3.org/2001/10/xml-exc-c14n#)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n        </ds:Transforms>\n\n        <ds:DigestMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#sha256](http://www.w3.org/2001/04/xmlenc#sha256)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n        <ds:DigestValue>lpS1RXr/umVsuBSHnSopOvUUKyBUnvwtTiwSuaQLst4=</ds:DigestValue>\n\n    </ds:Reference>\n\n</ds:SignedInfo>\n\n<ds:SignatureValue>KwDvkycwr445XGC4sKI0+d+bbqo15UACBZ6lFE9f9RWsJirO57fPl+izRWFqdNBxG834mK3FOtRoMsJc2xwcoVUtwlekdMQEKCnr8uWTMC976g9Gvat3aOyNCNNGI8eCo5u4ceiSena8qIGI7wLMszXfJwSNWCjEmzIKLHAB3EN1y+ZsyQXSAUvVJO3MH1bR8kNGWH6r5ysLuvmnzkmSuf3dmg0kXyb6R0JxoGeMxjlMgoIcwM40ye8Og5Scx3kM55xdvSiL7YSzYlEKRfhRZkk71BgY8fRTdoNUp5sDFG0pPsDZKyr3ygy2ZuEjc+IaCQlV1f6izrdpST7YOETDZA==</ds:SignatureValue>\n\n<ds:KeyInfo>\n\n    <ds:X509Data>\n\n        <ds:X509Certificate>MIIDpDCCAoygAwIBAgIGAVNCM9YkMA0GCSqGSIb3DQEBBQUAMIGSMQswCQYDVQQGEwJVUzETMBEG\n\n        A1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzENMAsGA1UECgwET2t0YTEU\n\n        MBIGA1UECwwLU1NPUHJvdmlkZXIxEzARBgNVBAMMCmRldi03NjQwNzIxHDAaBgkqhkiG9w0BCQEW\n\n        DWluZm9Ab2t0YS5jb20wHhcNMTYwMzA0MTUxNTQ2WhcNMjYwMzA0MTUxNjQ2WjCBkjELMAkGA1UE\n\n        BhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xDTALBgNV\n\n        BAoMBE9rdGExFDASBgNVBAsMC1NTT1Byb3ZpZGVyMRMwEQYDVQQDDApkZXYtNzY0MDcyMRwwGgYJ\n\n        KoZIhvcNAQkBFg1pbmZvQG9rdGEuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA\n\n        ld5EMTbyYx0L9YYo3wsWFL5Jq1CpULqpNhAUiPiMI+zfISSWco6SlFnbhEpaVl3rDILNHLEKYPOc\n\n        8pyDtQbrsvkxR402lpu94R0mFw1a/BO5oBvKoY0VnEDpYHMw65oq/TM3qw0pB3Qc3ZtihSjNZqpz\n\n        CD7WF6uIWJ3oDXCmPp/1ZJBxs6/rhfiGwvJCH/uu4PreBsuE7IgPnKrpxLD0F4yJS+h1Ypdb2B3o\n\n        TocPKvW9sAnITqKOZTrNKskTp0o6W1lO57s3cgtdWZLeuqR86UXvS5kBy3qiMoWxG7vRU70/7a7c\n\n        fxvD7DjUEXxf6IcS/soAXzHTAbkOAXoGDBvyqwIDAQABMA0GCSqGSIb3DQEBBQUAA4IBAQAVY69Y\n\n        uDLP6ByhGS5fy7ZYT3+JkAmPzK1A5lhVod9VIs+YfFvoLd3GsCulw7m4mzEjTm2uwy6rkXpGe1pv\n\n        rh+bpfrgNs91c0cBReFcUkVgNl1Dq1jMFJpuf7GsJgdbckGfysdiSevWpq/LOqXzp4vApNskTyC1\n\n        SQUTcIbPvjeeuXbvsI7oAeU49RhmTFDJLs2F6IaPA85mZjYBdHZo6UUrfJQsRHfZuJXt0fagfEO/\n\n        kbV9s2har4XGj/oKrhcVvEIaEirDWNoNjW3AF5+wmTFb5949Mh4Y5GBnUYXwrKM4zr0e7YMeUivj\n\n        MOpoLxDkgQBUjOj51iF/tR15jX17PbEg</ds:X509Certificate>\n\n    </ds:X509Data>\n\n</ds:KeyInfo>\n\n</ds:Signature>\n\n<saml2p:Status xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\">\n\n    <saml2p:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n\n</saml2p:Status>\n\n<saml2:EncryptedAssertion xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n\n    <xenc:EncryptedData xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\""
                },
                {
                  "type": "text",
                  "text": " Id=\"\\_a93bdf2dfb14d192abfd446cf1acf06c\" Type=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#Element](http://www.w3.org/2001/04/xmlenc#Element)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <xenc:EncryptionMethod xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\""
                },
                {
                  "type": "text",
                  "text": " Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#aes256-cbc](http://www.w3.org/2001/04/xmlenc#aes256-cbc)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:KeyInfo xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:RetrievalMethod Type=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#EncryptedKey](http://www.w3.org/2001/04/xmlenc#EncryptedKey)\""
                },
                {
                  "type": "text",
                  "text": " URI=\"#\\_4f9b9b5495ab6b437ab12adc914fad9d\"/>\n\n</ds:KeyInfo>\n\n<xenc:CipherData xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<xenc:CipherValue>9KA4KUtQzhVlkEa7v+40LAEP21QFdn1QsZKsTMlcNvvrjIT4d3EPKIULd/AzcHfMVBRt2v83XXfimhUlG0qS4JgFT2PHcsr5/V7UNqdYTrcg4Z0P/tVxN8D8UWCjQxaFSKUD9ogBDs3mRi/pLak9a9eYUa6y8XZmcCLqX16vrNBPYHoQ+ByJM9syHYRv2S5J7d4OMZ3ZLicORiLVmDls0cCWo/W14/t06sur0bWZSvDSrTC47GxjAxsaHzI24iTh//bN+bFQZNrrMZRT+SdW5mgZjKFM/NIiVZaAIa+uFk/BG56GV65DeGwj/Mq0Z5BTtrD7jL4qGkgfbntu+FnwjcCyqsm14oGz4cp5z6+Ekx+zVNjCjgf7SWBB3HQ0UftbipUcUU70bnjuBPTXqzNpe3scSP4aDJtDBUPErXqnAeKKya7JUu6jMJpk/UwVez4Fq3f5PL26x04+9mlw/nu+TaTNg3dTiNRVIFwFnfSb0QlJm1D2oYGpoqIwMo0YIk7zygPVrbro2BOCMsNiRHl6oYvBu3jrDgQQU4RzXCIEOjLT+Pa59NopBP1FHMk4FVGJI8QnyDbSmhZeDKneLcTKOygOYOQeDDAYs3wKnc62WPLVE+i/HlpRXOnZ2KGVBlioZ4aL46iXZ+B4w4e7fh2h86SI83R1H3abSAuKeAp+BBWWeLQp46YlYt2C4oBMyBCSdjMU2wdMMzDUoCZIxS2rNQcwCMxCahX4FlYCIPlSH/pE6t93VqpxMadIh3Ky6tOwV8YAlvm6Ac4tuWu+7fC/DQTpo+qijKUQUpMnjj2LRIi4+tY9bLVPaLh3kBq/c/zhANUE7jlAhtIaEY5es61JkF0LlVsdr/Qmr00RJY3Pfa7dLXmtdQ64QcchYerKSaJTrk9FvgL556PREgpLUIReXXJLhG7S2krxJcScMBLRcwjrz7+Ego1bn8iiGqWoViW57AaXiRCrQHfZUsYcRgIzcQgaHX97PLBSFR8MzBoEFxfLQYWU4BgWvbmDfCE7IZbS2j4RyZfu7i/j67SpDLKxfa61Tjtwx1u0Y/i7gJkziOw6fDeIru+gNsiCN5PrWsjSbyZfUNDqZquoXUiTlRVZKl0t3c/nDtQ61lZG+xFLQFPIaGBDeufTW/IgXfz+bnCMhoXiT6tXStKZn4LWrEEsoFxYr2etL93XNIk1rUXhZKG0wjI+sMJVMCMJrmhrydJnyC7ks3GAjQMhtZJX4C5PNaEF2PzzWEtzWpeLCr80EdjMlTTKJz0b9dDl6Yyu8IJcb55GkZ6KwZIFZCufAVunOcSs44gfq90TU66D6lORxKGN85NccQN3ZRcPaECLATTtvBoGBTsDHGtz1lPX4cCpyIUoEGvVMxOzZCmwVMO58wblYcKxd6PNQ8c8wMMz6INYImQpVInUwHf4rnHZDh+vlxAm3/sVEc/hk67+3oXdVk0D1YA1uHXaTmzvgK1AbaCA5zR+Xq/uhh9WrSmj9+OhPaVxIBiMzpNZGHpfNf/FbK5i3hRCfygh0Vz3R+v9SYA5zvnDfdnTyeC1NU5gZ/aMupvhg+D3j0/8ojnMGCGDpw+s3M2EeHev3+Wf+qxUwIgaURhqVmsNFbgmHMsGpXBMH8K/RY6KaJlRBy9sC6K95YTQKiEAJpuijOg2g8SkSszA0RaBGThB3nAeCYXbrk4TplmQEeRMlC7n3MwoxSI3sARrLjEs9rxWreyTHabu2gsNAgol4n9dZInjCfT8wsD26AG1yVcxMuH+AQoeamyV8MKr3a3Cj9IfGpPj77ZOfJmK/K5dAYOGMk0bIOcxfutcvKBdq9SAjZDk6K/LpiJap8NAVv2pOO0Cv3Ziqk3/IAWBZ57SOAmPGmIwgyClFTRo9uAJftB5ucJL2UP4jHu1GVAO7TIBA+p/R+k1z4jfhvyJyClGugm49lYqNuLbwQbHQLIu45jAIm9YOqlws8T2emqE4EOxawnqb/D7+NfTq/qhOEgaGp3zHfVT76ht9PVb7gPERYb9Q6c5gUWnzyYYly5JNzhrE5IUfrPLfhenAPhazixzSQsSyg4df9ArLd9ofBsqeXOGsMfC6gqBXPPZpQFQMT8AHVvA2AVfKgEFVZ+7wH7qpAYqPzUSIjZctXA3Mt8Al5xDL3JmkKb1PvxINLoUYdV9dx/AC8lhZ/DkYyWM968axaXanYvwDIjMvo9f0gJ2riLmVrVFHHlqGbu52MACQBnZ8AN3FLqJuAsFFj85kFUZk79sjOu/w959zn4khEslPs2Xcz/xA9gWTB+oIbxYgM8g4IGSggJs9y7QG1MqRyDooBPc5LY7rvnYbDKrKmQ5UrW71Pup5VEQlnu5HE/f+vt8C8E+NCladD5h/1LI0Lwea5+8tOZ0LDeilsOERhF1hi22C0HK/fDNBUoNscvpOxGeIKs8TNae9litKO9FosbhTX/zobnLDqJDKo4H7ym60OlKCt7LDEdEKkAVxezRtLtnMEucjzFI8yd6xN47HWFHRcYOt4+i5s0vqWvIsDSbylOsMNzerhSiUZPCWzJV8ceGBVJKY0szeClmlmQPvssV/wRzST6v/UtnK5o/Z0Ms7ueq0FgkoClsTCCg502DCWa5XBZdRdXguPzhlutu8SXpwhNpwAmo5yTVLyP4VgiUm06APVedB3x++vmM3s1pGyDdhXiDzwBF+H492YvYHkE+YasQJSbFzTnZVVIknzSb/cwtP4lEPMt4Tjs1WivPSUDQnALLbJ3CqIOwCZewrK7GnjuR/iCNmjZ20WNVrY1Sl9YfqAsbWyI2P+dxxjhWoJqBzB5Krhs1vSI6/x2T1YFpL7zLQ431UBGTPlYbM+rd4wGPhNYgygZBpeN6Qt4yoJyheVY/adDeHKsW3qpul4QpQLKoD/FGDR5YOuvxTBDMjL8ttVBpRF6hoV0Z0Devqx/Z2BoUJ3RdAVZ6mcFagaWjerNumLgq2H4F7YR36n1PvANIc+ggjoc9KnLp8D2qJJLwsr+lPW05Qgbbm42OHBijx5rpJl8c6kxTw8AcP+7e6LDKm5ZGvB7OXHckcKVz62SxhLZrOUtkCRcRUPiVYAJA7r3wjNtL7WGXIt7uM9OvQ6M2Ld22VS4lIv4F5JF1T6XTP9AWQwalrpxOiEc4K0EPmHX81oh+JNbApRGbJuVl+AhppDX0oIGT8AWffkdbC4umC2fYqGyZtFphSzLVF9T02pyaHR9W5mQAUFy5VhU5kTOFshYpzaYV3F5CKqLcjxP5QTbOZaEkRHT5CuGfUlzhfyu3nEYFP2GLMK0LWwvH/IzZ/tgSIYCyDDXZACUOyJyVC6/WV/S2bsYQklH+nxz9VYrlHLr2BwiAuhD28H7jgg3JMa4JvNlID6NzPRF6LJlx89Wk/o2x8Exgyls/6XqkFj9widh85lS+IqblU7OA8k2pHA07+VO6ITfHKrR41lLmuW6HeOnDfhELpyPcdVSR70ov32dwkb2IEYWRi9Th4O4KdhUQD7wz1IgTqwxGPOotabcsCNciXe/+CYefXNILITBYsNVLabbu6k7hED79OKScYttTaQQEcTBE1FjXjfgO2+VQKbEfA1nsaH5r+TZXXKS+Zykjpxm0Fs871DM+OvMdpxqbclzCvxhGIeBaqyLYkq5hH6Svn6cRT6HNX5V4rUrRD1GNuhcGSO3FTyNROTS1gTaGopblmOe2L/gOH3Ps2sdqILwUI7FLSSv0oxIS6vuXiKJVhv3ERhKdnh/JXiMg64vizWNS1EQltN5XSJe2x4g23XM6lNzbyWnc6mrJwgeWQb71xfY2UcPGOJDMqejS+HkJepKpZsSVlTOPw0PKHvv+W2+sR5zTMQQYU+RbxnvLq8YGRNMHbIuIZZbMa5JjA7gGnfyt3kcIeNm+J9SQxCPTBf4gT3Ea0PY2XupGiefQu0RSfLH26Hr+ENLnV4NsoOFxGIH0FAVNAXhrW0sO3P9ZN8U7mTf6qVW2F0SrqWB8VrTKpyRtLualSYKxhhXEfGkAK5SG4CASskJUK7WfgZ36/EcmGdp55/kuNcLQIn2HyU6V6PdxRPKToa2HvM0KG7sAp27zwVmM1Rqk1JiKemPcAOolJp16vO6qd9vodDfks6ZLR8/i7uaX9YotlWkTmza7DtDBIIOGAClFeplvD5svLg5z4tphedKI2yvCVfdsmrKRISeVCmgjk3seS5USHCh2gl8E+eeGW7M+/bDGDdn8v8DT+1UIakSgFK/LRoYJ4kHVjdeVi/z9nqbj8rOm0QWlj8/vcxrsiAsRumNtGiRn4dGmXfcZsk7Q+8CSLCrHHkJ+KILNuTYv5dHolaR+ED1dD9pIHB2k1b9wWmf9so0nYP4YT0HExW2iwkz7ECeW97SYI6tRCn6Pl91auyEBCTdCL3MJT0zav/nbxvAoM3hllAYQLwON6VAWmo97AaaAxLH3ecYXOvs0Wb175xI3ysLlUMISheMDFiD0/ODq7EkPGlslCgCI31NFxkvHySYn099olK/7vnuk/k0jjd0SEEOVydx6SdvUFJG6rHJ1i/z0zmZA1kMjVSoiGgrKJoPJSrIm8ZnJQ5DdKIWEyhGy+qmVE70v6gE+YMTmivcH+DCnAR5i7IM7W+VM8G74bTEAr3j0clwN5ChkrRezf+DEPZYFKj2fNcmI7km9bRi1CyeIXgIirIvGx20jvoyShLSPxldtERY/lFCw9mLEfhnKBTtjsk4E5BlJAkdn5FXkgTcaoSF6Iwr51zBmDx25q+GZnvZsvkQZExuj/ikWgq1KdBy6cywXQRSiP6aaiwnng1bITogZGL5ogz9ljocRlhBwpVEHA1kcD2UcVIG2l/PM+3seKZ87tCHoaY0LRKGbuypVqRUrCOelgUbPsBYQmg0zBdbz9TugZTxaRqQDLZMSaomtzEv4gB29ySQZbDHB+Rr2yGtEN2VBYuhA74HdNwK85xf9hyGLiZCc1JeG6eFES9znavYeZr3U5w72q4rCdk1TUcW0vQM7/Ci1k5rXxiS/zKmOtTo6YblIZMORdU+V4R0PuoYAbU+m7HWkIKSeUTjgD8b7sjGcXtTaxoY+SCUU3SjnvG6VcHzG1QEINyeVStojMzBK+tb2KaMdTIHLZlf0u8wJ+qqPhfy2Tu2Sbz0gEG6ay6+O18C7bn9AZr/1JkWG3lwm950gSBadRtcaEh1tah/tBCD9irC/PTPar5XmhUzrnMmJ8UnccnB3lt9aY+OM9nDqmef2Q7CWzbG4t7NMaPmurg5N0uSWf9+NXk/7NtQGcmSSdrJvgbW11j7uxEay1T6mrspwTbPloxVXPUGsd9I+MkL3NsLsPW1QSVfjno3NEMhMPTTLYYJkRzD8MM+HDawoAJqkR9uIMpW0kleuIupAgY3xVF/kQa6ZPxpOhOtItGo/qgKUsv3JPemg/ggF/KOL5HGrNRmVL1Y4lho96Y1Z+dFSzd+dhQ32WT4506w3//CaOc3Qw2PKpI5NYyMauiORfBI03QW9uVNUDO0C0TSqb+xsuipObghT/0OPV6YGKbFE8EXn2hjykbcDKBGD/2SPBbqdh90OwkkkLWkZgPwGkV+C/JblVyROJIC4dREEqCOYYbrviDeS4rrheupoLJSSScCVoKAf7/uvcorYfKEN+NFQlwd6r/c7vnKVLIQdVLerhFgsQxBZht8ZyquJ/tovchrpw2/BoyedjGRnOp+E4qY28REyGjSz1RZMtJ34arEcbG5r5/oCI9ntXVyUCbvfd4grOyw9MycyuskJQQAMdBUnpiXJhBveMicLn/f/HaqaNLqrnyWpg7e/uV7K0CMn67dPqcPE8Oynj6KKsLZOmSU52GVLC7ZxwZrm9R5QiDDBs9BAQtDwxnOyOwcGnapzZ1O+0bYOnmlwb+fm28yDdmHCcZrsyCtS2dN6eMV+YqnZ0QQwh9r9NPGkU5oDbdFT5TEJjxecE1AkJUAhcqCHEEqCKwxHdAu0VhIp1Zf2+O9033pmWcbA1uRAVAbznsUzZdaqudI=</xenc:CipherValue>\n\n</xenc:CipherData>\n\n</xenc:EncryptedData>\n\n<xenc:EncryptedKey xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\""
                },
                {
                  "type": "text",
                  "text": " Id=\"\\_4f9b9b5495ab6b437ab12adc914fad9d\">\n\n<xenc:EncryptionMethod xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\""
                },
                {
                  "type": "text",
                  "text": " Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p](http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:DigestMethod xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\""
                },
                {
                  "type": "text",
                  "text": " Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#sha1](http://www.w3.org/2000/09/xmldsig#sha1)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n</xenc:EncryptionMethod>\n\n<ds:KeyInfo xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<ds:X509Data>\n\n    <ds:X509Certificate>MIIByTCCATKgAwIBAgIGAVRwqgEnMA0GCSqGSIb3DQEBDQUAMBkxFzAVBgNVBAMMDkFwcEdhdGUg\n\n    WERQIENBMB4XDTE2MDUwMjA4NTExMFoXDTM2MDQyNzA4NTExMFowFDESMBAGA1UEAwwJbG9jYWxo\n\n    b3N0MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCRcvZT/vNCwJJWZ0f+6Z18R1VwSMl62g6i\n\n    6VefkswM/QsmlgDWrQ07+z764ic2aZZ1CZQ2qBk3RSgreEUiOfQKP+j2G16pghrxinSiljwCPDxB\n\n    ZEqdC3XYVMt4067RMeqih/RS4UWabZ5huHDF5/zRyeDInCqOUxCIAR5x0UdKywIDAQABoyEwHzAd\n\n    BgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDQYJKoZIhvcNAQENBQADgYEALMfn3TJ+SPMJ\n\n    cMBGV/p/9NKGUX9apryUM00HeWc1JomhU6UVYK6Wse0lzx4kheFGW3KWShNFuntqvAcqnsuy8ixG\n\n    zdKtEo+dDCxySwoCCfLWDlSlL+qkODaw8DXocqrIODysF0J6IAjJwsggHY0aVCC3a4wsdkekrRvV\n\n    ZHL4Vqg=</ds:X509Certificate>\n\n</ds:X509Data>\n\n</ds:KeyInfo>\n\n<xenc:CipherData xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n<xenc:CipherValue>FH+Qv4w0bay/1nPOl1+eLrnOGnpg7gznaP5ok81jYpM+ufovauEthZFIRlEBNDs/28LbkJQi0VebL2/W1XEM8vPD5+SKdmgfBfa6uW+3IzfJ71JK3mF8SkGZQIV7uodavSeaTAzWPvpdYGm/OjbPaj/A8A72dql5ODDXnqu0RxE=</xenc:CipherValue>\n\n</xenc:CipherData>\n\n<xenc:ReferenceList>\n\n    <xenc:DataReference URI=\"#\\_a93bdf2dfb14d192abfd446cf1acf06c\"/>\n\n</xenc:ReferenceList>\n\n</xenc:EncryptedKey>\n\n</saml2:EncryptedAssertion>\n\n</saml2p:Response>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1462264533467
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Awesome. You have encrypted assertions and encrypted attributes. Sigh."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1462265213829
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Encrypted attributes doesn't seem to be common, as I couldn't find any example at all. Will implement encrypted assertion only"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1462265565140
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And this is from ADFS:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<?xml version=\"1.0\"?>\n\n<samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"\\_68e39ce4-7c1a-46e6-9e0d-3b92abb0cd73\" Version=\"2.0\" IssueInstant=\"2016-05-03T12:18:40.702Z\" Destination=\"["
                },
                {
                  "type": "text",
                  "text": "https://turquoise.cryptzone.com/saml](https://turquoise.cryptzone.com/saml)\""
                },
                {
                  "type": "text",
                  "text": " Consent=\"urn:oasis:names:tc:SAML:2.0:consent:unspecified\">\n\n<Issuer xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">["
                },
                {
                  "type": "text",
                  "text": "http://adfs-test.czse.local/adfs/services/trust](http://adfs-test.czse.local/adfs/services/trust)</Issuer>"
                },
                {
                  "type": "text",
                  "text": "\n\n<samlp:Status>\n\n    <samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n\n</samlp:Status>\n\n<EncryptedAssertion xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n\n    <xenc:EncryptedData xmlns:xenc=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\""
                },
                {
                  "type": "text",
                  "text": " Type=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#Element](http://www.w3.org/2001/04/xmlenc#Element)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <xenc:EncryptionMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#aes256-cbc](http://www.w3.org/2001/04/xmlenc#aes256-cbc)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n    <KeyInfo xmlns=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <e:EncryptedKey xmlns:e=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#](http://www.w3.org/2001/04/xmlenc#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <e:EncryptionMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p](http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <DigestMethod Algorithm=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#sha1](http://www.w3.org/2000/09/xmldsig#sha1)\"/>"
                },
                {
                  "type": "text",
                  "text": "\n\n</e:EncryptionMethod>\n\n<KeyInfo>\n\n    <ds:X509Data xmlns:ds=\"["
                },
                {
                  "type": "text",
                  "text": "http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)\">"
                },
                {
                  "type": "text",
                  "text": "\n\n    <ds:X509IssuerSerial>\n\n        <ds:X509IssuerName>CN=Cryptzone Controller Root</ds:X509IssuerName>\n\n        <ds:X509SerialNumber>1429889046707</ds:X509SerialNumber>\n\n    </ds:X509IssuerSerial>\n\n</ds:X509Data>\n\n</KeyInfo>\n\n<e:CipherData>\n\n    <e:CipherValue>YGxUlumc0CCiODvPteDA49CA4Zv761KeYfPkNKm5FN72TzPcEb9LDSmrMJ+/F2vdiigMGD0L2LvY9mMG0wo2eDT/nZzO4el/oWVmJmVb/NwWByyhNmqEbP0ZZQmacXP5CNm5IiwF0+XoPEFrJErZR8wl16AdLj4QGseKcTF8jpo=</e:CipherValue>\n\n</e:CipherData>\n\n</e:EncryptedKey>\n\n</KeyInfo>\n\n<xenc:CipherData>\n\n    <xenc:CipherValue>6uQ1DLwht7uhcC0UVMQ7EpXXSblpNEJmuof5QcD8Q0chu+xHxUCCV21fRlNYKzxhZt7vb98lYRbgzYUDJJLgx6kHdl9bO+gp3GfxuR+ZA9SWaOz4WfvVk+rHFE1t6w0v5s0Wrj9+gv7AbPCgd9h9lcBkAEXcCV7/fGSbDc0qRZUkkYr3jdSWDyxuMmwM+bhEzR5uQPC68dy/JfGUpVpgMLV3627lXgAFuuAPeUcbtK0hyCB3sBrw8VOjMR3JA4ju4YaLeVE4qaanpOyCbyoUp0ag7BaLfB/EjEmtIcmlPr/ma19hsHRLy/1F/tJ4G7k9GE6lS2/nAFNmQcThepNs0ToKDR5Ly2LCIFfOHv4g7riXPygOxno73ZIAD75JwDrMedXOUX/3YEOaCqdAuy7y6/zbILmxKAtQGvukz+xOPUREMVfmldQn+QTBY4AHaNnyoOn/WSDVqZliw+mFr8uSRrL/5vEG3TBLUPe+vnw9s3v5ZLKVku1Nq+BXwPSzEkjrynxN3Mkan8yu630TSBadKY72TlwugaobJ7mSqjlO+4OIY9nv7L96S5Ibh3NqRGrf5gg3FCj4AiM4k491DW7C6u/aISY8L5N6IonCX+hkJC3cx249DCDTEivVvRem85KXE9eireeQxVM4VezLqK+lKAQuUzMCTl7smHwToTMfmNyqvJWA4VZvMqYM1QLPO0Wy1CtQx36FG6V8dBgUb6onTDkDXFSBfmwLjof0mb4ZvDBYLE/np2m8K1I/0PBOlYX+KNwYGD4Zb0a3CQbeayTHk0tyw0EiLULNJ1Ymljdi4cvSLCWksHo06zVBJz1lhkDKPOoG88ppWxiQd+vAzCwRq4rAE5TFlD4MRquzAk34bbH9qK+c+CcrAUiPetSt1wC9SAWep7uoR4Yfwafs60aeKaBDcHm5oFigmlbpbvHXOUSnIwrNzqTeb7f3CyYb2avQMbeQ5kJh1QVe2Lgwkdlxs4FRqajOVFGNWOlHow7iLpTayXz1vsc3XKdBrkmjXbJoNuBsJ1btsvYK2I2u408HNgZKhRoPnw9CSgV4ELOi/oZ+Zk0Xzz6BaijyuXWESwki7MuRdN7TOjHbcblsEg2/k4O2ID1BlIwIzliVWomWt/xVCNU1SOGdbdDIb5b2xFb+s6u5EHpBesRCDt98VjHcCSHEMjLXnjUgrqM3wrttMOzpedbkjWu6vRCUBaL9Axw9J4v6S2N7NNgK4ybOGF9lsxGEt6QOaxP2pSjM+JamsS7naJX9MY2CMsHf2SAt2ZIfsfYie7jC0nuoAaSbcUWbeukl/3H5Nqxjjq/TnQQ+/GmYThVSDzW+rkb6zQHbmamVyEIn+LC9gvYyY6dVWx4giQHQ2QPP07TQT4Dmy8mo0U8K+rfgMF7kbWSoQh/o3/Iy0wDe2koELE0SR7JhoYs4p0C+mvo0B4ckJtU3EaO7xzm1oH2kdSH6JRqjc0sURt7TgvfgU9v/uyHThEoVRQC/fipnRYI1z0Os+3x7lWRBgj/NnNegvYpWO6gC9/WhQqU73rDH2P9nwpOExYSms/IKsgQjAqaX0NgGvlw1NMnUndxtewklXxvpYD24Kt40/kdTWP0AepUOflBYca5ULTHH0Rpo8MDm5BcQBQOVcsE28smCzjkwUhXLv9ayv4MSo4FU5ZJO3BNHSQ7E52djz/Y5YAKU+TL3VFD20gyPdlIyriM+xjd0uilGQM9r07bs+QOAytZcZdf88eBogIjV6t6iXAMCGfeMtm2rPlY7CRGYSgKRSFCqcFt2J1+RZB5EARIDugUecNtg2mxYvXc2VXDiOkG7WjJak8STsJRPVrlgJHpteFaWNUaFCfoxDdkatvsmBePYE30QizQJUH0iQn+yMkDeRdKlZ3wbtczHN+D65Ru/rAKts51pjIE5rV6NunIboS18ZXxEMh0XHZLpiLm/XRM7NYSskcj4m0AyMs6kGUnyJcq7p3s5h+9efAsmy1EBKI6zjaX/FflZQmb+rF3MAORRV2PvvrmS5m7jPhodbm/RPqk5o9wXClM+VqRkuMEsx0GZZydY0cDwvGKJXaBb+w3BResFV9xhIy96eOD5i0C8jWfkEus2r8ucXEB2suJVdpGPXVZi2MSfdkN73XSmoak53/XcLNCroch2uXknYoGzePd8PjoyHFi00kVa/GJ7NPauYmV07O0J0WphNkVtVb1MBYylXvem1uwuxaCZtlbqjP/yTyrk/3yAW7ocDzmcmYe/Aqj2JAZJvgd8yhwZ5Vy1/A9MRlr60JINLHIGBueZBPIsKZnvKdI/ZuReyWCRHOnb6Vje1Vil/yLXD2q/Qap9bJoqVZHMawvn20WKmczPU9TDLUKI4LmqcRYczsx946eANjCFFtzBgGoAc3Kpgk2g+J8gFmJpfYElpT1Bfr0VBPVo9w+7D9H/XsTN1g3UjLQrNFj0qQhCtg67zMOJozuobBJ+o2e6FkXDJOF7LR5wxBihzTGNFhEnrLEzc32W/Q8s4Anipypro/RGEyrqxAEbqIEAruAeOTFQO5TRCb4ecZrILCVaQwHU7/Sx0rZn60Xei1lNNplit9R0z8kIV4Eo5YjdIyLNKxq8fFXo1+2Dux3MDi4YJJ+H8peer02JjiJTbfPIGzujiPpFos0yu4Q5gVu2Xj9NLin2rAYVUk3gdpF+Jti0BmxHjqlh6DZwFA+Z3uY78xtGTh6q4sfwtINOv7Kd1ATOeqHEFhzwLNikjRGWey62yD0xdhTphWIjDCknvD5P8YWpkJ4omNl9qbxOkzadmIoLHnczIj42tPmGocAgP89YYwenMS6IAS9dz7eZgOjo8l7Li7cIidpICHBrMF0HBKSBqs+sipbFfGdaGrKpuiFmj1CAOOknwPxr7MmyDYPL0Dx23LowJKkO72DsxFgjeeV68wwRJ18ngGML18EZKX8SoKjg3fqzUALKtHN2uaZhZOZZ1GuyzgVV8boeEpPa+VrJmJgc3nivcomqyKlOdle6xpzBtZQGfBigUzoSoEYT++dM5nSS4fZoKCDy1TvqNXh6JKBb+NJS4uPDPXaNx8HKLAEUS+OpOHENjecQoAbN4L5fmvP33Cu/bOtN/JaJ2eusn0jtHCpuHBhPhQGLtqHSKotaxkUTgz6rbFXouah4NI42gWJLKeKDJSjw96wQnVUtzDh56dWt4nUcSBOpidWov6XySvj+WUGr1HOgNBmuVt89SUa3s/uw4gkWZh9IYhWToMD+fA7kfMM6IM7TdIYW4o9V/AUqIqxvV+6AEDioOUATswl1hakWuKEfG1QgWnQT6menmnBlySsGPKRn0k8561IDVBKMf1WFvvX0ffLwX2oZXK4+2gY7xc8o2hM/+mMOIDyqWFsYGZzWZ989O2QqumYJL1BfJgq9Mp8MbpPgX8CGPSgyBa4K/qWQfXOJ0Fwe5Tev194xfC6DbTjZuxe+nZ4mVb2nXgFV94dUGFSEyt4JAXaKnH/Dj1G6uJ7BngTJoQFNQlM1uKjuoiFY77TjQ0rxkzgeySZVHQl4PQxZKxgf5Lb0uppeNPRelKx27oHQmEQo12eNp2kUsWZW51JxbEX4sBxAkR16x6EIWAXvFxYzxozpDghLeJZDxjKOKHLX7rmeixLwe/1nYaZroOu/LYMWv3QtslYlnUJGW4w8AWW83AenIjAjrJBH0qFoSJlwMAIeGrvkge+Lx0+uQ++CWRImIS08Xb+mRd+RUbNNh87R4VoIPXZQJftqUtb+z3M3zGDXT7m/jZGBH+uYZFPj/V0JNSbFJUjaeMDczf9WLHWrwmDdzAEfycGKCczr89BdpVjy/a83ODE8EmfFYXtaxaAjILTpSFLAkw2kyfPuq4USWsgw+2162dPI8mSR6bSoteFR0nEv7yw2J5kw8EzvbpVSqQnPH7yOsLjHPbqo4B9odgMwJ0UOkLNHqyvp0S37zZMhqcgqv8+z/ylJ0s+q6E+1dbyQxTbKg/v80HaDTI30wnhNuZ6XMzmAbbIxVO1hdH5Y8tKatZRjmalbpcLnsOD27FG9viqDVWlMA4NcEILugDBXn8jVRrzQ0N43HGjoOtruHxpGFPZXbn0PiGMC4WTrz9MbM+L89wfkZVvhdGEEVnSSEXZ1LSDH/ipUcbsdgkqbh0GGvE8dmYf/NqfTJBQ7ReNTMtnIlopPwFXnIURqY5uvwWA9KAsn5Dr4RLXI/BVgnputdppGhlJWLqtTK7VxoiVGuma3IizajkhQnkzm2INkkCDHW/R5udONdhlx0Uizy5vr8Z3rnBubGGFXmYmlYaeJNb90DHUvINnBYW/QEOK4un4t3O6DAJ2l/xEVUsdKxIiBRqxokDmmu3+1oAV9wuEQWEr6I0ggQW+zVTAWWdNxOD+tHygvlAHDzAaaNAt2s/fPTHOO9PBSNv0XrfQFd5iVTH0Yyfa0+Q+DliJGt6kA181gUd1CtuHH8TIdH3BRy05lsSLz6KKfoQ+oHAkfg+DdVKcsPagqY8VOG7w9AwNfigXmWq3dRY3cfLihBImWWKx0JSmpUrhbXqeIV0GzgoKjleZA+hYGEMOQeuIFd9LjN6i37Q/3OlLbCnxW4lIBA7ArWnlTuVvjngKYH4oCDtBjzjQswfobqnUBvA6VPv2//TYTCUKLZA/ctpxRk7l9SSUUGLIIq9OVxFLkQmG1JHJt4LbJO7gsimN7XZlbey8yHT8bvWJUFhhRXa7/Szq+tRq4Nee1wGniYlzHz/0vcasBMMERcKhZSXXV9zr/fmqz5fPTE6lGigq9zpbbs6+Z8A91n0SfqXG/YLL/wVAzUcx4IiaM2uqBCcih+z3fSmipGj6KAHHdhUQs12B9DZWMHZ7mnSVtQDeQUjpcKISC8gXN+EoDsTD5ik6wHgL86z7rtVSViYAIcAcRFvSjXAnvuyFWQ2Q=</xenc:CipherValue>\n\n</xenc:CipherData>\n\n</xenc:EncryptedData>\n\n</EncryptedAssertion>\n\n</samlp:Response>"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "surprise, surprise; can't use the same code for both. Investigating"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1462278190569
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "whoaa, look at onelogin: "
                },
                {
                  "type": "text",
                  "text": "https://www.samltool.com/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.samltool.com/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1462279726161
      }
    ]
  },
  {
    "key": "SA-2597",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The scenario is : 1 controller, 2 gateways on the same site, and 1 endpoint behind the gateways."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The testcase:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  does a ssh connection to gw1 and gw2 , and starts up had, and configures vpnd for ha."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  it enables telnet port 23 and ssh port 2222 on the endpoint through entitlements.A connection is made towards gw1"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "A ssh connection is made towards endpoint, over port 2222, and a command \"whoami\" is executed to make sure that the connection is established."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The test then ssh into the gw1 and kills all of the vpnds."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "and then issues a command over the ssh connection towards the endpoint to make sure that the connection is still alive."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The connection gets a reset, and the connection is lost.. (Connection reset by peer)"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "By doing tcpdumps on the test-runner machine and the gateway it can be seen that a RST packet is seen on the client machine:"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "10{{COLON"
                    },
                    {
                      "type": "text",
                      "text": "NUM",
                      "marks": [
                        {
                          "type": "em"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": "27}}22.116425 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags [R], seq 880085559, win 0, length 0"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "This packet is never seen when doing tcpDump on the gw. so it seems like the packet is created on the client machine."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "TCP dump on the client (test machine)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "TCP DUMP On THE client....\n\n^\\[\\[10:25:46.183808 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[S\\], seq 253730891, win 29200, options \\[mss 1460,sackOK,TS val 149258433 ecr 0,nop,wscale 7\\], length 0\n\n10:25:46.198377 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[S.\\], seq 2296369664, ack 253730892, win 28960, options \\[mss 1460,sackOK,TS val 106464722 ecr 149258433,nop,wscale 7\\], leng                   th 0\n\n10:25:46.198414 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[.\\], ack 1, win 229, options \\[nop,nop,TS val 149258437 ecr 106464722\\], length 0\n\n10:25:46.199309 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1:26, ack 1, win 229, options \\[nop,nop,TS val 149258437 ecr 106464722\\], length 25\n\n10:25:46.232848 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 1:42, ack 1, win 227, options \\[nop,nop,TS val 106464730 ecr 149258437\\], length 41\n\n10:25:46.232906 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[.\\], ack 42, win 229, options \\[nop,nop,TS val 149258445 ecr 106464730\\], length 0\n\n10:25:46.234190 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 26, win 227, options \\[nop,nop,TS val 106464731 ecr 149258437\\], length 0\n\n10:25:46.234208 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 26:626, ack 42, win 229, options \\[nop,nop,TS val 149258446 ecr 106464731\\], length 600\n\n10:25:46.238139 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], seq 42:1490, ack 26, win 227, options \\[nop,nop,TS val 106464732 ecr 149258445\\], length 1448\n\n10:25:46.239304 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 1490:1690, ack 26, win 227, options \\[nop,nop,TS val 106464732 ecr 149258445\\], length 200\n\n10:25:46.239316 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[.\\], ack 1690, win 274, options \\[nop,nop,TS val 149258447 ecr 106464732\\], length 0\n\n10:25:46.277073 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 626, win 236, options \\[nop,nop,TS val 106464742 ecr 149258446\\], length 0\n\n10:25:46.277095 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 626:770, ack 1690, win 274, options \\[nop,nop,TS val 149258456 ecr 106464742\\], length 144\n\n10:25:46.278865 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 770, win 245, options \\[nop,nop,TS val 106464742 ecr 149258456\\], length 0\n\n10:25:46.318792 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 1690:2410, ack 770, win 245, options \\[nop,nop,TS val 106464743 ecr 149258456\\], length 720\n\n10:25:46.324553 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 770:786, ack 2410, win 296, options \\[nop,nop,TS val 149258468 ecr 106464743\\], length 16\n\n10:25:46.364912 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 786, win 245, options \\[nop,nop,TS val 106464764 ecr 149258468\\], length 0\n\n10:25:46.364932 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 786:850, ack 2410, win 296, options \\[nop,nop,TS val 149258478 ecr 106464764\\], length 64\n\n10:25:46.366531 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 850, win 245, options \\[nop,nop,TS val 106464764 ecr 149258478\\], length 0\n\n10:25:46.406620 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2410:2474, ack 850, win 245, options \\[nop,nop,TS val 106464764 ecr 149258478\\], length 64\n\n10:25:46.421650 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 850:1506, ack 2474, win 296, options \\[nop,nop,TS val 149258493 ecr 106464764\\], length 656\n\n10:25:46.460894 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 1506, win 256, options \\[nop,nop,TS val 106464788 ecr 149258493\\], length 0\n\n10:25:46.498576 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2474:2554, ack 1506, win 256, options \\[nop,nop,TS val 106464790 ecr 149258493\\], length 80\n\n10:25:46.499001 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1506:1570, ack 2554, win 296, options \\[nop,nop,TS val 149258512 ecr 106464790\\], length 64\n\n10:25:46.501159 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 1570, win 256, options \\[nop,nop,TS val 106464798 ecr 149258512\\], length 0\n\n10:25:46.539016 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2554:2618, ack 1570, win 256, options \\[nop,nop,TS val 106464798 ecr 149258512\\], length 64\n\n10:25:46.539433 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1570:1666, ack 2618, win 296, options \\[nop,nop,TS val 149258522 ecr 106464798\\], length 96\n\n10:25:46.555733 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2618:2666, ack 1666, win 256, options \\[nop,nop,TS val 106464811 ecr 149258522\\], length 48\n\n10:25:46.556878 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1666:1746, ack 2666, win 296, options \\[nop,nop,TS val 149258526 ecr 106464811\\], length 80\n\n10:25:46.596925 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 1746, win 256, options \\[nop,nop,TS val 106464822 ecr 149258526\\], length 0                                        1                   0:25:47.786293 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2666:2730, ack 1746, win 256, options \\[nop,nop,TS val 106465119 ecr 149258526\\], length 64\n\n10:25:47.786687 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1746:1826, ack 2730, win 296, options \\[nop,nop,TS val 149258834 ecr 106465119\\], length 80\n\n10:25:47.788648 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 1826, win 256, options \\[nop,nop,TS val 106465119 ecr 149258834\\], length 0\n\n10:25:47.826710 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2730:2842, ack 1826, win 256, options \\[nop,nop,TS val 106465120 ecr 149258834\\], length 112\n\n10:25:47.827186 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2842:2986, ack 1826, win 256, options \\[nop,nop,TS val 106465124 ecr 149258834\\], length 144\n\n10:25:47.827224 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[P.\\], seq 2986:3082, ack 1826, win 256, options \\[nop,nop,TS val 106465124 ecr 149258834\\], length 96\n\n10:25:47.827538 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[.\\], ack 3082, win 319, options \\[nop,nop,TS val 149258844 ecr 106465120\\], length 0\n\n10:25:47.829099 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1826:1874, ack 3082, win 319, options \\[nop,nop,TS val 149258844 ecr 106465120\\], length 48\n\n10:25:47.913273 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 1874, win 256, options \\[nop,nop,TS val 106465151 ecr 149258844\\], length 0\n\n10:25:47.913296 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367 > 172.17.105.3.2222: Flags \\[P.\\], seq 1874:1922, ack 3082, win 319, options \\[nop,nop,TS val 149258866 ecr 106465151\\], length 48\n\n10:25:47.915029 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42367: Flags \\[.\\], ack 1922, win 256, options \\[nop,nop,TS val 106465151 ecr 149258866\\], length 0\n\ntcpdump: pcap\\_loop: The interface went down\n\n41 packets captured\n\n43 packets received by filter\n\n0 packets dropped by kernel\n\nroot@adminuser-VirtualBox:~#\n\nCapture 2 \n\n10:27:13.722916 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[P.\\], seq 880085031:880085095, ack 954440987, win 256, options \\[nop,nop,TS val 106486593 ecr 149280307\\], length 64\n\n10:27:13.723330 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 1:97, ack 64, win 296, options \\[nop,nop,TS val 149280318 ecr 106486593\\], length 96\n\n10:27:13.740047 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[P.\\], seq 64:112, ack 97, win 256, options \\[nop,nop,TS val 106486607 ecr 149280318\\], length 48\n\n10:27:13.741814 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 97:177, ack 112, win 296, options \\[nop,nop,TS val 149280323 ecr 106486607\\], length 80\n\n10:27:13.784867 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[.\\], ack 177, win 256, options \\[nop,nop,TS val 106486619 ecr 149280323\\], length 0\n\n10:27:14.915787 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[P.\\], seq 112:176, ack 177, win 256, options \\[nop,nop,TS val 106486901 ecr 149280323\\], length 64\n\n10:27:14.916196 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 177:257, ack 176, win 296, options \\[nop,nop,TS val 149280616 ecr 106486901\\], length 80\n\n10:27:14.917683 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[.\\], ack 257, win 256, options \\[nop,nop,TS val 106486902 ecr 149280616\\], length 0\n\n10:27:14.958728 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[P.\\], seq 176:288, ack 257, win 256, options \\[nop,nop,TS val 106486902 ecr 149280616\\], length 112\n\n10:27:14.959240 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[P.\\], seq 288:432, ack 257, win 256, options \\[nop,nop,TS val 106486906 ecr 149280616\\], length 144\n\n10:27:14.959240 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[P.\\], seq 432:528, ack 257, win 256, options \\[nop,nop,TS val 106486906 ecr 149280616\\], length 96\n\n10:27:14.959658 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[.\\], ack 528, win 319, options \\[nop,nop,TS val 149280627 ecr 106486902\\], length 0\n\n10:27:14.961811 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 257:305, ack 528, win 319, options \\[nop,nop,TS val 149280628 ecr 106486902\\], length 48\n\n10:27:15.041433 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[.\\], ack 305, win 256, options \\[nop,nop,TS val 106486933 ecr 149280628\\], length 0\n\n10:27:15.041453 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 305:353, ack 528, win 319, options \\[nop,nop,TS val 149280648 ecr 106486933\\], length 48\n\n10:27:15.043446 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[.\\], ack 353, win 256, options \\[nop,nop,TS val 106486933 ecr 149280648\\], length 0\n\n10:27:21.217457 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 353:433, ack 528, win 319, options \\[nop,nop,TS val 149282192 ecr 106486933\\], length 80\n\n10:27:21.441242 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 353:433, ack 528, win 319, options \\[nop,nop,TS val 149282248 ecr 106486933\\], length 80\n\n10:27:21.666641 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 353:433, ack 528, win 319, options \\[nop,nop,TS val 149282304 ecr 106486933\\], length 80\n\n10:27:22.113272 IP 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381 > 172.17.105.3.2222: Flags \\[P.\\], seq 353:433, ack 528, win 319, options \\[nop,nop,TS val 149282416 ecr 106486933\\], length 80\n\n10:27:22.116425 IP 172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42381: Flags \\[R\\], seq 880085559, win 0, length 0\n\ntcpdump: pcap\\_loop: The interface went down\n\n21 packets captured\n\n21 packets received by"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1456913726750
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "TCP dump on the gateway"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "APPLIANCE CAPTURE.. \n\nroot@envy-172-17-104-2:~# tcpdump -i tun0 -v\n\ntcpdump: listening on tun0, link-type RAW (Raw IP), capture size 65535 bytes\n\n^\\[\\[A09:31:16.029880 IP (tos 0x0, ttl 64, id 6156, offset 0, flags \\[DF\\], proto TCP (6), length 60)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[S\\], cksum 0x90e5 (correct), seq 784259817, win 29200, options \\[mss 1460,sackOK,TS val 149340901 ecr 0,nop,wscale 7\\], length 0\n\n09:31:16.030222 IP (tos 0x0, ttl 63, id 0, offset 0, flags \\[DF\\], proto TCP (6), length 60)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[S.\\], cksum 0x22b9 (correct), seq 2398491076, ack 784259818, win 28960, options \\[mss 1460,sackOK,TS val 106547191 ecr 149340901,nop,wscale 7\\], length 0\n\n09:31:16.031579 IP (tos 0x0, ttl 64, id 6157, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[.\\], cksum 0xc1bb (correct), ack 1, win 229, options \\[nop,nop,TS val 149340906 ecr 106547191\\], length 0\n\n09:31:16.063761 IP (tos 0x0, ttl 63, id 54834, offset 0, flags \\[DF\\], proto TCP (6), length 93)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0x9c5e (correct), seq 1:42, ack 1, win 227, options \\[nop,nop,TS val 106547199 ecr 149340906\\], length 41\n\n09:31:16.066885 IP (tos 0x0, ttl 64, id 6158, offset 0, flags \\[DF\\], proto TCP (6), length 77)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x0a84 (correct), seq 1:26, ack 1, win 229, options \\[nop,nop,TS val 149340907 ecr 106547191\\], length 25\n\n09:31:16.067270 IP (tos 0x0, ttl 63, id 54835, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xc171 (correct), ack 26, win 227, options \\[nop,nop,TS val 106547200 ecr 149340907\\], length 0\n\n09:31:16.068545 IP (tos 0x0, ttl 64, id 6159, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[.\\], cksum 0xc168 (correct), ack 42, win 229, options \\[nop,nop,TS val 149340915 ecr 106547199\\], length 0\n\n09:31:16.071270 IP (tos 0x0, ttl 63, id 54836, offset 0, flags \\[DF\\], proto TCP (6), length 1500)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0x5b6d (correct), seq 42:1490, ack 26, win 227, options \\[nop,nop,TS val 106547201 ecr 149340915\\], length 1448\n\n09:31:16.071329 IP (tos 0x0, ttl 63, id 54837, offset 0, flags \\[DF\\], proto TCP (6), length 252)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0xe49a (correct), seq 1490:1690, ack 26, win 227, options \\[nop,nop,TS val 106547201 ecr 149340915\\], length 200\n\n09:31:16.073067 IP (tos 0x0, ttl 64, id 6160, offset 0, flags \\[DF\\], proto TCP (6), length 652)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xd205 (correct), seq 26:626, ack 42, win 229, options \\[nop,nop,TS val 149340916 ecr 106547200\\], length 600\n\n09:31:16.074705 IP (tos 0x0, ttl 64, id 6161, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[.\\], cksum 0xb86f (correct), ack 1690, win 274, options \\[nop,nop,TS val 149340917 ecr 106547201\\], length 0\n\n09:31:16.112021 IP (tos 0x0, ttl 63, id 54838, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xb88b (correct), ack 626, win 236, options \\[nop,nop,TS val 106547212 ecr 149340916\\], length 0\n\n09:31:16.113797 IP (tos 0x0, ttl 64, id 6162, offset 0, flags \\[DF\\], proto TCP (6), length 196)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xa81f (correct), seq 626:770, ack 1690, win 274, options \\[nop,nop,TS val 149340927 ecr 106547212\\], length 144\n\n09:31:16.114093 IP (tos 0x0, ttl 63, id 54839, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xb7e7 (correct), ack 770, win 245, options \\[nop,nop,TS val 106547212 ecr 149340927\\], length 0\n\n09:31:16.118229 IP (tos 0x0, ttl 63, id 54840, offset 0, flags \\[DF\\], proto TCP (6), length 772)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0xfe19 (correct), seq 1690:2410, ack 770, win 245, options \\[nop,nop,TS val 106547213 ecr 149340927\\], length 720\n\n09:31:16.159080 IP (tos 0x0, ttl 64, id 6163, offset 0, flags \\[DF\\], proto TCP (6), length 68)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xaa9f (correct), seq 770:786, ack 2410, win 296, options \\[nop,nop,TS val 149340938 ecr 106547213\\], length 16\n\n09:31:16.195961 IP (tos 0x0, ttl 63, id 54841, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xb4e7 (correct), ack 786, win 245, options \\[nop,nop,TS val 106547233 ecr 149340938\\], length 0\n\n09:31:16.197694 IP (tos 0x0, ttl 64, id 6164, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x9d59 (correct), seq 786:850, ack 2410, win 296, options \\[nop,nop,TS val 149340948 ecr 106547233\\], length 64\n\n09:31:16.198134 IP (tos 0x0, ttl 63, id 54842, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xb49d (correct), ack 850, win 245, options \\[nop,nop,TS val 106547233 ecr 149340948\\], length 0\n\n09:31:16.198302 IP (tos 0x0, ttl 63, id 54843, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0xe0e0 (correct), seq 2410:2474, ack 850, win 245, options \\[nop,nop,TS val 106547233 ecr 149340948\\], length 64\n\n09:31:16.252619 IP (tos 0x0, ttl 64, id 6165, offset 0, flags \\[DF\\], proto TCP (6), length 708)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x6ca0 (correct), seq 850:1506, ack 2474, win 296, options \\[nop,nop,TS val 149340962 ecr 106547233\\], length 656\n\n09:31:16.291992 IP (tos 0x0, ttl 63, id 54844, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xb19c (correct), ack 1506, win 256, options \\[nop,nop,TS val 106547257 ecr 149340962\\], length 0\n\n09:31:16.301442 IP (tos 0x0, ttl 63, id 54845, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0xf3a3 (correct), seq 2474:2554, ack 1506, win 256, options \\[nop,nop,TS val 106547259 ecr 149340962\\], length 80\n\n09:31:16.334208 IP (tos 0x0, ttl 64, id 6166, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x09e7 (correct), seq 1506:1570, ack 2554, win 296, options \\[nop,nop,TS val 149340982 ecr 106547259\\], length 64\n\n09:31:16.334579 IP (tos 0x0, ttl 63, id 54846, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xb0ee (correct), ack 1570, win 256, options \\[nop,nop,TS val 106547267 ecr 149340982\\], length 0\n\n09:31:16.334713 IP (tos 0x0, ttl 63, id 54847, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0xe077 (correct), seq 2554:2618, ack 1570, win 256, options \\[nop,nop,TS val 106547267 ecr 149340982\\], length 64\n\n09:31:16.377950 IP (tos 0x0, ttl 64, id 6167, offset 0, flags \\[DF\\], proto TCP (6), length 148)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xe618 (correct), seq 1570:1666, ack 2618, win 296, options \\[nop,nop,TS val 149340993 ecr 106547267\\], length 96\n\n09:31:16.392518 IP (tos 0x0, ttl 63, id 54848, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0x3f78 (correct), seq 2618:2666, ack 1666, win 256, options \\[nop,nop,TS val 106547282 ecr 149340993\\], length 48\n\n09:31:16.395420 IP (tos 0x0, ttl 64, id 6168, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xdd78 (correct), seq 1666:1746, ack 2666, win 296, options \\[nop,nop,TS val 149340997 ecr 106547282\\], length 80\n\n09:31:16.431943 IP (tos 0x0, ttl 63, id 54849, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xafa6 (correct), ack 1746, win 256, options \\[nop,nop,TS val 106547292 ecr 149340997\\], length 0\n\n09:31:17.614356 IP (tos 0x0, ttl 63, id 54850, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0x6dcd (correct), seq 2666:2730, ack 1746, win 256, options \\[nop,nop,TS val 106547587 ecr 149340997\\], length 64\n\n09:31:17.616446 IP (tos 0x0, ttl 64, id 6169, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x559a (correct), seq 1746:1826, ack 2730, win 296, options \\[nop,nop,TS val 149341303 ecr 106547587\\], length 80\n\n09:31:17.616689 IP (tos 0x0, ttl 63, id 54851, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xacbc (correct), ack 1826, win 256, options \\[nop,nop,TS val 106547588 ecr 149341303\\], length 0\n\n09:31:17.618111 IP (tos 0x8, ttl 63, id 54852, offset 0, flags \\[DF\\], proto TCP (6), length 164)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0x7687 (correct), seq 2730:2842, ack 1826, win 256, options \\[nop,nop,TS val 106547588 ecr 149341303\\], length 112\n\n09:31:17.636820 IP (tos 0x8, ttl 63, id 54853, offset 0, flags \\[DF\\], proto TCP (6), length 196)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0xc505 (correct), seq 2842:2986, ack 1826, win 256, options \\[nop,nop,TS val 106547593 ecr 149341303\\], length 144\n\n09:31:17.636869 IP (tos 0x8, ttl 63, id 54854, offset 0, flags \\[DF\\], proto TCP (6), length 148)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[P.\\], cksum 0x0e1c (correct), seq 2986:3082, ack 1826, win 256, options \\[nop,nop,TS val 106547593 ecr 149341303\\], length 96\n\n09:31:17.658443 IP (tos 0x0, ttl 64, id 6170, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[.\\], cksum 0xab13 (correct), ack 3082, win 319, options \\[nop,nop,TS val 149341313 ecr 106547588\\], length 0\n\n09:31:17.697454 IP (tos 0x0, ttl 64, id 6171, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x55fe (correct), seq 1826:1874, ack 3082, win 319, options \\[nop,nop,TS val 149341313 ecr 106547588\\], length 48\n\n09:31:17.736022 IP (tos 0x8, ttl 63, id 54855, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xab04 (correct), ack 1874, win 256, options \\[nop,nop,TS val 106547618 ecr 149341313\\], length 0\n\n09:31:17.737987 IP (tos 0x0, ttl 64, id 6172, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xd78c (correct), seq 1874:1922, ack 3082, win 319, options \\[nop,nop,TS val 149341333 ecr 106547618\\], length 48\n\n09:31:17.738402 IP (tos 0x8, ttl 63, id 54856, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42437: Flags \\[.\\], cksum 0xaac0 (correct), ack 1922, win 256, options \\[nop,nop,TS val 106547618 ecr 149341333\\], length 0\n\ntcpdump: pcap\\_loop: The interface went down\n\n41 packets captured\n\n41 packets received by filter\n\n0 packets dropped by kernel\n\nroot@envy-172-17-104-2:~# tcpdump -i tun0 -v\n\nCAPTURE 2\n\ntcpdump: listening on tun0, link-type RAW (Raw IP), capture size 65535 bytes\n\n^\\[\\[A09:32:25.647983 IP (tos 0x0, ttl 63, id 51748, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[.\\], cksum 0xebe0 (correct), ack 3325276443, win 245, options \\[nop,nop,TS val 106564596 ecr 149358301\\], length 0\n\n09:32:25.649755 IP (tos 0x0, ttl 64, id 43193, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x0453 (correct), seq 1:65, ack 0, win 296, options \\[nop,nop,TS val 149358311 ecr 106564596\\], length 64\n\n09:32:25.650068 IP (tos 0x0, ttl 63, id 51749, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[.\\], cksum 0xeb96 (correct), ack 65, win 245, options \\[nop,nop,TS val 106564596 ecr 149358311\\], length 0\n\n09:32:25.650369 IP (tos 0x0, ttl 63, id 51750, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[P.\\], cksum 0x1598 (correct), seq 0:64, ack 65, win 245, options \\[nop,nop,TS val 106564596 ecr 149358311\\], length 64\n\n09:32:25.719371 IP (tos 0x0, ttl 64, id 43194, offset 0, flags \\[DF\\], proto TCP (6), length 708)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xec96 (correct), seq 65:721, ack 64, win 296, options \\[nop,nop,TS val 149358328 ecr 106564596\\], length 656\n\n09:32:25.755975 IP (tos 0x0, ttl 63, id 51751, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[.\\], cksum 0xe88f (correct), ack 721, win 256, options \\[nop,nop,TS val 106564623 ecr 149358328\\], length 0\n\n09:32:25.768106 IP (tos 0x0, ttl 63, id 51752, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[P.\\], cksum 0xfe3d (correct), seq 64:144, ack 721, win 256, options \\[nop,nop,TS val 106564626 ecr 149358328\\], length 80\n\n09:32:25.798015 IP (tos 0x0, ttl 64, id 43195, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x46c5 (correct), seq 721:785, ack 144, win 296, options \\[nop,nop,TS val 149358348 ecr 106564626\\], length 64\n\n09:32:25.798510 IP (tos 0x0, ttl 63, id 51753, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[.\\], cksum 0xe7e1 (correct), ack 785, win 256, options \\[nop,nop,TS val 106564633 ecr 149358348\\], length 0\n\n09:32:25.798696 IP (tos 0x0, ttl 63, id 51754, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[P.\\], cksum 0xea67 (correct), seq 144:208, ack 785, win 256, options \\[nop,nop,TS val 106564633 ecr 149358348\\], length 64\n\n09:32:25.842307 IP (tos 0x0, ttl 64, id 43196, offset 0, flags \\[DF\\], proto TCP (6), length 148)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xa73c (correct), seq 785:881, ack 208, win 296, options \\[nop,nop,TS val 149358359 ecr 106564633\\], length 96\n\n09:32:25.857303 IP (tos 0x0, ttl 63, id 51755, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[P.\\], cksum 0xd874 (correct), seq 208:256, ack 881, win 256, options \\[nop,nop,TS val 106564648 ecr 149358359\\], length 48\n\n09:32:25.860332 IP (tos 0x0, ttl 64, id 43197, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x0c90 (correct), seq 881:961, ack 256, win 296, options \\[nop,nop,TS val 149358364 ecr 106564648\\], length 80\n\n09:32:25.899960 IP (tos 0x0, ttl 63, id 51756, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42451: Flags \\[.\\], cksum 0xe697 (correct), ack 961, win 256, options \\[nop,nop,TS val 106564659 ecr 149358364\\], length 0\n\ntcpdump: pcap\\_loop: The interface went down\n\n14 packets captured\n\n25 packets received by filter\n\n0 packets dropped by kernel\n\nCAPTURE 3\n\nroot@envy-172-17-104-2:~# tcpdump -i tun0 -v\n\ntcpdump: listening on tun0, link-type RAW (Raw IP), capture size 65535 bytes\n\n^\\[\\[A09:36:19.215964 IP (tos 0x0, ttl 63, id 50662, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xd07c (correct), ack 3784235000, win 236, options \\[nop,nop,TS val 106622988 ecr 149416692\\], length 0\n\n09:36:19.217452 IP (tos 0x0, ttl 64, id 16233, offset 0, flags \\[DF\\], proto TCP (6), length 196)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x04da (correct), seq 1:145, ack 0, win 274, options \\[nop,nop,TS val 149416703 ecr 106622988\\], length 144\n\n09:36:19.217849 IP (tos 0x0, ttl 63, id 50663, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xcfd8 (correct), ack 145, win 245, options \\[nop,nop,TS val 106622988 ecr 149416703\\], length 0\n\n09:36:19.221913 IP (tos 0x0, ttl 63, id 50664, offset 0, flags \\[DF\\], proto TCP (6), length 772)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x1629 (correct), seq 0:720, ack 145, win 245, options \\[nop,nop,TS val 106622989 ecr 149416703\\], length 720\n\n09:36:19.269928 IP (tos 0x0, ttl 64, id 16234, offset 0, flags \\[DF\\], proto TCP (6), length 68)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xc28e (correct), seq 145:161, ack 720, win 296, options \\[nop,nop,TS val 149416716 ecr 106622989\\], length 16\n\n09:36:19.307952 IP (tos 0x0, ttl 63, id 50665, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xccd4 (correct), ack 161, win 245, options \\[nop,nop,TS val 106623011 ecr 149416716\\], length 0\n\n09:36:19.309523 IP (tos 0x0, ttl 64, id 16235, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x9057 (correct), seq 161:225, ack 720, win 296, options \\[nop,nop,TS val 149416726 ecr 106623011\\], length 64\n\n09:36:19.309821 IP (tos 0x0, ttl 63, id 50666, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xcc8a (correct), ack 225, win 245, options \\[nop,nop,TS val 106623011 ecr 149416726\\], length 0\n\n09:36:19.310180 IP (tos 0x0, ttl 63, id 50667, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x4d01 (correct), seq 720:784, ack 225, win 245, options \\[nop,nop,TS val 106623011 ecr 149416726\\], length 64\n\n09:36:19.377156 IP (tos 0x0, ttl 64, id 16236, offset 0, flags \\[DF\\], proto TCP (6), length 708)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xcc62 (correct), seq 225:881, ack 784, win 296, options \\[nop,nop,TS val 149416743 ecr 106623011\\], length 656\n\n09:36:19.415968 IP (tos 0x0, ttl 63, id 50668, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xc983 (correct), ack 881, win 256, options \\[nop,nop,TS val 106623038 ecr 149416743\\], length 0\n\n09:36:19.425283 IP (tos 0x0, ttl 63, id 50669, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0xcc4c (correct), seq 784:864, ack 881, win 256, options \\[nop,nop,TS val 106623040 ecr 149416743\\], length 80\n\n09:36:19.457058 IP (tos 0x0, ttl 64, id 16237, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x6b9e (correct), seq 881:945, ack 864, win 296, options \\[nop,nop,TS val 149416763 ecr 106623040\\], length 64\n\n09:36:19.457471 IP (tos 0x0, ttl 63, id 50670, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xc8d5 (correct), ack 945, win 256, options \\[nop,nop,TS val 106623048 ecr 149416763\\], length 0\n\n09:36:19.457664 IP (tos 0x0, ttl 63, id 50671, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x2eb6 (correct), seq 864:928, ack 945, win 256, options \\[nop,nop,TS val 106623048 ecr 149416763\\], length 64\n\n09:36:19.501395 IP (tos 0x0, ttl 64, id 16238, offset 0, flags \\[DF\\], proto TCP (6), length 148)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x08eb (correct), seq 945:1041, ack 928, win 296, options \\[nop,nop,TS val 149416774 ecr 106623048\\], length 96\n\n09:36:19.516081 IP (tos 0x0, ttl 63, id 50672, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x5618 (correct), seq 928:976, ack 1041, win 256, options \\[nop,nop,TS val 106623063 ecr 149416774\\], length 48\n\n09:36:19.520057 IP (tos 0x0, ttl 64, id 16239, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0x2ee4 (correct), seq 1041:1121, ack 976, win 296, options \\[nop,nop,TS val 149416779 ecr 106623063\\], length 80\n\n09:36:19.559980 IP (tos 0x0, ttl 63, id 50673, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xc78b (correct), ack 1121, win 256, options \\[nop,nop,TS val 106623074 ecr 149416779\\], length 0\n\n09:36:20.737336 IP (tos 0x0, ttl 63, id 50674, offset 0, flags \\[DF\\], proto TCP (6), length 116)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0xe329 (correct), seq 976:1040, ack 1121, win 256, options \\[nop,nop,TS val 106623368 ecr 149416779\\], length 64\n\n09:36:20.742081 IP (tos 0x0, ttl 64, id 16240, offset 0, flags \\[DF\\], proto TCP (6), length 132)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xcebb (correct), seq 1121:1201, ack 1040, win 296, options \\[nop,nop,TS val 149417084 ecr 106623368\\], length 80\n\n09:36:20.742321 IP (tos 0x0, ttl 63, id 50675, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xc4a3 (correct), ack 1201, win 256, options \\[nop,nop,TS val 106623369 ecr 149417084\\], length 0\n\n09:36:20.743242 IP (tos 0x8, ttl 63, id 50676, offset 0, flags \\[DF\\], proto TCP (6), length 164)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x9a84 (correct), seq 1040:1152, ack 1201, win 256, options \\[nop,nop,TS val 106623369 ecr 149417084\\], length 112\n\n09:36:20.757561 IP (tos 0x8, ttl 63, id 50677, offset 0, flags \\[DF\\], proto TCP (6), length 196)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0xf9e3 (correct), seq 1152:1296, ack 1201, win 256, options \\[nop,nop,TS val 106623373 ecr 149417084\\], length 144\n\n09:36:20.757611 IP (tos 0x8, ttl 63, id 50678, offset 0, flags \\[DF\\], proto TCP (6), length 148)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x1c01 (correct), seq 1296:1392, ack 1201, win 256, options \\[nop,nop,TS val 106623373 ecr 149417084\\], length 96\n\n09:36:20.787919 IP (tos 0x8, ttl 63, id 50679, offset 0, flags \\[DF\\], proto TCP (6), length 148)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[P.\\], cksum 0x1bf9 (correct), seq 1296:1392, ack 1201, win 256, options \\[nop,nop,TS val 106623381 ecr 149417084\\], length 96\n\n09:36:20.790224 IP (tos 0x0, ttl 64, id 16241, offset 0, flags \\[DF\\], proto TCP (6), length 64)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[.\\], cksum 0x5eb3 (correct), ack 1392, win 319, options \\[nop,nop,TS val 149417097 ecr 106623369,nop,nop,sack 1 {1296:1392}\\], length 0\n\n09:36:20.829443 IP (tos 0x0, ttl 64, id 16242, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xc1c6 (correct), seq 1201:1249, ack 1392, win 319, options \\[nop,nop,TS val 149417098 ecr 106623369\\], length 48\n\n09:36:20.867934 IP (tos 0x8, ttl 63, id 50680, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xc2e5 (correct), ack 1249, win 256, options \\[nop,nop,TS val 106623401 ecr 149417098\\], length 0\n\n09:36:20.870402 IP (tos 0x0, ttl 64, id 16243, offset 0, flags \\[DF\\], proto TCP (6), length 100)\n\n    172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466 > 172.17.105.3.2222: Flags \\[P.\\], cksum 0xc53f (correct), seq 1249:1297, ack 1392, win 319, options \\[nop,nop,TS val 149417117 ecr 106623401\\], length 48\n\n09:36:20.870673 IP (tos 0x8, ttl 63, id 50681, offset 0, flags \\[DF\\], proto TCP (6), length 52)\n\n    172.17.105.3.2222 > 172-13-0-1.lightspeed.mssnks.sbcglobal.net.42466: Flags \\[.\\], cksum 0xc2a2 (correct), ack 1297, win 256, options \\[nop,nop,TS val 106623401 ecr 149417117\\], length 0\n\ntcpdump: pcap\\_loop: The interface went down\n\n31 packets captured\n\n31 packets received by filter\n\n0 packets dropped by kernel"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1456913762541
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Debug logs from the test"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "adminuser@adminuser-VirtualBox:~/stratus-tests$ sudo PYTHONPATH=lib python3 -m testy -s my\\_ha -l debug cases/ha/ha.yaml\n\n\\[NEW TEST\\] \\[None\\] New test started: 2016-02-29 08:10:28.926737\n\n\\[STARTED\\] \\[cases/ha/ha\\] \\[scenario: my\\_ha\\] \\[#867647\\] High Availibility Test\n\n    2016-02-29T08:10:29,036726Z \\[INFO\\] \\[cases/ha/ha\\] Starting!\n\n    2016-02-29T08:10:29,344294Z \\[DEBUG\\] \\[cases/ha/ha\\] Start HAD\n\n    2016-02-29T08:10:29,344666Z \\[DEBUG\\] \\[cases/ha/ha\\] Starting prccess!\n\n    2016-02-29T08:10:29,344936Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:29,344996Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' status cz-had\n\n    2016-02-29T08:10:29,374937Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:status cz-had output cz-had start/running, process 1958\n\n    2016-02-29T08:10:29,375477Z \\[DEBUG\\] \\[cases/ha/ha\\] Start HAD\n\n    2016-02-29T08:10:29,375712Z \\[DEBUG\\] \\[cases/ha/ha\\] Starting prccess!\n\n    2016-02-29T08:10:29,375947Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:29,376184Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' status cz-had\n\n    2016-02-29T08:10:29,399227Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:status cz-had output cz-had start/running, process 2048\n\n    2016-02-29T08:10:29,400111Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:29,400449Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' cz-vpnd INSTANCE=0\n\n    2016-02-29T08:10:29,440588Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:cz-vpnd INSTANCE=0 output\n\n    2016-02-29T08:10:29,440955Z \\[DEBUG\\] \\[cases/ha/ha\\] Configure HA for 1 vpnds\n\n    2016-02-29T08:10:29,441218Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:29,441428Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' grep \"ha-module: true\" /etc/cz-vpnd/config-0.yaml\n\n    2016-02-29T08:10:29,508123Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:grep \"ha-module: true\" /etc/cz-vpnd/config-0.yaml output\n\n    2016-02-29T08:10:29,508481Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:29,508741Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' echo ha-module: true >> /etc/cz-vpnd/config-0.yaml\n\n    2016-02-29T08:10:29,557164Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:echo ha-module: true >> /etc/cz-vpnd/config-0.yaml output\n\n    2016-02-29T08:10:29,557775Z \\[DEBUG\\] \\[cases/ha/ha\\] Restart process\n\n    2016-02-29T08:10:29,558115Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:29,558463Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' restart cz-vpnd INSTANCE=0\n\n    2016-02-29T08:10:31,618082Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:restart cz-vpnd INSTANCE=0 output cz-vpnd (0) start/running, process 22599\n\n    2016-02-29T08:10:31,618715Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:31,619081Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' cz-vpnd INSTANCE=0\n\n    2016-02-29T08:10:31,642407Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:cz-vpnd INSTANCE=0 output\n\n    2016-02-29T08:10:31,642871Z \\[DEBUG\\] \\[cases/ha/ha\\] Configure HA for 1 vpnds\n\n    2016-02-29T08:10:31,643236Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:31,643557Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' grep \"ha-module: true\" /etc/cz-vpnd/config-0.yaml\n\n    2016-02-29T08:10:31,700621Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:grep \"ha-module: true\" /etc/cz-vpnd/config-0.yaml output ha-module: true\n\n    2016-02-29T08:10:31,701282Z \\[DEBUG\\] \\[cases/ha/ha\\] Ha already configured\n\n    2016-02-29T08:10:31,838535Z \\[DEBUG\\] \\[cases/ha/ha\\] Running command\n\n    2016-02-29T08:10:31,838894Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' ip route add 192.168.100.0/24 dev eth0\n\n    2016-02-29T08:10:35,668837Z \\[DEBUG\\] \\[cases/ha/ha\\] running command:ip route add 192.168.100.0/24 dev eth0 output\n\n    2016-02-29T08:10:35,669341Z \\[DEBUG\\] \\[cases/ha/ha\\] Closing ssh connection\n\n    2016-02-29T08:10:36,154726Z \\[DEBUG\\] \\[cases/ha/ha\\] Formatted tag: \\['tag'\\]\n\n    2016-02-29T08:10:36,155166Z \\[DEBUG\\] \\[cases/ha/ha\\] endpoint ip 172.17.105.3\n\n    2016-02-29T08:10:36,155430Z \\[DEBUG\\] \\[cases/ha/ha\\] endpoint network 172.17.105.0/24\n\n    2016-02-29T08:10:36,155679Z \\[DEBUG\\] \\[cases/ha/ha\\] Authenticated\n\n    2016-02-29T08:10:36,222075Z \\[INFO\\] \\[cases/ha/ha\\] Site already exists: 409: {\"id\":\"conflict\",\"message\":\"172.17.105.0/24 conflicts with the following site site1(172.17.105.0/24)\"}, pass\n\n    2016-02-29T08:10:36,233048Z \\[DEBUG\\] \\[cases/ha/ha\\] Site id: b784ffad-86d6-47b1-ad34-e3f7633cc0e1\n\n    2016-02-29T08:10:36,233433Z \\[DEBUG\\] \\[cases/ha/ha\\] Added ippool testing\\_ipv4\n\n    2016-02-29T08:10:36,326277Z \\[DEBUG\\] \\[cases/ha/ha\\] Added ippool testing\\_ipv6\n\n    2016-02-29T08:10:36,385310Z \\[DEBUG\\] \\[cases/ha/ha\\] Added ldap cvk60\n\n    2016-02-29T08:10:36,386252Z \\[DEBUG\\] \\[cases/ha/ha\\] Authenticated\n\n    2016-02-29T08:10:36,386514Z \\[DEBUG\\] \\[cases/ha/ha\\] Added entitlement to access TCP over 2222\n\n    2016-02-29T08:10:36,637922Z \\[DEBUG\\] \\[cases/ha/ha\\] Added policy\n\n    2016-02-29T08:10:36,638176Z \\[DEBUG\\] \\[cases/ha/ha\\] Starting Tunservice\n\n    2016-02-29T08:10:36,638592Z \\[INFO\\] \\[cases/ha/ha\\] Calling command: sudo stdbuf --output=L /home/adminuser/stratus-tests/scenarios/../artifacts/tun-service/linux/tun-service.sh -d -v\n\n    2016-02-29T08:10:36,643130Z \\[DEBUG\\] \\[cases/ha/ha\\] Tunservice is started...\n\n    2016-02-29T08:10:36,643660Z \\[INFO\\] \\[cases/ha/ha\\] Calling command: stdbuf --output=L /home/adminuser/stratus-tests/scenarios/../artifacts/client\\_daemon/linux/client\\_daemon.sh --log-level debug -p 29005\n\n    2016-02-29T08:10:36,653777Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-02-29T09:10:36.652Z\\] Info : tun\\_loop\\_init, version 1.1.0-866-552, Feb 27 2016, 07:28:51\n\n    2016-02-29T08:10:36,655047Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-02-29T09:10:36.655Z\\] Info : Using OpenSSL 1.0.2f  28 Jan 2016 (0x1000206f)\n\n    2016-02-29T08:10:36,655286Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-02-29T09:10:36.655Z\\] Info : Dir: /home/adminuser/stratus-tests/artifacts/tun-service/linux/bin\n\n    2016-02-29T08:10:36,655461Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-02-29T09:10:36.655Z\\] Warn : reset\\_dns is not executable\n\n    2016-02-29T08:10:36,655692Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-02-29T09:10:36.655Z\\] Info : Starting client control channel on 127.0.0.1:7269\n\n    2016-02-29T08:10:36,655849Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-02-29T09:10:36.655Z\\] Info : Starting event loop\n\n    2016-02-29T08:10:36,656318Z \\[INFO\\] \\[cases/ha/ha\\] Starting the websocket connection to ws://127.0.0.1:29005/live\n\n    2016-02-29T08:10:36,658264Z \\[INFO\\] \\[cases/ha/ha\\] Error occurred on websocket connection. Will try again. Error: \\[Errno 111\\] Connection refused\n\n    2016-02-29T08:10:36,732617Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.6959680Z ClientDaemon, Version=1.1.0.846, Culture=neutral, PublicKeyToken=null 1.1.0-846-dev\n\n    2016-02-29T08:10:36,733335Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] ClientDaemon, Version=1.1.0.846, Culture=neutral, PublicKeyToken=null 1.1.0-846-dev\n\n    2016-02-29T08:10:36,733642Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,733861Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,773815Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.7733660Z Info - \\[BusinessLogic - Start\\] Process starting.\n\n    2016-02-29T08:10:36,777561Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[BusinessLogic - Start\\] Process starting.\n\n    2016-02-29T08:10:36,778009Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,778260Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,966566Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9664030Z Debug - \\[HttpRequestReader - CheckPayload:63\\] \\[HttpRequest: Method=Get, Headers=Cryptzone.Shared.Http.Header.HttpHeaderDictionary, Body=\\]\n\n    2016-02-29T08:10:36,967110Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[HttpRequestReader - CheckPayload:63\\] \\[HttpRequest: Method=Get, Headers=Cryptzone.Shared.Http.Header.HttpHeaderDictionary, Body=\\]\n\n    2016-02-29T08:10:36,967478Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,967738Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,971215Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9710720Z Debug - \\[HttpResponseWriter - WriteResponse:25\\] -> HTTP/1.1 101 Switching Protocols\n\n    2016-02-29T08:10:36,971592Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Connection: Upgrade\n\n    2016-02-29T08:10:36,971876Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Upgrade: websocket\n\n    2016-02-29T08:10:36,971930Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Sec-WebSocket-Accept: LzSKTiFYPI1W2sjZJcFc0lSdKT0=\n\n    2016-02-29T08:10:36,972054Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Content-Length: 0\n\n    2016-02-29T08:10:36,972207Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,972360Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,972552Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[HttpResponseWriter - WriteResponse:25\\] -> HTTP/1.1 101 Switching Protocols\n\n    2016-02-29T08:10:36,972597Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Connection: Upgrade\n\n    2016-02-29T08:10:36,972627Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Upgrade: websocket\n\n    2016-02-29T08:10:36,972653Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Sec-WebSocket-Accept: LzSKTiFYPI1W2sjZJcFc0lSdKT0=\n\n    2016-02-29T08:10:36,972799Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Content-Length: 0\n\n    2016-02-29T08:10:36,972838Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,973098Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,973289Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,973422Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,980179Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9790550Z Info - \\[LiveLogic - Start\\] UI has connected to service.\n\n    2016-02-29T08:10:36,980601Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LiveLogic - Start\\] UI has connected to service.\n\n    2016-02-29T08:10:36,981114Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,982466Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,984706Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9830950Z Debug - \\[LiveLogic - SendUiRootModel:209\\] \\[SendUiRootModel\\]\n\n    2016-02-29T08:10:36,984706Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LiveLogic - SendUiRootModel:209\\] \\[SendUiRootModel\\]\n\n    2016-02-29T08:10:36,984743Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,985897Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,987371Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9872570Z Debug - \\[ActionCenter - GetPendingConsumerActions:131\\] \\[GetPendingConsumerActions\\]\n\n    2016-02-29T08:10:36,988528Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - GetPendingConsumerActions:131\\] \\[GetPendingConsumerActions\\]\n\n    2016-02-29T08:10:36,988847Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9879260Z Debug - \\[LiveApp - StartServiceConnectionEx:69\\] UI connection has started\n\n    2016-02-29T08:10:36,989108Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,989404Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,992761Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:36.9925990Z Debug - \\[JsonRpcWorker - RequestWithObjectTask:221\\] Sending RPC request 'smackbone.save' with I '1' to 'Smackbone'.\n\n    2016-02-29T08:10:36,993235Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LiveApp - StartServiceConnectionEx:69\\] UI connection has started\n\n    2016-02-29T08:10:36,993616Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,993876Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,996122Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:221\\] Sending RPC request 'smackbone.save' with I '1' to 'Smackbone'.\n\n    2016-02-29T08:10:36,996608Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:36,997047Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,106588Z \\[INFO\\] \\[cases/ha/ha\\] Websocket connection is successful and ready to proceed.\n\n    2016-02-29T08:10:37,109810Z \\[INFO\\] \\[cases/ha/ha\\] Login request to \"envy-172-17-104-1.devops\" with provider name \"cvk60\" and username \"stratus4000\".\n\n    2016-02-29T08:10:37,127730Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1262410Z Info - \\[LiveLogic - Ready\\] UI is ready.\n\n    2016-02-29T08:10:37,127977Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LiveLogic - Ready\\] UI is ready.\n\n    2016-02-29T08:10:37,128182Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,128444Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,128677Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1264080Z Debug - \\[ActionCenter - Ready:117\\] \\[Ready\\]\n\n    2016-02-29T08:10:37,128743Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - Ready:117\\] \\[Ready\\]\n\n    2016-02-29T08:10:37,128862Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,128902Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,129485Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1265190Z Debug - \\[ActionCenter - NotifyOnReady:239\\] \\[NotifyOnReady\\]\n\n    2016-02-29T08:10:37,129551Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - NotifyOnReady:239\\] \\[NotifyOnReady\\]\n\n    2016-02-29T08:10:37,129588Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,129728Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,129781Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1266170Z Info - \\[BusinessLogic - HandleOnReady\\] UI is ready to login.\n\n    2016-02-29T08:10:37,130005Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[BusinessLogic - HandleOnReady\\] UI is ready to login.\n\n    2016-02-29T08:10:37,130085Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,130386Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,193394Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1884860Z Debug - \\[BusinessLogic - Process:176\\] \\[ProcessLogic: \\_queuedState 'loggingin'\\]\n\n    2016-02-29T08:10:37,193523Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[BusinessLogic - Process:176\\] \\[ProcessLogic: \\_queuedState 'loggingin'\\]\n\n    2016-02-29T08:10:37,193572Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,193790Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,193844Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1891810Z Debug - \\[BusinessLogic - UpdateInternalState:266\\] \\[UpdateInternalState: newLogicState 'loggingin', prev 'idle'\\]\n\n    2016-02-29T08:10:37,194103Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[BusinessLogic - UpdateInternalState:266\\] \\[UpdateInternalState: newLogicState 'loggingin', prev 'idle'\\]\n\n    2016-02-29T08:10:37,194348Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,194507Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,194550Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1902660Z Info - \\[LoginLogic - StartLoginProcess\\] Login process has started.\n\n    2016-02-29T08:10:37,194742Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LoginLogic - StartLoginProcess\\] Login process has started.\n\n    2016-02-29T08:10:37,194868Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,194907Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,195088Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1914190Z Info - \\[LoginLogic - StartLoginProcess\\] Not enough data to login. Waiting for UI...\n\n    2016-02-29T08:10:37,195224Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LoginLogic - StartLoginProcess\\] Not enough data to login. Waiting for UI...\n\n    2016-02-29T08:10:37,195520Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,195710Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,195764Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1914970Z Debug - \\[LoginLogic - StartLoginProcess:167\\] \\[StartLoginProcess: loginWithUi '#NULL#'\\]\n\n    2016-02-29T08:10:37,195893Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LoginLogic - StartLoginProcess:167\\] \\[StartLoginProcess: loginWithUi '#NULL#'\\]\n\n    2016-02-29T08:10:37,196038Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,196079Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,196192Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1918830Z Debug - \\[ActionCenter - RequestNewInput:142\\] \\[RequestNewInput: RequestNewInput\\]\n\n    2016-02-29T08:10:37,196231Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - RequestNewInput:142\\] \\[RequestNewInput: RequestNewInput\\]\n\n    2016-02-29T08:10:37,196464Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,196505Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,196680Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1921070Z Debug - \\[ActionCenter - NotifyOnPendingConsumerActionsUpdated:251\\] \\[NotifyOnPendingConsumerActionsUpdated\\]\n\n    2016-02-29T08:10:37,196803Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - NotifyOnPendingConsumerActionsUpdated:251\\] \\[NotifyOnPendingConsumerActionsUpdated\\]\n\n    2016-02-29T08:10:37,196972Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,197025Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,197215Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1921590Z Debug - \\[LiveLogic - SendUiRootModel:209\\] \\[SendUiRootModel\\]\n\n    2016-02-29T08:10:37,197297Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LiveLogic - SendUiRootModel:209\\] \\[SendUiRootModel\\]\n\n    2016-02-29T08:10:37,197365Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,197422Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,197472Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1922520Z Debug - \\[ActionCenter - GetPendingConsumerActions:131\\] \\[GetPendingConsumerActions\\]\n\n    2016-02-29T08:10:37,197519Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - GetPendingConsumerActions:131\\] \\[GetPendingConsumerActions\\]\n\n    2016-02-29T08:10:37,197570Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,197612Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,198801Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1986260Z Debug - \\[TaskContractManager - Contract:23\\] \\[Contract: loginAction\\]\n\n    2016-02-29T08:10:37,199026Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[TaskContractManager - Contract:23\\] \\[Contract: loginAction\\]\n\n    2016-02-29T08:10:37,199258Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,199409Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,199982Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.1998820Z Debug - \\[JsonRpcWorker - RequestWithObjectTask:221\\] Sending RPC request 'smackbone.save' with I '2' to 'Smackbone'.\n\n    2016-02-29T08:10:37,200213Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:221\\] Sending RPC request 'smackbone.save' with I '2' to 'Smackbone'.\n\n    2016-02-29T08:10:37,200448Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,200608Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,207371Z \\[INFO\\] \\[cases/ha/ha\\] Sent login request to daemon.\n\n    2016-02-29T08:10:37,213501Z \\[INFO\\] \\[cases/ha/ha\\] The daemon got this controller url for the first time, and validated it. Sending it again to actually connect to the service\n\n    2016-02-29T08:10:37,219493Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.2192490Z Debug - \\[LiveLogic - FeedTask:146\\] \\[FeedTask: loginAction\\]\n\n    2016-02-29T08:10:37,220254Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LiveLogic - FeedTask:146\\] \\[FeedTask: loginAction\\]\n\n    2016-02-29T08:10:37,220783Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,221112Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,233127Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.2329040Z Debug - \\[LiveLogic - LoginResponse:82\\] \\[LoginResponse\\]\n\n    2016-02-29T08:10:37,234447Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LiveLogic - LoginResponse:82\\] \\[LoginResponse\\]\n\n    2016-02-29T08:10:37,234975Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,235372Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,236216Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.2360880Z Info - \\[LoginLogic - StartLoginProcess\\] Login input received. Controller Url: envy-172-17-104-1.devops, Provider Name: cvk60, Username: stratus4000\n\n    2016-02-29T08:10:37,236439Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LoginLogic - StartLoginProcess\\] Login input received. Controller Url: envy-172-17-104-1.devops, Provider Name: cvk60, Username: stratus4000\n\n    2016-02-29T08:10:37,236664Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,236865Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,316913Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.3167440Z Info - \\[LoginLogic - ValidateoLoginInputFromUi\\] A new controller URL is entered. #NULL# -> ["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/](https://envy-172-17-104-1.devops/)"
                },
                {
                  "type": "text",
                  "text": "\n\n    2016-02-29T08:10:37,317250Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LoginLogic - ValidateoLoginInputFromUi\\] A new controller URL is entered. #NULL# -> ["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/](https://envy-172-17-104-1.devops/)"
                },
                {
                  "type": "text",
                  "text": "\n\n    2016-02-29T08:10:37,317475Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,317619Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,318336Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.3182420Z Debug - \\[LoginLogic - TrySetControllerUrl:284\\] \\[TrySetControllerUrl: LoggingIn\\]\n\n    2016-02-29T08:10:37,318502Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LoginLogic - TrySetControllerUrl:284\\] \\[TrySetControllerUrl: LoggingIn\\]\n\n    2016-02-29T08:10:37,318707Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,318844Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,319137Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.3190670Z Info - \\[LoginLogic - TrySetControllerUrl\\] Setting controller URL ["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/](https://envy-172-17-104-1.devops/)"
                },
                {
                  "type": "text",
                  "text": "\n\n    2016-02-29T08:10:37,319298Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LoginLogic - TrySetControllerUrl\\] Setting controller URL ["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/](https://envy-172-17-104-1.devops/)"
                },
                {
                  "type": "text",
                  "text": "\n\n    2016-02-29T08:10:37,319491Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,319639Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-02-29T08:10:37,320300Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-02-29T08:10:37.3202070Z Debug - \\[ControllerLogic - SetControllerUrl:139\\] \\[SetControllerUrl: hostInfo '["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/'](https://envy-172-17-104-1.devops/')\\]"
                },
                {
                  "type": "text",
                  "text": "\n\n    2016-02-29T08:10:37,320496Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ControllerLogic - SetControllerUrl:139\\] \\[SetControllerUrl: hostInfo '["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/'](https://envy-172-17-104-1.devops/')\\]"
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/](https://envy-172-17-104-1.devops/)"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " Provider Name: cvk60, Username: stratus4000\n\n    2016-02-29T08:10:37,735044Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[LoginLogic - TryLoginUser\\] Successfully logged in. Storing settings. Url: ["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-104-1.devops/](https://envy-172-17-104-1.devops/)"
                },
                {
                  "type": "text",
                  "text": ","
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1456913947610
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This problem has changed abit. This testcase is actually working.. but its not very stable. If i insert a sleep between the killing of vpnds and trying the ssh connection again, with a new command, then it feels more stable.. 10 sek seems to be a \"OK\" number.. If its lower then the testcase fails... with a connection RST."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A Case when it does not work"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "T10:19:53,444577Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-03-03T10:19:53.4410360Z Info - \\[BusinessLogic - UpdateInternalState\\] Everything is in order. Connected to all gateways.\n\n    2016-03-03T10:19:53,444811Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Info - \\[BusinessLogic - UpdateInternalState\\] Everything is in order. Connected to all gateways.\n\n    2016-03-03T10:19:53,444944Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,445082Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,445124Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-03-03T10:19:53.4410820Z Debug - \\[LiveLogic - SendUiRootModel:209\\] \\[SendUiRootModel\\]\n\n    2016-03-03T10:19:53,445388Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[LiveLogic - SendUiRootModel:209\\] \\[SendUiRootModel\\]\n\n    2016-03-03T10:19:53,445559Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,445599Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,445629Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-03-03T10:19:53.4411890Z Debug - \\[ActionCenter - GetPendingConsumerActions:131\\] \\[GetPendingConsumerActions\\]\n\n    2016-03-03T10:19:53,445742Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[ActionCenter - GetPendingConsumerActions:131\\] \\[GetPendingConsumerActions\\]\n\n    2016-03-03T10:19:53,445908Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,445946Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,445973Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] 2016-03-03T10:19:53.4412380Z Debug - \\[JsonRpcWorker - RequestWithObjectTask:217\\] Sending RPC request 'smackbone.save' with I '19' to 'Smackbone'.\n\n    2016-03-03T10:19:53,446001Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\] Debug - \\[JsonRpcWorker - RequestWithObjectTask:217\\] Sending RPC request 'smackbone.save' with I '19' to 'Smackbone'.\n\n    2016-03-03T10:19:53,446114Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:53,446275Z \\[STREAM\\] \\[cases/ha/ha\\] \\[client\\_daemon/stdout\\]\n\n    2016-03-03T10:19:54,403949Z \\[DEBUG\\] \\[cases/ha/ha\\] stopping service with name : cz-vpnd INSTANCE=4\n\n    2016-03-03T10:19:54,404130Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' stop cz-vpnd INSTANCE=4\n\n    2016-03-03T10:19:54,426114Z \\[DEBUG\\] \\[cases/ha/ha\\] Giving it some time to complete the handover.. this makes it more stable\n\n    2016-03-03T10:19:59,429367Z \\[DEBUG\\] \\[cases/ha/ha\\] ##################### TRYING SSH CONNECTION after handover\n\n    2016-03-03T10:19:59,429935Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: whoami\n\nSocket exception: Connection reset by peer (104)\n\n    2016-03-03T10:19:59,433370Z \\[DEBUG\\] \\[cases/ha/ha\\] Starting service with name: cz-vpnd INSTANCE=0\n\n    2016-03-03T10:19:59,433679Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' status cz-vpnd INSTANCE=0\n\n    2016-03-03T10:19:59,456331Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' start cz-vpnd INSTANCE=0\n\n    2016-03-03T10:19:59,528108Z \\[DEBUG\\] \\[cases/ha/ha\\] Starting service with name: cz-vpnd INSTANCE=1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When it does work :"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "    2016-03-03T10:14:59,856044Z \\[DEBUG\\] \\[cases/ha/ha\\] stopping service with name : cz-vpnd INSTANCE=0\n\n    2016-03-03T10:14:59,856311Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: sudo -S -p '' stop cz-vpnd INSTANCE=0\n\n    2016-03-03T10:14:59,959567Z \\[DEBUG\\] \\[cases/ha/ha\\] Giving it some time to complete the handover.. this makes it more stable\n\n    2016-03-03T10:15:09,300535Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-03-03T11:15:09.300Z\\] Debug : Sending ping, unacked=0\n\n    2016-03-03T10:15:09,966989Z \\[DEBUG\\] \\[cases/ha/ha\\] ##################### TRYING SSH CONNECTION after handover\n\n    2016-03-03T10:15:09,967431Z \\[DEBUG\\] \\[cases/ha/ha\\] SshClient: Calling command: whoami\n\n    2016-03-03T10:15:09,969950Z \\[STREAM\\] \\[cases/ha/ha\\] \\[tun-service/stdout\\] \\[2016-03-03T11:15:09.969Z\\] Debug : Got pong size: 4/0\n\n    2016-03-03T10:15:10,015786Z \\[DEBUG\\] \\[cases/ha/ha\\] Output = ubuntu\n\n    2016-03-03T10:15:10,016499Z \\[INFO\\] \\[cases/ha/ha\\] Logging out\n\n    2016-03-03T10:15:10,016934Z \\[INFO\\] \\[cases/ha/ha\\] Logout request sent. Waiting for client to complete."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1457000672689
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[Per Allansson]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"per.allansson\") "
                },
                {
                  "type": "text",
                  "text": "Per Leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                        "title": "per.leino"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " What is the status on this?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1457943369978
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "My intention was to look at it when tests were more stable. Guess they are now."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1457943868776
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "From Kurt, having the same issue on Windows: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2016-03-15T19:34:31.271Z\\] Debug : vpn\\_client\\_close: HA test network Dead connection detected\n\n\\[2016-03-15T19:34:31.287Z\\] Info : Sending <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"clientdeploy\", \"sites\": { \"HA test network\": {\"gw-id\": \"4db4953e-47eb-494f-9743-98bcb1a0c468\", \"status\": \"down\", \"error\": \"Dead connection detected\"}} } }\n\n\\>\n\n\\[2016-03-15T19:34:31.314Z\\] Info : Initiating connection to TLS://192.168.1.140:443\n\n\\[2016-03-15T19:34:31.316Z\\] Info : Verification enabled for gw1.glk.local\n\n\\[2016-03-15T19:34:31.318Z\\] Debug : vpn\\_client\\_close\\_final: HA test network\n\n\\[2016-03-15T19:34:32.271Z\\] Debug : Server certificate SN: gw1.glk.local\n\n\\[2016-03-15T19:34:32.284Z\\] Info : TLS://192.168.1.140:443: Connected (969ms)\n\n\\[2016-03-15T19:34:32.299Z\\] Debug : Cipher: ECDHE-RSA-AES256-GCM-SHA384\n\n\\[2016-03-15T19:34:32.301Z\\] Info : Sending <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"clientdeploy\", \"sites\": { \"HA test network\": {\"gw-id\": \"bed9c228-ca3a-4122-b03d-9127fc6a5a5a\", \"host\": \"gw1.glk.local\", \"ip\": \"192.168.1.140\", \"status\": \"connected\"}} } }\n\n\\>\n\n\\[2016-03-15T19:34:32.982Z\\] Info : TLS://192.168.1.140:443: Tunnel up (1672ms)\n\n\\[2016-03-15T19:34:32.986Z\\] Debug : Route already added\n\n\\[2016-03-15T19:34:32.987Z\\] Info : Sending <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"clientdeploy\", \"sites\": { \"HA test network\": {\"gw-id\": \"bed9c228-ca3a-4122-b03d-9127fc6a5a5a\", \"host\": \"gw1.glk.local\", \"ip\": \"192.168.1.140\", \"status\": \"up\"}} } }\n\n\\>\n\n\\[2016-03-15T19:34:32.996Z\\] Debug : Sending blob, size: 184\n\n\\[2016-03-15T19:34:32.998Z\\] Debug : Storing blob, size: 184"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1458114291965
      }
    ]
  },
  {
    "key": "SA-2384",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Probably due to low timeout setting."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2016-01-27T15:25:14.751Z Info : \\[GatewayLogic\\] Logging out of gateway '["
            },
            {
              "type": "text",
              "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\n2016-01-27T15:25:14.756Z Warn : \\[GatewayLogic\\] Logout to gateway 'Couldn't connect to 'POST:/session/logout/'' has failed. Reason: \n\n2016-01-27T15:25:14.763Z Info : \\[GatewayLogic\\] Logging out of gateway '["
            },
            {
              "type": "text",
              "text": "https://sa1.cryptzone.com/'](https://sa1.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\n2016-01-27T15:25:14.765Z Warn : \\[GatewayLogic\\] Logout to gateway 'Couldn't connect to 'POST:/session/logout/'' has failed. Reason: \n\n2016-01-27T15:25:14.769Z Info : \\[BusinessLogic\\] Logout done."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Yet the user is removed from dashboard."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This will be actually obsolete when we get rid of gateway REST interface. But keeping it here for known issues for the time being."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1454065938467
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Actually, this won't be in the known issues. So, obsolete."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1454065962041
      }
    ]
  },
  {
    "key": "SA-2143",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Hibernated at 23{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "50}}57 UTC yesterday, started at 19{{COLON"
            },
            {
              "type": "text",
              "text": "NUM",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "09}}32.530 UTC today."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "[^image.png]"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "but I have no connection."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Shared: 1.0.0.334\n\nService: 1.0.0.721"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Logs:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2015-12-10T23:50:54.065Z Debug : \\[JsonRpcWorker\\] Sending RPC request 'ping' with I '4841' to 'Tun Driver'.\n\n2015-12-10T23:50:57.065Z Debug : \\[JsonRpcWorker\\] Sending RPC request 'ping' with I '4842' to 'Tun Driver'.\n\n2015-12-10T23:50:57.760Z Debug : \\[JsonRpcWorker\\] Received notification \\[Notification:disconnected:System.Object\\[\\]\\]\n\n2015-12-10T23:50:57.764Z Debug : \\[TunDriverCommunication\\] OnDisconnected:\\[VpnId: 9e9ea215-3fe7-4885-a247-99b6cc3216ed\\] reason:\n\n2015-12-10T23:50:57.768Z Debug : \\[TunDriver\\] \\[HandleOnVpnDisconnected: vpn '\\[VpnConfigAndRoutes: VpnId='\\[VpnId: 9e9ea215-3fe7-4885-a247-99b6cc3216ed\\]' Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
            },
            {
              "type": "text",
              "text": "https://sa1.cryptzone.com/'](https://sa1.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " AllocatedIpv4 '192.168.100.95', AllocatedIpv6 '', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\]', disconnectionReason 'Suspended'\\]\n\n2015-12-10T23:50:57.773Z Warn : \\[TunDriverLogic\\] TUN Driver has disconnected from VPN server at '["
            },
            {
              "type": "text",
              "text": "https://sa1.cryptzone.com/'](https://sa1.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": " Reason: Unknown\n\n2015-12-10T23:50:57.778Z Debug : \\[JsonRpcWorker\\] Received notification \\[Notification:disconnected:System.Object\\[\\]\\]\n\n2015-12-10T23:50:57.787Z Debug : \\[TunDriverCommunication\\] OnDisconnected:\\[VpnId: 870ccb60-79fc-4a5a-a611-d391bf768cbd\\] reason:\n\n2015-12-10T23:50:57.791Z Debug : \\[TunDriver\\] \\[HandleOnVpnDisconnected: vpn '\\[VpnConfigAndRoutes: VpnId='\\[VpnId: 870ccb60-79fc-4a5a-a611-d391bf768cbd\\]' Routes=System.Collections.Generic.List\\`1\\[Cryptzone.Stratus.Base.types.ip.Route\\], Config=Url '["
            },
            {
              "type": "text",
              "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " AllocatedIpv4 '192.168.100.95', AllocatedIpv6 '', DnsServers 'System.Collections.Generic.List\\`1\\[System.String\\]', DnsSearchDomains 'System.Collections.Generic.List\\`1\\[System.String\\]'\\]', disconnectionReason 'Suspended'\\]\n\n2015-12-10T23:50:57.796Z Warn : \\[TunDriverLogic\\] TUN Driver has disconnected from VPN server at '["
            },
            {
              "type": "text",
              "text": "https://sa2.cryptzone.com/'](https://sa2.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": " Reason: Unknown\n\n2015-12-11T19:09:32.530Z Debug : \\[OpenSslSocket\\] Service Listener  H115500512 \\[\\[41\\]\\] : Dispose Service Listener\n\n2015-12-11T19:09:32.672Z Debug : \\[JsonRpcWorker\\] Sending RPC request 'ping' with I '4843' to 'Tun Driver'.\n\n2015-12-11T19:09:32.657Z Debug : \\[OpenSslSocket\\] TunDriverConnection  (127.0.0.1:7269) H117092608 \\[\\[49\\]\\] : Dispose TunDriverConnection\n\n2015-12-11T19:09:33.514Z Debug : \\[OpenSslSocket\\] TunDriverConnection  (127.0.0.1:7269) H0 \\[\\[49\\]\\] : Read: Connection failed: octetsRead '-1'. closing...\n\n2015-12-11T19:09:33.514Z Debug : \\[OpenSslSocket\\] TunDriverConnection  (127.0.0.1:7269) H0 \\[\\[48\\]\\] : Send: error octetswritten '-1' not equal to data.Length '45'\n\n2015-12-11T19:09:33.524Z Debug : \\[JsonRpcWorker\\] Connection lost.\n\n2015-12-11T19:09:33.612Z Debug : \\[OpenSslSocket\\] Service Listener  H0 \\[\\[41\\]\\] : Read: Connection failed: octetsRead '0'. closing...\n\n2015-12-11T19:09:33.646Z "
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-2117",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Steps to reproduce:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Install RC1 client"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Login with your LDAP credentials to sa1.cryptzone.com"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Logout and run uninstaller"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Restart computer"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Both root and user preferences (partially) are still there:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "defaults read com.cryptzone.appgate.xdp.service.plist\n\n{\n\n    \"controller\\_url\" = \"["
                    },
                    {
                      "type": "text",
                      "text": ";"
                    },
                    {
                      "type": "text",
                      "text": "\n\n}\n\nsudo defaults read com.cryptzone.appgate.xdp.service.plist\n\n{\n\n    \"tunservice\\_url\" = \"[telnet://127.0.0.1:7269/](telnet://127.0.0.1:7269/)\";\n\n}"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Solution might be to add these to uninstaller script:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "defaults delete com.cryptzone.appgate.xdp.service.plist\n\nsudo defaults delete com.cryptzone.appgate.xdp.service.plist"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-2098",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Envy is the new environment handler for the \"toolchain\"."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Envy will need to be modular and well designed so we can support flexible scenarios with multiple VM vendors."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "My idea is to rewrite the POC and make the service easily extendable, for instance if we need to support different tools than Terraform (which I hope won't be the case)."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "How envy will work"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will be made up of few components."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Main components"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The main envy process will spawn two subprocesses."
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  "
                        },
                        {
                          "type": "text",
                          "text": "API",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " - Will handle incoming requests in jsonrpc format and dispatch them to a "
                        },
                        {
                          "type": "text",
                          "text": "HandlerHelper",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  "
                        },
                        {
                          "type": "text",
                          "text": "Bookkeeping",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " - Will take care of managing which networks are available in our local environment (vmware). It won't care about cloud providers. (Or was this something "
                        },
                        {
                          "type": "text",
                          "text": "testyd",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " was going to take care of "
                        },
                        {
                          "type": "text",
                          "text": "Aitor Iturri",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "http://got-youtrack.agi.appgate.com:8112/users/aitor.iturri",
                                "title": "aitor.iturri"
                              }
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " ?)"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Plugin components"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Handlers",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will be supported as plugins. To start with we will only have one handler, "
                },
                {
                  "type": "text",
                  "text": "TerraformHandler",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Handlers",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " must satisfy certain public interfaces."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Scenarios"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Every "
                },
                {
                  "type": "text",
                  "text": "Handler",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " must be able to support all the available scenarios."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We need to make "
                },
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " pretty flexible when it comes to scenarios. However, we can't design it in a way that makes it too complicated to handle. For instance, "
                },
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " shouldn't care about anything that already exists in AWS when spawning up an environment there. For example, we will not support spawning up the scenario into an already existing VPC. We will always start from scratch, by creating the VPC, etc., and then we clean up after ourselves."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will generate the Terraform formulas \"on the fly\" - meaning, it will programmatically generate formulas in json format, instead of the default Terraform format (Terraform supports json for formulas as well)."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Scenario definition"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A suggested format for scenario definition. Each provider is very unique - but the API interface must be able to hide all the details."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For example, let's say we want to create a scenario that will be labelled "
                },
                {
                  "type": "text",
                  "text": "Hax",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " ("
                },
                {
                  "type": "text",
                  "text": "scenarios/hax.json",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")."
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  vmware"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  One appliance running controller and gateway."
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  One endpoint running linux."
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  One endpoint running Windows."
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  AWS"
                        }
                      ]
                    },
                    {
                      "type": "bulletList",
                      "content": [
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  One appliance running a gateway."
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  One endpoint running linux."
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "listItem",
                          "content": [
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "  One endpoint running Windows."
                                }
                              ]
                            },
                            {
                              "type": "codeBlock",
                              "attrs": {},
                              "content": [
                                {
                                  "type": "text",
                                  "text": "{\n\n\"providers\": \\[\n\n{\n\n\"vendor\": \"vmware\",\n\n\"vms\": \\[\n\n{\n\n\"label\": \"controller\",\n\n\"image\": \"["
                                },
                                {
                                  "type": "text",
                                  "text": ","
                                },
                                {
                                  "type": "text",
                                  "text": "\n\n\"controller\": true,\n\n\"gateway\": true\n\n},\n\n{\n\n\"label\": \"linux\",\n\n\"image\": \"vmware-template-name\",\n\n\"endpoint\": true\n\n},\n\n{\n\n\"label\": \"windows\",\n\n\"image\": \"vmware-template-name\",\n\n\"endpoint\": true\n\n}\n\n\\]\n\n},\n\n{\n\n\"vendor\": \"aws\",\n\n\"vms\": \\[\n\n{\n\n\"label\": \"gateway\",\n\n\"image\": \"ami-id\",\n\n\"gateway\": true,\n\n\"register-with\": \"vmware/controller\"\n\n},\n\n{\n\n\"label\": \"linux\",\n\n\"image\": \"ami-id\",\n\n\"endpoint\": true\n\n},\n\n{\n\n\"label\": \"windows\",\n\n\"image\": \"ami-id\",\n\n\"endpoint\": true\n\n}\n\n\\]\n\n}\n\n\\]\n\n}"
                                }
                              ]
                            },
                            {
                              "type": "paragraph",
                              "content": [
                                {
                                  "type": "text",
                                  "text": "Ommitted bool fields will default to false.Connection and auth details for various providers will be saved locally so there is no need for the client to provide that to the API. The only thing that is required is to provide the API with a jsonrpc formatted request, an test/environments specific uuid and the scenario that should be created. In case of cleaning up environments, it would be enough to provide the API with the same test/environments uuid as was given when the environments were created."
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Reporting"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Create environments"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will report back to "
                },
                {
                  "type": "text",
                  "text": "testyd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " with exact details on every "
                },
                {
                  "type": "text",
                  "text": "vm",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " that was created."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will also report in case of a failure and tell "
                },
                {
                  "type": "text",
                  "text": "testyd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " what failed and where. "
                },
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will clean up in case of a failure."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Destroy environments"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will report back to "
                },
                {
                  "type": "text",
                  "text": "testyd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " when the environments have been destroyed."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "envy",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will also report in case of a failure and tell "
                },
                {
                  "type": "text",
                  "text": "testyd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " what failed and where."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "API payload"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Aitor Iturri",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/aitor.iturri",
                        "title": "aitor.iturri"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will provide suggestions regarding the jsonrpc format. The only other parameter that is required is the name of the scenario when requesting new environments (I use plural since it might be many different environments, spanning multiple vendors, that are linked together into a single one)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1449498891474
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "scenario from a high level point of view is just a string, only envy knows about the scenario implementation."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1449499140895
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "also, we shouldn't use the jsonrpc uuid to register environments, testyd will provide an 'id' field inside the 'params'object, use the jsonrpc one only to reply to the same message."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1449499219395
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes I know. The scenario implementation is an envy detail. You will just provide the name of the scenario in the API request."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Regarding API requests. If envy will take care of keeping tracks of the networks that are available in our vmware setup, then you will always only have to provide the scenario name, nothing else. Otherwise you will have to provide the vlan to use."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1449499229810
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We need to support a way of retrieving the info from a scenario, dont know the extact format i will think on it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1449499255093
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes that is true (regarding the uuid)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1449499267529
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, that's the ideal scenario, envy taking care of networks."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1449499290549
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But read over the whole comment, the scenario details I'm suggesting there is how it will be stored in envy. We would then construct a response to testyd from those values when testyd asks for information about a scenario."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1449499384612
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The reason for this implementation detail here is to make sure I'm not forgetting anything and also to come up with suggestions on things. :-) The implementation details will not be exposed to testyd via the API. The API will be very simple to use."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kos",
        "created": 1449499452138
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will make this a story and you can create subtasks for it [Kristinn rn Sigursson]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/kos",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/kos"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"kos\") "
                },
                {
                  "type": "text",
                  "text": "Per Leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                        "title": "per.leino"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1449571664999
      }
    ]
  },
  {
    "key": "SA-1995",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The problem is that udev creates a mapping of nic names to mac addresses but we dont persist it so names CAN change at every reboot if there is no deterministic way to assign the nic names on that hardware."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This file in question is /etc/udev/rules.d/70-persistent-net.rules."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Workaround, after first boot do this to persist mapping:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "root"
            },
            {
              "type": "mention",
              "attrs": {
                "id": "b2",
                "text": "@b2"
              }
            },
            {
              "type": "text",
              "text": ":/home/cz# mount -o remount,rw /mnt/root-ro root"
            },
            {
              "type": "mention",
              "attrs": {
                "id": "b2",
                "text": "@b2"
              }
            },
            {
              "type": "text",
              "text": ":/home/cz# nano /mnt/root-rw/etc/udev/rules.d/70-persistent-net.rules - Change so that pluged-in 10 gigabit network are labled eth0 and eth1 root"
            },
            {
              "type": "mention",
              "attrs": {
                "id": "b2",
                "text": "@b2"
              }
            },
            {
              "type": "text",
              "text": ":/home/cz# cp /mnt/root-rw/etc/udev/rules.d/70-persistent-net.rules /mnt/root-ro/etc/udev/rules.d/70-persistent-net.rules root"
            },
            {
              "type": "mention",
              "attrs": {
                "id": "b2",
                "text": "@b2"
              }
            },
            {
              "type": "text",
              "text": ":/home/cz# mount -o remount,ro /mnt/root-ro"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I can suggest a few different solutions:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The enterprise solution"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We allow the option to specify a physical MAC address in the appliance config for each NIC, so that you can tie down the NIC names the way you want. Actually, if the assignment is random, even with a persistent file, the assignment on first boot might not match the numbering on the physical or virtual server!"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The cowardly solution"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Give up overlayfs."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The ugly solution"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Configd copies /etc/udev/rules.d/70-persistent-net.rules to /mnt/state/patches/xxx/etc/udev/rules.d/70-persistent-net.rules on startup. Will not persist across upgrades though, and will not pick up changes if NICs are added."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The half-ugly solution"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Extract the assignments and save in local.json on first boot, then compile the rules file from config. Will not pick up changes if NICs are added."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The proper solution"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fix Linux/Debian/Ubuntu, wherever this comes from? Is there really no notion of NIC order on the hardware level?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1448549827792
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "http://linux.dell.com/files/whitepapers/nic-enum-whitepaper.pdf",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://linux.dell.com/files/whitepapers/nic-enum-whitepaper.pdf"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1448550188421
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Some hints on how to change order at runtime: "
                },
                {
                  "type": "text",
                  "text": "http://retrospekt.dk/2012/02/persistant-enumeration-of-network-interfaces-across-hardware-addresses/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://retrospekt.dk/2012/02/persistant-enumeration-of-network-interfaces-across-hardware-addresses/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1448550461069
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We allow the option to specify a physical MAC address in the appliance config for each NIC, so that you can tie down the NIC names the way you want. Actually, if the assignment is random, even with a persistent file, the assignment on first boot might not match the numbering on the physical or virtual server!"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think that is what systemd does by default now so fixed in 16.04. They use interface names based on the mac address. The problem is that our whole configuration relies on names like eth0. We need to think if this is the right way to do it long term."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1448550778706
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fix Linux/Debian/Ubuntu, wherever this comes from? Is there really no notion of NIC order on the hardware level?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "That mostly depends on driver support I think. So there are two fixes: switch to systemd like ubuntu did or upgrade the NIC drivers for the physical appliance we support."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1448550834514
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is the document from systemd. Maybe it is usable with upstart as well since udev is part of the systemd project and we use udev."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "http://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1448550871047
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Good article explaining the problem: "
                },
                {
                  "type": "text",
                  "text": "http://lwn.net/Articles/356900/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://lwn.net/Articles/356900/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1448550925557
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Workaround, after first boot do this to persist mapping:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, that is the butt-ugly solution. It breaks the filesystem checksum. :-)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1448551619349
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This paragraph caught my attention in the Systemd article:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This combined policy is only applied as last resort. That means, if the system has biosdevname installed, it will take precedence. If the user has added udev rules which change the name of the kernel devices these will take precedence too. Also, any distribution specific naming schemes generally take precedence."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Apparently Ubuntu (at least some flavors of it) come with biosdevname preinstalled. It's not included in Ubuntu Core, so we would have to include it ourselves. It looks promising:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Device"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Embedded network interface (LOM)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "eth"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "em"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "PCI card network interface"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "eth[0123]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": ""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I had it already installed on my virtual Ubuntu Server, but for some reason it was not being used by the system. Googling for it I found:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://www.s3it.uzh.ch/blog/biosdevname/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.s3it.uzh.ch/blog/biosdevname/"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Further, [DELL1] states that new naming scheme kicks in if:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "SMBIOS has a version >= 2.6 and SMBIOS Type 9 and Type 41 tables are supported."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If the first point does not hold, it falls back to the IRQ Routing Table"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Well, it would be nice if the man page of biosdevname(1) or [DELL1] state a little more prominently, that "
                        },
                        {
                          "type": "text",
                          "text": "the new naming scheme is not used under any circumstances when running in a VM",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Apparently this software is written by Dell, for use with PowerEdge servers and nothing else, and the Ubuntu guys are discussing whether to use biosdevname on physical servers but ethN on other machines, as this creates inconsistency:"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "https://bugs.launchpad.net/ubuntu/+source/biosdevname/+bug/891258",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://bugs.launchpad.net/ubuntu/+source/biosdevname/+bug/891258"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "https://lists.ubuntu.com/archives/ubuntu-devel/2012-January/034687.html",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://lists.ubuntu.com/archives/ubuntu-devel/2012-January/034687.html"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "https://lists.ubuntu.com/archives/ubuntu-devel/2012-February/thread.html",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://lists.ubuntu.com/archives/ubuntu-devel/2012-February/thread.html"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "And by the way, even if we forcibly enabled biosdevname on virtual machines, it seems the numbering becomes unpredictable, whereas it is now predictable. The command-line tool says that my VM's NICs would be called p2p1, p7p1 and p8p1. How would I know that in advance?"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Indeed, someone writes:"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "https://bugs.launchpad.net/ubuntu/+source/biosdevname/+bug/1284043",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://bugs.launchpad.net/ubuntu/+source/biosdevname/+bug/1284043"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "None of the solutions works all the time. In a virtual machine with 10 nics, the booting algorithm changes the PCI number all the time, it seems, so we need to match the name via the mac address."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Also, if you read the last link above, biosdevname can be quite buggy."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "So in summary I think we should avoid using biosdevname, and instead use ethN or the systemd scheme, whatever the OS gives us, and at least for ethN we should allow selecting an interface by MAC address, as that seems to be the surest way."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1455879773074
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok, we could avoid this problem by upgrading the drivers for the specific NICs we will use for hardware appliances. For virtual appliances this problem does not seem to appear anyways."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1456133135585
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What difference would an updated driver make for the ordering?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1456134419543
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think the problem with undeterministic order only occurs if the driver doesn't have enough information to reliably order the NICs. We don't see it with most NICs we tried, only some particular (10Gbit) models."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1456142707479
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Interesting. Have we confirmed that the problem goes away on our performance testing machines if we use newer drivers? Also, will we have control over the hardware the customers are going to use, or will we distribute the XDP installer ISO, meaning that the customers can install on any machine?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1456151760463
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well we have only seen it happen on the hardware we use for performance testing, not on the hardware we plan on selling (at least so far, lets see what Kasper finds). I think the idea is that we only support the hardware that we sell. ISO are to be used by customers only for deploying virtual machines."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1456159005340
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Now I figured out why I never got the persistent-rules file in my VM's, it's because Ubuntu's script filters out VirtualBox NICs, so rules will not be autogenerated for these."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, I tried out Ubuntu Server 15.10 which has gone full systemd, and instead of eth0 I get enp0s3. This is another problem, since the NIC names need to be known in advance when creating a config to be exported. You can apparently configure systemd to use a different naming scheme."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think we need to decide how we want to handle NIC ordering and naming schemes, preferably come up with a solution which suits both 14.04 and 16.04. My suggestion is to stay with the ethN scheme (even in 16.04), but to let the admin (optionally) specify each ethN by MAC address. (It's not entirely straightforward though. For instance, if the MAC is specified for one NIC, it should be specified for all NICs, otherwise we have a mess.)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1456248871895
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [18:37]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "eth52:54:00:c8:00:1c",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " "
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [18:38]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this would mean that in the appliance ui, where you have "
                },
                {
                  "type": "text",
                  "text": "Name",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " for each NIC, that would stay the same ("
                },
                {
                  "type": "text",
                  "text": "eth0",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " etc), but you could have an extra field like "
                },
                {
                  "type": "text",
                  "text": "Select by MAC",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " where you can enter "
                },
                {
                  "type": "text",
                  "text": "52:54:00:c8:00:1c",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " or similar"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[18:38]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "then the appliance makes sure to map the "
                },
                {
                  "type": "text",
                  "text": "52:54:00:c8:00:1c",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " interface to "
                },
                {
                  "type": "text",
                  "text": "eth0",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [18:39]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah I guess that makes for the easiest solution"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tom Weber [18:41]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this would solve three problems:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "under 14.04, with physical nics, the order can change from boot to boot (because the generated map is not persisted)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "under 14.04, with physical nics, even with persistent file, the order at first boot is unpredictable, so a mismatch in the exported seed can easily brick the machine (the appliance and controller not being able to talk to each other)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "under 16.04 with systemd, the naming scheme is slightly unpredictable, especially in vm's (i get ens0p3, ens0p8... how should i know the phony pci bus numbers in advance?) (edited)"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [18:44]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Looks like a good solution for me"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:45]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "I assume we can create a list of Mac addresses in cz-setup that you can pick from?"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [18:45]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "cz-setup is not a problem, that can be automated"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [18:47]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "What about additional appliances? Once controller has been deployed (edited)"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [18:48]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "adding an appliance is the tedious part... if it's a physical one, the admin would have to know all the nic macs in advance and fill them in when creating the appliance config"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:49]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "i don't even know if the macs are usually readable on the backside of a multi-port card in a server"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [18:50]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Hmm that sounds not very userfriendly"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [18:50]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "it doesn't"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [18:50]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "What if we just pick an order for additional appliance and you could switch the order if needed afterwards?"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [18:52]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "suppose that the appliance has 8 ports and one of them can reach the controller. the right nic has to get the right settings (ip/subnet/gw/dhcp) before the appliance can talk to the controller"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:53]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "if that nic gets any other settings, or if the right settings are assigned to the wrong nic, the machines can't talk (edited)"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:53]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "so in that case you have a 1/8 chance of success, assuming the order is entirely random"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [18:54]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If it is not reachable nothing happens I guess. So you could switch the nic order and try again"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:55]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Just a menu that allows you to change nic ordering. Once connected it will do the seeding"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [18:57]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "aha, you mean to handle the ordering entirely in the appliance, not involving the controller?"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:57]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "that may actually be much better"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:57]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "it could be a local setting"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:57]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "just like log levels"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[18:59]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "it could be a submenu in cz-setup, where you get a list of nics with mac and 'cable plugged' status"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[19:00]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "we could even do something with blinking the leds on the nics"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Per Allansson [19:00]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "and remember that nics can be added or removed"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [19:00]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "sure"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Per Allansson [19:00]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "physically I mean"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[19:01]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "just so adding/removing a card keeps the ethX mappings"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [19:01]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Yes"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [19:02]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "hmm, depends on what behavior you want. suppose you have cards eth0, eth1 and eth2, and you remove eth1, do you want eth2 to shift down, or have a gap between 0 and 2?"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Per Allansson [19:03]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "gap"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [19:03]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "yep... especially since the appliance config in the ctrlr knows nothing about the changes"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Kurt Glazemakers [19:04]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "With the udev rules you will have a gap automatically and will need to reconfigure the mapping for eth1"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [19:05]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "so the local settings can map "
                        },
                        {
                          "type": "text",
                          "text": "MAC --> ethN",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " or maybe "
                        },
                        {
                          "type": "text",
                          "text": "ethN --> MAC",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ", and even if you remove a card, it will be remembered, the slot will be held for it until changed"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[19:05]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "mention",
                          "attrs": {
                            "id": "kurtglazemakers",
                            "text": "@kurtglazemakers"
                          }
                        },
                        {
                          "type": "text",
                          "text": ": true"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Jamie Bodley-Scott [19:06]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "mention",
                          "attrs": {
                            "id": "tom",
                            "text": "@tom"
                          }
                        },
                        {
                          "type": "text",
                          "text": ": when you are done thinking can you document the plan in a YT case pls"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "[19:07]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "I assume this needs to be done in R2 latest."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Tom Weber [19:07]"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "i'll paste this chat in the current ticket, close it and open a new one"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1456250905312
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [19:29]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "morse-signaling through the nic leds is optional"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[19:29]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "although supporting the HELLO-HERE-I-AM LED would be nice"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thomas Cellerier [19:31]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "oh a led driver!"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [19:31]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "oh I forgot we have Senior Led Driver Developer here"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Kurt Glazemakers [19:32]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [19:32]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "unfortunately its probably just a command line away "
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thomas Cellerier [19:33]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "emoji",
                  "attrs": {
                    "shortName": ":disappointed:"
                  }
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tom.weber",
        "created": 1456252468965
      }
    ]
  },
  {
    "key": "SA-247",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The purpose of the Teamcity monitor is, currently, to remove finished QA test runs from Teamcity."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We want to make some improvements."
            }
          ]
        },
        {
          "type": "orderedList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": " Keep the last X build configurations and their build logs (all or only the ones who failed?)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": " The program tends to crash because of some invalid parsing."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Copy/paste from logs, regarding the crash:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "kos@akira:~$ sudo zcat /var/log/upstart/teamcity-monitor.log.1.gz \n2015/04/26 03:57:02 Get https://github.salt:7byWJhSLVL8z@teamcity.cryptzone.ad:443/httpAuth/app/rest/builds/?locator=running%3Atrue: EOF\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value\n2015/04/27 04:01:40 invalid character '<' looking for beginning of value"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think is better to integrate on the toolchain, we can have a periodic task to clean the builds, we have currently the API to talk with TC so it's going to take less time and is better to have everything integrated in the same place and async."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1433168611124
      }
    ]
  },
  {
    "key": "SA-410",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Place a button on OTP message to start initialization."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "GET "
            },
            {
              "type": "text",
              "text": "/client/authentication/otp/initialize",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "{\n  \"secret\": \"ABCDABCDABCD\",\n  \"barcodeUrl\": http://www.google.com/chart?someidentifier\n}"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "example URL: "
            },
            {
              "type": "text",
              "text": "https://www.google.com/chart?chs=200x200&chld=M%%7C0&cht=qr&chl=otpauth://totp/natan@appgate2%%3Fsecret%%3DABCDABCDABCD",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Returns HTTP 409 if the user already has the seed."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A new initialization button on OTP dialog."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image.png]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If it's already initialized, it will return \"Conflict\" error."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If it isn't this dialog will pop-up again."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image2.png]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1438676995087
      }
    ]
  },
  {
    "key": "SA-266",
    "description": {
      "version": 1,
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:13]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "hi Kristinn... when you setup azure.. did you specify any tcp source port range ?"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:14]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "when azure gw is connecting to logserver , i usually see a port like 1081 -> 1087 .."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:14]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "but at some times, it does a port reuse, when a new tcp connection is made..."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:14]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "and at those times i can see that there is a delay to connect.."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:17]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "hm nope not to my knowledge"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:17]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "that's weird"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:17]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "so it's trying to reuse a port that is already in use or?"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:26]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "i dont know..  it is strange..    from azure i just do a simple connect to the logging server..."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:26]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "all goes ok..."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:26]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "i can see that azure is using ports"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:26]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "like 1080"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:26]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "1081"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:26]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "1082"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "1083"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "etc etc.."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "but then all the sudden it uses 1064"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "and for some reason the SYN fails."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "it does not get any responce from the log server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "same pattern every time"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:27]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "I'm wondering if it has something to do with the natting of the log server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "or does it work from aws?"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "it allways work from amazon"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "ok"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "hm"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "let me look into it"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "need to google and stuff, not sure what it can be"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:29]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "i reproduce it like:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:29]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "nc -vz "
            },
            {
              "type": "text",
              "text": "log.sa.cryptzone.com",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://log.sa.cryptzone.com"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " 5000      <-- on azure"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:29]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "sudo tcpdump -i eth0 tcp port 5000 -n -X  <-- on logging server"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:29]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "ok cool"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:29]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "I will investigate this now"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [16:29]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "thanks"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [16:30]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "np"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Per Leino [17:01]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "there is a article @ "
            },
            {
              "type": "text",
              "text": "https://msdn.microsoft.com/en-us/library/azure/dn848316.aspx",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://msdn.microsoft.com/en-us/library/azure/dn848316.aspx"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "   where the number of source ports can be configured?"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:02]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "maybe we will need to use the security groups feature. It isn't available in the GUI (at least I haven't found it) so we didn't know about it, that's the reason we use the SNAT hack"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:02]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "but if this can be fixed by using security groups then we might need to do that"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:23]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "I think it just uses the next available port. I don't know why this would be an issue"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:24]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "weird"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:24]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "it's using 1024-1040 ca. for me now and it's working"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:24]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "from a different azure vm"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:24]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "we should investigate this further after RSA"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:24]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "I can't do any good tests now"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "I'll add this to the devops backlog in youtrack"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Kristinn rn Sigursson [17:28]"
            },
            {
              "type": "hardBreak"
            },
            {
              "type": "text",
              "text": "we'll take a better look after RSA, unless this is a showstopper for RSA"
            }
          ]
        }
      ]
    }
  },
  {
    "key": "SA-15016",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When receiving a route from the controller, the lite client doesn't check if that route already exists (and ignore it if so). This cause the client to be permanently updating the PAC file in the OS and also (aparently) increase the number of routes internally allocated in the TcpIp/stack lib. It also keeps login the same message all the time."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2020-09-30T18:19:51.559Z] Info : 'VPN Proxy Device': 2 new routes have been added to the Proxy\n[2020-09-30T18:19:51.559Z] Info : ProxyPacUpdated "
            },
            {
              "type": "text",
              "text": "http://localhost:3198/sdp_proxy_pac_1601489991.pac"
            },
            {
              "type": "text",
              "text": "\n[2020-09-30T18:20:51.564Z] Info : 'VPN Proxy Device': 2 new routes have been added to the Proxy\n[2020-09-30T18:20:51.565Z] Info : ProxyPacUpdated "
            },
            {
              "type": "text",
              "text": "http://localhost:3198/sdp_proxy_pac_1601490051.pac"
            },
            {
              "type": "text",
              "text": "\n[2020-09-30T18:21:51.566Z] Info : 'VPN Proxy Device': 3 new routes have been added to the Proxy\n[2020-09-30T18:21:51.566Z] Info : ProxyPacUpdated "
            },
            {
              "type": "text",
              "text": "http://localhost:3198/sdp_proxy_pac_1601490111.pac"
            },
            {
              "type": "text",
              "text": "\n[2020-09-30T18:22:51.564Z] Info : 'VPN Proxy Device': 2 new routes have been added to the Proxy\n[2020-09-30T18:22:51.565Z] Info : ProxyPacUpdated "
            },
            {
              "type": "text",
              "text": "http://localhost:3198/sdp_proxy_pac_1601490171.pac"
            },
            {
              "type": "text",
              "text": "\n[2020-09-30T18:23:51.565Z] Info : 'VPN Proxy Device': 3 new routes have been added to the Proxy\n[2020-09-30T18:23:51.565Z] Info : ProxyPacUpdated "
            },
            {
              "type": "text",
              "text": "http://localhost:3198/sdp_proxy_pac_1601490231.pac"
            },
            {
              "type": "text",
              "text": "\n[2020-09-30T18:24:21.822Z] Info : 'VPN Proxy Device': 3 new routes have been added to the Proxy\n[2020-09-30T18:24:21.822Z] Info : ProxyPacUpdated "
            },
            {
              "type": "text",
              "text": "http://localhost:3198/sdp_proxy_pac_1601490261.pac"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15054",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The kibana authentication seems to fail"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In nginx: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " \nlocation /auditlogs {\n        auth_request /kibana-authorization;\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9310"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n    }\n"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "disabling the auth"
                },
                {
                  "type": "text",
                  "text": "request /kibana-authorization;  seems to make it work again.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And it feels related to the removal of open-resty"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601904613372
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ditched completely the whole 3rd party "
                },
                {
                  "type": "text",
                  "text": "nginx-c-function",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " module calling our lua which was using x509.c. Layers upon layers... As a result all the luajit dependencies + compilation/linking from nginx could be removed. Added instead a pure module of our own that just hooks in the access phase in identical way like url"
                },
                {
                  "type": "text",
                  "text": "access. ",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-appliance/pull/4036",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-appliance/pull/4036"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "+290 \u22121,416",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " legit"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1602067146791
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok, so we are merged... time to retest then"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1602141099568
      }
    ]
  },
  {
    "key": "SA-15061",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\\[2020-10-05T18:50:19.991Z\\] Info : Token renewal for \\[70bde4f0-5735-42e5-94ba-c45fdc668f71\\] is received by 'aws - purple40'. Will update the token.\n\n...\n\n\\[2020-10-05T18:50:21.526Z\\] Info : Received SAML token. Will send it to controller.\n\n\\[2020-10-05T18:50:21.559Z\\] Info : Retrieving claims token.\n\n\\[2020-10-05T18:50:21.560Z\\] Info : Fetching on-boarding cookie for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-830fc1db-1bf0-4c89-9768-854884ea8958' from secure storage.\n\n\\[2020-10-05T18:50:21.560Z\\] Info : On-boarding cookie available for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-830fc1db-1bf0-4c89-9768-854884ea8958'.\n\n\\[2020-10-05T18:50:21.561Z\\] Info : Resolving hostname 'purple.cryptzone.com'\n\n\\[2020-10-05T18:50:21.582Z\\] Info : Resolved IPs: \\[35.177.27.1, 35.157.222.129, 35.157.235.196\\]\n\n\\[2020-10-05T18:50:21.582Z\\] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA key name 'CryptZone'.\n\n\\[2020-10-05T18:50:21.863Z\\] Info : 2FA required while updating claims token at '["
            },
            {
              "type": "text",
              "text": "https://purple.cryptzone.com/'](https://purple.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\n\\[2020-10-05T18:50:21.867Z\\] Info : Initializing on-boarding OTP seed.\n\n\\[2020-10-05T18:50:21.907Z\\] Info : OTP seed is already initialized for this user.\n\n...\n\n\\[2020-10-06T07:24:35.739Z\\] Info : Sending on-boarding OTP to controller.\n\n\\[2020-10-06T07:24:35.739Z\\] Info : Resolving hostname 'purple.cryptzone.com'\n\n\\[2020-10-06T07:24:35.796Z\\] Info : Resolved IPs: \\[35.157.235.196, 35.157.222.129, 35.177.27.1\\]\n\n\\[2020-10-06T07:24:35.796Z\\] Info : Trying to connect 'purple.cryptzone.com/35.177.27.1' with SPA key name 'CryptZone'.\n\n\\[2020-10-06T07:24:36.232Z\\] Info : On-boarding OTP authentication has been failed because the initial authentication has expired.\n\n\\[2020-10-06T07:24:36.247Z\\] Info : Retrieving claims token.\n\n\\[2020-10-06T07:24:36.248Z\\] Info : Fetching on-boarding cookie for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-830fc1db-1bf0-4c89-9768-854884ea8958' from secure storage.\n\n\\[2020-10-06T07:24:36.249Z\\] Info : On-boarding cookie available for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-830fc1db-1bf0-4c89-9768-854884ea8958'.\n\n\\[2020-10-06T07:24:36.292Z\\] Warn : Authentication to '["
            },
            {
              "type": "text",
              "text": "https://purple.cryptzone.com/'](https://purple.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": " failed while renewing claims token. Prompting user to re-authenticate.\n\n\\[2020-10-06T07:24:36.516Z\\] Info : Starting HTTP Server to receive SAML token.\n\n\\[2020-10-06T07:24:36.516Z\\] Info : Starting the browser to ["
            },
            {
              "type": "text",
              "text": "https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNS8NAEIb%2FSth742abjemQpBSiUFAspu3BS5ikowaS3bizEX%2B%2BQSu0F48v78c8TLb%2BGvrgkxx31uQiCqUIyLT21Jm3XBz294tUrIuMcejVCJvJv5tn%2BpiIfTAXDcOvk4vJGbDIHYPBgRh8C9Xm8QFUKGF01tvW9iLYlrmoY2pvXzVhg6hUg6uEVISnRmuZLmWc4Bxjnmhr2KPxuVBSyUUkF1LvZQI6hqUOV2n0IoLjH%2Fd8RZwp4afsLvH%2Bp0Nmcn6eEUVV7sq7Y72b3NhTXVVP9WH2spvL4eIsr79RfAM%3D](https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNS8NAEIb%2FSth742abjemQpBSiUFAspu3BS5ikowaS3bizEX%2B%2BQSu0F48v78c8TLb%2BGvrgkxx31uQiCqUIyLT21Jm3XBz294tUrIuMcejVCJvJv5tn%2BpiIfTAXDcOvk4vJGbDIHYPBgRh8C9Xm8QFUKGF01tvW9iLYlrmoY2pvXzVhg6hUg6uEVISnRmuZLmWc4Bxjnmhr2KPxuVBSyUUkF1LvZQI6hqUOV2n0IoLjH%2Fd8RZwp4afsLvH%2Bp0Nmcn6eEUVV7sq7Y72b3NhTXVVP9WH2spvL4eIsr79RfAM%3D)"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\n\\[2020-10-06T07:24:37.882Z\\] Info : A new HTTP connection has been opened to the client.\n\n\\[2020-10-06T07:24:37.882Z\\] Info : Parsed HTTP header. Waiting for payload.\n\n\\[2020-10-06T07:24:37.883Z\\] Info : Received SAML token. Will send it to controller.\n\n\\[2020-10-06T07:24:37.995Z\\] Info : Retrieving claims token.\n\n\\[2020-10-06T07:24:37.995Z\\] Info : Fetching on-boarding cookie for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-830fc1db-1bf0-4c89-9768-854884ea8958' from secure storage.\n\n\\[2020-10-06T07:24:37.996Z\\] Info : On-boarding cookie available for 'onboardingcookie-f9:17:fd:6a:4b:45:9a:b1:85:44:7d:dd:2b:e4:50:92:23:30:dd:bf:9d:2d:d2:40:81:ca:7e:7c:0b:fb:18:e6-AppGate Azure AD SAML Client-kurt.glazemakers-830fc1db-1bf0-4c89-9768-854884ea8958'.\n\n\\[2020-10-06T07:24:38.040Z\\] Info : 2FA required while updating claims token at '["
            },
            {
              "type": "text",
              "text": "https://purple.cryptzone.com/'](https://purple.cryptzone.com/')"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Token expires"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Auto-SAML happens but fails because 2fa required"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Day passes"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Kurt enters OTP"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Fails because SAML has expired"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  OTP does not pop-up?"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "One catch is that, when it auto-samled the second time, it still used the old SAML token. Should be fixed but can't have caused the original issue."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This issue makes it impossible to connect with chromebook, I always get \"invalid OTP\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1601978459881
      }
    ]
  },
  {
    "key": "SA-15065",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "/\\* This should return an object of claims. For example: return {'posture': 25}; \\*/\n\nvar meta = JSON.parse(httpGet(\"["
            },
            {
              "type": "text",
              "text": "https://bin.appgate-sdp.com/github/ips.json](https://bin.appgate-sdp.com/github/ips.json)\").data)"
            },
            {
              "type": "text",
              "text": ";"
            },
            {
              "type": "text",
              "text": "\n\nvar fields = \\[\"hooks\", \"web\", \"api\", \"git\", \"pages\", \"importer\"\\];\n\nvar hosts = \\[\\];\n\nfor(var i in fields) { \n\n  hosts = hosts.concat(meta\\[fields\\[i\\]\\]);\n\n}\n\nconsole.log(hosts);\n\nconsole.log(JSON.stringify({ \"github\\_ips\" : hosts }));\n\nreturn { \"github\\_ips\" : hosts };"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Result: { \"github\\_ips\": { \"0\": \"192.30.252.0/22\", \"1\": \"185.199.108.0/22\", \"2\": \"140.82.112.0/20\", \"3\": \"192.30.252.0/22\", \"4\": \"185.199.108.0/22\", \"5\": \"140.82.112.0/20\", \"6\": \"13.114.40.48/32\", \"7\": \"52.192.72.89/32\", \"8\": \"52.69.186.44/32\", \"9\": \"15.164.81.167/32\", \"10\": \"52.78.231.108/32\", \"11\": \"13.234.176.102/32\", \"12\": \"13.234.210.38/32\", \"13\": \"13.229.188.59/32\", \"14\": \"13.250.177.223/32\", \"15\": \"52.74.223.119/32\", \"16\": \"13.236.229.21/32\", \"17\": \"13.237.44.5/32\", \"18\": \"52.64.108.95/32\", \"19\": \"18.228.52.138/32\", \"20\": \"18.228.67.229/32\", \"21\": \"18.231.5.6/32\", \"22\": \"192.30.252.0/22\", \"23\": \"185.199.108.0/22\", \"24\": \"140.82.112.0/20\", \"25\": \"13.230.158.120/32\", \"26\": \"18.179.245.253/32\", \"27\": \"52.69.239.207/32\", \"28\": \"13.209.163.61/32\", \"29\": \"54.180.75.25/32\", \"30\": \"13.233.76.15/32\", \"31\": \"13.234.168.60/32\", \"32\": \"13.250.168.23/32\", \"33\": \"13.250.94.254/32\", \"34\": \"54.169.195.247/32\", \"35\": \"13.236.14.80/32\", \"36\": \"13.238.54.232/32\", \"37\": \"52.63.231.178/32\", \"38\": \"18.229.199.252/32\", \"39\": \"54.207.47.76/32\", \"40\": \"192.30.252.0/22\", \"41\": \"185.199.108.0/22\", \"42\": \"140.82.112.0/20\", \"43\": \"13.114.40.48/32\", \"44\": \"52.192.72.89/32\", \"45\": \"52.69.186.44/32\", \"46\": \"15.164.81.167/32\", \"47\": \"52.78.231.108/32\", \"48\": \"13.234.176.102/32\", \"49\": \"13.234.210.38/32\", \"50\": \"13.229.188.59/32\", \"51\": \"13.250.177.223/32\", \"52\": \"52.74.223.119/32\", \"53\": \"13.236.229.21/32\", \"54\": \"13.237.44.5/32\", \"55\": \"52.64.108.95/32\", \"56\": \"18.228.52.138/32\", \"57\": \"18.228.67.229/32\", \"58\": \"18.231.5.6/32\", \"59\": \"18.181.13.223/32\", \"60\": \"54.238.117.237/32\", \"61\": \"54.168.17.15/32\", \"62\": \"3.34.26.58/32\", \"63\": \"13.125.114.27/32\", \"64\": \"3.7.2.84/32\", \"65\": \"3.6.106.81/32\", \"66\": \"18.140.96.234/32\", \"67\": \"18.141.90.153/32\", \"68\": \"18.138.202.180/32\", \"69\": \"52.63.152.235/32\", \"70\": \"3.105.147.174/32\", \"71\": \"3.106.158.203/32\", \"72\": \"54.233.131.104/32\", \"73\": \"18.231.104.233/32\", \"74\": \"18.228.167.86/32\", \"75\": \"192.30.252.153/32\", \"76\": \"192.30.252.154/32\", \"77\": \"185.199.108.153/32\", \"78\": \"185.199.109.153/32\", \"79\": \"185.199.110.153/32\", \"80\": \"185.199.111.153/32\", \"81\": \"192.30.252.0/22\", \"82\": \"185.199.108.0/22\", \"83\": \"140.82.112.0/20\" } }"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "hosts is indeed an array but represented by nashorn&jackson as object"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://gist.github.com/thomasdarimont/b30357185d44e86b5fa2",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://gist.github.com/thomasdarimont/b30357185d44e86b5fa2"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1601986739791
      }
    ]
  },
  {
    "key": "SA-15071",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Given the following condition:"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601993667549
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. its a OR logic with remedies."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601993684137
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I attach that to a entitlement"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601993694932
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "like this"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601993726730
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So when i connect with client..  for the first time"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601993756990
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so gateway sends: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " \n{\n\t\"method\": \"app-update\",\n\t\"params\": {\n\t\t\"apps\": {\n\t\t\t\"entitlement\": {\n\t\t\t\t\"remedies\": [{\n\t\t\t\t\t\"method\": \"OtpAuthentication\",\n\t\t\t\t\t\"params\": {\n\t\t\t\t\t\t\"providerId\": \"03542d1e-733c-4c43-a567-d28fbc4649a7\",\n\t\t\t\t\t\t\"message\": \"Please provide additional authentication.\",\n\t\t\t\t\t\t\"claimSuffix\": \"mfa\",\n\t\t\t\t\t\t\"actionIdentifier\": \"1774345838\"\n\t\t\t\t\t},\n\t\t\t\t\t\"active\": true,\n\t\t\t\t\t\"groupId\": \"839381241\"\n\t\t\t\t}, {\n\t\t\t\t\t\"method\": \"Reason\",\n\t\t\t\t\t\"params\": {\n\t\t\t\t\t\t\"message\": \"Please provide a reason.\",\n\t\t\t\t\t\t\"claimSuffix\": \"reason\",\n\t\t\t\t\t\t\"actionIdentifier\": \"-934964597\"\n\t\t\t\t\t},\n\t\t\t\t\t\"active\": true,\n\t\t\t\t\t\"groupId\": \"839381241\"\n\t\t\t\t}],\n\t\t\t\t\"status\": \"Remedy\",\n\t\t\t\t\"appData\": {\n\t\t\t\t\t\"name\": \"someApp\",\n\t\t\t\t\t\"description\": \"\",\n\t\t\t\t\t\"url\": \""
                },
                {
                  "type": "text",
                  "text": "http://172.17.131.2/\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\t\t\t\t\t\"colorCode\": 3\n\t\t\t\t},\n\t\t\t\t\"appDatas\": [{\n\t\t\t\t\t\"name\": \"someApp\",\n\t\t\t\t\t\"description\": \"\",\n\t\t\t\t\t\"url\": \""
                },
                {
                  "type": "text",
                  "text": "http://172.17.131.2/\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n\t\t\t\t\t\"colorCode\": 3\n\t\t\t\t}],\n\t\t\t\t\"displayName\": \"someApp\",\n\t\t\t\t\"name\": \"someApp\"\n\t\t\t}\n\t\t}\n\t},\n\t\"jsonrpc\": \"2.0\"\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601993812785
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So in this case, you can choose to use OTP or Reason..  So in this case i want to use reason."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601994044296
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So if i click the app shortcut"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601994060093
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I get the dialog for setting up the OTP.. but i dont want todo that"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601994091240
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Anyway. i go along.. and set it up. hopeing that we see reason late on."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601994132422
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but we dont.. if we continue we get:"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601994160981
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "agh, the last commit must have broken the whole thing."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1601994194522
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Wrong client verion..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1601994617121
      }
    ]
  },
  {
    "key": "SA-15161",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When the download fails due to a HTTP 404 - Not Found error, the client logs says that the download was succesfull but failed to verify the file."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2020-10-14T22:11:04.608Z] Info : Starting package download to 'C:\\Users\\Arturo\\AppData\\Local\\Temp\\AppGate\\Appgate__SDP__5.3.0-23925-release__Installer' from '"
            },
            {
              "type": "text",
              "text": "http://localhost:8000/Appgate__SDP__5.3.0-23925-release__Installer'"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n[2020-10-14T22:11:04.777Z] Info : Download completed, file is in 'C:\\Users\\Arturo\\AppData\\Local\\Temp\\AppGate\\Appgate__SDP__5.3.0-23925-release__Installer'\n[2020-10-14T22:11:04.788Z] Error : Could not parse the certificate of installer. Cannot find the requested object.\n[2020-10-14T22:11:04.788Z] Warn : Installer was downloaded but not verified"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "C:\\Users\\Arturo\\Downloads>python -m http.server\nServing HTTP on :: port 8000 ("
            },
            {
              "type": "text",
              "text": "http://[::]:8000/)"
            },
            {
              "type": "text",
              "text": " ...\n::1 - - [14/Oct/2020 15:11:04] code 404, message File not found\n::1 - - [14/Oct/2020 15:11:04] \"GET /Appgate__SDP__5.3.0-23925-release__Installer HTTP/1.1\" 404 -"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Very odd that it doesn't end up in the exception handler.. Perhaps it never has."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1602746764847
      }
    ]
  },
  {
    "key": "SA-15175",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "In the logs I get stuff Like"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "ott 15 07:00:21 magma AppGate[6130]: Info : Starting the browser to "
            },
            {
              "type": "text",
              "text": "https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNa4NAEIb0.000000isw9dnfVxgxqCJhCoKWhJjn0IltdG0F37c5a%2BvO7tCkkl8JchvdjHiZbf41D8Kks9UbnwEMGgdKNaXv9nsPx8LBIYV1kJMdBTLiZ3Vm0.000000qI9ZkQt8UBP%2BKjnMVqOR1BNqOSpC12C1eXpEETKcrHGmMQMEuzKHuhVcdjxRTdLeL1naiU7J6C1dxh3nq4Q13kY0q50mJ7XLQTDBFtxPdOArjBjGSZjG0SsEpz9ufwUulPgTttd48516284015314208902742317606792550877757440.0000009NJImWdr4GiKvfl9lTvZzsNqq6q50.000000rotezuuri4rLffKL4B"
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "However trying to open the URL (because the client fails to open the browser on my desktop machine) brings this"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](immagine.png)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "lol, what is \"decently\"? There is a dot at the end, I guess that's not good, but is that it?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Lowering the prio as the log is just there for logs, not workaround for your modified client."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1602766234288
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " no it's not the . at the end, i tried also without that. I don't know what is the issue there. By decently i mean that it should work if i copy paste it into a browser :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1602767204454
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "obsolete because we removed the log due to security concerns."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1614003422070
      }
    ]
  },
  {
    "key": "SA-15201",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "PAC Enforcement is not supported on Multi-User client but the client still shows the Device Proxy field as Activated in the UI and also the driver try to configure according to the logs. "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2020-10-16T17:14:14.650Z] Info : Applying PAC: "
            },
            {
              "type": "text",
              "text": "http://mycompany.com/proxy.pac"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " ![](image.png)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ah, I can remove the log entry there: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/5911",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/5911"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1603090641585
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, need to add code for the UI also."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1603092860801
      }
    ]
  },
  {
    "key": "SA-15246",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "To start with, it can just add a flag to code so it can be used (and then replaced) and add two nginx entries to peer (so no need to disable SPA and stuff for now)."
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  add client nginx entries to client port without SPA "
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "    location /client {\n\n        alias /var/www/html/cz-client-ui/;\n\n        try\\_files $uri index.html $uri;\n\n    }\n\n    location /client-ws {\n\n        proxy\\_http\\_version 1.1;\n\n        proxy\\_read\\_timeout 86400;\n\n        proxy\\_send\\_timeout 86400;\n\n        proxy\\_set\\_header X-Forwarded-For $remote\\_addr;\n\n        proxy\\_set\\_header Upgrade $http\\_upgrade;\n\n        proxy\\_set\\_header Connection \"upgrade\";\n\n        proxy\\_pass ["
                    },
                    {
                      "type": "text",
                      "text": "http://127.0.0.1:29000/live](http://127.0.0.1:29000/live)"
                    },
                    {
                      "type": "text",
                      "text": ";"
                    },
                    {
                      "type": "text",
                      "text": "\n\n    }"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  add nginx entry for the routing (both port 443 and 80?)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  start the client at "
                    },
                    {
                      "type": "text",
                      "text": "/opt/appgate-webclient/service/appgateservice",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " and "
                    },
                    {
                      "type": "text",
                      "text": "/opt/appgate-webclient/appgate-driver",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " in a namespace"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  start the new websessiond"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "makes sense, will do."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1603378864161
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "using unix socket for websocket now at "
                },
                {
                  "type": "text",
                  "text": "/run/user/appgate.service.sock",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1603453076067
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok I implemented the bare minimum, but at least we can build on top of that."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1603454046605
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Blocked by "
                },
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com/issue/SA-15271",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-youtrack.agi.appgate.com/issue/SA-15271"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1603785639275
      }
    ]
  },
  {
    "key": "SA-15253",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  An endpoint on "
                    },
                    {
                      "type": "text",
                      "text": "appliance.hostname:443",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " where it sets the cookie."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  An endpoint for all the other endpoint hostnames which checks if there is a cookie or not. If there is not, redirect back to "
                    },
                    {
                      "type": "text",
                      "text": "appliance.hostname:443",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " with the info of the attempted URL. This redirection will lead to the next point."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  An endpoint on "
                    },
                    {
                      "type": "text",
                      "text": "appliance.hostname:443",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " where it takes the cookie and redirects back to the endpoint with the said cookie."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. there is the user"
                },
                {
                  "type": "text",
                  "text": "id module. ",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://nginx.org/en/docs/http/ngx",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://nginx.org/en/docs/http/ngx"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http"
                },
                {
                  "type": "text",
                  "text": "userid",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "module.html"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603803545947
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so .. to enable it.. you add it to the \"server\" of nginx like:"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603803589552
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "userid         on;  <-- Enable the thing userid"
                },
                {
                  "type": "text",
                  "text": "name    ag",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "uid;  <-- give it a name"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603803622472
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so using the following \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " server { listen 127.0.0.1:9201; listen [::1]:9201; resolver 127.0.0.1:9253; #proxy\\_set\\_header X-Forwarded-For $proxy\\_add\\_x\\_forwarded\\_for; # Necessary for streaming of request body using chunked encoding proxy\\_http\\_version 1.1; proxy\\_buffering off; proxy\\_request\\_buffering off; client\\_max\\_body\\_size 0; userid on; # enable the cookie userid\\_name ag\\_uid; # give it a name userid\\_domain none; # optional domain appgate.com? userid\\_expires off; # date/max/off off means end of browser. max means \u201c31 Dec 2037 23:55:55 GMT\u201d userid\\_mark off; # makrin off userid\\_path / ; # define a path for which the cookie is set. location / { proxy\\_pass ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://unix:/tmp/tunservice1.socket",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://unix:/tmp/tunservice1.socket"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ";",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " } } \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and do a verbose curl.. you see: \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "502 Bad Gateway"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "rule"
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nginx"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " Connection #0 to host 127.0.0.1 left intact \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603808343306
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. you can see that the cookie gets set there anyway."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603808361893
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "map $cookie_ag_uid $new_session {\n    default 0;\n    \"\"  1;\n}\n\nupstream tunservice1 {\n        server unix:/tmp/tunservice1.socket;\n}\nupstream tunservice2 {\n        server unix:/tmp/tunservice2.socket;\n}\n# map to different upstream backends based on header\nmap $http_x_server_select $pool {\n        tunservice1 \"tunservice1\";\n        tunservice2 \"tunservice2\";\n}\nserver {\n    listen 127.0.0.1:9201;\n    listen [::1]:9201;\n    resolver 127.0.0.1:9253;\n    #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    # Necessary for streaming of request body using chunked encoding\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n    userid         on;     # enable the cookie\n    userid_name    ag_uid; # give it a name\n    userid_domain  none;   # optional domain appgate.com?\n    userid_expires off;    # date/max/off off means end of browser. max means \u201c31 Dec 2037 23:55:55 GMT\u201d\n    userid_mark    off;    # makrin off\n    userid_path    / ;     # define a path for which the cookie is set. \n    location / {\n\tif ($new_session) {\n\t\treturn 302 $request_uri;\n\t}\n\treturn 200 \"OK uid_set=$uid_set uid_got=$uid_got\\n\";\n        #proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://unix:/tmp/tunservice1.socket"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n    }\n}\n"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " curl -b -L -v -XGET "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9201/testers",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1:9201/testers"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603813680137
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK..  so the following works: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "map $cookie_ag_uid $new_session {\n    default 0;\n    \"\"  1;\n}\n\nupstream tunservice1 {\n        server unix:/tmp/tunservice1.socket;\n}\n\nserver {\n    listen 127.0.0.1:9201;\n    listen [::1]:9201;\n    resolver 127.0.0.1:9253;\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n    userid         on;     # enable the cookie\n    userid_name    ag_uid; # give it a name\n    userid_domain  none;   # optional domain appgate.com?\n    userid_expires off;    # date/max/off off means end of browser. max means \u201c31 Dec 2037 23:55:55 GMT\u201d\n    userid_mark    off;    # makrin off\n    userid_path    / ;     # define a path for which the cookie is set. \n    location / {\n\tif ($new_session) {\n\t\treturn 302 $uri;\n\t}\n\t#return 200 \"OK uid_set=$uid_set uid_got=$uid_got\\n\";\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://unix:/tmp/tunservice1.socket"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n    }\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And using a domain socket to listen.."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "nc -l -U /tmp/tunservice1.socket"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The with the following request. "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -L -b cookies.txt "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9201/testersdsfsd"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Then you in the domain socket get:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-100-1:/tmp# nc -l -U /tmp/tunservice1.socket\nGET /testersdsfsd HTTP/1.1\nHost: localhost\nConnection: close\nUser-Agent: curl/7.58.0\nAccept: */*\nCookie: ag_uid=fwAAAV+ZK3iDJlReAwMDAg=="
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603873788388
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So the follow is pretty intresting "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "map $cookie_ag_uid $new_session {\n    default 0;\n    \"\"  1;\n}\n\nserver {\n    listen 127.0.0.1:9201;\n    listen [::1]:9201;\n    resolver 127.0.0.1:9253;\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n    userid         on;     # enable the cookie\n    userid_name    ag_uid; # give it a name\n    userid_domain  none;   # optional domain appgate.com?\n    userid_expires off;    # date/max/off off means end of browser. max means \u201c31 Dec 2037 23:55:55 GMT\u201d\n    userid_mark    off;    # makrin off\n    userid_path    / ;     # define a path for which the cookie is set. \n    location / {\n\tif ($new_session) {\n\t\treturn 302 $uri;\n\t}\n\tproxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n\tproxy_set_header Host $host;\n    }\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " And having a {{CODEBLOCK1}} And requesting with {{CODEBLOCK2}} you get the following:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-100-1:/tmp# nc -l 127.0.0.1 9999\nGET /issue/SA-15253 HTTP/1.1\nHost: youtrack.com\nConnection: close\nUser-Agent: curl/7.58.0\nAccept: */*\nCookie: ag_uid=fwAAAV+ZQgMvdVAEAwMFAg=="
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603879446471
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and the following "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -v -L -b cookies.txt --resolve testrail.com:9201:127.0.0.1 "
                },
                {
                  "type": "text",
                  "text": "http://testrail.com:9201/test/test"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " You get {{CODEBLOCK1}} so seems like we always get the same cookie there.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603879653244
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. if i connected from another computer with the following instead: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -v -L -b cookies.txt --resolve testrail.com:444:172.17.100.1 "
                },
                {
                  "type": "text",
                  "text": "http://testrail.com:444/test/test"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "we get: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "GET /test/test HTTP/1.1\nHost: testrail.com\nConnection: close\nUser-Agent: curl/7.58.0\nAccept: */*\nCookie: ag_uid=rBFkAV+ZQ5VBGVdCAwMEAg=="
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603879875102
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and if we do youtrack instead:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -v -L -b cookies.txt --resolve youtrack.com:444:172.17.100.1 "
                },
                {
                  "type": "text",
                  "text": "http://youtrack.com:444/test/test"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Then we get:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "GET /test/test HTTP/1.1\nHost: youtrack.com\nConnection: close\nUser-Agent: curl/7.58.0\nAccept: */*\nCookie: ag_uid=rBFkAV+ZQ+VBGVdCAwMGAg=="
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603879962218
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And if we compare the cookies.. they are slightly different: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "ag_uid=rBFkAV+ZQ5VBGVdCAwMEAg==\nag_uid=rBFkAV+ZQ+VBGVdCAwMGAg=="
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603880048977
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so that is since they are not based on host.. ok so this is why we need the single sign on page"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603881795171
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So. at this point..  it feels like we actualy need a client in the browser.  since its hard to transfer cookies between domains."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603891486728
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So based on that.."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "server {\n    listen 443 http2 ssl;\n    server_name envy-172-17-126-1.devops;\n    ssl_certificate /mnt/state/pki/appliance-cert.pem;\n    ssl_certificate_key /mnt/state/pki/appliance-priv.pem;\n    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256;\n    ssl_client_certificate /mnt/state/pki/ca-cert.pem;\n    ssl_prefer_server_ciphers on;\n    ssl_protocols TLSv1.2;\n    userid         on;     # enable the cookie\n    userid_name    ag_uid; # give it a name\n    userid_domain  envy-172-17-126-1.devops;\n    userid_expires off;    # date/max/off off means end of browser. max means \u201c31 Dec 2037 23:55:55 GMT\u201d\n    userid_mark    off;    # makrin off\n    userid_path    / ;     # define a path for which the cookie is set. \n    location /client {\n        alias /var/www/html/cz-client-ui/;\n        try_files $uri index.html $uri;\n    }\n    location /client-ws {\n        proxy_http_version 1.1;\n        proxy_read_timeout 86400;\n        proxy_send_timeout 86400;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://unix:/run/user/appgate.service.sock:/live"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n    }\n}\n\nmap $cookie_ag_uid $new_session {\n    default 0;\n    \"\"  1;\n}\n\nserver {\n    listen 127.0.0.1:9201;\n    listen [::1]:9201;\n    resolver 127.0.0.1:9253;\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n\n    #We will probably need this sso thing. \n    #Since its they way we can transfer the \n    #cookie to make the request\n    location ~ ^/agsid/(.*)$ {\n        root             /var/www/html/cz-client-ui/;\n        try_files        /sso.html =404;\n    }\n\n\n    location / {\n\tif ($new_session) {\n\t\treturn 302 envy-172-17-126-1.devops:443/client;\n\t}\n        #this session has s cookie.. so transfer it to the page.\n\tproxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n\tproxy_set_header Host $host;\n    }\n} "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1603891593247
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeah, we need to have a meeting :D."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tomorrow?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1603891891200
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK.. so this kind of works.. The following nginx: \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " map $cookie\\_ag\\_uid $new\\_session { default 0; \"\" 1; } server { listen 0.0.0.0:443; server\\_name envy-172-17-130-2.devops; userid on; userid\\_name agsid; location /client/ { root /usr/html/; try\\_files /client.html =404; } } server { listen 0.0.0.0:443 default\\_server; listen [::1]:443; server\\_name something; resolver 127.0.0.1:9253; proxy\\_http\\_version 1.1; proxy\\_buffering off; proxy\\_request\\_buffering off; client\\_max\\_body\\_size 0; location / { if ($new\\_session) { return 302 /proxy-set-cookie/aguid/None/host/$host/$uri; } proxy\\_pass ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1:9999"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ";",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " proxy\\_set\\_header Host $host; } location /proxy-set-cookie/ { root /usr/html; try\\_files /copyCookie.html =404; } } \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and the copyCookie.html page: \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "function setCookie(name, value, days) { const d = new Date; d.setTime(d.getTime() + 24 \\"
                },
                {
                  "type": "text",
                  "text": " 60 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 60 \\"
                },
                {
                  "type": "text",
                  "text": " 1000 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " days); document.cookie = \\"
                },
                {
                  "type": "text",
                  "text": "${name}=${value};path=/;expires=${d.toGMTString()}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "; } document.addEventListener(\"DOMContentLoaded\", () => { setTimeout(() => { const match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const cookie = match[1] const host = match[2] const url = match[3] console.log(cookie); console.log(host); console.log(url); const server = \"172.17.130.2:443\" if (cookie === \"None\"){ location.replace(\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://envy-172-17-130-2.devops:443/client/host/${host}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://envy-172-17-130-2.devops:443/client/host/${host}/${url}\\"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } else { setCookie(\"agsid\", cookie); location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${host}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "); } }, 500); });"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " And a dummy client page: \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "This is the client"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " SO.. If i add a hostfile where \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 172.17.130.2 someservice.com \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " And direct my browser to \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " "
                },
                {
                  "type": "text",
                  "text": "http://someservice.com:443/blabla",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://someservice.com:443/blabla"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " Then.. first thing that happens is that nginx see that there is no cookie.. so it redirects the user to: (todo maybe we need the port here also) \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " "
                },
                {
                  "type": "text",
                  "text": "http://someservice.com:443/proxy-set-cookie/aguid/None/host/someservice.com/blabla",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://someservice.com:443/proxy-set-cookie/aguid/None/host/someservice.com/blabla"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " The copyCookie.html page will then load. It will parse out from the url that the cookie is set to None.. So then it redirects the user to client download, and preserves the url in the url: \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " "
                },
                {
                  "type": "text",
                  "text": "http://envy-172-17-130-2.devops:443/client/host/someservice.com//blabla",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://envy-172-17-130-2.devops:443/client/host/someservice.com//blabla"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604044594793
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so now even more automatic.. nginx configuration. \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " map $cookie\\_aguid $new\\_session { default 0; \"\" 1; } server { listen 0.0.0.0:443; server\\_name envy-172-17-130-2.devops; userid on; userid\\_name aguid; userid\\_domain envy-172-17-130-2.devops; location /client/ { root /usr/html/; try\\_files /client.html =404; } } server { listen 0.0.0.0:443-555 default\\_server; listen [::1]:443-555; server\\_name something; resolver 127.0.0.1:9253; proxy\\_http\\_version 1.1; proxy\\_buffering off; proxy\\_request\\_buffering off; client\\_max\\_body\\_size 0; location ~ ^/aguid/(.\\*)$ { root /usr/html; try\\_files /copyCookie.html =404; } location / { if ($new\\_session) { return 302 /proxy-set-cookie/aguid/None/host/$host/port/$server\\_port/$uri; } proxy\\_pass ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1:9999"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ";",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " proxy\\_set\\_header Host $host; } location /proxy-set-cookie/ { root /usr/html; try\\_files /copyCookie.html =404; } } \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " /usr/html/copyCookie.html \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "function setCookie(name, value, days) { const d = new Date; d.setTime(d.getTime() + 24 \\"
                },
                {
                  "type": "text",
                  "text": " 60 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 60 \\"
                },
                {
                  "type": "text",
                  "text": " 1000 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " days); document.cookie = \\"
                },
                {
                  "type": "text",
                  "text": "${name}=${value};path=/;expires=${d.toGMTString()}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "; } document.addEventListener(\"DOMContentLoaded\", () => { setTimeout(() => { //var match = location.href.match(new RegExp(\"/aguid/(.+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); //const cookie = match[1] //console.log(cookie); match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/port/([0-9]+)/(.\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")\")); if (match && match[1] === \"None\"){ match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const cookie = match[1] const host = match[2] const port = match[3] const url = match[4] console.log(cookie); console.log(host); console.log(port) console.log(url); const server = \"172.17.130.2:443\" location.replace(\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://envy-172-17-130-2.devops:443/client/host/${host}/port/${port}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://envy-172-17-130-2.devops:443/client/host/${host}/port/${port}/${url}\\"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } else { match = location.href.match(new RegExp(\"/aguid/(.+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const cookie = match[1] const url = match[2] setCookie(\"aguid\", cookie); const redirect = \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${location.host}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${redirect}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "); console.log(redirect) } }, 500); });"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " /usr/html/client.html \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "This is the client"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "function getCookie(cname) { var name = cname + \"=\"; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i <ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') { c = c.substring(1); } if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); } } return \"\"; } document.addEventListener(\"DOMContentLoaded\", () => { setTimeout(() => { const match = location.href.match(new RegExp(\"/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const host = match[1] const port = match[2] const url = match[3] var cookie = getCookie(\"aguid\") console.log(host); console.log(port) console.log(url); console.log(cookie); var redirect = \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${host}:${port}/aguid/${cookie}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${redirect}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "); }, 500); });"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604053543765
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so strange urls are still a issue here.. and localstorage/sessionStorage"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604312043835
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "New version Nginx: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "map $cookie_aguid $new_session {\n    default 0;\n    \"\"  1;\n}\n\nserver {\n    listen               0.0.0.0:443;\n    server_name          envy-172-17-130-2.devops;\n    userid               on;\n    userid_name          aguid;\n    userid_domain        envy-172-17-130-2.devops;\n\n    location /client/ {\n        root             /usr/html/;\n        try_files        /client.html =404;\n    }\n}\n\n\n\nserver {\n    listen 0.0.0.0:443-555 default_server;\n    listen [::1]:443-555;\n    server_name something;\n    resolver 127.0.0.1:9253;\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n    location ~ ^/aguid/(.*)$ {\n        root /usr/html;\n        try_files /copyCookie.html =404;\n    }\n    location / {\n\tif ($new_session = 1) {\n\t\trewrite ^ $request_uri;\n\t\treturn 302 /proxy-set-cookie/aguid/None/host/$host/port/$server_port/$uri;\n\t}\n\t#proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n\t#proxy_set_header Host $host;\n\t\n\troot /usr/html;\n\ttry_files /endpoint.html =404;\n    }\n\n    location /proxy-set-cookie/ {\n    \troot /usr/html;\n        try_files /copyCookie.html =404;\n    }\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604321635280
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "CopyCookie \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "function setCookie(name, value, days) { const d = new Date; d.setTime(d.getTime() + 24 \\"
                },
                {
                  "type": "text",
                  "text": " 60 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 60 \\"
                },
                {
                  "type": "text",
                  "text": " 1000 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " days); document.cookie = \\"
                },
                {
                  "type": "text",
                  "text": "${name}=${value};path=/;expires=${d.toGMTString()}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "; } document.addEventListener(\"DOMContentLoaded\", () => { setTimeout(() => { match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); if (match && match[1] === \"None\"){ match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/port/([0-9]+)/(.\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")\")); const cookie = match[1] const host = match[2] const port = match[3] const url = match[4] console.log(cookie); console.log(host); console.log(port) console.log(url); const server = \"172.17.130.2:443\" encoded = decodeURIComponent(url) complete = \\"
                },
                {
                  "type": "text",
                  "text": "http://envy-172-17-130-2.devops:443/client/host/${host}/port/${port}/${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://envy-172-17-130-2.devops:443/client/host/${host}/port/${port}/${encoded}\\"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(complete) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${complete}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } else { match = location.href.match(new RegExp(\\"
                },
                {
                  "type": "text",
                  "text": "/aguid/(.\\*)\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")) if(match) { separator = (match[1]).indexOf(\"/\") if(separator != -1) { cookie = (match[1]).substring(0, separator) console.log(cookie) rest = (match[1]).substring(separator+1) console.log(rest) encoded = decodeURIComponent(rest) setCookie(\"aguid\", cookie); const redirect = \\"
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${location.host}${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${redirect}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } } } }, 500); });"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604321664030
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client: \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Appgate Client 5.4"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Auto login button function getCookie(cname) { var name = cname + \"=\"; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i <ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') { c = c.substring(1); } if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); } } return \"\"; } function forward() { const match = location.href.match(new RegExp(\"/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const host = match[1] const port = match[2] const url = match[3] var cookie = getCookie(\"aguid\") console.log(host); console.log(port) console.log(url); console.log(cookie); var redirect = \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${host}:${port}/aguid/${cookie}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) encoded = decodeURIComponent(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "); }"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604321688811
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "lets see.. latest version:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nginx: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " \nmap $cookie_aguid $new_session {\n    default 0;\n    \"\"  1;\n}\n\nserver {\n    listen               0.0.0.0:443;\n    server_name          envy-172-17-130-2.devops;\n    userid               on;\n    userid_name          aguid;\n    userid_domain        envy-172-17-130-2.devops;\n\n    location /client/ {\n        root             /usr/html/;\n        try_files        /client.html =404;\n    }\n}\n\n\n\nserver {\n    listen 0.0.0.0:443-555 default_server;\n    listen [::1]:443-555;\n    server_name something;\n    resolver 127.0.0.1:9253;\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n    location ~ ^/aguid/(.*)$ {\n        root /usr/html;\n        try_files /copyCookie.html =404;\n    }\n    location / {\n\tif ($new_session = 1) {\n\t\trewrite ^ $request_uri;\n\t\treturn 302 proxy-set-cookie/aguid/None/host/$host/port/$server_port/$uri;\n\t}\n\t#proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n\t#proxy_set_header Host $host;\n\t\n\troot /usr/html;\n\ttry_files /endpoint.html =404;\n    }\n    location /proxy-set-cookie/ {\n    \troot /usr/html;\n        try_files /copyCookie.html =404;\n    }\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604394531520
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "copyCookie \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "function setCookie(name, value, days) { const d = new Date; d.setTime(d.getTime() + 24 \\"
                },
                {
                  "type": "text",
                  "text": " 60 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 60 \\"
                },
                {
                  "type": "text",
                  "text": " 1000 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " days); document.cookie = \\"
                },
                {
                  "type": "text",
                  "text": "${name}=${value};path=/;expires=${d.toGMTString()}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "; } document.addEventListener(\"DOMContentLoaded\", () => { setTimeout(() => { match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); localStorageCookie = localStorage.getItem(\"aguid\"); cookie = \"None\" if (localStorageCookie) { cookie = localStorageCookie console.log(\"Found cookie in localstorage: \" + cookie) setCookie(\"aguid\", cookie); location.reload(); } else if (match && match[1] === \"None\") { console.log(\"Cookie hardcoded to None in URL\") match = location.href.match(new RegExp(\"/aguid/(.+)/host/(.+)/port/([0-9]+)/(.\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")\")); const host = match[2] const port = match[3] const url = match[4] console.log(host); console.log(port) console.log(url); const server = \"172.17.130.2:443\" encoded = decodeURIComponent(url) complete = \\"
                },
                {
                  "type": "text",
                  "text": "http://envy-172-17-130-2.devops:443/client/host/${host}/port/${port}/${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://envy-172-17-130-2.devops:443/client/host/${host}/port/${port}/${encoded}\\"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(complete) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${complete}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } else { match = location.href.match(new RegExp(\\"
                },
                {
                  "type": "text",
                  "text": "/aguid/(.\\*)\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ")) if(match) { separator = (match[1]).indexOf(\"/\") cookie = (match[1]).substring(0, separator) console.log(\"Cookie found in Url: \" + cookie) rest = (match[1]).substring(separator+1) console.log(rest) encoded = decodeURIComponent(rest) setCookie(\"aguid\", cookie); const redirect = \\"
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${location.host}${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${redirect}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } } }, 500); });"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604394585982
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "client: \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Appgate Client 5.4"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Auto login button var cookie = localStorage.getItem(\"aguid\"); console.log(\"Local storage cookie:\" + cookie) if (cookie) { //We already have a cookie in local storage.. so //just go to proxyCookie and set the cookie for the //domain forward() } else { //cookie = getCookie(\"aguid\") //console.log(\"Setting cookie to : \" + cookie) //localStorage.setItem(\"aguid\", cookie); } function getCookie(cname) { var name = cname + \"=\"; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i <ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') { c = c.substring(1); } if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); } } return \"\"; } function forward() { const match = location.href.match(new RegExp(\"/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const host = match[1] const port = match[2] const url = match[3] console.log(host); console.log(port) console.log(url); var cookie = getCookie(\"aguid\") localStorage.setItem(\"aguid\", cookie); var redirect = \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${host}:${port}/aguid/${cookie}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) encoded = decodeURIComponent(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "); cookie = localStorage.getItem(\"aguid\"); console.log(\"2 Local storage cookie:\" + cookie) }"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604394625478
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Leino",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.leino",
                        "title": "per.leino"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " maybe use github for tracking instead of youtrack :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1604395007582
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "its on the way..   Above is just hacks..   im actually adding it to configd right now."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604400437561
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You need to POC before you can code.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604400465793
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Pr is already done.. but just for refeerence lets put it here also: nginx: \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " map $cookie\\_aguid $new\\_session { default 0; \"\" 1; } server { listen 0.0.0.0:443; server\\_name envy-172-17-114-1.devops; userid on; userid\\_name aguid; userid\\_domain envy-172-17-114-1.devops; location /client/ { root /usr/html/; try\\_files /client.html =404; } } server { listen 0.0.0.0:443-555 default\\_server; listen [::1]:443-555; server\\_name something; resolver 127.0.0.1:9253; proxy\\_http\\_version 1.1; proxy\\_buffering off; proxy\\_request\\_buffering off; client\\_max\\_body\\_size 0; location ~ ^/16872eb861894a7e9e787f6355e95d3b/(.\\*)$ { root /usr/html; try\\_files /copyCookie.html =404; } location / { if ($new\\_session = 1) { rewrite ^ $request\\_uri; return 302 ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://envy-172-17-114-1.devops:443/client/host/$host/port/$server\\_port/$uri",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://envy-172-17-114-1.devops:443/client/host/$host/port/$server\\_port/$uri"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ";",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " } #proxy\\_pass ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9999",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1:9999"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ";",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " #proxy\\_set\\_header Host $host; root /usr/html; try\\_files /endpoint.html =404; } } \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " copyCookie \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "function setCookie(name, value, days) { const d = new Date; d.setTime(d.getTime() + 24 \\"
                },
                {
                  "type": "text",
                  "text": " 60 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " 60 \\"
                },
                {
                  "type": "text",
                  "text": " 1000 \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " days); document.cookie = \\"
                },
                {
                  "type": "text",
                  "text": "${name}=${value};path=/;expires=${d.toGMTString()}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "; } console.log(\"initial\") document.addEventListener(\"DOMContentLoaded\", () => { console.log(\"dom\") setTimeout(() => { console.log(\"timeout\") localStorageCookie = localStorage.getItem(\"aguid\"); cookie = \"None\" if (localStorageCookie) { cookie = localStorageCookie console.log(\"Found cookie in localstorage: \" + cookie) setCookie(\"aguid\", cookie); location.reload(); } else { match = location.href.match(new RegExp(\"/16872eb861894a7e9e787f6355e95d3b/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")) if(match) { separator = (match[1]).indexOf(\"/\") cookieB64 = (match[1]).substring(0, separator) cookie = atob(cookieB64) console.log(\"Cookie found in Url: \" + cookie) rest = (match[1]).substring(separator+1) console.log(rest) encoded = decodeURIComponent(rest) setCookie(\"aguid\", cookie); const redirect = \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${location.host}${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${redirect}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") } else { console.log(\"NoMatch\") } } }, 500); });"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " client \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Appgate Client 5.4"
                }
              ],
              "attrs": {
                "level": 1
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Auto login button var cookie = localStorage.getItem(\"aguid\"); console.log(\"Local storage cookie:\" + cookie) if (cookie) { //We already have a cookie in local storage.. so //just go to proxyCookie and set the cookie for the //domain forward() } function getCookie(cname) { var name = cname + \"=\"; var decodedCookie = decodeURIComponent(document.cookie); var ca = decodedCookie.split(';'); for(var i = 0; i <ca.length; i++) { var c = ca[i]; while (c.charAt(0) == ' ') { c = c.substring(1); } if (c.indexOf(name) == 0) { return c.substring(name.length, c.length); } } return \"\"; } function forward() { const match = location.href.match(new RegExp(\"/host/(.+)/port/([0-9]+)/(.\\"
                },
                {
                  "type": "text",
                  "text": ")\")); const host = match[1] const port = match[2] const url = match[3] console.log(host); console.log(port) console.log(url); var cookie = getCookie(\"aguid\") localStorage.setItem(\"aguid\", cookie); var encodedCookie = btoa(cookie) var redirect = \\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "${location.protocol}//${host}:${port}/16872eb861894a7e9e787f6355e95d3b/${encodedCookie}/${url}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " console.log(redirect) encoded = decodeURIComponent(redirect) location.replace(\\"
                },
                {
                  "type": "text",
                  "text": "${encoded}\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "); cookie = localStorage.getItem(\"aguid\"); console.log(\"2 Local storage cookie:\" + cookie) }"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1604649845437
      }
    ]
  },
  {
    "key": "SA-15277",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Doing the PoC according to the findings/results of SA-15250"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Alright so the proxying is piece of cake with that approach but has 1 major problem. Nginx will make a new connection with that socket and not with the real endpoint thus there will be no connection, through the tunnel, with the endpoint. This is the case no matter if we use real sockets or unix domain sockets"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Nginx's configuration: According to header nginx does proxy"
                },
                {
                  "type": "text",
                  "text": "pass to a specific unix domain sockets",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-102-2:/home/cz# cat /etc/nginx/sites-enabled-urlaccess/http \n# This file is autogenerated by cz-configd\nupstream tunservice1 {\n\tserver unix:/tmp/tunservice1.socket;\n}\n\nupstream tunservice2 {\n\tserver unix:/tmp/tunservice2.socket;\n}\n\n# map to different upstream backends based on header\nmap $http_x_server_select $pool {\n        tunservice1 \"tunservice1\";\n        tunservice2 \"tunservice2\";\n}\n\n\nserver {\n    listen 127.0.0.1:9201;\n    listen [::1]:9201;\n    resolver 127.0.0.1:9253;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n    # Necessary for streaming of request body using chunked encoding\n    proxy_http_version 1.1;\n    proxy_buffering off;\n    proxy_request_buffering off;\n    client_max_body_size 0;\n\n    # Jump to different locations based on the \"Upgrade\" header\n    location / {\n        try_files /\u03bc\u03b1\u03bb\u03b1\u03ba\u03af\u03b5\u03c2 @$http_upgrade;\n    }\n\n    location @websocket {\n        # websocket related stuff\n        url_access on;\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://$pool"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"Upgrade\";\n    }\n\n    location @ {\n        # web related stuff\n        url_access on;\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://$pool"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n    }\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "netcat simulating tun-service. A simple unix domain socket Here it won't even be IP packets as it's a unix domain socket so for sure it cannot be used "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-102-2:/home/cz# nc -l -U /tmp/tunservice1.socket\nGET / HTTP/1.1\nX-Forwarded-For: 192.168.100.2\nHost: tunservice1\nConnection: close\nUser-Agent: curl/7.68.0\nAccept: */*\nX-Server-Select: tunservice1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " With a real socket like 127.0.0.1:8080 The socket gets IP packets but nginx has now a TCP connection with that socket and not with the real endpoint {{CODEBLOCK2}}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client doing an HTTP request with a specific header "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl "
                },
                {
                  "type": "text",
                  "text": "http://172.17.103.2"
                },
                {
                  "type": "text",
                  "text": " -H \"X-Server-Select: tunservice1\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1603814145860
      }
    ]
  },
  {
    "key": "SA-15293",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Controller can connect directly to configd instead, we already have a web server listening on localhost for the sessiond proxy. "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "# This file is autogenerated by cz-configdserver {{\n    listen 127.0.0.1:{port};\n    location /ip_allocation {{\n        proxy_pass "
            },
            {
              "type": "text",
              "text": "http://unix:/{DEFAULT_UNIX_DOMAIN_SOCKET}:/ip_allocation?node_name={node_name}&is_prefix=1"
            },
            {
              "type": "text",
              "text": ";"
            },
            {
              "type": "text",
              "text": "\n    }}\n}}"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15323",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/webd/src/internal/http/http_server.go"
            },
            {
              "type": "text",
              "text": "  <-- rename towards server..\n"
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/webd/src/internal/socket/server.go"
            },
            {
              "type": "text",
              "text": " <-- rename towards clienthandler. \n"
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/webd/src/internal/socket/server.go"
            },
            {
              "type": "text",
              "text": " <-- maybe even rename the package to clienthandler. \n"
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/webd/src/internal/session/collection.go"
            },
            {
              "type": "text",
              "text": " <- rename towards sessionCollection\n"
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/webd/src/internal/session/handler.go"
            },
            {
              "type": "text",
              "text": " <-- rename towards session\n"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15381",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "20-11-05T10:30:02.869Z\\] Info : CA certificate found in the storage for 'purple.appgate.com'.\n\n\\[2020-11-05T10:30:03.143Z\\] Info : Resolving hostname 'purple.appgate.com'\n\n\\[2020-11-05T10:30:03.405Z\\] Info : Resolved IPs: \\[35.177.27.1, 35.157.235.196, 35.157.222.129\\]\n\n\\[2020-11-05T10:30:03.407Z\\] Info : Trying to connect 'purple.appgate.com/35.177.27.1' with SPA key name 'CryptZone'.\n\n\\[2020-11-05T10:30:04.345Z\\] Info : Changing profile.\n\n\\[2020-11-05T10:30:04.989Z\\] Info : Identity Provider AppGate Azure AD SAML Client found.\n\n\\[2020-11-05T10:30:04.989Z\\] Info : Logging in using 'AppGate Azure AD SAML Client'.\n\n\\[2020-11-05T10:30:04.989Z\\] Info : Authenticating for the first time. AppGate Azure AD SAML Client\n\n\\[2020-11-05T10:30:04.989Z\\] Info : Retrieving claims token.\n\n\\[2020-11-05T10:30:05.030Z\\] Info : Redirection to an external identity provider is received. URL: ["
            },
            {
              "type": "text",
              "text": "https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNa4QwEIb%2FisxdO8ZYNajLgi0stHSpu3voRUI2toImNhNLf36l3cL20uPL%2BzEPU24%2BpzH40I4GayqII4RAG2XPg3mt4Hi4D3PY1CXJaWSz2C7%2BzTzr90WTD9aiIfHjVLA4I6ykgYSRkybhlWi3jw%2BCRShmZ71VdoRg11TQ3XKdcS5RMpZmOU%2F7opdnlXOlkqRHLNYY0aJ3hrw0vgKGDMM4DjE9xCgSFMijIsteIDj9cq9X4EIpvsvuGu9%2FOkmknV9noG6bfXN36vaLm0fdte1Td1y98uZ6uL7Iv9%2BovwA%3D](https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNa4QwEIb%2FisxdO8ZYNajLgi0stHSpu3voRUI2toImNhNLf36l3cL20uPL%2BzEPU24%2BpzH40I4GayqII4RAG2XPg3mt4Hi4D3PY1CXJaWSz2C7%2BzTzr90WTD9aiIfHjVLA4I6ykgYSRkybhlWi3jw%2BCRShmZ71VdoRg11TQ3XKdcS5RMpZmOU%2F7opdnlXOlkqRHLNYY0aJ3hrw0vgKGDMM4DjE9xCgSFMijIsteIDj9cq9X4EIpvsvuGu9%2FOkmknV9noG6bfXN36vaLm0fdte1Td1y98uZ6uL7Iv9%2BovwA%3D)"
            },
            {
              "type": "text",
              "text": "\n\n\\[2020-11-05T10:30:05.031Z\\] Info : Starting HTTP Server to receive SAML token.\n\n\\[2020-11-05T10:30:05.034Z\\] Info : Starting the browser to ["
            },
            {
              "type": "text",
              "text": "https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNa4QwEIb%2FisxdO8ZYNajLgi0stHSpu3voRUI2toImNhNLf36l3cL20uPL%2BzEPU24%2BpzH40I4GayqII4RAG2XPg3mt4Hi4D3PY1CXJaWSz2C7%2BzTzr90WTD9aiIfHjVLA4I6ykgYSRkybhlWi3jw%2BCRShmZ71VdoRg11TQ3XKdcS5RMpZmOU%2F7opdnlXOlkqRHLNYY0aJ3hrw0vgKGDMM4DjE9xCgSFMijIsteIDj9cq9X4EIpvsvuGu9%2FOkmknV9noG6bfXN36vaLm0fdte1Td1y98uZ6uL7Iv9%2BovwA%3D](https://login.microsoftonline.com/b93e809a-49c5-4a0f-a606-82b846acc30d/saml2?SAMLRequest=fZBNa4QwEIb%2FisxdO8ZYNajLgi0stHSpu3voRUI2toImNhNLf36l3cL20uPL%2BzEPU24%2BpzH40I4GayqII4RAG2XPg3mt4Hi4D3PY1CXJaWSz2C7%2BzTzr90WTD9aiIfHjVLA4I6ykgYSRkybhlWi3jw%2BCRShmZ71VdoRg11TQ3XKdcS5RMpZmOU%2F7opdnlXOlkqRHLNYY0aJ3hrw0vgKGDMM4DjE9xCgSFMijIsteIDj9cq9X4EIpvsvuGu9%2FOkmknV9noG6bfXN36vaLm0fdte1Td1y98uZ6uL7Iv9%2BovwA%3D)"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n\n\\[2020-11-05T10:30:06.031Z\\] Info : Profile changed to ASdemo-AD\n\n\\[2020-11-05T10:30:06.162Z\\] Info : Changing profile.\n\n\\[2020-11-05T10:30:06.262Z\\] Info : Profile changed to AGI\\_Users\n\n\\[2020-11-05T10:30:06.414Z\\] Info : User input required for 'ConnectCredentialsLoginHandler'.\n\n\\[2020-11-05T10:30:08.057Z\\] Info : A new HTTP connection has been opened to the client.\n\n\\[2020-11-05T10:30:08.057Z\\] Info : Parsed HTTP header. Waiting for payload.\n\n\\[2020-11-05T10:30:08.060Z\\] Info : Received SAML token. Will send it to controller."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The HTTP server is being closed already but in this case it probably wasn't fast enough. Will make sure to ignore the incoming token."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1605003019122
      }
    ]
  },
  {
    "key": "SA-15452",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "location @ {\n    # web related stuff\n    auth_request /memcverify;\n    proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://$host:$server_port$request_uri"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n}\n\nlocation = /memcverify {\n    # memcached authorization\n    internal;\n    set  $memcached_key $cookie_aguid;\n    memcached_pass unix:/run/cz-memcached/memcached.socket;\n    error_page        404 = @error;\n}\n\nlocation @error  {\n    # Do something on error\n    return 401;\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is a way looks like it to use the build-in memcached of nginx by attaching it into an authentication location thus not interfering with the proxy"
                },
                {
                  "type": "text",
                  "text": "pass. Reminder the problem was that both modules memcached and proxy",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "pass hook to upstream callbacks so we couldn't put order i.e. first upstream to query to get the value and then proxy"
                },
                {
                  "type": "text",
                  "text": "pass to the app. It was solved by proxy",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "pass \"calling\" our custom variable whose handler it was querying the memcached. That had the drawback that the proxy"
                },
                {
                  "type": "text",
                  "text": "pass would have to do blocking I/O (localhost negligible but still not nice)",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So the above works in the following steps:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "HTTP request goes to the generic location @"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "internal \"redirect\" to  /memcverify  where memcached db is queried with key the aguid from the Cookie"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If value exists for that key THEN proxy"
                        },
                        {
                          "type": "text",
                          "text": "pass to the app",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If value does not exist return 404 So the flow is async following the nginx cycle"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "What we need though is an addition in the proxy"
                        },
                        {
                          "type": "text",
                          "text": "pass patch to get the value that memcached auth retrieved to pass it to our marking code",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1605606439857
      }
    ]
  },
  {
    "key": "SA-15492",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "  if job_running('postgresql', instance=postgres.pg_version):\n            subprocess.call([\n                'sudo',\n                '-u',\n                'czd-ca',\n                'java',\n                '-jar',\n                '/usr/cz-controllerd/cz-controllerd.jar',\n                'disable-other-controllers',\n                '/etc/cz-controllerd/config.yaml',\n            ])\n            break"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We have this code in configd, to force to single controller."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "After I do the force to single controller, I get error that the 2nd controller is offline in the status, so it seems that it is not working."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It seems it is disabling the Controller role "
                },
                {
                  "type": "text",
                  "text": "Salvatore Tomaselli",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                        "title": "salvatore.tomaselli"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". It is not deactivating the Appliance. If that was your expectation, it wasn't part of the initial design at least."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1606148625137
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But after a restore, the 1st controller, instead of being green, goes like: "
                },
                {
                  "type": "text",
                  "text": "            \"details\": \"Not connected to 1 controller out of 2: envy-172-17-142-2.devops\", ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606228354379
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "(and that is why the latest e2e i did failed, because it expects it just needs to enable the 2nd controller with the api, not to fix the state as well)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606228820761
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "that could be for various reasons. like configd not pulling the configuration changes when it starts? I can take a look if you have an environment where it's reproduced."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1606230669646
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It's a test env where i ran the e2e "
                },
                {
                  "type": "text",
                  "text": "b6a329ff-e3f0-49ee-9b33-0c4d80fb0740",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " controller\n                                roles:   controller, logserver\n                                web ui:  "
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-142-1.devops:444"
                },
                {
                  "type": "text",
                  "text": "\n                                status:  Running\n                                ip:      172.17.142.1\n                                network: 172.17.142.0/24\n                                hostname: envy-172-17-142-1.devops\n                                admin username: admin\n                                admin password: admin\n                        controller2\n                                roles:   controller\n                                web ui:  "
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-142-2.devops:444"
                },
                {
                  "type": "text",
                  "text": "\n                                status:  Running\n                                ip:      172.17.142.2\n                                network: 172.17.142.0/24\n                                hostname: envy-172-17-142-2.devops\n                                admin username: admin\n                                admin password: admin"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606231491557
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "By the way, why does that code need to be run in a loop with several retries and a sleep? It is just locally accessing the db, it shouldn't be anything special\u2026"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606920971690
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "maybe db isn't up in some cases? Should check git history or ask "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "thomas.cellerier",
                    "text": "@thomas.cellerier",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " probably."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1606921725999
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It is up, that's just after we told the db to re-create bdr if it wasn't there\u2026 so it most certainly did reply."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606979975550
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "is this still a thing?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1607517282971
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1607520417668
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok. all you're saying is it isn't working without providing any data whatsoever about it. I can't go around dig evidence for something that hasn't changed and works fine locally."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1607520708397
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What information more information do you need?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The fact that is behind retries is already not indicative of something so reliable."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1607521134086
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You should find out why those retries are there in the first place. I did not get any reports of the command itself being unreliable before. I don't see any reason besides database or controller not being ready yet which is very common with the configd code."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What you're reporting is basically a conspiracy theory."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1607521447550
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the first line here was wrong: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  if job_running('postgresql', instance=postgres.pg_version):"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " it was using 9.4 as the instance instead of 9.4-main."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1610634392690
      }
    ]
  },
  {
    "key": "SA-15578",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is the copyright file."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Format: "
            },
            {
              "type": "text",
              "text": "https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/"
            },
            {
              "type": "text",
              "text": "\n\nFiles: *\nCopyright: (C) 2019 Cyxtera Cybersecurity, Inc. d/b/a AppGate\nLicense: Proprietary\nUpstream-Name: sessiond"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Those are some files contained within the package:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "/usr/src/cz-sessiond/\n/usr/src/cz-sessiond/jackson-jaxrs-json-provider-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jersey-common-2.31-sources.jar.zip\n/usr/src/cz-sessiond/jackson-databind-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jackson-datatype-jsr310-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/logback-core.sources.zip\n/usr/src/cz-sessiond/jetty-servlet-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/javax.servlet-api-3.1.0-sources.jar.zip\n/usr/src/cz-sessiond/hk2-api-2.6.1-sources.jar.zip\n/usr/src/cz-sessiond/httpcore-4.4.13-sources.jar.zip\n/usr/src/cz-sessiond/javax.servlet.sources.zip\n/usr/src/cz-sessiond/jackson-datatype-jdk8-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jersey-media-json-jackson-2.31-sources.jar.zip\n/usr/src/cz-sessiond/jakarta.annotation-api-1.3.5-sources.jar.zip\n/usr/src/cz-sessiond/jetty-security-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/bcpkix-jdk15on-1.66-sources.jar.zip\n/usr/src/cz-sessiond/jakarta.inject-2.6.1-sources.jar.zip\n/usr/src/cz-sessiond/jakarta.activation-api-1.2.1-sources.jar.zip\n/usr/src/cz-sessiond/json-smart-1.3.1-sources.jar.zip\n/usr/src/cz-sessiond/junixsocket-native-common-1.0.2-sources.jar.zip\n/usr/src/cz-sessiond/jna.sources.zip\n/usr/src/cz-sessiond/logback-classic-1.2.3-sources.jar.zip\n/usr/src/cz-sessiond/javax.annotation-api-1.2-sources.zip\n/usr/src/cz-sessiond/hk2-locator-2.6.1-sources.jar.zip\n/usr/src/cz-sessiond/jersey-entity-filtering-2.31-sources.jar.zip\n/usr/src/cz-sessiond/jetty-util-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/boss-logging.sources.zip\n/usr/src/cz-sessiond/jaxb-api-2.3.1-sources.jar.zip\n/usr/src/cz-sessiond/geoip2-2.14.0-sources.jar.zip\n/usr/src/cz-sessiond/jackson-jaxrs-base.sources.zip\n/usr/src/cz-sessiond/bcprov-jdk15on-1.66-sources.jar.zip\n/usr/src/cz-sessiond/jakarta.ws.rs-api-2.1.6-sources.jar.zip\n/usr/src/cz-sessiond/commons-logging-1.2-sources.jar.zip\n/usr/src/cz-sessiond/jackson-datatype-guava-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jaxb-api.sources.zip\n/usr/src/cz-sessiond/jackson-datatype-joda-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/args4j-2.33-sources.jar.zip\n/usr/src/cz-sessiond/commons-codec-1.15-sources.jar.zip\n/usr/src/cz-sessiond/junixsocket-common-1.0.2-sources.jar.zip\n/usr/src/cz-sessiond/aopalliance-repackaged-2.6.1-sources.jar.zip\n/usr/src/cz-sessiond/javax.el.sources.zip\n/usr/src/cz-sessiond/checker-qual-2.10.0-sources.jar.zip\n/usr/src/cz-sessiond/jnagmp-3.0.0-sources.jar.zip\n/usr/src/cz-sessiond/jersey-client-2.31-sources.jar.zip\n/usr/src/cz-sessiond/logback-core-1.2.3-sources.jar.zip\n/usr/src/cz-sessiond/javassist-3.25.0-GA-sources.jar.zip\n/usr/src/cz-sessiond/controller-common-library-5.4.0-201106.0903-sources.jar.zip\n/usr/src/cz-sessiond/jsonrpc2-base-1.38.1-sources.jar.zip\n/usr/src/cz-sessiond/commons-lang3-3.11-sources.jar.zip\n/usr/src/cz-sessiond/snakeyaml-1.27-sources.jar.zip\n/usr/src/cz-sessiond/jackson-annotations-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jackson-core-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jackson-module-afterburner-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/osgi-resource-locator-1.0.3-sources.jar.zip\n/usr/src/cz-sessiond/guava-28.2-jre-sources.jar.zip\n/usr/src/cz-sessiond/jakarta.xml.bind-api-2.3.2-sources.jar.zip\n/usr/src/cz-sessiond/javax.activation-api-1.2.0-sources.jar.zip\n/usr/src/cz-sessiond/slf4j-api-1.7.25-sources.jar.zip\n/usr/src/cz-sessiond/jackson-module-parameter-names-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jetty-server-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/hk2-locator.sources.zip\n/usr/src/cz-sessiond/hk2-utils.sources.zip\n/usr/src/cz-sessiond/jackson-jaxrs-base-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/hk2-api.sources.zip\n/usr/src/cz-sessiond/hk2-utils-2.6.1-sources.jar.zip\n/usr/src/cz-sessiond/jetty-http-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/jsr305-3.0.2-sources.jar.zip\n/usr/src/cz-sessiond/j2objc-annotations-1.3-sources.jar.zip\n/usr/src/cz-sessiond/failureaccess-1.0.1-sources.jar.zip\n/usr/src/cz-sessiond/jna-5.5.0-sources.jar.zip\n/usr/src/cz-sessiond/httpclient-4.5.12-sources.jar.zip\n/usr/src/cz-sessiond/jersey-hk2-2.31-sources.jar.zip\n/usr/src/cz-sessiond/native-lib-loader-2.2.0-sources.jar.zip\n/usr/src/cz-sessiond/joda-time-2.9.9-sources.jar.zip\n/usr/src/cz-sessiond/error_prone_annotations-2.3.4-sources.jar.zip\n/usr/src/cz-sessiond/SDNotify-1.3-sources.jar.zip\n/usr/src/cz-sessiond/jetty-jmx-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/maxmind-db-1.4.0-sources.jar.zip\n/usr/src/cz-sessiond/jackson-module-jaxb-annotations-2.11.2-sources.jar.zip\n/usr/src/cz-sessiond/jetty-io-9.4.31.v20200723-sources.jar.zip\n/usr/src/cz-sessiond/policy-evaluator-5.4.0-201021.1154-sources.jar.zip"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "So it seems somehow pretty unrealistic that the copyright file is accurate."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Please make it accurate."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We only need to include sources of LGPL dependencies (to make gcp happy), and we can't use AGPL and GPL."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "In the case that there actually LGPL libraries in there, I am not sure of what the legal status of using a fat jar would be, since the license of LGPL libraries says that the user must be able to replace them, so they can't be statically linked (unless object files are provided to relink the final binary)."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I guess we should update the dependency plugin .. "
                },
                {
                  "type": "text",
                  "text": "https://github.com/hierynomus/license-gradle-plugin",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/hierynomus/license-gradle-plugin"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " <-- this could be something to check.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1606739481106
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is probably a good task for you anton.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1606739512057
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "salvatore.tomaselli",
                    "text": "@salvatore.tomaselli",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "  "
                },
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com/issue/SA-10604",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-youtrack.agi.appgate.com/issue/SA-10604"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "  according to you   CDDL, GPL, LGPL, EPL and MPL should be included..  what do you want? only LGPL or CDDL, GPL, LGPL, EPL and MPL"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1606740297974
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well thing is, if there is GPL, sessiond is now free software :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606745036306
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is no GPL but there are pretty many CDDL license libraries.. so should we include them or not"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1606745233300
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Most of the libraries there have a MIT license, so we don't need to ship the sources. That would save time and space on every build."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Plus the copyright file needs to include the correct information anyway."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm not sure about LGPL, since we run the thingy as a fat jar."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If instead of using those, the versions that are packaged in ubuntu already would work, it'd be better, then we don't need to worry about LGPL or shipping sources, if they are already part of the base distribution. But that can be explored later I guess."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This task is strictly about:"
                }
              ]
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Having actual information on license of all the files that are installed by sessiond"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Do not include sources for libraries that have MIT/BSD/Apache license."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1606745302584
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok..  then we will still continue to include the CDDL .."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1606746107182
      }
    ]
  },
  {
    "key": "SA-15632",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[1] Error: Warning: Cannot update a component (`%s`) while rendering a different component (`%s`). To locate the bad setState() call inside `%s`, follow the stack trace as described in "
            },
            {
              "type": "text",
              "text": "https://fb.me/setstate-in-render%s"
            },
            {
              "type": "text",
              "text": " App StatusView StatusVie\nw\n[1]     in StatusView (created by Context.Consumer)\n[1]     in Route (created by AppRouting)\n[1]     in Router (created by AppRouting)\n[1]     in AppRouting (created by AppWrapper)\n[1]     in div (created by AppWrapper)\n[1]     in ToastProvider (created by AppWrapper)\n[1]     in AppWrapper (created by App)\n[1]     in App"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " and {{CODEBLOCK1}}"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15677",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For this kind of error: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Nov 14 04:04:36.703529 ec2-3-137-17-216.us-east-2.compute.amazonaws.com cz-named[23848]: [INFO] [STSCredentials] Renewing sts credentials arn:aws:iam::738846512696:role/AppGateRole with master credentials instance credentials with current access key id ASIA2YBVPCY4LY5G6LNG\nNov 14 04:04:36.765906 ec2-3-137-17-216.us-east-2.compute.amazonaws.com cz-named[23848]: [ERROR] [STSClient] Action AssumeRole using POST "
            },
            {
              "type": "text",
              "text": "https://sts.amazonaws.com"
            },
            {
              "type": "text",
              "text": " returned with HTTP 403 Forbidden\nNov 14 04:04:36.766200 ec2-3-137-17-216.us-east-2.compute.amazonaws.com cz-named[23848]: [ERROR] [STSClient] Got error response of type Sender and code AccessDenied: User: arn:aws:sts::065840544940:assumed-role/appgate-gateway-role/i-0713e75dee8d00722 is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::738846512696:role/AppGateRole\nNov 14 04:04:36.766279 ec2-3-137-17-216.us-east-2.compute.amazonaws.com cz-named[23848]: [ERROR] Failed to get credentials for the assumed role: AssumedRole(role_session_name='AppGateAWSResolver-0b77e34f-b130-48aa-9fa7-8a3e7f76d9b0', account_id='738846512696', role_name='AppGateRole', duration=900, regions={'us-east-2'}, external_id=None)\nNov 14 04:04:36.766449 ec2-3-137-17-216.us-east-2.compute.amazonaws.com cz-named[23848]: [ERROR] [STSCredentials] Failed to get new credentials for sts credentials arn:aws:iam::738846512696:role/AppGateRole with master credentials instance credentials with current access key id ASIA2YBVPCY4LY5G6LNG"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15713",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is the copyright file of the controller package."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "$ cat /usr/share/doc/cz-controllerd/copyright\nFormat: "
            },
            {
              "type": "text",
              "text": "https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/"
            },
            {
              "type": "text",
              "text": "\n\nFiles: *\nUpstream-Name: cz-controllerd\nCopyright: (C) 2020 Cyxtera Technologies, Inc.\nLicense: Proprietary"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Now, controller package actually ships a number of dependencies within the same package."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "At the moment the copyright and license of all the dependencies is wrongly attributed to appgate."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "mention",
              "attrs": {
                "id": "anton.lundgren",
                "text": "@anton.lundgren",
                "accessLevel": ""
              }
            },
            {
              "type": "text",
              "text": " is working on a similar issue for sessiond, so perhaps his solution could be applied to both repositories once he is done?"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The 3rd party dependencies are installed on a separate path, so the copyright info is also on a separate path. See the screenshots. It's a remnant of the old way of having multiple controller services. It should be cleaned up at some point probably so everything is installed at the same spot, but that's not part of this task."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "![](image1608030734135.png)![](image1608030795976.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1608030797120
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " nop, it needs to be a valid copyright file in that precise path for it to be scanned, because the scanner finds \"non ubuntu packages\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1608031612215
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If there is no such package with that name it won't be picked up."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1608031639196
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok, I thought it was the directory of the installation that's relevant, not the package. I'll merge them."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1608032005175
      }
    ]
  },
  {
    "key": "SA-15790",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It will need update on the frontend part to to update the links to the mains parts (update of "
            },
            {
              "type": "text",
              "text": "tabGuideMap",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " under "
            },
            {
              "type": "text",
              "text": "appliances/Contsants.js",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ")"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The new URLs are "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "https://sdphelp.appgate.com/adminguide/v5.4/appliance-system-configure.html"
                },
                {
                  "type": "text",
                  "text": "\n"
                },
                {
                  "type": "text",
                  "text": "https://sdphelp.appgate.com/adminguide/v5.4/appliance-function-configure.html"
                },
                {
                  "type": "text",
                  "text": "\n"
                },
                {
                  "type": "text",
                  "text": "https://sdphelp.appgate.com/adminguide/v5.4/appliance-miscellaneous-configure.html"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1615197893618
      }
    ]
  },
  {
    "key": "SA-15860",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "After the 5 mins of token revocation, the lite client is not informing immediately to the upper layer that a site is down. In consequence the C# code part doesn't dispose the driver and proxy settings are not cleared, hence the browser is not able to access the SAML login page due to a proxy error."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2021-01-14T23:01:14.014Z] Info : Token revocation for [5b40efcb-881a-4733-ab73-2a01f2d725d6] is received by 'ES-APPGATE02_labspace_com'. Will update the token.\n[2021-01-14T23:01:14.014Z] Info : Token revocation for [71c06d2a-8d86-4e98-be52-e7a16de84c93] is received by 'ES-APPGATE02_labspace_com'. Will update the token.\n[2021-01-14T23:01:24.369Z] Info : Starting HTTP Server to receive SAML token.\n[2021-01-14T23:01:24.369Z] Info : Starting the browser to "
            },
            {
              "type": "text",
              "text": "https://login.microsoftonline.com/7733d4d4-91f3-4dea-b063-9263633dbd9b/saml2?SAMLRequest=fY%2FNTsMwEIRfxdp7gn8SmqziVJEqUCW4QOHABVmOSyMldvA6iMcngiKVC8fV7Mx802w%2Fp5F9uEhD8BpEzoE5b0M%2F%2BDcNT4ebrIJt25CZRjljt6STf3Dvi6PEVqMn%2FFE0LNFjMDQQejM5wmTxsbu%2FQ5lznGNIwYYR2H6n4dUVtbJK1Gpz7GtxvVHH0pqqVFYo1du%2BWt%2BIFrf3lIxPGiSXIuMiE8VBSiwr5FVeKP4C7PmXe22BMyV%2Bm%2BMl3v90hsjFtMZA283zrUmuubpMas%2Fn3%2FntFw%3D%3D"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n[2021-01-14T23:03:22.789Z] Info : Processing on-demand Claims: [Command: processRunning, ClaimName: AMP_Running, Parameters: [[name, sfc]], Command: processRunning, ClaimName: SEP_Running, Parameters: [[name, sepWscSvc64]], Command: processRunning, ClaimName: FireEye_Agent_Running, Parameters: [[name, xagt]]]\n[2021-01-14T23:06:14.811Z] Error : 'VPN Proxy Device': Error: Error when trying to check events on shim device. Error: 10038\n[2021-01-14T23:06:14.867Z] Error : 'VPN Proxy Device': Error: Error when trying to check events on shim device. Error: 10038\n[2021-01-14T23:06:14.868Z] Error : 'VPN Proxy Device': Error: Error when trying to check if site is ready to write. Invalid SOCKET.\n[2021-01-14T23:08:23.020Z] Info : Processing on-demand Claims: [Command: processRunning, ClaimName: AMP_Running, Parameters: [[name, sfc]], Command: processRunning, ClaimName: SEP_Running, Parameters: [[name, sepWscSvc64]], Command: processRunning, ClaimName: FireEye_Agent_Running, Parameters: [[name, xagt]]]\n[2021-01-14T23:12:24.336Z] Info : Starting HTTP Server to receive SAML token.\n[2021-01-14T23:12:24.337Z] Info : Starting the browser to "
            },
            {
              "type": "text",
              "text": "https://login.microsoftonline.com/7733d4d4-91f3-4dea-b063-9263633dbd9b/saml2?SAMLRequest=fY%2FNTsMwEIRfxdp7gn8SmqziVJEqUCW4QOHABVmOSyMldvA6iMcngiKVC8fV7Mx802w%2Fp5F9uEhD8BpEzoE5b0M%2F%2BDcNT4ebrIJt25CZRjljt6STf3Dvi6PEVqMn%2FFE0LNFjMDQQejM5wmTxsbu%2FQ5lznGNIwYYR2H6n4dUVtbJK1Gpz7GtxvVHH0pqqVFYo1du%2BWt%2BIFrf3lIxPGiSXIuMiE8VBSiwr5FVeKP4C7PmXe22BMyV%2Bm%2BMl3v90hsjFtMZA283zrUmuubpMas%2Fn3%2FntFw%3D%3D"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n[2021-01-14T23:13:16.691Z] Info : Starting HTTP Server to receive SAML token."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15963",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The build agents will soon lose access to remote resource on the internet. so we need to setup a proxy for sum.golang.org to be able to authenticate the package we install and download."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Setup a direct raw proxy to sum.golang.org"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "https://got-nexus01.agi.appgate.com",
                      "marks": [
                        {
                          "type": "link",
                          "attrs": {
                            "href": "https://got-nexus01.agi.appgate.com"
                          }
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": ":8443/#admin/repository/repositories:"
                    },
                    {
                      "type": "text",
                      "text": "gosum"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "https://got-nexus01.agi.appgate.com",
                      "marks": [
                        {
                          "type": "link",
                          "attrs": {
                            "href": "https://got-nexus01.agi.appgate.com"
                          }
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": ":8443/#browse/browse:"
                    },
                    {
                      "type": "text",
                      "text": "gosum"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "how to use it:"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "export environment variable "
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "GOSUMDB=\"sum.golang.org "
                    },
                    {
                      "type": "text",
                      "text": "https://got-nexus01.agi.appgate.com:8443/repository/gosum\""
                    },
                    {
                      "type": "text",
                      "text": "\n "
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-15976",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I had left my portal env/setup for 2 days. Today I went to got-youtrack and got redirected to the portal, that's fine. I didn't logged in and I closed the tab. I went again to got-youtrack and instead of getting the page to log in I get \"bad gateway 502\" and the URL in browser stays "
            },
            {
              "type": "text",
              "text": "https://got-youtrack.agi.appgate.com/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://got-youtrack.agi.appgate.com/"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " i.e. no redirection"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I checked logs and cz-dnsproxyd say "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Feb 01 09:33:31 envy-172-17-198-1.devops cz-dnsproxyd[2475]: WARNING [cz-dnsproxyd] Can't get cookie info (2v767jgyy7) from memcache. memcache: cache miss\nFeb 01 09:33:36 envy-172-17-198-1.devops cz-dnsproxyd[2475]: WARNING [cz-dnsproxyd] Can't get cookie info (2v767jgyy7) from memcache. memcache: cache miss\nFeb 01 09:33:41 envy-172-17-198-1.devops cz-dnsproxyd[2475]: WARNING [cz-dnsproxyd] Can't get cookie info (2v767jgyy7) from memcache. memcache: cache miss\nFeb 01 09:33:46 envy-172-17-198-1.devops cz-dnsproxyd[2475]: WARNING [cz-dnsproxyd] Can't get cookie info (2v767jgyy7) from memcache. memcache: cache miss"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The problem is that that cookie is old/expored/doesn't exist in the memcache but no redirection is happening to renew it"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is  untrue. Based on the following logs "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " 01 09:32:39 envy-172-17-198-1.devops cz-webd[2564]: WARNING [router][192.168.100.190][1azk7uhr4l] Invalid or old cookie No such session, creating a new cookie and session\nFeb 01 09:32:39 envy-172-17-198-1.devops cz-webd[2564]: INFO    [allocationLogic] Allocated: 1, Free: 32, Suggestion: 1, CurrentOutSignal : 0\nFeb 01 09:32:39 envy-172-17-198-1.devops cz-webd[2564]: INFO    [allocationLogic] Calling clientd to add a client\nFeb 01 09:32:40 envy-172-17-198-1.devops cz-webd[2564]: INFO    [unauthenticated][192.168.100.190][2v767jgyy7][router] New Session created\nFeb 01 09:32:40 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] First connection started\nFeb 01 09:32:40 envy-172-17-198-1.devops cz-webd[2564]: INFO    [unauthenticated][2v767jgyy7][9005][session] Session idle timer canceled\nFeb 01 09:32:40 envy-172-17-198-1.devops cz-webd[2564]: INFO    [allocationLogic] Client allocated: 9000 /run/appgate/portal9000/appgate.service.socket\nFeb 01 09:32:40 envy-172-17-198-1.devops cz-webd[2564]: INFO    [allocationLogic] Allocated: 1, Free: 33, Suggestion: 0, CurrentOutSignal : 0\nFeb 01 09:32:47 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Last connection closed\nFeb 01 09:32:47 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Session idle timer started\nFeb 01 09:32:47 envy-172-17-198-1.devops cz-webd[2564]: INFO    [router][192.168.100.190][2v767jgyy7][postCookie][unauthenticated] postCookieOK "
                },
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com:443/clientless-16872eb8"
                },
                {
                  "type": "text",
                  "text": "\nFeb 01 09:32:47 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Session idle timer started\nFeb 01 09:32:48 envy-172-17-198-1.devops cz-webd[2564]: INFO    [router][192.168.100.190][2v767jgyy7][storeCookie][unauthenticated] Redirecting to /, copy cookie for host localhost\nFeb 01 09:33:00 envy-172-17-198-1.devops cz-webd[2564]: INFO    [router][192.168.100.190][2v767jgyy7][postCookie][unauthenticated] postCookieOK "
                },
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com:443/clientless-16872eb8"
                },
                {
                  "type": "text",
                  "text": "\nFeb 01 09:33:00 envy-172-17-198-1.devops cz-webd[2564]: INFO    [9005][2v767jgyy7][session][unauthenticated] Session idle timer started\nFeb 01 09:33:00 envy-172-17-198-1.devops cz-webd[2564]: INFO    [192.168.100.190][2v767jgyy7][router][storeCookie][unauthenticated] Redirecting to /, copy cookie for host localhost\nFeb 01 09:33:43 envy-172-17-198-1.devops cz-webd[2564]: INFO    [9005][2v767jgyy7][session][unauthenticated] Banner connected\nFeb 01 09:33:43 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] First connection started\nFeb 01 09:33:43 envy-172-17-198-1.devops cz-webd[2564]: INFO    [session][2v767jgyy7][9005][unauthenticated] Session idle timer canceled\nFeb 01 09:34:21 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connection closed, by: Browser , why: websocket: close 1001 (going away)\nFeb 01 09:34:21 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Last connection closed\nFeb 01 09:34:21 envy-172-17-198-1.devops cz-webd[2564]: INFO    [unauthenticated][2v767jgyy7][9005][session] Session idle timer started\nFeb 01 09:34:51 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connected\nFeb 01 09:34:51 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] First connection started\nFeb 01 09:34:51 envy-172-17-198-1.devops cz-webd[2564]: INFO    [unauthenticated][2v767jgyy7][9005][session] Session idle timer canceled\nFeb 01 09:35:39 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connected\nFeb 01 09:39:49 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connected\nFeb 01 09:39:53 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connection closed, by: Browser , why: websocket: close 1001 (going away)\nFeb 01 09:39:55 envy-172-17-198-1.devops cz-webd[2564]: INFO    [9005][2v767jgyy7][session][unauthenticated] Banner connected\nFeb 01 09:40:23 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connection closed, by: Browser , why: websocket: close 1001 (going away)\nFeb 01 09:40:24 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connected\nFeb 01 09:43:32 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connection closed, by: Browser , why: websocket: close 1001 (going away)\nFeb 01 09:56:02 envy-172-17-198-1.devops cz-webd[2564]: INFO    [2v767jgyy7][9005][session][unauthenticated] Banner connection closed, by: Browser , why: websocket: close 1006 (abnormal closure): unexpect"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "   The session was created a \"Feb 01 09{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "32}}40\"   The session never logged in..  And the dns information is recieved by the webd when the session is logged in."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So before you login you will ofcourse get cz-dnsproxyd trace errors."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1612182090542
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Its also good to include a bit more logs. Fortunately i was able to get them from the enviroment"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1612182137342
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What is untrue? I never logged in and I never get redirected. That's the problem here not the dnsproxyd"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1612182439204
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so we should redirect to client, if the session does not exist.. or if the session is not logged in.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Where shall we fix that..   nginx or webd?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1612184854850
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Nginx could ask some memcache which webd populates: \"Does this aguid have a valid session? If yes then continue as normal else redirect to login page\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In slack "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " and you have discussed another approach though"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1612185256898
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yep. one could actually use the same key as dnsproxyd uses.. and that information is available when the session has logged in"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1612185801997
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yep looks like we are doing with that.. so i guess this needs to happen in nginx"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1612186552428
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this is done, no?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1613574790066
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "must be"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1613576655261
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Obsolete? Didn't my nginx fix work? The code was linked to this task"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1613758179888
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It is merged "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-appliance/commit/a3461053f7a251156e28f36948f11275064b1ab0",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-appliance/commit/a3461053f7a251156e28f36948f11275064b1ab0"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " I move it to verify then"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1613758364907
      }
    ]
  },
  {
    "key": "SA-15992",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I'll copy paste what Norwegian reported:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Backspace handling in new OTP remediation prompt\nA new UI for entering OTPs was introduced in 5.3 with individual boxes for each of the 6 OTP digits.\nWhen entering an OTP this functions as expected with each digit advancing to the following box. No loss of functionality over the old method for this part.\nWhen using backspace to make a correction however, it does not behave as expected and requires two presses. It seems the first establishes focus and the following deletes the digit.\nI am not sure if I have explained this well, so please let me know if you can reproduce it and if it makes sense.\nI just had a look if there was something that showed how I believe it is expected to behave, and I found this:\n"
            },
            {
              "type": "text",
              "text": "https://midhunmonachan.github.io/otp_html_input.html"
            },
            {
              "type": "text",
              "text": "\nI believe that this behaves as users expect, in both directions. I share the link solely for the behaviour, not the code. I have not looked at the code and it may not be the \"right\" way to do this, just wanted to show the expected UX."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So the current behaviour is after discussions with "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "per.svensson",
                    "text": "@per.svensson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " . We shouldn't just change the behaviour just because a customer wants it unless we actually agree on it. So leaving the decision to svensson here, as the behaviour Norwegian wants has other drawbacks."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1612261815415
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I find the current behavior annoying too. And some others in slack mentioned some irritation also. What are the drawbacks?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1612262119268
      }
    ]
  },
  {
    "key": "SA-16064",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Configure two profiles for portal"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Try to choose another profile"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "It doesn't do much"
                    }
                  ]
                },
                {
                  "type": "blockquote",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Feb 10 14{{COLON"
                        },
                        {
                          "type": "text",
                          "text": "NUM",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "37}}59 envy-172-17-134-1.devops cz-webclient"
                        },
                        {
                          "type": "mention",
                          "attrs": {
                            "id": "9001",
                            "text": "@9001",
                            "accessLevel": ""
                          }
                        },
                        {
                          "type": "text",
                          "text": "[6028]: [2021-02-10T14{{COLON"
                        },
                        {
                          "type": "text",
                          "text": "NUM",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "37}}59.062Z] Warn : Web Client attempted an API that is not allowed."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16125",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "If I don't have an entitlement on portal and I attempt to go there, the browser hangs for like 60 seconds and then fails with HTTP 503 (I think) Gateway Timeout. This HTTP code implies there is something wrong with the server which is not the case."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is afaik the default behavior of proxy"
            },
            {
              "type": "text",
              "text": "pass. From it's purpose perspective, it's natural it returns 503. But let's see if we can change that. To 401 or 403 I guess. Something that matches the URL access responses.",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Related: SA-16028"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Something like this should do the trick ` proxy"
                },
                {
                  "type": "text",
                  "text": "intercept",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "errors on; error"
                },
                {
                  "type": "text",
                  "text": "page 404 =302 /your",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "html"
                },
                {
                  "type": "text",
                  "text": "file",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1614679644907
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed with the below: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "https://$cookie_aguid_label.$host:$server_port$request_uri"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n        proxy_intercept_errors on;\n        error_page 500 502 503 504 = @fallback;\n    }\n\n    location @fallback {\n        return 403;\n    }"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "!"
                },
                {
                  "type": "text",
                  "text": "Text",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "403.png"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1614682705035
      }
    ]
  },
  {
    "key": "SA-16247",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[11:00:18][appgate-image] Adding administrative user account...\n[11:00:18][appgate-image] + touch root/home/cz/.sudo_as_admin_successful\n[11:00:18][appgate-image] + ../run-in-chroot root chown -R cz:cz /home/cz/\n[11:00:18][appgate-image] + chmod 750 root/home/cz/\n[11:00:18][appgate-image] + sed 's/^RANDFILE.*//g' -i root/etc/ssl/openssl.cnf\n[11:00:18][appgate-image] + ../unsetup_apt_in_chroot root\n[11:00:18][appgate-image] + DIR=root\n[11:00:18][appgate-image] + dirname ../unsetup_apt_in_chroot\n[11:00:18][appgate-image] + MYPATH=..\n........\n[11:00:19][appgate-image] + rm root/etc/apt/sources.list.d/localrepo.list\n[11:00:19][appgate-image] + rm -f root/etc/apt/trusted.gpg.d/apt-mirror-keyring-8FBD2738.gpg root/etc/apt/trusted.gpg\n[11:00:19][appgate-image] + cat\n[11:00:19][appgate-image] + ../run-in-chroot root apt-get update\n[11:00:19][appgate-image] Get:1 <"
            },
            {
              "type": "text",
              "text": "http://archive.ubuntu.com/ubuntu>"
            },
            {
              "type": "text",
              "text": " bionic InRelease [242 kB]\n[11:00:19][appgate-image] Get:2 <"
            },
            {
              "type": "text",
              "text": "http://archive.ubuntu.com/ubuntu>"
            },
            {
              "type": "text",
              "text": " bionic-updates InRelease [88.7 kB]\n[11:00:19][appgate-image] Get:3 <"
            },
            {
              "type": "text",
              "text": "http://security.ubuntu.com/ubuntu>"
            },
            {
              "type": "text",
              "text": " bionic-security InRelease [88.7 kB]\n[11:00:19][appgate-image] Get:4 <"
            },
            {
              "type": "text",
              "text": "http://archive.ubuntu.com/ubuntu>"
            },
            {
              "type": "text",
              "text": " bionic/main amd64 Packages [1019 kB]\n...."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Towards the end of the image creation, mirrors are changed to point to the public ones, apt update is ran so that the license collector knows which packages do not exist on apt."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Do this using the internal clean mirror instead, and then change the mirrors to the public ones without running the update, so that we don't connect out."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16260",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We should set up proper public repos for the linux clients, so that linux users could get updates through their normal update process. Repos should be separate per minor version so that users to not start running ahead of server versions."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Here I list some technologies that could be used and a mockup of what the installation instructions would be for the user."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For Ubuntu, we could use PPA "
            },
            {
              "type": "text",
              "text": "https://help.launchpad.net/Packaging/PPA",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://help.launchpad.net/Packaging/PPA"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "sudo add-apt-repository ppa:appgate/sdpclient53\nsudo apt update \nsudo apt install appgate-sdp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For Fedora & RHEL, there's COPR "
            },
            {
              "type": "text",
              "text": "https://copr.fedorainfracloud.org/coprs/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://copr.fedorainfracloud.org/coprs/"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "sudo dnf install epel-release\nsudo dnf copr enable appgate/sdpclient53\nsudo dnf install appgate-sdp"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For Arch, the work has already been done. "
            },
            {
              "type": "text",
              "text": "https://aur.archlinux.org/packages/appgate-sdp/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://aur.archlinux.org/packages/appgate-sdp/"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "git clone "
            },
            {
              "type": "text",
              "text": "https://aur.archlinux.org/appgate-sdp.git"
            },
            {
              "type": "text",
              "text": "\ncd appgate-sdp\nmakepkg -si"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "kasper.gustavsson",
                    "text": "@kasper.gustavsson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " I guess these are easy to manage and not like Azure :-). I assume there is just some sort of repository where we upload these. I guess they do need 'approving'. I imagine you cold script all this when we do a release. So if we do this what steps are there to get it going?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1625555326813
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If you think that this feature request is still valid. Please add it to "
                },
                {
                  "type": "text",
                  "text": "https://ztna.ideas.craft.io",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://ztna.ideas.craft.io"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "christoffer.karlsson",
        "created": 1749718081443
      }
    ]
  },
  {
    "key": "SA-16346",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Connect with u:p on headless"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Blacklist user"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "See that the connection is gone"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Unblacklist user"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Connection is not back"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "That's because we trigger a \"password renewal\" user action in that case which needs to be specially handled by headless. See these relevant logs:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "[2021-03-23T14:27:16.185Z] Warn : Authentication to '"
                    },
                    {
                      "type": "text",
                      "text": "https://appgate.sullcrom.com/'"
                    },
                    {
                      "type": "text",
                      "text": " failed while renewing claims token. Prompting user to re-authenticate.\n[2021-03-23T14:33:29.735Z] Info : 'VPN Driver': Closing connection.\n... and then nothing until you restart the service."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16375",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "At the moment cz-webd verifies that the domain really belongs to what the certificate is made for. For example it checks that "
            },
            {
              "type": "text",
              "text": "got-teamcity.agi.appgate.com",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " is indeed covered by the certificate "
            },
            {
              "type": "text",
              "text": "*.appgate.com",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ". This check is redundant as SSL handshake between browser and nginx will fail instantly in case there is no match"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Curl to access google.com through portal where nginx is set with \\"
            },
            {
              "type": "text",
              "text": ".appgate.com certificate "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "kosmas@kosmas-VirtualBox:/media/kosmas/Data/git/stratus-appliance$ curl -v "
            },
            {
              "type": "text",
              "text": "https://google.com/post-cookie"
            },
            {
              "type": "text",
              "text": "\n*   Trying 35.181.145.75:443...\n* TCP_NODELAY set\n* Connected to google.com (35.181.145.75) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\n* ALPN, server accepted to use h2\n* Server certificate:\n*  subject: C=US; ST=Florida; L=Coral Gables; O=Cyxtera Cybersecurity, Inc.; CN=*.purple.appgate.com\n*  start date: Jan 14 00:00:00 2021 GMT\n*  expire date: Jan 18 23:59:59 2022 GMT\n*  subjectAltName does not match google.com\n* SSL: no alternative certificate subject name matches target host name 'google.com'\n* Closing connection 0\n* TLSv1.2 (OUT), TLS alert, close notify (256):\ncurl: (60) SSL: no alternative certificate subject name matches target host name 'google.com'\nMore details here: "
            },
            {
              "type": "text",
              "text": "https://curl.haxx.se/docs/sslcerts.html"
            },
            {
              "type": "text",
              "text": "\n\ncurl failed to verify the legitimacy of the server and therefore could not\nestablish a secure connection to it. To learn more about this situation and\nhow to fix it, please visit the web page mentioned above."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It would make sense in case of HTTP but as the portal will only be HTTPs then nginx/SSL is making sure of the match"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this is now obsolete.. we only have domain verification in copy-cookie and store-cookie left.. and since we can not validate that in nginx, we will validate it in webd"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617875505399
      }
    ]
  },
  {
    "key": "SA-16473",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Seems like elasticsearch is complaining on the version field. "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 08 14:10:25 envy-10-97-254-2.devops cz-logd[8803]: WARNING [Elasticsearch] Errors during insert: {\"took\":1,\"errors\":true,\"items\":[{\"create\":{\"_index\":\"logstash-2021-04-08\",\"_type\":\"logs\",\"_id\":\"c1ngtk9dt3ce3rtejllg\",\"status\":400,\"error\":{\"type\":\"mapper_parsing_exception\",\"reason\":\"failed to parse field [version] of type [long] in document with id 'c1ngtk9dt3ce3rtejllg'\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"For input string: \\\"5.4.0-24336\\\"\"}}}}]}\nApr 08 14:10:29 envy-10-97-254-2.devops cz-logd[8803]: WARNING [Elasticsearch] Errors during insert: {\"took\":1,\"errors\":true,\"items\":[{\"create\":{\"_index\":\"logstash-2021-04-08\",\"_type\":\"logs\",\"_id\":\"c1ngtl9dt3ce3rtejlm0\",\"status\":400,\"error\":{\"type\":\"mapper_parsing_exception\",\"reason\":\"failed to parse field [version] of type [long] in document with id 'c1ngtl9dt3ce3rtejlm0'\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"For input string: \\\"5.4.0-24336\\\"\"}}}}]}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "normally the version fields there is the api-version not a string.. that will cause mapping conflicts"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But i wonder if we also are missing important fields, like id, daemon "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 08 13:47:17 envy-10-97-254-2.devops cz-configd[843]: INFO {'event_type': 'appliance_status_changed', 'version': '5.4.0-24336', 'cpu': {'percent': 5.4}, 'disk': {'free': 19292483584, 'percent': 0.6, 'total': 20470939648, 'used': 114991104}, 'memory': {'free': 5818290176, 'percent': 49.1, 'total': 20993622016, 'used': 10299920384}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed': '43.2 bps', 'rxSpeed': '48.0 bps', 'dropin': 5, 'dropout': 0, 'ips': ['10.97.254.2']}}}, 'roles': {'appliance': {'status': 'healthy'}, 'controller': {'status': 'healthy', 'details': 'Database size is 12 MB'}, 'logServer': {'status': 'healthy', 'details': '100% of shards are active.'}}, 'state': 'controller_ready', 'status': 'healthy', 'upgrade': {'status': 'idle'}, 'appliance_version': '5.4.0-24336', 'volumeNumber': 1}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617892218705
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is also a problem with the \"appliance"
                },
                {
                  "type": "text",
                  "text": "status",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "changed\" audit log which passes the appliance version as the audit log version instead of the API version (now 15)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1617892359954
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the missing fields are not a problem the client adds them afterwards, configd logs them before that I think: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "        if 'timestamp' not in log:\n            log['timestamp'] = iso_date()\n        if 'event_type' not in log:\n            raise ValueError('Missing field \"event_type\"')\n        if 'daemon' in log:\n            raise ValueError('Value \"daemon\" is strictly forbidden')\n        if 'id' not in log:\n            log['id'] = str(uuid.uuid4())"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1617892688345
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I traced back the file."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since day one (in 2018) "
                },
                {
                  "type": "text",
                  "text": "caa1a4770390d2505db34a2ce1af472b4553fb00",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " the "
                },
                {
                  "type": "text",
                  "text": "version",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " field was something like "
                },
                {
                  "type": "text",
                  "text": "4.x.x",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " so it has always been a string. The only recent change (6 months) is about having also the build number in there."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The change was made because the version file was just a string that was containing the an out of date non-numeric value."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617952132621
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So if elastic search has always wanted a numeric field there, this code has never worked."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Or, there has been some later change in elasticsearch configuration (such as "
                },
                {
                  "type": "text",
                  "text": "63c900b6",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " in jun2019 on logging repository, defining a mapping for version as integer)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617952916828
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In any event, not a problem to change it to peer api version."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617952943622
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Question is this is a problem on the release branch right now.. maybe its "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "thomas.cellerier",
                    "text": "@thomas.cellerier",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " trolling ous..  because i just made a relase env.. and there is working.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617953593709
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah i just made another one.. here it looks good"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617954144909
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think your special build was somehow strange "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "thomas.cellerier",
                    "text": "@thomas.cellerier",
                    "accessLevel": ""
                  }
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617954177872
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this is however another issue..  there are log-drops from configd during the statup phase.. when logd is restarting "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Apr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: WARNING [status] System status changed from warning to error\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: INFO {'event_type': 'appliance_status_changed', 'version': '5.4.0-24337-release', 'cpu': {'percent': 72.7}, 'disk': {'free': 19300872192, 'percent'\n: 0.5, 'total': 20470939648, 'used': 106602496}, 'memory': {'free': 15492907008, 'percent': 3.8, 'total': 20993622016, 'used': 806526976}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed':\n '0.0 Bps', 'rxSpeed': '0.0 Bps', 'dropin': 1, 'dropout': 0, 'ips': ['10.97.180.2']}}}, 'roles': {'appliance': {'status': 'error', 'details': 'The following service is not running: cz-logd\\nThe following \nservice should not be running: ssh\\nno ntp servers configured\\ncz-logd: Failed to perform healthcheck for cz-logd'}}, 'state': 'waiting_config', 'status': 'error', 'upgrade': {'status': 'idle'}, 'applianc\ne_version': '5.4.0-24337-release', 'volumeNumber': 1}\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: ERROR [status] Failed to write appliance_status_changed audit log! {'cpu': {'percent': 72.7}, 'disk': {'free': 19300872192, 'percent': 0.5, 'total': 20470939648, 'used': 106602496}, 'memory': {'free': 15492907008, 'percent': 3.8, 'total': 20993622016, 'used': 806526976}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed': '0.0 Bps', 'rxSpeed': '0.0 Bps', 'dropin': 1, 'dropout': 0, 'ips': ['10.97.180.2']}}}, 'roles': {'appliance': {'status': 'error', 'details': 'The following service is not running: cz-logd\\nThe following service should not be running: ssh\\nno ntp servers configured\\ncz-logd: Failed to perform healthcheck for cz-logd'}}, 'state': 'waiting_config', 'status': 'error', 'upgrade': {'status': 'idle'}, 'appliance_version': '5.4.0-24337-release', 'volumeNumber': 1}\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: INFO [status] Appliance ips change from no ips to 10.97.180.2\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: INFO [change] Change 667e151c-1b5a-42d4-a7ef-f9d8936e18e3 submitted\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: cz-logd.service: Service hold-off time over, scheduling restart.\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: cz-logd.service: Scheduled restart job, restart counter is at 1.\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: Stopped Appliance Logd, application for reliable logging.\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: Starting Appliance Logd, application for reliable logging...\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [ServerLogic] Starting server logic, role is: server\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [console] Console listening at /run/cz-logd/cz-logd-admin.socket\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [esLogRetention] Checking retention(initial)\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [ServerLogic] Setting up relp server\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [RelpServer] RelpServer starting @ 127.0.0.1:9320 idleTimeout:true/1h0m0s\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: Started Appliance Logd, application for reliable logging.\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: WARNING [esLogRetention] Was unable to get index list: Get \""
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/_cat/indices?format=json\""
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": " dial tcp 127.0.0.1:9300: connect: connection refused\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: WARNING [esLogRetention] Could not run log-retention, got err: Get \""
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/_cat/indices?format=json\""
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": " dial tcp 127.0.0.1:9300: connect: connection refused\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: WARNING [Status] Service status changed to: warning/Unable to perform log-retention, check access or elasticsearch status. Details: Get \""
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300/_cat/indices?format=json\""
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": " dial tcp 127.0.0.1:9300: connect: connection refused\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [esLogRetention] Next check at latest at : 2021-04-09T07:41:16Z\nAp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " But i will create another issue for that"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617954410632
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "aha. there was a merge.. that why..  well ok then its verified working now instead"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617958920351
      }
    ]
  },
  {
    "key": "SA-16484",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Apr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: WARNING [status] System status changed from warning to error\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: INFO {'event_type': 'appliance_status_changed', 'version': '5.4.0-24337-release', 'cpu': {'percent': 72.7}, 'disk': {'free': 19300872192, 'percent'\n: 0.5, 'total': 20470939648, 'used': 106602496}, 'memory': {'free': 15492907008, 'percent': 3.8, 'total': 20993622016, 'used': 806526976}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed':\n '0.0 Bps', 'rxSpeed': '0.0 Bps', 'dropin': 1, 'dropout': 0, 'ips': ['10.97.180.2']}}}, 'roles': {'appliance': {'status': 'error', 'details': 'The following service is not running: cz-logd\\nThe following \nservice should not be running: ssh\\nno ntp servers configured\\ncz-logd: Failed to perform healthcheck for cz-logd'}}, 'state': 'waiting_config', 'status': 'error', 'upgrade': {'status': 'idle'}, 'applianc\ne_version': '5.4.0-24337-release', 'volumeNumber': 1}\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: ERROR [status] Failed to write appliance_status_changed audit log! {'cpu': {'percent': 72.7}, 'disk': {'free': 19300872192, 'percent': 0.5, 'total': 20470939648, 'used': 106602496}, 'memory': {'free': 15492907008, 'percent': 3.8, 'total': 20993622016, 'used': 806526976}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed': '0.0 Bps', 'rxSpeed': '0.0 Bps', 'dropin': 1, 'dropout': 0, 'ips': ['10.97.180.2']}}}, 'roles': {'appliance': {'status': 'error', 'details': 'The following service is not running: cz-logd\\nThe following service should not be running: ssh\\nno ntp servers configured\\ncz-logd: Failed to perform healthcheck for cz-logd'}}, 'state': 'waiting_config', 'status': 'error', 'upgrade': {'status': 'idle'}, 'appliance_version': '5.4.0-24337-release', 'volumeNumber': 1}\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: INFO [status] Appliance ips change from no ips to 10.97.180.2\nApr 09 07:40:15 envy-10-97-180-2.devops cz-configd[868]: INFO [change] Change 667e151c-1b5a-42d4-a7ef-f9d8936e18e3 submitted\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: cz-logd.service: Service hold-off time over, scheduling restart.\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: cz-logd.service: Scheduled restart job, restart counter is at 1.\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: Stopped Appliance Logd, application for reliable logging.\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: Starting Appliance Logd, application for reliable logging...\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [ServerLogic] Starting server logic, role is: server\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [console] Console listening at /run/cz-logd/cz-logd-admin.socket\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [esLogRetention] Checking retention(initial)\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [ServerLogic] Setting up relp server\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [RelpServer] RelpServer starting @ 127.0.0.1:9320 idleTimeout:true/1h0m0s\nApr 09 07:40:16 envy-10-97-180-2.devops systemd[1]: Started Appliance Logd, application for reliable logging.\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: WARNING [esLogRetention] Was unable to get index list: Get \""
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:9300/_cat/indices?format=json\""
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": " dial tcp 127.0.0.1:9300: connect: connection refused\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: WARNING [esLogRetention] Could not run log-retention, got err: Get \""
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:9300/_cat/indices?format=json\""
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": " dial tcp 127.0.0.1:9300: connect: connection refused\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: WARNING [Status] Service status changed to: warning/Unable to perform log-retention, check access or elasticsearch status. Details: Get \""
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:9300/_cat/indices?format=json\""
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": " dial tcp 127.0.0.1:9300: connect: connection refused\nApr 09 07:40:16 envy-10-97-180-2.devops cz-logd[2576]: INFO    [esLogRetention] Next check at latest at : 2021-04-09T07:41:16Z\nAp"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. Seems like the configd audit log client is not doing retries to send audit logs..  so it probably does 1 try and then drops the logs."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The c-version does several retries.. to prevent log drops, for example when the logd is restarted"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617954540039
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The c-version does several retries.. to prevent log drops, for example when the logd is restarted"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The retries are done in the same thread so since it is configd itself starting logd, all that would happen here using the C library is that this would hang the appliance for a while before moving on."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You are very welcome to implement socket activation in logd and support configuration reload, so that when logs arrive before it is started, systemd will start it, and logd itself can retain the logs in memory until some configuration is written, logd is reloaded and can do whatever it needs to do with the logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617959125993
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also consider that those audit logs are not called with the guaranteed thing."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The python library also does retries when using guaranteed logs, but not in this case since they are not guaranteed logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617959243657
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But.. why did this work in 5.3 and not in 5.4?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617959814709
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "normal mode does not mean its ok to drop logs =)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617959942988
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "guaranteed also means, to wait for the audit log to be written to disc before continuing, but doing retries is a step on the way"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617960051272
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I still think this is a new problem in 5.4..  we did not have any drops of configd audit logs in 5.3"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617960963914
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "But.. why did this work in 5.3 and not in 5.4?"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Did it?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I can't reproduce, so there must be some precise sequence of events to be triggered to make this happen. Maybe the same sequence of events on 5.3 caused the same error."
                }
              ]
            },
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "normal mode does not mean its ok to drop logs"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Why was logd not running? The logs don't show that. How should the library deal with the logging daemon not running? Considering that blocking will likely result in the logging daemon keeping on not running."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The C library has nothing to buffer messages when logd is not running, and then start a thread to send them later on\u2026"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617960997614
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "logd was not running since configd re-configured it.. some re-configuration requires a restart.. some we are able to reload"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617961103037
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When creating 5.3 env.. i dont see any log drops from configd.. but almost always on 5.4 release envs"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617961148089
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In configd, appliance"
                },
                {
                  "type": "text",
                  "text": "status",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "changed always had non-guaranteed logging since the error can be logd being down and you still want to see the status updates in that case."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1617961729008
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For example if you stop logd: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-10-97-240-2:~# journalctl -u cz-configd.service -f\n-- Logs begin at Thu 2021-04-08 13:19:04 UTC. --\nApr 09 09:02:02 envy-10-97-240-2.devops cz-configd[833]: INFO [ApplyServicesAction] Applying services configuration with current configuration /mnt/state/config/20210409-090202-fj26sjdu and previous configuration /mnt/state/config/20210409-090034-ufdkzjlr\nApr 09 09:02:03 envy-10-97-240-2.devops cz-configd[833]: INFO [service] cz-nginx@main reload (reason: base system, service is enabled, required files are present, files changed)\nApr 09 09:02:03 envy-10-97-240-2.devops cz-configd[833]: INFO [ActionsRunner] ApplyServicesAction done\nApr 09 09:02:03 envy-10-97-240-2.devops cz-configd[833]: INFO [change] Change 101d4f45-cba0-483f-9629-58f1cbb3817b completed with result success after 1.088 seconds\nApr 09 09:02:03 envy-10-97-240-2.devops cz-configd[833]: INFO [jsonrpcapp] internal 1 \"get_changes\" success 4\nApr 09 09:50:45 envy-10-97-240-2.devops cz-configd[833]: INFO [jsonrpcapp] internal 1 \"status\" success 0\nApr 09 09:50:51 envy-10-97-240-2.devops cz-configd[833]: WARNING [status] System status changed from healthy to error\nApr 09 09:50:51 envy-10-97-240-2.devops cz-configd[833]: INFO {'event_type': 'appliance_status_changed', 'version': '5.4.0-24332-release', 'cpu': {'percent': 0.3}, 'disk': {'free': 886038528, 'percent': 5.3, 'total': 1006526464, 'used': 50024448}, 'memory': {'free': 9793556480, 'percent': 49.2, 'total': 20993622016, 'used': 10333298688}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed': '10.0 Kbps', 'rxSpeed': '8.98 Kbps', 'dropin': 15, 'dropout': 0, 'ips': ['10.97.240.2']}}}, 'roles': {'appliance': {'status': 'error', 'details': 'The following service is not running: cz-logd'}, 'controller': {'status': 'healthy', 'details': 'Database size is 23 MB'}, 'logServer': {'status': 'error', 'details': '100% of shards are active.\\ncz-logd: Failed to perform healthcheck for cz-logd'}}, 'state': 'controller_ready', 'status': 'error', 'upgrade': {'status': 'idle'}, 'appliance_version': '5.4.0-24332-release', 'volumeNumber': 1}\nApr 09 09:50:51 envy-10-97-240-2.devops cz-configd[833]: ERROR [status] Failed to write appliance_status_changed audit log! {'cpu': {'percent': 0.3}, 'disk': {'free': 886038528, 'percent': 5.3, 'total': 1006526464, 'used': 50024448}, 'memory': {'free': 9793556480, 'percent': 49.2, 'total': 20993622016, 'used': 10333298688}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed': '10.0 Kbps', 'rxSpeed': '8.98 Kbps', 'dropin': 15, 'dropout': 0, 'ips': ['10.97.240.2']}}}, 'roles': {'appliance': {'status': 'error', 'details': 'The following service is not running: cz-logd'}, 'controller': {'status': 'healthy', 'details': 'Database size is 23 MB'}, 'logServer': {'status': 'error', 'details': '100% of shards are active.\\ncz-logd: Failed to perform healthcheck for cz-logd'}}, 'state': 'controller_ready', 'status': 'error', 'upgrade': {'status': 'idle'}, 'appliance_version': '5.4.0-24332-release', 'volumeNumber': 1}\nApr 09 09:50:51 envy-10-97-240-2.devops cz-configd[833]: INFO [jsonrpcapp] internal 1 \"status\" success 0"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "![](image1617961931719.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1617961959335
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeah im not saying re-try forever..  there needs to be a reasonable amount of reties..  enough to handle a logd restart anyway"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617963100270
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You could also make configd a special case. and do some kind of queue of logs there.  its not the end of the world if appliance"
                },
                {
                  "type": "text",
                  "text": "status",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "changed is dropped.. but for example ssh-access logs and ip-access logs are for example way more important"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617963347130
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but it still feels like we should make a effort not to try to drop logs"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617963376865
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Im fine with putting this as a known issue for 5.4"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617964743708
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but i think the ssh-access log thing is using this client? right.. so i think those are more sad to drop, if you just reconfigure or restart logd for some reason"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1617964875459
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, i'm making a pr for that case"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617964894346
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "To summarize, I made the ssh thingy to wait for 3s for logd, i made no changes to configd because I don't want to slow it down."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1617971321243
      }
    ]
  },
  {
    "key": "SA-16564",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "since we released the terraform provider  to hashicorp terraform registery, we notice that it did not like the kebab-case in the name it is unable to use dashes (-) in provider {}, data {}, and resource {} blocks, so we need to rename it. the suggestion is to rename it to  "
            },
            {
              "type": "text",
              "text": "appgatesdp",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "terraform {\n  required_providers {\n    appgate-sdp = {\n      source  = \"appgate/appgate-sdp\"\n      version = \"0.4.0\"\n    }\n  }\n}\nprovider \"appgate-sdp\" {\n  username = \"admin\"\n  password = \"admin\"\n  url      = \""
            },
            {
              "type": "text",
              "text": "https://ec2-52-202-108-111.compute-1.amazonaws.com:8443/admin\""
            },
            {
              "type": "text",
              "text": "\n  provider = \"local\"\n  insecure = true\n}# the resource/data prefix must match provider name,\n# provider local name: must contain only letters, digits, and dashes, and may not use leading or trailing dashes\n# resource/data name must be snake_case only.\n# So even though they accept a provider name with kebab case, we cant use it without an alias\n# or using the bultin attribute provider. as shown in the example below.\ndata \"appgate_certificate_authority\" \"ca\" {\n  provider = appgate-sdp # this needs to be appended to all resources/data sources.\n  pem = true\n}\n\n "
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16581",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Seems to be very apparent on headless "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "aitorbot ['headless_windows', 'headless'] | 2021-04-21 04:00:05\n        id:   045a3774-e829-44bc-a170-e35fdbfe4284\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/861044"
            },
            {
              "type": "text",
              "text": "\n        passed: 7/7\naitorbot ['headless_windows', 'headless'] | 2021-04-22 04:00:06\n        id:   45bb6fe5-b2dc-4bc2-a307-1227230e25ef\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/861447"
            },
            {
              "type": "text",
              "text": "\n        passed: 6/7"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Summary of the underlying issue:"
            }
          ]
        },
        {
          "type": "blockquote",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "looks like a timing issue as usual. not sure why it affects only Windows. Maybe it keeps connections alive shorter. When the test passes, client manages to get a new VPN cert with the already existing Controller connection. Then the driver complains about CA being unknown instead of client cert not working. This is handled properly by the client. but if the Controller connection needs to be reestablished to get a VPN cert, which fails because Controller cert isn't trusted, it doesn't go ahead and try the next CA."
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16644",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "According to E2E "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/866147",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/866147"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Seems it's broken some time between recently and December 3 when it succeeded last time.  After December 3, the test started failing due to a test code issue."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "hmm, the test passed tonight.. I'll close it if it passes tomorrow also."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1620139302407
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/867177",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/867177"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " weird that this time TCP was blocked fine but not the UDP.. Maybe Windows is just slower on ipv6?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1620201702547
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "time.sleep(10) ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1620207913476
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nowadays it's fifty fifty. Yesterday it was block"
                },
                {
                  "type": "text",
                  "text": "out that was broken. 3 days ago it was block",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "in. Ringfence ipv6 is maybe messing with the gateway connections?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1621263935329
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Right, didn't I update the ticket... yes it seems to be something like that -  the appgate-driver says it gets a dead connection in the middle of the tests - which is a bit random due to timing."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1621270094860
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "do you see any other random failures? or does it look like ringfence is interfering with the connection?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1621324481298
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "looks like RF (=Windows FW rules) interfer with the established TLS connections even though they are explicitly whitelisted"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1621333604829
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Works perfectly on a local setup. :/"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1624958750155
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "haha of course."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1624959951899
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It's rarer and rarer but still happens "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Test case 101967222 failed at 2021-07-17 02:45:06.565348. "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/894295"
                },
                {
                  "type": "text",
                  "text": "\nTest case 101967222 failed at 2021-07-18 02:45:06.776492. "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/894654"
                },
                {
                  "type": "text",
                  "text": "\nTest case 101967222 failed at 2021-07-19 02:45:07.352854. "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/895013"
                },
                {
                  "type": "text",
                  "text": "\nTest case 101967222 failed at 2021-08-06 02:45:06.801619. "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/901903"
                },
                {
                  "type": "text",
                  "text": "\nTest case 101967222 failed at 2021-08-14 02:45:06.735433. "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/905080"
                },
                {
                  "type": "text",
                  "text": "\nTest case 101967222 failed at 2021-08-15 02:45:06.714644. "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/905445"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1629279325377
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Every run was broken when I checked the logs last time, but it's often saved by a client reconnect"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1629280517653
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Seems like it's working now :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1634296769633
      }
    ]
  },
  {
    "key": "SA-16703",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[12:21:51]\n[ui] \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n[12:21:51]\n[ui] \u2502 high          \u2502 Regular Expression Denial of Service                         \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Package       \u2502 ua-parser-js                                                 \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Patched in    \u2502 >=0.7.24                                                     \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Dependency of \u2502 ua-parser-js                                                 \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Path          \u2502 ua-parser-js                                                 \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 More info     \u2502 "
            },
            {
              "type": "text",
              "text": "https://www.npmjs.com/advisories/1679"
            },
            {
              "type": "text",
              "text": "                        \u2502\n[12:21:51]\n[ui] \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n[12:21:51]\n[ui] \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n[12:21:51]\n[ui] \u2502 high          \u2502 Command Injection                                            \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Package       \u2502 lodash                                                       \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Patched in    \u2502 >=4.17.21                                                    \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 Dependency of \u2502 react-loading-skeleton                                       \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[12:21:51]\n[ui] \u2502 Path          \u2502 react-loading-skeleton > @emotion/core > @emotion/css >      \u2502\n[12:21:51]\n[12:21:51]\n[ui] \u2502               \u2502 babel-plugin-emotion > @babel/helper-module-imports >        \u2502\n[12:21:51]\n[12:21:51]\n[ui] \u2502               \u2502 @babel/types > lodash                                        \u2502\n[12:21:51]\n[ui] \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n[12:21:51]\n[ui] \u2502 More info     \u2502 "
            },
            {
              "type": "text",
              "text": "https://www.npmjs.com/advisories/1673"
            },
            {
              "type": "text",
              "text": "                        \u2502\n[12:21:51]\n[12:21:51]\n[ui] \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16773",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "-May 18 02:37:47 envy envy[13543]: [envy.providers.azure] Welcome to a world of Azure pain!\n97639:May 18 02:37:47 envy envy[13543]: [envy.providers.azure] Parsing /var/opt/envy/storage/b2fe4662-75b0-4acb-9df0-3d46b003e316/b2fe4662-75b0-4acb-9df0-3d46b003e316-site1/credentials.json\n97640:May 18 02:37:47 envy envy[13543]: [envy.providers.azure] Deleting resource group resgrp-b2fe4662-75b0-4acb-9df0-3d46b003e316-site1...\n97641-May 18 02:37:47 envy envy[13543]: Traceback (most recent call last):\n97642-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/msrestazure/azure_active_directory.py\", line 478, in set_token\n97643-May 18 02:37:47 envy envy[13543]:     proxies=self.proxies)\n97644-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/requests_oauthlib/oauth2_session.py\", line 307, in fetch_token\n97645-May 18 02:37:47 envy envy[13543]:     self._client.parse_request_body_response(r.text, scope=self.scope)\n97646-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/clients/base.py\", line 415, in parse_request_body_response\n97647-May 18 02:37:47 envy envy[13543]:     self.token = parse_token_response(body, scope=scope)\n97648-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/parameters.py\", line 425, in parse_token_response\n97649-May 18 02:37:47 envy envy[13543]:     validate_token_parameters(params)\n97650-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/parameters.py\", line 432, in validate_token_parameters\n97651-May 18 02:37:47 envy envy[13543]:     raise_from_error(params.get('error'), params)\n97652-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/errors.py\", line 405, in raise_from_error\n97653-May 18 02:37:47 envy envy[13543]:     raise cls(**kwargs)\n97654-May 18 02:37:47 envy envy[13543]: oauthlib.oauth2.rfc6749.errors.InvalidClientError: (invalid_client) AADSTS7000222: The provided client secret keys are expired. Visit the Azure Portal to create new keys for your app, or consider using certificate credentials for added security: "
            },
            {
              "type": "text",
              "text": "https://docs.microsoft.com/azure/active-directory/develop/active-directory-certificate-credentials"
            },
            {
              "type": "text",
              "text": "\n97655-May 18 02:37:47 envy envy[13543]: Trace ID: 7d092290-c5d2-445e-9cfc-6b32ec828701\n--\n97683-May 18 02:37:47 envy envy[13543]:     proxies=self.proxies)\n97684-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/requests_oauthlib/oauth2_session.py\", line 307, in fetch_token\n97685-May 18 02:37:47 envy envy[13543]:     self._client.parse_request_body_response(r.text, scope=self.scope)\n97686-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/clients/base.py\", line 415, in parse_request_body_response\n97687-May 18 02:37:47 envy envy[13543]:     self.token = parse_token_response(body, scope=scope)\n97688-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/parameters.py\", line 425, in parse_token_response\n97689-May 18 02:37:47 envy envy[13543]:     validate_token_parameters(params)\n97690-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/parameters.py\", line 432, in validate_token_parameters\n97691-May 18 02:37:47 envy envy[13543]:     raise_from_error(params.get('error'), params)\n97692-May 18 02:37:47 envy envy[13543]:   File \"/opt/envy/envy-virtualenv/lib/python3.6/site-packages/oauthlib/oauth2/rfc6749/errors.py\", line 405, in raise_from_error\n97693-May 18 02:37:47 envy envy[13543]:     raise cls(**kwargs)\n97694-May 18 02:37:47 envy envy[13543]: msrest.exceptions.AuthenticationError: , InvalidClientError: (invalid_client) AADSTS7000222: The provided client secret keys are expired. Visit the Azure Portal to create new keys for your app, or consider using certificate credentials for added security: "
            },
            {
              "type": "text",
              "text": "https://docs.microsoft.com/azure/active-directory/develop/active-directory-certificate-credentials"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-16826",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "A new special server, basically clone of the client server of cz-nginx"
            },
            {
              "type": "mention",
              "attrs": {
                "id": "main",
                "text": "@main",
                "accessLevel": ""
              }
            },
            {
              "type": "text",
              "text": " with the only difference that it listens at another unix domain socket and adds the special HTTP header at the proxy request towards the controller"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The special server ends up as below: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "server {\n    listen unix:/run/czd/cz-nginx-main-webclient.socket fd_passing ssl;\n    server_name _;\n    include /etc/nginx/sites-enabled-main/client_ssl.conf;\n    location / {\n        proxy_pass "
                },
                {
                  "type": "text",
                  "text": "http://client_upstream/client/"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n        proxy_set_header AG-SPA-Key-Type webclient;\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_http_version 1.1;\n        proxy_set_header Connection \"\";\n        proxy_set_header Host $host;\n    }\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " AG-SPA-Key-Type webclient;",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is the important for controller "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1621856893537
      }
    ]
  },
  {
    "key": "SA-16988",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Client auto-upgrade is failing with:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2021-06-28T09:17:32.456Z] Info : Starting package download to '/Users/teo/.appgatesdp/updates/Appgate SDP 5.5.0-26650-master Installer.dmg' from '"
            },
            {
              "type": "text",
              "text": "http://127.0.0.1:8000/Appgate%20SDP%205.5.0-26650-master%20Installer.dmg'"
            },
            {
              "type": "text",
              "text": "."
            },
            {
              "type": "text",
              "text": "\n[2021-06-28T09:17:32.550Z] Error : Error during file download. Cannot write more bytes to the buffer than the configured maximum buffer size: 150000000."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I made a quick fix here: "
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/stratus-tests/pull/2569",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://github.com/appgate-sdp-int/stratus-tests/pull/2569"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " but the long term solution is to switch the artifact downloader to streaming reads and writes."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed in 5.4.x with "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/6575",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/6575"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and 5.5 with SA-16989"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1624975873964
      }
    ]
  },
  {
    "key": "SA-16993",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "![](image1624956330030.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1624956331756
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://www.elastic.co/guide/en/elasticsearch/reference/current/http-clients.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.elastic.co/guide/en/elasticsearch/reference/current/http-clients.html"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Basic auth.. example (added the extraHeaders paramter in the elasticsearch section."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "{\n    \"geoIpDbPath\": \"/etc/cz-geoip/GeoLite2-City.mmdb\",\n    \"logLevel\": \"INFO\",\n    \"role\": \"server\",\n    \"hostname\": \"envy-10-97-138-2.devops\",\n    \"collectiveId\": \"31f65e5c-2630-4350-b8f4-92a63631c2c0\",\n    \"persistenceMode\": \"default\",\n    \"relpClients\": [\n        {\n            \"host\": \"127.0.0.1\",\n            \"port\": 20514,\n            \"format\": \"syslog\",\n            \"name\": \"rsyslog\"\n        }\n    ],\n    \"logdClientMaxPoolSize\": 200,\n    \"maxNrOfLogs\": 100000,\n    \"relpServer\": {\n        \"bindHost\": \"127.0.0.1\",\n        \"bindPort\": 9320,\n        \"idleTimeout\": \"1h\"\n    },\n    \"elasticsearch\": {\n        \"url\": \""
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9300\""
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": "\n        \"retentionDays\": 30,\n        \"nrOfFields\": 3000,\n        \"compabilityMode\": 7,\n\t\"extraHeaders\": {\n\t\t\"Authorization\": \"Basic yada yada yada\"\n\t}\n    }\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1624956865344
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There are also token based: "
                },
                {
                  "type": "text",
                  "text": "https://www.elastic.co/guide/en/elasticsearch/reference/current/token-authentication-services.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.elastic.co/guide/en/elasticsearch/reference/current/token-authentication-services.html"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so..  in same way: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\t\"extraHeaders\": {\n\t\t\"Authorization\": \"Bearer yada yada yada\"\n\t}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "or"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\t\"extraHeaders\": {\n\t\t\"Authorization\": \"ApiKey yada yada yada\"\n\t}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1624956973170
      }
    ]
  },
  {
    "key": "SA-17122",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Aug 03 14:32:18 purple10.appgate.com cz-controllerd[99394]: 127.0.0.1 - - [03/Aug/2021:14:32:18 +0000] \"GET /admin/appliances HTTP/1.0\" 200 9587166 \""
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/sites\""
            },
            {
              "type": "text",
              "text": " \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0\" 14002"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-17190",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "CDP exist in our client certificates and it works fine but it has been noticed that when checking with openssl cmd it doesn't print the CDP extension. Something to look at as it might bite in the future."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Example:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "-----BEGIN CERTIFICATE-----\nMIIFKjCCAxKgAwIBAgIGAXt32X7oMA0GCSqGSIb3DQEBDQUAMBkxFzAVBgNVBAMM\nDkFwcGdhdGUgU0RQIENBMCIYDzIwMjEwODIzMTIyNDE5WhgPMjAyMzAxMDYxMjI0\nMTlaMEsxDjAMBgNVBAsMBWxvY2FsMQ4wDAYDVQQDDAVhZG1pbjEpMCcGA1UEAwwg\nNzQ4NzRlZTc3ZjAzNDljMzkyNmQzZTYzODJlZmZhZWUwggIiMA0GCSqGSIb3DQEB\nAQUAA4ICDwAwggIKAoICAQCjn5Nr9ucNZpYx76kGF61hazyH9vBPQXgO1Ugsc6Fy\nxviJT5Hgxyat7PGj3v+V0k6M1cewwrMlQjeClkD6pwE/m5h6Z6kH0cBf2l23Kpp3\n/IdKSZrNZDj9Ewtsn9w2yqob7kCqGv+7pUVAnX2f7OgggbOEjfjmA2e50ONgmkMu\nzsnCE8akT8dh/guRWSPQz73FUcgFHGaq1fAX/VtFF4RWq8W8hjkagZrOo38Bt/Gv\n+N9lpajTJrxqyy3bZhKDGvAtAFkiEOJlsRgWtWeqolLuSBTKySOJnnWUkm15sVBT\nCWeP/uLrTkp5A22BGQQXOqedRNWIV1keYlynIXvf1NL37dwyKikA0sUUwiGWDvOE\nebOwnwdkaOZDjTcEtpOkF5Ajbi7x7u6BOpDuZ2p0BYAGj/NsDwEeqUqB0dnp1RjK\n5+WtDOsF4RS3Ix1T+Dt+bAmLb/b6DfFFZUs3/X9JqbFuFYsGUFG//rZktqi+UTfp\noqxcd8P2VUql7VhyjtJfFBcpV4QG8bytu1gpeiDKbjHYrFW7UIeKA6Hc1+3ShMF6\nPAWn2ML27rY07YwWSnvPgNjKO5qislI0vU5XBZ6lfEDkzi73yMBSRyZgE4tjpc4X\nnA4faOD12aUHk1gk3HrXY71gEe54K+GV6n0s9ro6oMueIY95fGeRmRBfgmARwp6E\nlwIDAQABo0IwQDAdBgNVHQ4EFgQUUEoFRKa3zBtLjnvPeQmY2fQ0uGwwHwYDVR0j\nBBgwFoAUDdCpCdETQd1Ihe/m9FxoH+D8JBYwDQYJKoZIhvcNAQENBQADggIBAHYN\nqNdOiI9UZ8SR43wjBEWMeVahe5cL6VZR6encORDyj9vB1tACYYJNmUJN6HcppNwL\nI+8MviLRbs7k4EbPY0xdTLDC5ub/ZpGpPj4qqkxY4Brbm3dLQB1i2lkPAqytFmOI\n5lcD/wguJ2p9ZSlKB8Z9VZJDDX+SgylnpDngJyG+k/7hLFHb32mRo6RBcaBww5nG\nb5fakJoRaVEgRD5hxli07L2TVMVNftpyK25KQCruEYo+yPlttNLDhLHOktFwIoSU\nZMTQfh+5twsjF9c8jnogd7dPOqRVm41R1puZHR4zMGWzfPGszAZcWzeDkJNekcrH\nt22+kal5dvmdxg4VA4CI5huW1dyz8sN1oWD1PLi/bA8c0GSz2gkA2O6gQSRkLxtQ\nVQt5fdwH3FQIRCA1uYDfYLfneAgQgl7oLRtWp7Zljl21dL8LFhJwzipIGZRhRCHU\n7kDfsI8tBxfpkuCyNvUgIbhcLM+Hp8Ms6TV7FwMIC4J21NS2fLlWBnzYndja2e4A\nYYT6JRhHEe0hVtA/V1AbjJmUsQs8u4xupLbVbd377ViZN2PHLFJhTbwzYzdyQ4aE\nSXKCrh1YrGTRvDrhJ1p3QL3UqOK2JVW4sYzBs1bkp5mjTso4Nr/i8c1gHB2Sta/n\nalymJaFF+IhDOjpk6+4nBNT5q2iob6klf1NsFhOb\n-----END CERTIFICATE-----"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "kosmas@kosmas-VirtualBox:~/Desktop$ openssl x509 -noout -text -in natan.pem | grep -A 4 'X509v3 CRL Distribution Points'\nkosmas@kosmas-VirtualBox:~/Desktop$ "
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "kosmas.valianos",
                    "text": "@kosmas.valianos",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " any ideas here?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1632150130224
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Except that the cert there has no CRL distribution point inside?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1632151538402
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "openssl asn1parse -in natancertwithoutcrl.pem -inform pem",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1632151629317
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "no it doesn't. probably a bad example. But we have seen certs which showed CDP on Windows and KeyStoreExplorer but openssl disagreed."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1632152565089
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It looks like the certificate extracted from vpnd is different from what the adminUI says it is. They both have the same serial number etc but the one from vpnd does not show the CDP"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client certificate downloaded from "
                },
                {
                  "type": "text",
                  "text": "https://envy-10-97-160-2.devops:8443/ui/issued-certificates",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-10-97-160-2.devops:8443/ui/issued-certificates"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "kosmas@kosmas-CELSIUS-W530-Power:~/Desktop$ openssl x509 -in client.pem -text\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 1632920287060 (0x17c31a23754)\n        Signature Algorithm: sha512WithRSAEncryption\n        Issuer: C = SE, ST = Goteborg, L = Goteborg, postalCode = 40032, street = Kungsgatan, O = appgate, OU = devops, CN = devops.appgate.com, emailAddress = no-reply@appgate.com\n        Validity\n            Not Before: Sep 29 12:57:07 2021 GMT\n            Not After : Sep 29 12:57:07 2022 GMT\n        Subject: OU = local, CN = admin, CN = 515ea82d3493470bbf181dae820d7056\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                RSA Public-Key: (4096 bit)\n                Modulus:\n                    00:ba:ef:41:75:de:56:90:93:e0:e3:55:c6:29:76:\n                    56:40:b1:8c:14:1c:03:03:99:10:b6:e4:ac:bb:28:\n                    11:e6:ad:2c:27:5f:5e:28:a5:69:c3:23:72:75:82:\n                    d9:fd:19:81:69:8a:be:45:ce:3d:80:d2:f4:38:9d:\n                    59:21:7d:21:ac:7c:c0:cb:d5:df:b2:69:31:4c:48:\n                    68:72:34:90:b1:cf:da:5c:d6:71:b2:59:b2:87:0a:\n                    38:af:2d:3a:1c:25:90:d0:89:fa:76:73:e6:fd:fe:\n                    61:57:2b:79:3f:fe:1a:07:e4:d4:34:7e:d7:25:60:\n                    35:d2:dc:b7:ac:93:94:21:e2:34:d1:4b:4e:38:c4:\n                    c2:82:99:bb:c8:d4:e9:6f:2b:fc:97:ea:19:53:e8:\n                    d4:87:a2:09:19:94:4e:3b:cd:da:85:7f:48:2f:85:\n                    d2:fd:98:14:86:64:86:1e:68:ef:01:c7:77:51:5b:\n                    58:fc:1c:40:5c:d5:0a:ef:95:ff:d3:8a:d0:7b:e7:\n                    94:50:61:75:fb:a7:8c:7a:5d:9b:3a:fe:4b:79:99:\n                    a6:ac:b7:8b:a6:8a:43:c4:0c:56:bb:b2:01:be:d5:\n                    b7:00:df:be:0e:aa:29:e1:77:45:e9:a0:28:9a:e9:\n                    8a:6d:f2:01:4a:d2:fa:2c:fc:65:fa:94:56:60:c2:\n                    01:70:13:5b:32:11:b3:75:fa:55:e2:75:57:44:ae:\n                    bb:d7:09:d5:3b:b0:f2:fe:ca:e5:72:45:ed:95:41:\n                    39:3d:ab:90:81:bb:ee:4b:ed:8e:00:ef:cb:c7:55:\n                    c7:28:17:57:5c:7d:02:f5:8f:53:5f:50:9a:5d:f2:\n                    ba:53:94:7c:17:a9:f7:bc:50:84:ab:ae:2e:47:cc:\n                    9d:4e:f8:dd:74:26:9e:9b:ae:d0:ee:dc:c8:6c:01:\n                    4d:08:25:4f:5a:47:e0:b9:97:3e:4f:01:b3:14:e9:\n                    d3:9a:5a:60:f6:eb:b4:bf:56:00:64:9f:5a:76:f5:\n                    3a:1c:b5:05:56:30:ea:62:c2:38:65:95:ad:e7:8b:\n                    21:c6:4b:cc:f4:8c:21:c3:9b:8e:09:60:0a:cc:4e:\n                    c7:d9:ac:89:b7:94:e1:8f:0e:d1:4c:8f:9c:67:96:\n                    d4:76:c1:ab:fa:76:22:41:af:e0:c7:b1:04:16:4f:\n                    06:8b:1b:ed:16:2c:90:36:23:81:6b:28:34:9b:df:\n                    ae:eb:6c:67:17:25:f9:f6:27:2f:3c:13:ff:73:2e:\n                    ca:d9:77:75:11:b8:3e:3a:58:08:b1:66:3c:81:32:\n                    ee:a7:fd:ba:fe:25:7e:d8:13:09:f5:17:8c:21:75:\n                    20:70:23:9a:db:71:8c:87:25:8e:e8:09:8c:1a:cd:\n                    9d:b7:73\n                Exponent: 65537 (0x10001)\n        X509v3 extensions:\n            X509v3 Extended Key Usage: \n                TLS Web Client Authentication\n            Netscape Cert Type: \n                SSL Client\n            X509v3 Subject Key Identifier: \n                0E:20:FC:A5:ED:67:36:55:6C:95:B2:5C:9D:D2:E6:17:9E:AD:92:5B\n            X509v3 Authority Key Identifier: \n                keyid:27:0F:FC:51:0E:B2:F9:D2:3E:29:16:2E:76:5D:44:B6:1C:8B:83:D9\n                DirName:/C=SE/ST=Goteborg/L=Goteborg/postalCode=40032/street=Kungsgatan/O=appgate/OU=devops/CN=devops.appgate.com/emailAddress=no-reply@appgate.com\n                serial:0B:D1:DF:A9:86:B8:F0:33:8F:83:A3:C8:F0:FD:9D:62:8D:0C:A1:CB\n\n            X509v3 CRL Distribution Points: \n\n                Full Name:\n                  URI:"
                },
                {
                  "type": "text",
                  "text": "http://ec2-52-56-222-134.eu-west-2.compute.amazonaws.com/kosmas.crl"
                },
                {
                  "type": "text",
                  "text": "\n\n    Signature Algorithm: sha512WithRSAEncryption\n         bf:ec:a6:57:90:6c:72:65:a8:c7:71:9c:c8:ff:4e:d4:65:17:\n         b1:0d:56:15:e0:a7:a1:38:a3:07:da:91:e0:22:e5:c5:a9:82:\n         68:83:61:71:0a:f9:15:43:7f:2b:6c:08:4a:a4:63:bd:de:4d:\n         0a:53:88:8c:99:b4:92:f8:47:d6:74:e1:6f:4a:a2:6c:7e:c6:\n         91:1b:5d:4b:ee:7d:cc:de:ea:c5:3e:f2:8b:cd:b4:e0:ca:63:\n         47:75:57:cd:f1:b8:31:54:9c:80:e7:bb:6d:48:05:06:24:b0:\n         34:29:23:53:d5:2f:31:7d:54:d0:c3:41:3c:f9:d4:27:2a:29:\n         e5:ea:28:36:89:f4:09:3a:ca:0a:14:fa:5f:bd:c6:a5:e0:fa:\n         19:22:99:84:6d:4d:60:11:8b:df:82:cb:19:88:7e:16:6c:dd:\n         54:84:48:c9:93:3a:29:3b:eb:89:71:9c:13:9d:28:ee:c5:3f:\n         03:ab:d4:c4:17:86:85:9e:3f:77:5a:82:e3:77:76:e6:3b:52:\n         af:6a:76:53:5e:ba:f3:1c:81:86:16:f7:59:61:e1:7c:68:4f:\n         80:e5:a6:4c:1f:9d:18:7a:17:77:20:73:b7:ac:8a:87:65:76:\n         50:4d:97:e3:53:ec:11:80:dc:fd:f1:07:83:2b:5c:b9:0c:f0:\n         b8:0a:15:6c:99:84:bf:72:05:30:94:44:70:28:0b:df:48:11:\n         6b:1a:6c:8f:f9:cd:67:1e:98:e5:13:97:fb:b2:3b:6e:fc:ee:\n         2f:60:9d:98:52:cf:03:d1:78:16:6d:70:d0:9d:ac:72:4c:50:\n         1e:c8:f7:ae:fc:20:c4:c2:31:d1:bd:f4:52:bb:f1:0b:81:59:\n         fa:49:0a:c5:25:76:63:4b:0c:c7:4d:56:86:f5:d8:fc:84:01:\n         05:dd:1e:6f:e2:00:b6:a8:0e:60:61:7f:c6:51:46:be:c7:c4:\n         6f:73:6f:55:d5:c6:dc:82:cf:d6:ad:35:1e:f0:0b:22:53:ff:\n         f0:84:05:18:03:c2:c3:ff:8b:5e:a5:c6:39:a9:b4:62:fb:4d:\n         14:89:b4:b5:af:dd:03:db:e2:a9:67:b7:52:7f:82:17:52:93:\n         88:92:16:b8:98:50:fe:ae:4f:3f:ee:4d:ab:e9:26:31:a1:6e:\n         bb:06:cb:8e:cd:2d:e2:ec:2d:ad:cb:63:11:5c:52:8a:69:49:\n         16:3d:9e:56:26:6f:2d:92:2f:ec:4f:20:f8:42:ac:e1:6e:c0:\n         68:72:42:1c:ab:54:a8:1b:ff:18:a3:ff:d5:aa:1f:24:a9:61:\n         b8:12:a5:02:18:69:06:0e:29:14:3c:d7:a5:bf:7a:84:7f:79:\n         58:1c:49:e2:ce:f3:95:f1\n-----BEGIN CERTIFICATE-----\nMIIHLDCCBRSgAwIBAgIGAXwxojdUMA0GCSqGSIb3DQEBDQUAMIG9MQswCQYDVQQG\nEwJTRTERMA8GA1UECAwIR290ZWJvcmcxETAPBgNVBAcMCEdvdGVib3JnMQ4wDAYD\nVQQRDAU0MDAzMjETMBEGA1UECQwKS3VuZ3NnYXRhbjEQMA4GA1UECgwHYXBwZ2F0\nZTEPMA0GA1UECwwGZGV2b3BzMRswGQYDVQQDDBJkZXZvcHMuYXBwZ2F0ZS5jb20x\nIzAhBgkqhkiG9w0BCQEWFG5vLXJlcGx5QGFwcGdhdGUuY29tMB4XDTIxMDkyOTEy\nNTcwN1oXDTIyMDkyOTEyNTcwN1owSzEOMAwGA1UECwwFbG9jYWwxDjAMBgNVBAMM\nBWFkbWluMSkwJwYDVQQDDCA1MTVlYTgyZDM0OTM0NzBiYmYxODFkYWU4MjBkNzA1\nNjCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBALrvQXXeVpCT4ONVxil2\nVkCxjBQcAwOZELbkrLsoEeatLCdfXiilacMjcnWC2f0ZgWmKvkXOPYDS9DidWSF9\nIax8wMvV37JpMUxIaHI0kLHP2lzWcbJZsocKOK8tOhwlkNCJ+nZz5v3+YVcreT/+\nGgfk1DR+1yVgNdLct6yTlCHiNNFLTjjEwoKZu8jU6W8r/JfqGVPo1IeiCRmUTjvN\n2oV/SC+F0v2YFIZkhh5o7wHHd1FbWPwcQFzVCu+V/9OK0HvnlFBhdfunjHpdmzr+\nS3mZpqy3i6aKQ8QMVruyAb7VtwDfvg6qKeF3RemgKJrpim3yAUrS+iz8ZfqUVmDC\nAXATWzIRs3X6VeJ1V0Suu9cJ1Tuw8v7K5XJF7ZVBOT2rkIG77kvtjgDvy8dVxygX\nV1x9AvWPU19Qml3yulOUfBep97xQhKuuLkfMnU743XQmnpuu0O7cyGwBTQglT1pH\n4LmXPk8BsxTp05paYPbrtL9WAGSfWnb1Ohy1BVYw6mLCOGWVreeLIcZLzPSMIcOb\njglgCsxOx9msibeU4Y8O0UyPnGeW1HbBq/p2IkGv4MexBBZPBosb7RYskDYjgWso\nNJvfrutsZxcl+fYnLzwT/3Muytl3dRG4PjpYCLFmPIEy7qf9uv4lftgTCfUXjCF1\nIHAjmttxjIcljugJjBrNnbdzAgMBAAGjggGhMIIBnTATBgNVHSUEDDAKBggrBgEF\nBQcDAjARBglghkgBhvhCAQEEBAMCB4AwHQYDVR0OBBYEFA4g/KXtZzZVbJWyXJ3S\n5heerZJbMIH9BgNVHSMEgfUwgfKAFCcP/FEOsvnSPikWLnZdRLYci4PZoYHDpIHA\nMIG9MQswCQYDVQQGEwJTRTERMA8GA1UECAwIR290ZWJvcmcxETAPBgNVBAcMCEdv\ndGVib3JnMQ4wDAYDVQQRDAU0MDAzMjETMBEGA1UECQwKS3VuZ3NnYXRhbjEQMA4G\nA1UECgwHYXBwZ2F0ZTEPMA0GA1UECwwGZGV2b3BzMRswGQYDVQQDDBJkZXZvcHMu\nYXBwZ2F0ZS5jb20xIzAhBgkqhkiG9w0BCQEWFG5vLXJlcGx5QGFwcGdhdGUuY29t\nghQL0d+phrjwM4+Do8jw/Z1ijQyhyzBUBgNVHR8ETTBLMEmgR6BFhkNodHRwOi8v\nZWMyLTUyLTU2LTIyMi0xMzQuZXUtd2VzdC0yLmNvbXB1dGUuYW1hem9uYXdzLmNv\nbS9rb3NtYXMuY3JsMA0GCSqGSIb3DQEBDQUAA4ICAQC/7KZXkGxyZajHcZzI/07U\nZRexDVYV4KehOKMH2pHgIuXFqYJog2FxCvkVQ38rbAhKpGO93k0KU4iMmbSS+EfW\ndOFvSqJsfsaRG11L7n3M3urFPvKLzbTgymNHdVfN8bgxVJyA57ttSAUGJLA0KSNT\n1S8xfVTQw0E8+dQnKinl6ig2ifQJOsoKFPpfvcal4PoZIpmEbU1gEYvfgssZiH4W\nbN1UhEjJkzopO+uJcZwTnSjuxT8Dq9TEF4aFnj93WoLjd3bmO1KvanZTXrrzHIGG\nFvdZYeF8aE+A5aZMH50Yehd3IHO3rIqHZXZQTZfjU+wRgNz98QeDK1y5DPC4ChVs\nmYS/cgUwlERwKAvfSBFrGmyP+c1nHpjlE5f7sjtu/O4vYJ2YUs8D0XgWbXDQnaxy\nTFAeyPeu/CDEwjHRvfRSu/ELgVn6SQrFJXZjSwzHTVaG9dj8hAEF3R5v4gC2qA5g\nYX/GUUa+x8Rvc29V1cbcgs/WrTUe8AsiU//whAUYA8LD/4tepcY5qbRi+00UibS1\nr90D2+KpZ7dSf4IXUpOIkha4mFD+rk8/7k2r6SYxoW67BsuOzS3i7C2ty2MRXFKK\naUkWPZ5WJm8tki/sTyD4QqzhbsBockIcq1SoG/8Yo//Vqh8kqWG4EqUCGGkGDikU\nPNelv3qEf3lYHEnizvOV8Q==\n-----END CERTIFICATE-----"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Client certificate extracted from vpnd"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "kosmas@kosmas-CELSIUS-W530-Power:~/Desktop$ openssl x509 -in vpnclient.pem -text\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 1632920287060 (0x17c31a23754)\n        Signature Algorithm: sha512WithRSAEncryption\n        Issuer: C = SE, ST = Goteborg, L = Goteborg, O = appgate, OU = devops, CN = devops.appgate.com, emailAddress = no-reply@appgate.com\n        Validity\n            Not Before: Sep 28 14:00:15 2021 GMT\n            Not After : Feb 11 14:00:15 2023 GMT\n        Subject: OU = local, CN = admin, CN = 515ea82d3493470bbf181dae820d7056\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                RSA Public-Key: (4096 bit)\n                Modulus:\n                    00:ba:ef:41:75:de:56:90:93:e0:e3:55:c6:29:76:\n                    56:40:b1:8c:14:1c:03:03:99:10:b6:e4:ac:bb:28:\n                    11:e6:ad:2c:27:5f:5e:28:a5:69:c3:23:72:75:82:\n                    d9:fd:19:81:69:8a:be:45:ce:3d:80:d2:f4:38:9d:\n                    59:21:7d:21:ac:7c:c0:cb:d5:df:b2:69:31:4c:48:\n                    68:72:34:90:b1:cf:da:5c:d6:71:b2:59:b2:87:0a:\n                    38:af:2d:3a:1c:25:90:d0:89:fa:76:73:e6:fd:fe:\n                    61:57:2b:79:3f:fe:1a:07:e4:d4:34:7e:d7:25:60:\n                    35:d2:dc:b7:ac:93:94:21:e2:34:d1:4b:4e:38:c4:\n                    c2:82:99:bb:c8:d4:e9:6f:2b:fc:97:ea:19:53:e8:\n                    d4:87:a2:09:19:94:4e:3b:cd:da:85:7f:48:2f:85:\n                    d2:fd:98:14:86:64:86:1e:68:ef:01:c7:77:51:5b:\n                    58:fc:1c:40:5c:d5:0a:ef:95:ff:d3:8a:d0:7b:e7:\n                    94:50:61:75:fb:a7:8c:7a:5d:9b:3a:fe:4b:79:99:\n                    a6:ac:b7:8b:a6:8a:43:c4:0c:56:bb:b2:01:be:d5:\n                    b7:00:df:be:0e:aa:29:e1:77:45:e9:a0:28:9a:e9:\n                    8a:6d:f2:01:4a:d2:fa:2c:fc:65:fa:94:56:60:c2:\n                    01:70:13:5b:32:11:b3:75:fa:55:e2:75:57:44:ae:\n                    bb:d7:09:d5:3b:b0:f2:fe:ca:e5:72:45:ed:95:41:\n                    39:3d:ab:90:81:bb:ee:4b:ed:8e:00:ef:cb:c7:55:\n                    c7:28:17:57:5c:7d:02:f5:8f:53:5f:50:9a:5d:f2:\n                    ba:53:94:7c:17:a9:f7:bc:50:84:ab:ae:2e:47:cc:\n                    9d:4e:f8:dd:74:26:9e:9b:ae:d0:ee:dc:c8:6c:01:\n                    4d:08:25:4f:5a:47:e0:b9:97:3e:4f:01:b3:14:e9:\n                    d3:9a:5a:60:f6:eb:b4:bf:56:00:64:9f:5a:76:f5:\n                    3a:1c:b5:05:56:30:ea:62:c2:38:65:95:ad:e7:8b:\n                    21:c6:4b:cc:f4:8c:21:c3:9b:8e:09:60:0a:cc:4e:\n                    c7:d9:ac:89:b7:94:e1:8f:0e:d1:4c:8f:9c:67:96:\n                    d4:76:c1:ab:fa:76:22:41:af:e0:c7:b1:04:16:4f:\n                    06:8b:1b:ed:16:2c:90:36:23:81:6b:28:34:9b:df:\n                    ae:eb:6c:67:17:25:f9:f6:27:2f:3c:13:ff:73:2e:\n                    ca:d9:77:75:11:b8:3e:3a:58:08:b1:66:3c:81:32:\n                    ee:a7:fd:ba:fe:25:7e:d8:13:09:f5:17:8c:21:75:\n                    20:70:23:9a:db:71:8c:87:25:8e:e8:09:8c:1a:cd:\n                    9d:b7:73\n                Exponent: 65537 (0x10001)\n        X509v3 extensions:\n            X509v3 Subject Key Identifier: \n                0E:20:FC:A5:ED:67:36:55:6C:95:B2:5C:9D:D2:E6:17:9E:AD:92:5B\n            X509v3 Authority Key Identifier: \n                keyid:27:0F:FC:51:0E:B2:F9:D2:3E:29:16:2E:76:5D:44:B6:1C:8B:83:D9\n\n    Signature Algorithm: sha512WithRSAEncryption\n         bf:ec:a6:57:90:6c:72:65:a8:c7:71:9c:c8:ff:4e:d4:65:17:\n         b1:0d:56:15:e0:a7:a1:38:a3:07:da:91:e0:22:e5:c5:a9:82:\n         68:83:61:71:0a:f9:15:43:7f:2b:6c:08:4a:a4:63:bd:de:4d:\n         0a:53:88:8c:99:b4:92:f8:47:d6:74:e1:6f:4a:a2:6c:7e:c6:\n         91:1b:5d:4b:ee:7d:cc:de:ea:c5:3e:f2:8b:cd:b4:e0:ca:63:\n         47:75:57:cd:f1:b8:31:54:9c:80:e7:bb:6d:48:05:06:24:b0:\n         34:29:23:53:d5:2f:31:7d:54:d0:c3:41:3c:f9:d4:27:2a:29:\n         e5:ea:28:36:89:f4:09:3a:ca:0a:14:fa:5f:bd:c6:a5:e0:fa:\n         19:22:99:84:6d:4d:60:11:8b:df:82:cb:19:88:7e:16:6c:dd:\n         54:84:48:c9:93:3a:29:3b:eb:89:71:9c:13:9d:28:ee:c5:3f:\n         03:ab:d4:c4:17:86:85:9e:3f:77:5a:82:e3:77:76:e6:3b:52:\n         af:6a:76:53:5e:ba:f3:1c:81:86:16:f7:59:61:e1:7c:68:4f:\n         80:e5:a6:4c:1f:9d:18:7a:17:77:20:73:b7:ac:8a:87:65:76:\n         50:4d:97:e3:53:ec:11:80:dc:fd:f1:07:83:2b:5c:b9:0c:f0:\n         b8:0a:15:6c:99:84:bf:72:05:30:94:44:70:28:0b:df:48:11:\n         6b:1a:6c:8f:f9:cd:67:1e:98:e5:13:97:fb:b2:3b:6e:fc:ee:\n         2f:60:9d:98:52:cf:03:d1:78:16:6d:70:d0:9d:ac:72:4c:50:\n         1e:c8:f7:ae:fc:20:c4:c2:31:d1:bd:f4:52:bb:f1:0b:81:59:\n         fa:49:0a:c5:25:76:63:4b:0c:c7:4d:56:86:f5:d8:fc:84:01:\n         05:dd:1e:6f:e2:00:b6:a8:0e:60:61:7f:c6:51:46:be:c7:c4:\n         6f:73:6f:55:d5:c6:dc:82:cf:d6:ad:35:1e:f0:0b:22:53:ff:\n         f0:84:05:18:03:c2:c3:ff:8b:5e:a5:c6:39:a9:b4:62:fb:4d:\n         14:89:b4:b5:af:dd:03:db:e2:a9:67:b7:52:7f:82:17:52:93:\n         88:92:16:b8:98:50:fe:ae:4f:3f:ee:4d:ab:e9:26:31:a1:6e:\n         bb:06:cb:8e:cd:2d:e2:ec:2d:ad:cb:63:11:5c:52:8a:69:49:\n         16:3d:9e:56:26:6f:2d:92:2f:ec:4f:20:f8:42:ac:e1:6e:c0:\n         68:72:42:1c:ab:54:a8:1b:ff:18:a3:ff:d5:aa:1f:24:a9:61:\n         b8:12:a5:02:18:69:06:0e:29:14:3c:d7:a5:bf:7a:84:7f:79:\n         58:1c:49:e2:ce:f3:95:f1\n-----BEGIN CERTIFICATE-----\nMIIFqjCCA5KgAwIBAgIGAXwxojdUMA0GCSqGSIb3DQEBDQUAMIGYMQswCQYDVQQG\nEwJTRTERMA8GA1UECAwIR290ZWJvcmcxETAPBgNVBAcMCEdvdGVib3JnMRAwDgYD\nVQQKDAdhcHBnYXRlMQ8wDQYDVQQLDAZkZXZvcHMxGzAZBgNVBAMMEmRldm9wcy5h\ncHBnYXRlLmNvbTEjMCEGCSqGSIb3DQEJARYUbm8tcmVwbHlAYXBwZ2F0ZS5jb20w\nIhgPMjAyMTA5MjgxNDAwMTVaGA8yMDIzMDIxMTE0MDAxNVowSzEOMAwGA1UECwwF\nbG9jYWwxDjAMBgNVBAMMBWFkbWluMSkwJwYDVQQDDCA1MTVlYTgyZDM0OTM0NzBi\nYmYxODFkYWU4MjBkNzA1NjCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIB\nALrvQXXeVpCT4ONVxil2VkCxjBQcAwOZELbkrLsoEeatLCdfXiilacMjcnWC2f0Z\ngWmKvkXOPYDS9DidWSF9Iax8wMvV37JpMUxIaHI0kLHP2lzWcbJZsocKOK8tOhwl\nkNCJ+nZz5v3+YVcreT/+Ggfk1DR+1yVgNdLct6yTlCHiNNFLTjjEwoKZu8jU6W8r\n/JfqGVPo1IeiCRmUTjvN2oV/SC+F0v2YFIZkhh5o7wHHd1FbWPwcQFzVCu+V/9OK\n0HvnlFBhdfunjHpdmzr+S3mZpqy3i6aKQ8QMVruyAb7VtwDfvg6qKeF3RemgKJrp\nim3yAUrS+iz8ZfqUVmDCAXATWzIRs3X6VeJ1V0Suu9cJ1Tuw8v7K5XJF7ZVBOT2r\nkIG77kvtjgDvy8dVxygXV1x9AvWPU19Qml3yulOUfBep97xQhKuuLkfMnU743XQm\nnpuu0O7cyGwBTQglT1pH4LmXPk8BsxTp05paYPbrtL9WAGSfWnb1Ohy1BVYw6mLC\nOGWVreeLIcZLzPSMIcObjglgCsxOx9msibeU4Y8O0UyPnGeW1HbBq/p2IkGv4Mex\nBBZPBosb7RYskDYjgWsoNJvfrutsZxcl+fYnLzwT/3Muytl3dRG4PjpYCLFmPIEy\n7qf9uv4lftgTCfUXjCF1IHAjmttxjIcljugJjBrNnbdzAgMBAAGjQjBAMB0GA1Ud\nDgQWBBQOIPyl7Wc2VWyVslyd0uYXnq2SWzAfBgNVHSMEGDAWgBQnD/xRDrL50j4p\nFi52XUS2HIuD2TANBgkqhkiG9w0BAQ0FAAOCAgEAv+ymV5BscmWox3GcyP9O1GUX\nsQ1WFeCnoTijB9qR4CLlxamCaINhcQr5FUN/K2wISqRjvd5NClOIjJm0kvhH1nTh\nb0qibH7GkRtdS+59zN7qxT7yi8204MpjR3VXzfG4MVScgOe7bUgFBiSwNCkjU9Uv\nMX1U0MNBPPnUJyop5eooNon0CTrKChT6X73GpeD6GSKZhG1NYBGL34LLGYh+Fmzd\nVIRIyZM6KTvriXGcE50o7sU/A6vUxBeGhZ4/d1qC43d25jtSr2p2U1668xyBhhb3\nWWHhfGhPgOWmTB+dGHoXdyBzt6yKh2V2UE2X41PsEYDc/fEHgytcuQzwuAoVbJmE\nv3IFMJREcCgL30gRaxpsj/nNZx6Y5ROX+7I7bvzuL2CdmFLPA9F4Fm1w0J2sckxQ\nHsj3rvwgxMIx0b30UrvxC4FZ+kkKxSV2Y0sMx01WhvXY/IQBBd0eb+IAtqgOYGF/\nxlFGvsfEb3NvVdXG3ILP1q01HvALIlP/8IQFGAPCw/+LXqXGOam0YvtNFIm0ta/d\nA9viqWe3Un+CF1KTiJIWuJhQ/q5PP+5Nq+kmMaFuuwbLjs0t4uwtrctjEVxSimlJ\nFj2eViZvLZIv7E8g+EKs4W7AaHJCHKtUqBv/GKP/1aofJKlhuBKlAhhpBg4pFDzX\npb96hH95WBxJ4s7zlfE=\n-----END CERTIFICATE-----"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1632924702316
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like a wolfssl bug to me. It looks it doesn't understand some ASN to print them properly. By taking a closer look in the above 2 outputs it can be seen that lots of extensions have problems"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "WolfSSL (cz-vpnd)"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "X509v3 extensions:\n            X509v3 Subject Key Identifier: \n                0E:20:FC:A5:ED:67:36:55:6C:95:B2:5C:9D:D2:E6:17:9E:AD:92:5B\n            X509v3 Authority Key Identifier: \n                keyid:27:0F:FC:51:0E:B2:F9:D2:3E:29:16:2E:76:5D:44:B6:1C:8B:83:D9"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OpenSSL"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "X509v3 extensions:\n            X509v3 Extended Key Usage: \n                TLS Web Client Authentication\n            Netscape Cert Type: \n                SSL Client\n            X509v3 Subject Key Identifier: \n                0E:20:FC:A5:ED:67:36:55:6C:95:B2:5C:9D:D2:E6:17:9E:AD:92:5B\n            X509v3 Authority Key Identifier: \n                keyid:27:0F:FC:51:0E:B2:F9:D2:3E:29:16:2E:76:5D:44:B6:1C:8B:83:D9\n                DirName:/C=SE/ST=Goteborg/L=Goteborg/postalCode=40032/street=Kungsgatan/O=appgate/OU=devops/CN=devops.appgate.com/emailAddress=no-reply@appgate.com\n                serial:0B:D1:DF:A9:86:B8:F0:33:8F:83:A3:C8:F0:FD:9D:62:8D:0C:A1:CB\n\n            X509v3 CRL Distribution Points: \n\n                Full Name:\n                  URI:"
                },
                {
                  "type": "text",
                  "text": "http://ec2-52-56-222-134.eu-west-2.compute.amazonaws.com/kosmas.crl"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1632925723295
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I opened a ticket with wolfSSL to verify it is a \"print support\" for some extensions that is missing. Closing for now and will open it again if it turns out there is something we can do on our end"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1632987271193
      }
    ]
  },
  {
    "key": "SA-17211",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It's slow and Console is full of errors:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Uncaught Invariant Violation: A state mutation was detected between dispatches, in the path `applianceForm.appliance.logForwarder.elasticsearch.useInstanceCredentials`. This may cause incorrect behavior. ("
            },
            {
              "type": "text",
              "text": "http://redux.js.org/docs/Troubleshooting.html#never-mutate-reducer-arguments)"
            },
            {
              "type": "text",
              "text": "\n    invariant browser.js:38"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Similar issue in the "
                },
                {
                  "type": "text",
                  "text": "Active Users",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " page when blacklisting user (from the header button) "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Uncaught Invariant Violation: A state mutation was detected inside a dispatch, in the path: `activeUsers.selection.distinguishedName`. Take a look at the reducer(s) handling the action undefined. "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1630599103859
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "mikael.harsjo",
                    "text": "@mikael.harsjo",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " Hadrien will look in to this one (it's a 400 after all). The plan is to try to fix the issue first, rather than to make the tests first this time. I could create a separate ticket for creating tests for this functionality if that makes sense?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "filip.dalvag",
        "created": 1631172586679
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Nice, and i think we know that parts needs testing."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "mikael.harsjo",
        "created": 1631180931063
      }
    ]
  },
  {
    "key": "SA-17222",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "(on all pages) it says:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "GET"
            },
            {
              "type": "text",
              "text": "http://localhost:8080/ui/assets/images/manifest/icon-180x180.png"
            },
            {
              "type": "text",
              "text": "\n[HTTP/1.1 404 Not Found 0ms]"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "There seems to be a "
            },
            {
              "type": "text",
              "text": "manifest.json",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " as well that reference non existing icons too. There are two options:"
            }
          ]
        },
        {
          "type": "orderedList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Remove icon references (makes this a bug ticket)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Add icons (makes this a feature-ticket)"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " FYI"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "filip.dalvag",
        "created": 1630410645839
      }
    ]
  },
  {
    "key": "SA-17255",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The report string is build with "
            },
            {
              "type": "text",
              "text": "\\n",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " but then it's not printed like that An example: "
            },
            {
              "type": "text",
              "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildTypeId=StratusGateway",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://got-teamcity.agi.appgate.com/viewLog.html?buildTypeId=StratusGateway"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "Build&buildId=597995&tab=buildLog&logTab=tree&filter=debug&expand=all&",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "focus=77399 "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "cz-vpnd\t('Licenses\\n========\\n\\nThis document contains license information about software installed on this\\nimage that is not included in the Ubuntu repositories.\\n#### debian/copyright\\nLicense information for the package and embedded software\\n\\nFiles | License name\\n--- | ---\\n* | Proprietary \\nLicense information for the package and embedded software\\n\\nFiles | License name\\n--- | ---\\n/usr/sbin/cz-vpnd | Proprietary \\nLicense information for the package and embedded software\\n\\nFiles | License name\\n--- | ---\\n/usr/sbin/cz-vpnd | \u039c\u0399\u03a4 \\n\\n\\n### Detailed information\\n\\n#### debian/copyright\\nMissing copyright information\\n\\n', [['Upstream-Name', 'License', 'X-License-Url', 'X-Source-Included', 'X-Binaries-List', 'X-Original-License-Available', 'Package-Name'], ['cz-vpnd', 'Proprietary', '', '', '', '', 'debian/copyright'], ['wolfssl', 'Proprietary', '"
            },
            {
              "type": "text",
              "text": "https://github.com/wolfSSL/wolfssl/blob/master/LICENSING'"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " 'false', '', 'false', 'debian/copyright'], ['cJSON', '\u039c\u0399\u03a4', '"
            },
            {
              "type": "text",
              "text": "https://github.com/DaveGamble/cJSON/blob/master/LICENSE'"
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " 'false', '', 'false', 'debian/copyright']])"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If it is intended for the print just close the task "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "salvatore.tomaselli",
                    "text": "@salvatore.tomaselli",
                    "accessLevel": ""
                  }
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1630933527836
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Intended. It's python code I can copy paste to debug what the parsed data is."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1630939406302
      }
    ]
  },
  {
    "key": "SA-17335",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Sep 16 17:01:04.859103 sdpgw-014.appgate.com cz-named[2836]: [ERROR] [ELBv1Client] Got error response of type Sender and code LoadBalancerNotFound: Cannot find Load Balancer gabriel-ferrari\nSep 16 17:01:05.853055 sdpgw-014.appgate.com cz-named[2836]: [ERROR] [ELBv1Client] Action DescribeTags using POST "
            },
            {
              "type": "text",
              "text": "https://elasticloadbalancing.us-east-1.amazonaws.com"
            },
            {
              "type": "text",
              "text": " returned with HTTP 400 Bad Request"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "False alarm, this is already handled by the AWS resolver."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1632230924842
      }
    ]
  },
  {
    "key": "SA-17352",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Which can result in this funny error when trying to activate an appliance:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "root@appgate:~# openssl verify -CAfile ca-cert.pem -crl_check -CRLfile my.crl  < cert.pem\nCN = envy-10-97-128-3.devops\nerror 47 at 0 depth lookup: permitted subtree violation\nerror stdin: verification failed"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It probably also affects the websocket connection etc\u2026"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Example constraints:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "            X509v3 Name Constraints: \n                Permitted:\n                  DNS:.devops\n                  IP:10.97.128.0/255.255.255.0"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Appliance IPs: ![](image1.png)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The CA openssl config I used:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ cat ca_config.txt \n[ req ]\ndefault_bits       = 2048\ndefault_md         = sha512\nprompt             = no\nencrypt_key        = yes\n\n# base request\ndistinguished_name = req_distinguished_name\n\n# extensions\nreq_extensions     = v3_req\nx509_extensions     = v3_req\n\n[ req_distinguished_name ]\ncountryName            = \"SE\"\nstateOrProvinceName    = \"Goteborg\"\nlocalityName           = \"Goteborg\"\npostalCode             = \"\"\nstreetAddress          = \"Majorna\"\norganizationName       = \"appgate\"\norganizationalUnitName = \"devops\"\ncommonName             = \"devops.appgate.com\" \nemailAddress           = \"no-reply@appgate.com\"\n\n[ v3_req ]\nsubjectAltName  = DNS:appgate.com # multidomain certificate\nbasicConstraints = CA:TRUE,pathlen:0\nkeyUsage = digitalSignature,keyCertSign,cRLSign\nextendedKeyUsage = clientAuth,serverAuth,OCSPSigning\nnameConstraints=permitted;DNS:.devops,permitted;IP:10.97.128.0/255.255.255.0\ncrlDistributionPoints=URI:"
                },
                {
                  "type": "text",
                  "text": "http://testyd.devops/my.crl"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1632319856156
      }
    ]
  },
  {
    "key": "SA-17424",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Running 5.5 upgrade"
            },
            {
              "type": "text",
              "text": "script with 5.4.3 appliance:",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "python3 appgate-upgrade.pyz prepare "
            },
            {
              "type": "text",
              "text": "https://envy-10-97-222-2.devops"
            },
            {
              "type": "text",
              "text": " ./appgate-5.5.0-26077-beta.img.zip --cacert Appgate_SDP_envy-10-97-222-2.devops_CA.pem\n11:14:27 Discovering API version for "
            },
            {
              "type": "text",
              "text": "https://envy-10-97-222-2.devops:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n11:14:27 API version is 15\nEnter password for username admin and provider name local:\n11:14:31 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://envy-10-97-222-2.devops:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n11:14:32 Invalid username or password!\nEnter password for username admin and provider name local:\n11:14:33 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://envy-10-97-222-2.devops:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n11:14:33 Authentication succeeded\n11:14:33 Authorizing...\n11:14:54 Upgrade failed: Appliance controller-c9b5058e-a2a3-4043-a666-62fde01e71cf-site1 never reached expected status: expected state single_controller_ready, got controller_ready"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "env id:"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "c9b5058e-a2a3-4043-a666-62fde01e71cf"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I can repeat this: 5.5 upgrade script, 5.4 to 5.5 fails. 5.3 to 5.5 works."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1633696095423
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this is basically when not passing the --dev flag right? The upgrade fails but the message is confusing."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1634030582967
      }
    ]
  },
  {
    "key": "SA-17573",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Restarting named fixes it. It sounds like it related to token renewal/re-authentication."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "root@purple81:~# cz-names resolve esx://tag:*\nResolving 1 name: esx://tag:*\nesx://tag:*: {challenge : Basic realm=\"VAPI endpoint\",SIGN realm=3f0ca3f198ceb1c5bc268bf4ed5a3398ef029d3a,service=\"VAPI endpoint\",sts=\""
            },
            {
              "type": "text",
              "text": "https://lhr-nuvc01.agi.appgate.com/sts/STSService/lhrdevops.local\""
            },
            {
              "type": "text",
              "text": ","
            },
            {
              "type": "text",
              "text": " messages : [LocalizableMessage(id='com.vmware.vapi.endpoint.method.authentication.required', default_message='Authentication required.', args=[], params=None, localized=None)], data : None, error_type : UNAUTHENTICATED}\nroot@purple81:~# systemctl restart cz-named\nroot@purple81:~# cz-names resolve esx://tag:*\nResolving 1 name: esx://tag:*\nesx://tag:*: 10.97.154.1, 10.97.168.129, 10.97.185.129, 10.97.186.1, 10.97.200.129, 10.97.202.1, 10.97.218.1, 10.97.228.1, 10.97.231.1, 10.97.235.129, 10.97.243.129, 10.97.253.129, 10.97.3.254, fd00:ffff:a:3::254, fd00:ffff:d:154::1, fd00:ffff:d:186::1, fd00:ffff:d:202::1, fd00:ffff:d:2168::1, fd00:ffff:d:2185::1, fd00:ffff:d:218::1, fd00:ffff:d:2200::1, fd00:ffff:d:2235::1, fd00:ffff:d:2243::1, fd00:ffff:d:2253::1, fd00:ffff:d:228::1, fd00:ffff:d:231::1"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-17650",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Disallow http redirects"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Disallow http (only https)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Add a local config"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Add a deprecation check"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Controller: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-controller/pull/2671",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-controller/pull/2671"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Gateway: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-gateway/pull/3106",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-gateway/pull/3106"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Passing to appliance for"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "local config"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "deprecation check "
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "SELECT name FROM policy WHERE expression ILIKE '%"
                        },
                        {
                          "type": "text",
                          "text": "http://%'"
                        },
                        {
                          "type": "text",
                          "text": ";"
                        },
                        {
                          "type": "text",
                          "text": "\nSELECT name FROM filter WHERE expression ILIKE '%"
                        },
                        {
                          "type": "text",
                          "text": "http://%'"
                        },
                        {
                          "type": "text",
                          "text": ";"
                        },
                        {
                          "type": "text",
                          "text": "\nSELECT name FROM condition WHERE expression ILIKE '%"
                        },
                        {
                          "type": "text",
                          "text": "http://%'"
                        },
                        {
                          "type": "text",
                          "text": ";"
                        },
                        {
                          "type": "text",
                          "text": "\nSELECT name FROM entitlement_script WHERE expression ILIKE '%"
                        },
                        {
                          "type": "text",
                          "text": "http://%'"
                        },
                        {
                          "type": "text",
                          "text": ";"
                        },
                        {
                          "type": "text",
                          "text": "\nSELECT name FROM user_script WHERE expression ILIKE '%"
                        },
                        {
                          "type": "text",
                          "text": "http://%'"
                        },
                        {
                          "type": "text",
                          "text": ";"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": " Notes:"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "user"
                        },
                        {
                          "type": "text",
                          "text": "script appeared on 5.4. 5.3 will not have the table.",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "user"
                        },
                        {
                          "type": "text",
                          "text": "script is called \"User Claim Script\".",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "filter is called \"Criteria Script\""
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1635520395549
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The local settings are "
                },
                {
                  "type": "text",
                  "text": "policyEvaluator/allowUnsafeHttp",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " and "
                },
                {
                  "type": "text",
                  "text": "policyEvaluator/allowUnsafeHttpRedirection",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Example setting both settings to true: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ sudo cz-config set -j policyEvaluator/allowUnsafeHttp true\n$ sudo cz-config set -j policyEvaluator/allowUnsafeHttpRedirection true"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "To reset to default settings (both false): "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ sudo cz-config del policyEvaluator"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1635753379974
      }
    ]
  },
  {
    "key": "SA-17671",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Shall use nginx's API instead i.e "
            },
            {
              "type": "text",
              "text": "ngx_vsnprintf",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " instead of "
            },
            {
              "type": "text",
              "text": "vsnprintf",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " as only nginx understands specifier "
            },
            {
              "type": "text",
              "text": "%V",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "portal_access: aguid_label %V has corresponding session. User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:93.0) Gecko/20100101 Firefox/93.0, client: 212.16.176.132, server: *.agi.appgate.com, request: \"GET /hub/api/rest/settings/public?fields=id HTTP/2.0\", host: \"got-youtrack.agi.appgate.com\", referrer: \""
            },
            {
              "type": "text",
              "text": "https://got-youtrack.agi.appgate.com/issue/SA-17431\""
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-17813",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Implement a command for listing all appliances in an Appgate SDP collective. List should be presented as a tabbed list of appliances or as json output depending on the an option provided by the command itself."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Should also have filter functionality for getting more specific lists of appliances, such as only controllers or gateways."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Examples:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "# List command with no arguments or flags should list all appliances in the collective\n$>appgatectl appliance list\nID                                      NAME                                                    ROLES                   HOST                                   IP\n6ac3fe2c-29b1-4bb9-81f2-938fe92ef922    controller-9fcdee05-5275-45a3-b5c1-21be024bba37-site1   controller,logserver    "
            },
            {
              "type": "text",
              "text": "https://envy-10-97-132-2.devops:444"
            },
            {
              "type": "text",
              "text": "    10.97.132.2\na2f3df30-c003-4da6-b8b0-7f52f4a93858    gateway-9fcdee05-5275-45a3-b5c1-21be024bba37-site1      gateway                                                        10.97.132.3"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "# Example of filter implementation\n$>appgatectl appliance list --filter=roles=controller\nID                                      NAME                                                    ROLES                   HOST                                   IP\n6ac3fe2c-29b1-4bb9-81f2-938fe92ef922    controller-9fcdee05-5275-45a3-b5c1-21be024bba37-site1   controller,logserver    "
            },
            {
              "type": "text",
              "text": "https://envy-10-97-132-2.devops:444"
            },
            {
              "type": "text",
              "text": "    10.97.132.2"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-17835",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Either 1 test per command or all in one depending on what makes sense."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Test cases for appliance centric features go here "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-tests/tree/master/cases/appliance",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-tests/tree/master/cases/appliance"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " The test runner "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/testy",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/testy"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Bootstrapping the test environment "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-tests/blob/master/bootstrap.py",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-tests/blob/master/bootstrap.py"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Not sure how well all this works on mac m1 though :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637051757184
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "e2e test cases in testrail "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/suites/view/199&group",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-testrail.agi.appgate.com/index.php?/suites/view/199&group"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "by=cases:section",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "id&group"
                },
                {
                  "type": "text",
                  "text": "order=asc",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637051808979
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So the test did run in the latest nightly run, see "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/946173",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/946173"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You can get it like this btw: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot test get -t nightly_linux\naitorbot ['nightly_linux'] | 2021-12-01 22:00:03\n\tid:   1f527efb-9efc-4fec-a38a-b247ff7b76e1\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/946173"
                },
                {
                  "type": "text",
                  "text": "\n\tpassed: 95/100"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "However 2 of them failed: ![](image1.png)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "With the following errors: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Test case failed with:\nAssertion (\"tcpdump: can't parse filter expression: syntax error\" in 'tcpdump: syntax error in filter expression: syntax error\\nCommand exited with code 1\\n') failed: Expected failed tcpdump command\nFile \"/tmp/cz-stratus-tests/cases/appliance/remote_commands/tcpdump.py\", line 43, in run\ntest_tcpdump(appliance[\"id\"], admin, node)\nFile \"/tmp/cz-stratus-tests/cases/appliance/remote_commands/tcpdump.py\", line 24, in test_tcpdump\nasserts.contains(expected_failure, actual, \"Expected failed tcpdump command\")\nFile \"/tmp/virtualenv_0f788de5-4aad-4ae3-aa13-1624b1d9073a/lib/python3.8/site-packages/testy/assertions.py\", line 94, in contains\nraise_error(\"{} in {}\", a, b, message, args) File \"/tmp/virtualenv_0f788de5-4aad-4ae3-aa13-1624b1d9073a/lib/python3.8/site-packages/testy/assertions.py\", line 8, in raise_error raise AssertionError(f\"Assertion ({assertion}) failed: {message.format(args)}\")"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Test case failed with:\nAssertion ('ping: SO_BINDTODEVICE foo: No such device' in 'ping: SO_BINDTODEVICE: Invalid argument\\nCommand exited with code 2\\n') failed: Expected failed ping command\nFile \"/tmp/cz-stratus-tests/cases/appliance/remote_commands/ping.py\", line 42, in run\ntest_ping(appliance[\"id\"], admin, node)\nFile \"/tmp/cz-stratus-tests/cases/appliance/remote_commands/ping.py\", line 28, in test_ping\nasserts.contains(expected_failure, actual, \"Expected failed ping command\")\nFile \"/tmp/virtualenv_0f788de5-4aad-4ae3-aa13-1624b1d9073a/lib/python3.8/site-packages/testy/assertions.py\", line 94, in contains\nraise_error(\"{} in {}\", a, b, message, args) File \"/tmp/virtualenv_0f788de5-4aad-4ae3-aa13-1624b1d9073a/lib/python3.8/site-packages/testy/assertions.py\", line 8, in raise_error raise AssertionError(f\"Assertion ({assertion}) failed: {message.format(args)}\")"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The same 2 tests fail with ipv6, see "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/946206",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/946206"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot test get -t nightly_linux_ipv6\naitorbot ['nightly_linux_ipv6'] | 2021-12-02 00:30:06\n\tid:   b89ec6a6-7ff6-49f8-bbaa-545f9ac98185\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/946206"
                },
                {
                  "type": "text",
                  "text": "\n\tpassed: 132/134"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Test case failed with:\nAssertion ('PING fd00:ffff:d:128::2 (fd00:ffff:d:128::2) from fd00:ffff:d:128::2 eth0: 56(84) bytes of data.\\n64 bytes from fd00:ffff:d:128::2' in 'PING fd00:ffff:d:128::2(fd00:ffff:d:128::2) from fd00:ffff:d:128::2 eth0: 56 data bytes\\n64 bytes from fd00:ffff:d:128::2: icmp_seq=1 ttl=64 time=0.033 ms\\n64 bytes from fd00:ffff:d:128::2: icmp_seq=2 ttl=64 time=0.055 ms\\n64 bytes from fd00:ffff:d:128::2: icmp_seq=3 ttl=64 time=0.085 ms\\n\\n--- fd00:ffff:d:128::2 ping statistics ---\\n3 packets transmitted, 3 received, 0% packet loss, time 2043ms\\nrtt min/avg/max/mdev = 0.033/0.057/0.085/0.023 ms\\nCommand exited with code 0\\n') failed: Expected successful ping command\nFile \"/tmp/cz-stratus-tests/cases/appliance/remote_commands/ping.py\", line 42, in run\ntest_ping(appliance[\"id\"], admin, node)\nFile \"/tmp/cz-stratus-tests/cases/appliance/remote_commands/ping.py\", line 18, in test_ping\nasserts.contains(expected, actual, \"Expected successful ping command\")\nFile \"/tmp/virtualenv_dabacd6b-c1de-4fd3-bf42-232361babfe7/lib/python3.8/site-packages/testy/assertions.py\", line 94, in contains\nraise_error(\"{} in {}\", a, b, message, args) File \"/tmp/virtualenv_dabacd6b-c1de-4fd3-bf42-232361babfe7/lib/python3.8/site-packages/testy/assertions.py\", line 8, in raise_error raise AssertionError(f\"Assertion ({assertion}) failed: {message.format(args)}\")"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1638435561004
      }
    ]
  },
  {
    "key": "SA-17880",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Using SA-17621"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Will update as I go. Currently 6.0 allows all but that probably is a focal problem. Testing on 5.5.0 env."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "console.log(httpGet('"
                },
                {
                  "type": "text",
                  "text": "http://nghttp2.org/httpbin/redirect-to?url=http%3A%2F%2F127.0.0.1%3A9200'))"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\nreturn true;"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Elasticsearch & kibana (9300, 9301, 9310): reachable."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "configd (9230): reachable."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "ffwd"
                        },
                        {
                          "type": "text",
                          "text": "logs",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "client"
                        },
                        {
                          "type": "text",
                          "text": "input (9010):",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "ffwd"
                        },
                        {
                          "type": "text",
                          "text": "server (9011):",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "logd"
                        },
                        {
                          "type": "text",
                          "text": "input (9320):",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "controllerd (9130, 9131): Not reachable"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "sessiond (9200): reachable"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "nginx"
                        },
                        {
                          "type": "text",
                          "text": "url",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "access"
                        },
                        {
                          "type": "text",
                          "text": "http (9201):",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "nginx"
                        },
                        {
                          "type": "text",
                          "text": "url",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "access"
                        },
                        {
                          "type": "text",
                          "text": "ctrl",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "channel (9202):"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "nginx"
                        },
                        {
                          "type": "text",
                          "text": "url",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "access"
                        },
                        {
                          "type": "text",
                          "text": "https (9203):",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "dnsfwd (9204): Portal doesn't have policy evaluator"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "controller"
                        },
                        {
                          "type": "text",
                          "text": "proxy (9230): reachable",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "rsyslog"
                        },
                        {
                          "type": "text",
                          "text": "relp",
                          "marks": [
                            {
                              "type": "em"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "input (20514):"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1637599415359
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "On 5.5.1: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@envy-10-97-186-2:~$ sudo nc -vz -w1 127.0.0.1 9130\nConnection to 127.0.0.1 9130 port [tcp/*] succeeded!\ncz@envy-10-97-186-2:~$ nc -vz -w1 127.0.0.1 9130\nnc: connect to 127.0.0.1 port 9130 (tcp) timed out: Operation now in progress"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637680421430
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In the end we only use this capability for controller, controller proxy & named-dns. So we could extend it to much more."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637680507336
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "On an actual 5.5.1 controller (not a logserver): "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-10-97-186-2:~# ss -lnp -t\nState Recv-Q Send-Q       Local Address:Port   Peer Address:Port                                                                                                                                           \nLISTEN0      128              127.0.0.1:9230        0.0.0.0:*     users:((\"cz-configd\",pid=78924,fd=23))                                                                                                   \nLISTEN0      1024             127.0.0.1:9010        0.0.0.0:*     users:((\"cz-ffwd\",pid=68823,fd=10))                                                                                                      \nLISTEN0      128                0.0.0.0:22          0.0.0.0:*     users:((\"sshd\",pid=2530,fd=3))                                                                                                           \nLISTEN0      1024               0.0.0.0:443         0.0.0.0:*     users:((\"cz-proxyd\",pid=3039,fd=3))                                                                                                      \nLISTEN0      511                0.0.0.0:8443        0.0.0.0:*     users:((\"nginx\",pid=68816,fd=3),(\"nginx\",pid=68815,fd=3),(\"nginx\",pid=68814,fd=3),(\"nginx\",pid=68813,fd=3),(\"nginx\",pid=3107,fd=3))      \nLISTEN0      511                0.0.0.0:444         0.0.0.0:*     users:((\"nginx\",pid=68126,fd=9),(\"nginx\",pid=68125,fd=9),(\"nginx\",pid=68124,fd=9),(\"nginx\",pid=68122,fd=9),(\"nginx\",pid=3090,fd=9))      \nLISTEN0      55                 0.0.0.0:20514       0.0.0.0:*     users:((\"rsyslogd\",pid=2492,fd=6))                                                                                                       \nLISTEN0      256     [::ffff:127.0.0.1]:9130              *:*     users:((\"java\",pid=2659,fd=209))                                                                                                         \nLISTEN0      1024    [::ffff:127.0.0.1]:9131              *:*     users:((\"java\",pid=2659,fd=211))                                                                                                         \nLISTEN0      128                   [::]:22             [::]:*     users:((\"sshd\",pid=2530,fd=4))                                                                                                           \nLISTEN0      511                   [::]:8443           [::]:*     users:((\"nginx\",pid=68816,fd=6),(\"nginx\",pid=68815,fd=6),(\"nginx\",pid=68814,fd=6),(\"nginx\",pid=68813,fd=6),(\"nginx\",pid=3107,fd=6))      \nLISTEN0      1024                  [::]:443            [::]:*     users:((\"cz-proxyd\",pid=3039,fd=7))                                                                                                      \nLISTEN0      511                   [::]:444            [::]:*     users:((\"nginx\",pid=68126,fd=10),(\"nginx\",pid=68125,fd=10),(\"nginx\",pid=68124,fd=10),(\"nginx\",pid=68122,fd=10),(\"nginx\",pid=3090,fd=10)) \nLISTEN0      55                    [::]:20514          [::]:*     users:((\"rsyslogd\",pid=2492,fd=7))    "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637680560454
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For example sessiond is open bar: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@envy-10-97-186-3:~$ nc -vz 127.0.0.1 9200\nConnection to 127.0.0.1 9200 port [tcp/*] succeeded!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637680650082
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "BTW the behavior is the same on 6.0 as far as I can tell: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz@envy-10-97-202-2:~$ nc -vz -w1 127.0.0.1 9130\nnc: connect to 127.0.0.1 port 9130 (tcp) timed out: Operation now in progress\ncz@envy-10-97-202-2:~$ sudo nc -vz -w1 127.0.0.1 9130\nConnection to 127.0.0.1 9130 port [tcp/*] succeeded!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1637681431284
      }
    ]
  },
  {
    "key": "SA-17975",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "\t\t\tvar isAlwaysOnClient = RegistryManager.ReadRegValueInt(RegistryQueries.RegistryApplicationAlwaysOn) != 0;\n\t\t\tif (isAlwaysOnClient)\n\t\t\t{\n\t\t\t\t"
            },
            {
              "type": "text",
              "text": "http://Log.Info(\"Running"
            },
            {
              "type": "text",
              "text": " in Always-On mode.\");\n\t\t\t\tappConfig.PlatformTools = new AlwaysOnHeadlessPlatformTools();\n\t\t\t\tupdateLogic = new WindowsAlwaysOnVersionUpdateLogic();\n\t\t\t}"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Client (I think both headless and full) needs to be aware of always-on as it has slight effects on the logic."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "a flag in user defaults could work, but perhaps even better would be to check for service running as service "
                },
                {
                  "type": "text",
                  "text": "ps -ef | grep -i \"Appgate Service -s\"",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". There is also "
                },
                {
                  "type": "text",
                  "text": "launchtl list",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " but to list system services sudo is needed."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1638955539254
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "hmm tricky. Just to be clear, in windows case, it's both headless and the full which knows it. But I'm not sure if the full client really needs to know that."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "user defaults should be fine, and matches the windows approach but might be problematic since headless isn't the same user perhaps? "
                },
                {
                  "type": "text",
                  "text": "ps | grep",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " feels a bit hacky to me but less state management, so it's a good idea. But I'm afraid it might cause timing issues."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1638965247254
      }
    ]
  },
  {
    "key": "SA-18046",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Perhaps by adding this extension? "
            },
            {
              "type": "text",
              "text": "https://chrome.google.com/webstore/detail/windows-10-accounts/ppnbnpeolgkicgegkbkbjmhlideopiji?hl=en",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://chrome.google.com/webstore/detail/windows-10-accounts/ppnbnpeolgkicgegkbkbjmhlideopiji?hl=en"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " "
            },
            {
              "type": "text",
              "text": "https://stackoverflow.com/questions/53341132/how-can-i-add-a-custom-chrome-extension-to-my-electron-app",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://stackoverflow.com/questions/53341132/how-can-i-add-a-custom-chrome-extension-to-my-electron-app"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "extension_1_0_5_0.crx",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "extension_1_0_5_0.crx"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I unzipped the extension and loaded into electron. Tried hundred things but no luck. I don't get any error logs or anything, so that's quite annoying. Here is the last code I had on Electron Fiddle:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "// Modules to control application life and create native browser window\nconst {app, BrowserWindow, session } = require('electron')\nconst path = require('path')\n\n\n\nasync function createWindow () {\n  // Create the browser window.\n  const result = await session.defaultSession.loadExtension('C:\\\\Users\\\\natan.abolafya\\\\Downloads\\\\win10-chrome', { allowFileAccess: true });\n  // const result = await mainWindow.webContents.session.loadExtension('C:\\\\Users\\\\natan.abolafya\\\\Downloads\\\\win10-chrome', { allowFileAccess: true });\n  console.log(result);\n  \n  const mainWindow = new BrowserWindow({\n    width: 1600,\n    height: 900,\n    webPreferences: {\n      preload: path.join(__dirname, 'preload.js'),\n      nodeIntegration: true,\n      contextIsolation: false,\n    },\n  })\n\n  mainWindow.webContents.session.on('extension-loaded', () => console.log('extension-loaded'));\n  mainWindow.webContents.session.on('extension-unloaded', () => console.log('extension-unloaded'));\n  mainWindow.webContents.session.on('extension-ready', () => console.log('extension-ready'));\n\n  // and load the index.html of the app.\n  console.log('loading')\n  mainWindow.webContents.openDevTools();\n  //mainWindow.loadFile('index.html');\n  setTimeout(() => mainWindow.loadURL('"
                },
                {
                  "type": "text",
                  "text": "https://outlook.office.com/')"
                },
                {
                  "type": "text",
                  "text": ","
                },
                {
                  "type": "text",
                  "text": " 1000);\n}\n\n// This method will be called when Electron has finished\n// initialization and is ready to create browser windows.\n// Some APIs can only be used after this event occurs.\napp.whenReady().then(async () => {\n//  const result = await session.defaultSession.loadExtension('C:\\\\Users\\\\natan.abolafya\\\\Downloads\\\\win10-chrome', { allowFileAccess: true });\n//  console.log(result);\n  createWindow();\n  \n  app.on('activate', function () {\n    // On macOS it's common to re-create a window in the app when the\n    // dock icon is clicked and there are no other windows open.\n    if (BrowserWindow.getAllWindows().length === 0) createWindow()\n  })\n})\n\n// Quit when all windows are closed, except on macOS. There, it's common\n// for applications and their menu bar to stay active until the user quits\n// explicitly with Cmd + Q.\napp.on('window-all-closed', function () {\n  if (process.platform !== 'darwin') app.quit()\n})\n\n// In this file you can include the rest of your app's specific main process\n// code. You can also put them in separate files and require them here."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1641834712501
      }
    ]
  },
  {
    "key": "SA-18067",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "So it just defaults to bionic "
            },
            {
              "type": "text",
              "text": "https://github.com/appgate-sdp-int/appgate-docker/blob/master/assets/appgate-build.sh#L167",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://github.com/appgate-sdp-int/appgate-docker/blob/master/assets/appgate-build.sh#L167"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We could read it from /etc/os-release directly"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1639751994863
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Example output on focal: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@e6c23b0676d2:/build/project# cat /etc/os-release \nNAME=\"Ubuntu\"\nVERSION=\"20.04.3 LTS (Focal Fossa)\"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME=\"Ubuntu 20.04.3 LTS\"\nVERSION_ID=\"20.04\"\nHOME_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://www.ubuntu.com/\""
                },
                {
                  "type": "text",
                  "text": "\nSUPPORT_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://help.ubuntu.com/\""
                },
                {
                  "type": "text",
                  "text": "\nBUG_REPORT_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://bugs.launchpad.net/ubuntu/\""
                },
                {
                  "type": "text",
                  "text": "\nPRIVACY_POLICY_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\""
                },
                {
                  "type": "text",
                  "text": "\nVERSION_CODENAME=focal\nUBUNTU_CODENAME=focal"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1639752033309
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Example output on bionic: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ docker run --rm -it lhr-nexus01.agi.appgate.com:5001/appgate-builder /bin/bash\nroot@a54f0ad6a78e:/build/project# cat /etc/os-release\nNAME=\"Ubuntu\"\nVERSION=\"18.04.6 LTS (Bionic Beaver)\"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME=\"Ubuntu 18.04.6 LTS\"\nVERSION_ID=\"18.04\"\nHOME_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://www.ubuntu.com/\""
                },
                {
                  "type": "text",
                  "text": "\nSUPPORT_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://help.ubuntu.com/\""
                },
                {
                  "type": "text",
                  "text": "\nBUG_REPORT_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://bugs.launchpad.net/ubuntu/\""
                },
                {
                  "type": "text",
                  "text": "\nPRIVACY_POLICY_URL=\""
                },
                {
                  "type": "text",
                  "text": "https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\""
                },
                {
                  "type": "text",
                  "text": "\nVERSION_CODENAME=bionic\nUBUNTU_CODENAME=bionic"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1639752095227
      }
    ]
  },
  {
    "key": "SA-18091",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Traceback (most recent call last):\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 275, in _cancel_build\n    await self.request(method='POST', path=method,\n  File \"/usr/share/helvetest/clients/base_client.py\", line 150, in request\n    return await self._request(method, path, data, json_, headers, params, raise_for_status=raise_for_status)\n  File \"/usr/share/helvetest/clients/base_client.py\", line 129, in _request\n    await self.raise_for_status(resp)\n  File \"/usr/share/helvetest/clients/base_client.py\", line 106, in raise_for_status\n    raise ClientResponseError(\nclients.base_client.ClientResponseError: HTTP 404: b\"Responding with error, status code: 404 (Not Found).\\nDetails: jetbrains.buildServer.server.rest.errors.NotFoundException: No queued build with id '625954' can be found (build already started or finished?).\\nCould not find the entity requested. Check the reference is correct and the user has permissions to access the entity.\"\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 299, in cancel_build\n    await self.cancel_queued_build(build_id=build_id, reason=reason)\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 291, in cancel_queued_build\n    await self._cancel_build(build_id, reason, 'buildQueue')\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 286, in _cancel_build\n    raise BuildNotFoundError(f'Build {build_id} not found')\nclients.teamcity.BuildNotFoundError: Build 625954 not found\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 275, in _cancel_build\n    await self.request(method='POST', path=method,\n  File \"/usr/share/helvetest/clients/base_client.py\", line 150, in request\n    return await self._request(method, path, data, json_, headers, params, raise_for_status=raise_for_status)\n  File \"/usr/share/helvetest/clients/base_client.py\", line 129, in _request\n    await self.raise_for_status(resp)\n  File \"/usr/share/helvetest/clients/base_client.py\", line 106, in raise_for_status\n    raise ClientResponseError(\nclients.base_client.ClientResponseError: HTTP 403: b'403 Forbidden: Responding with 403 status code due to failed CSRF check: authenticated POST request is made, but neither tc-csrf-token parameter nor X-TC-CSRF-Token header are provided.. For a temporary workaround, you can set internal property teamcity.csrf.paranoid=false  and provide valid Origin="
            },
            {
              "type": "text",
              "text": "https://got-teamcity.agi.appgate.com"
            },
            {
              "type": "text",
              "text": " header with your request\\n'\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/usr/lib/python3/dist-packages/themachine/action_runner.py\", line 152, in arun\n    action_result = action_task.result()\n  File \"/usr/share/helvetest/helvetest/services/testsd/actions.py\", line 141, in arun\n    await teamcity_client.cancel_build(build_id=self.queued_build.id, reason=self.reason)\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 302, in cancel_build\n    await self.cancel_running_build(build_id=build_id, reason=reason)\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 294, in cancel_running_build\n    await self._cancel_build(build_id, reason, 'builds')\n  File \"/usr/share/helvetest/clients/teamcity.py\", line 288, in _cancel_build\n    raise TeamCityError(f'Failed to cancel build {build_id} with reason {reason}') from e\nclients.teamcity.TeamCityError: Failed to cancel build 625954 with reason Deleted by owner thomascellerier"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://www.jetbrains.com/help/teamcity/csrf-protection.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.jetbrains.com/help/teamcity/csrf-protection.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1640102610959
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "masaya.ando",
                    "text": "@masaya.ando",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " this could be a good intro task for helvetest when you are done with your current set of tasks."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/helvetest/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/helvetest/"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1640253771475
      }
    ]
  },
  {
    "key": "SA-18094",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Not sure what exactly but: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Dec 22 06:42:43.045439 envy-10-97-228-2.devops cz-webclient@9000[4221]: [2021-12-22T06:42:43.045Z] Error : Device claim update failed 'Only the invariant culture is supported in globalization-invariant mode. See "
            },
            {
              "type": "text",
              "text": "https://aka.ms/GlobalizationInvariantMode"
            },
            {
              "type": "text",
              "text": " for more information. (Parameter 'name')\nDec 22 06:42:43.046280 envy-10-97-228-2.devops cz-webclient@9000[4221]: en-us is an invalid culture identifier.'\nDec 22 06:42:43.046601 envy-10-97-228-2.devops cz-webclient@9000[4221]: [2021-12-22T06:42:43.046Z] Error :    at System.Globalization.CultureInfo.GetCultureInfo(String )\nDec 22 06:42:43.046681 envy-10-97-228-2.devops cz-webclient@9000[4221]:    at Shared.Client.DeviceClaims.Os..ctor(String name, String family, String version, String type, String platform, String hostname, String parent, String locale)\nDec 22 06:42:43.046681 envy-10-97-228-2.devops cz-webclient@9000[4221]:    at Shared.Client.DeviceClaims.Implementations.WebSystemInformationProvider.get_OsInformation()\nDec 22 06:42:43.046753 envy-10-97-228-2.devops cz-webclient@9000[4221]:    at Shared.Client.DeviceClaims.DeviceClaimCollector.GetSystemClaims(ISystemInformationProvider systemInformationProvider, ClientType clientType, Boolean isService)\nDec 22 06:42:43.046753 envy-10-97-228-2.devops cz-webclient@9000[4221]:    at Shared.Client.DeviceClaims.DeviceClaimCollector.RenewAndMigrateClaims(ISystemInformationProvider systemInformationProvider, UntrustedClaimsToken oldToken, ClientType clientType, Boolean isService)\nDec 22 06:42:43.046926 envy-10-97-228-2.devops cz-webclient@9000[4221]:    at Shared.Client.DeviceClaims.UntrustedClaimsHandler.UpdateDeviceClaims(UntrustedClaimsToken oldUntrustedClaimsToken, List`1 onDemandClaims, List`1 deviceScriptChecksums, Func`2 downloadFunction)\nDec 22 06:42:43.046978 envy-10-97-228-2.devops cz-webclient@9000[4221]:    at Shared.Client.DeviceClaims.UntrustedClaimsHandler.StartDeviceClaimsUpdate(List`1 onDemandClaims, List`1 deviceScriptChecksums, Func`2 downloadFunction)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I don't see this in 5.5 so I imagine .net 6 with \\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": " true \\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\\"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is causing this."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1640702916096
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "On .NET 6 and later versions, a CultureNotFoundException is thrown if the app is running in an environment where globalization-invariant mode is enabled, for example, some Docker containers, and a culture other than the invariant culture is specified."
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yep. "
                },
                {
                  "type": "text",
                  "text": "https://docs.microsoft.com/en-us/dotnet/api/System.Globalization.CultureInfo.GetCultureInfo?view=netstandard-2.1",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.microsoft.com/en-us/dotnet/api/System.Globalization.CultureInfo.GetCultureInfo?view=netstandard-2.1"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1640703125303
      }
    ]
  },
  {
    "key": "SA-18129",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2022-01-09T05:29:41.581Z] Info : Trying to connect 'sdp.remoteaccess.dxc.com/15.176.112.148' with SPA key name 'UserSPAKey'.\n[2022-01-09T05:29:51.687Z] Info : REST  (sdp.remoteaccess.dxc.com:443) H0 [[18]] : Connection failed. ERR_CONNECT_GENERIC_ERROR - Failed to connect TLS socket: The operation completed successfully. (0)\n[2022-01-09T05:29:51.688Z] Info : Trying to connect 'sdp.remoteaccess.dxc.com/15.176.64.136' with SPA key name 'UserSPAKey'.\n[2022-01-09T05:30:01.763Z] Info : REST  (sdp.remoteaccess.dxc.com:443) H0 [[18]] : Connection failed. ERR_CONNECT_GENERIC_ERROR - Failed to connect TLS socket: The operation completed successfully. (0)\n[2022-01-09T05:30:01.768Z] Error : First connection to controller '"
            },
            {
              "type": "text",
              "text": "https://sdp.remoteaccess.dxc.com/'"
            },
            {
              "type": "text",
              "text": " has failed. Details: Connection failed."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18144",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "In Breadcrumbs, the "
            },
            {
              "type": "text",
              "text": "aria-current=\"page\"",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " is incorrectly added."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "On an edit/create page, the aria-current is on the breadcrumb link for the page \"above\" (screen shot from Edit Identity Provider page):"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](Screenshot 2022-01-12 at 10.31.40.png)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "To fix this, there are two options:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Put aria-current on the last item (in this case \"Edit\")"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Remove aria-current altogether"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "According to Mozilla (MDN Web Docs):"
                    }
                  ]
                },
                {
                  "type": "blockquote",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "If the element representing the current page in the breadcrumb was not a link, the\u00a0"
                        },
                        {
                          "type": "text",
                          "text": "aria-current",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "\u00a0is optional."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-current",
                      "marks": [
                        {
                          "type": "link",
                          "attrs": {
                            "href": "https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-current"
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18292",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "It looks that sometimes after the "
            },
            {
              "type": "text",
              "text": "block_report",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " =\\> remedy =\\> OTP provides =\\> new ACL rules from cz-sessiond, cz-vpnd is not applying the new rules"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "an 31 11:19:27.047105 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [C 7f81672f6700 CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] 860 bytes read from ITC\nJan 31 11:19:29.584985 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_write(): 0x7f8160001960 251\nJan 31 11:19:29.584985 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [C 7f81672f6700 CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] block_report: UP 15.0.0.0 TO 10.97.201.67 TCP 37382 TO 80 SEQ 3043480912 ACK 0 WIN 65377 SYN SIZE 60 (ACL rule name \"stratus1000_tcp-0\")\nJan 31 11:19:29.585681 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [ReportMessageHandler] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] remedy report\nJan 31 11:19:29.587225 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [ClientCommandHandler] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] ->client remedy action: OtpAuthentication name:Optional[stratus1000_tcp]\nJan 31 11:19:29.587502 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 325 IPC bytes read: F Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"method\":\"otp-authentication\",\"params\":{\"providerId\":\"64cda0c3-567a-4292-9a0d-efebc33147e3\",\"displayName\":\"stratus1000_tcp\",\"name\":\"stratus1000_tcp\",\"message\":\"test otp\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"2063920332\"},\"jsonrpc\":\"2.0\"}\nJan 31 11:19:29.587502 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 325 bytes in IPC read buffer: F Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"method\":\"otp-authentication\",\"params\":{\"providerId\":\"64cda0c3-567a-4292-9a0d-efebc33147e3\",\"displayName\":\"stratus1000_tcp\",\"name\":\"stratus1000_tcp\",\"message\":\"test otp\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"2063920332\"},\"jsonrpc\":\"2.0\"}\nJan 31 11:19:29.587630 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 1 IPC messages have been extracted from the read buffer\nJan 31 11:19:29.587630 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [14] itc_add_write(): 0x7f8160001c00 354\nJan 31 11:19:29.587630 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_read()\nJan 31 11:19:29.587630 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [14] ITC bytes written: 354\nJan 31 11:19:29.587630 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] itc_erase_bytes_written(): 0x7f8160001c00 354 bytes\nJan 31 11:19:29.587630 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [C 7f81672f6700 CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] 354 bytes read from ITC\nJan 31 11:19:29.587972 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [AuditJsonEventLogger] {\"id\":\"a5ce2203-630b-40bd-b722-db729e64dc28\",\"timestamp\":\"2022-01-31T11:19:29.587457Z\",\"version\":17,\"distinguished_name\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"session_id\":\"1111ee46-882c-46c4-860c-93947db054bd\",\"remedy_types\":[\"OtpAuthentication\"],\"hosts\":[\"10.97.201.67\"],\"protocol\":\"tcp_up\",\"entitlement_name\":\"stratus1000_tcp\",\"ports\":[\"80\"],\"remedy_logic\":\"and\",\"event_type\":\"remedy_action_triggered\"}\nJan 31 11:19:29.588475 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [Session] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] Prepared client app-update: c23ea37c2f64cc8558619ad301ce321f6ab9d8fd [ available: 0 remedy: 1 blocking: 0 ] remedys( active: 1 inactive: 0 )\nJan 31 11:19:34.706676 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_write(): 0x7f8160001960 6029\nJan 31 11:19:34.711082 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [ClientCommandHandler] client->update-tokens\nJan 31 11:19:34.730776 envy-10-97-140-3.devops cz-sessiond[58463]: 11:19:34.730 [EventDispatcher] INFO com.appgate.controller.common.library.util.ClaimsUtil - GeoIP service could not find any record for Ip: 10.97.2.135. The address 10.97.2.135 is not in the database.\nJan 31 11:19:34.731163 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [AuditJsonEventLogger] {\"id\":\"d7c0c03d-7e0e-46cb-b75d-2a449f13a15d\",\"timestamp\":\"2022-01-31T11:19:34.730997Z\",\"version\":17,\"expiration_time\":\"2022-02-01T11:19:24.644879Z\",\"distinguished_name\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"session_id\":\"1111ee46-882c-46c4-860c-93947db054bd\",\"claims_token_id\":\"4cfe7e41-9a83-4e4f-bc6f-70f9c34724b0\",\"event_type\":\"claims_token_accepted\"}\nJan 31 11:19:34.731544 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [TimerCollection] Doing cancel on timer: f5b09006-42c2-48ba-81a2-c70285849b7c\nJan 31 11:19:34.731696 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [TimerCollection] Doing cancel on timer: 5bde117c-c989-4b2b-86cd-659173345647\nJan 31 11:19:34.731789 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [TimerCollection] Got a new timer to act oncom.appgate.gateway.sessiondaemon.timers.TimerCollection$CancelTimerEvent@29a8019b\nJan 31 11:19:34.731962 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [TimerCollection] Got a new timer to act oncom.appgate.gateway.sessiondaemon.timers.TimerCollection$CancelTimerEvent@378eecb6\nJan 31 11:19:34.732127 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [TimerCollection] Got a new timer to act oncom.appgate.gateway.sessiondaemon.timers.TimerCollection$AddTimerEvent@6fc5d9e3\nJan 31 11:19:34.732214 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [TimerCollection] Got a new timer to act oncom.appgate.gateway.sessiondaemon.timers.TimerCollection$AddTimerEvent@7b91a477\nJan 31 11:19:34.732305 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [AuditJsonEventLogger] {\"id\":\"5bdb7638-7814-47df-8185-9ee149f86890\",\"timestamp\":\"2022-01-31T11:19:34.732044Z\",\"version\":17,\"distinguished_name\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"session_id\":\"1111ee46-882c-46c4-860c-93947db054bd\",\"device_claims\":{\"isUserAdmin\":false,\"clientVersion\":\"6.0.0-27686-master\",\"os\":{\"name\":\"Ubuntu 20.04.3 LTS\",\"family\":\"linux\",\"version\":\"20.04\",\"type\":\"desktop\",\"platform\":\"x64\",\"hostname\":\"TestAgentUbuntu\",\"lcid\":\"1033\",\"parent\":\"debian\"},\"language\":\"en-us\",\"isFirewallEnabled\":true,\"macAddresses\":[\"005056A8F6B2\"],\"isMultiUser\":false,\"clientIPs\":[\"10.97.2.135\",\"fd00:ffff:a:2:10:97:3:114\"],\"clientType\":\"full\",\"spaKey\":\"test\",\"profileName\":\"test\"},\"event_type\":\"device_claims_accepted\"}\nJan 31 11:19:34.733999 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [Session] setting evaluation results: 2\nJan 31 11:19:34.734227 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 940 IPC bytes read: P Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"method\":\"access-control-list\",\"params\":{\"sign-key\":\"3da889b883da7cc76e36f5acf9de5d2d7156005335484f2e4e31551667a6768bfde680f8ab9be14906a4832968163ce1d7a80678f179691711bc8ceefb295cd96406e52e4b0951e00eb3d9ac61180335977412a15d8529d6c165f9a452a5ce29475dcfac3844c2e65278c18d310864634558bf0a74afaff10812ed63368ad131\",\"entitlement-based-routing\":false,\"dn\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"token-id\":\"8c045661-00c7-4224-9433-7d8f19e74ace\",\"acl-rules\":[{\"protocol\":0,\"types\":[\"0-255\"],\"action-id\":\"stratus1000_ping#b9b1d17b-9315-34ac-a874-96ceccb0ca27\",\"name\":\"stratus1000_ping-0\",\"rule\":0,\"subnets\":[\"10.97.201.67\\/32\"],\"direction\":0},{\"protocol\":2,\"action-id\":\"stratus1000_tcp#815b2a93-0283-3fa5-82a5-601022a77bee\",\"name\":\"stratus1000_tcp-0\",\"rule\":0,\"subnets\":[\"10.97.201.67\\/32\"],\"ports\":[\"80\"],\"direction\":0}]},\"jsonrpc\":\"2.0\"}\nJan 31 11:19:34.734227 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 940 bytes in IPC read buffer: P Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"method\":\"access-control-list\",\"params\":{\"sign-key\":\"3da889b883da7cc76e36f5acf9de5d2d7156005335484f2e4e31551667a6768bfde680f8ab9be14906a4832968163ce1d7a80678f179691711bc8ceefb295cd96406e52e4b0951e00eb3d9ac61180335977412a15d8529d6c165f9a452a5ce29475dcfac3844c2e65278c18d310864634558bf0a74afaff10812ed63368ad131\",\"entitlement-based-routing\":false,\"dn\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"token-id\":\"8c045661-00c7-4224-9433-7d8f19e74ace\",\"acl-rules\":[{\"protocol\":0,\"types\":[\"0-255\"],\"action-id\":\"stratus1000_ping#b9b1d17b-9315-34ac-a874-96ceccb0ca27\",\"name\":\"stratus1000_ping-0\",\"rule\":0,\"subnets\":[\"10.97.201.67\\/32\"],\"direction\":0},{\"protocol\":2,\"action-id\":\"stratus1000_tcp#815b2a93-0283-3fa5-82a5-601022a77bee\",\"name\":\"stratus1000_tcp-0\",\"rule\":0,\"subnets\":[\"10.97.201.67\\/32\"],\"ports\":[\"80\"],\"direction\":0}]},\"jsonrpc\":\"2.0\"}\nJan 31 11:19:34.734356 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 1 IPC messages have been extracted from the read buffer\nJan 31 11:19:34.734356 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [14] itc_add_write(): 0x7f8160001c00 1003\nJan 31 11:19:34.734356 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_read()\nJan 31 11:19:34.734486 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [VpndMessageSender] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] sent:{\"method\":\"access-control-list\",\"params\":{\"sign-key\":\"3da889b883da7cc76e36f5acf9de5d2d7156005335484f2e4e31551667a6768bfde680f8ab9be14906a4832968163ce1d7a80678f179691711bc8ceefb295cd96406e52e4b0951e00eb3d9ac61180335977412a15d8529d6c165f9a452a5ce29475dcfac3844c2e65278c18d310864634558bf0a74afaff10812ed63368ad131\",\"entitlement-based-routing\":false,\"dn\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"token-id\":\"8c045661-00c7-4224-9433-7d8f19e74ace\",\"acl-rules\":[{\"protocol\":0,\"types\":[\"0-255\"],\"action-id\":\"stratus1000_ping#b9b1d17b-9315-34ac-a874-96ceccb0ca27\",\"name\":\"stratus1000_ping-0\",\"rule\":0,\"subnets\":[\"10.97.201.67\\/32\"],\"direction\":0},{\"protocol\":2,\"action-id\":\"stratus1000_tcp#815b2a93-0283-3fa5-82a5-601022a77bee\",\"name\":\"stratus1000_tcp-0\",\"rule\":0,\"subnets\":[\"10.97.201.67\\/32\"],\"ports\":[\"80\"],\"direction\":0}]},\"jsonrpc\":\"2.0\"}\nJan 31 11:19:34.734580 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [VpndMessageSender] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] ->vpnd sent new acl, nr of rules: 2 vpnd id:57717\nJan 31 11:19:34.734660 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [AuditJsonEventLogger] {\"id\":\"8be79a06-d7c9-4e5f-a4d3-26b48adf00cf\",\"timestamp\":\"2022-01-31T11:19:34.733559Z\",\"version\":17,\"distinguished_name\":\"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\",\"session_id\":\"1111ee46-882c-46c4-860c-93947db054bd\",\"successful_condition_names\":[\"stratus1000_condition\"],\"entitlement_token_id\":\"8c045661-00c7-4224-9433-7d8f19e74ace\",\"successful_entitlement_names\":[\"stratus1000_ping\",\"stratus1000_tcp\"],\"app_shortcuts\":{\"stratus1000_https\":\"Available\"},\"execution_ms\":2,\"cached_values_used\":false,\"event_type\":\"entitlement_token_evaluated\",\"entitlement_token_available\":true}\nJan 31 11:19:34.734707 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 122 IPC bytes read: F Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"result\":true,\"id\":3,\"jsonrpc\":\"2.0\"}\nJan 31 11:19:34.734707 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 122 bytes in IPC read buffer: F Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"result\":true,\"id\":3,\"jsonrpc\":\"2.0\"}\nJan 31 11:19:34.734707 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 1 IPC messages have been extracted from the read buffer\nJan 31 11:19:34.734707 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [14] itc_add_write(): Skipping 0 1128 1\nJan 31 11:19:34.734707 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_read()\nJan 31 11:19:34.734901 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 771 IPC bytes read: F Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"method\":\"app-update\",\"params\":{\"apps\":{\"stratus1000_tcp\":{\"remedies\":[{\"method\":\"OtpAuthentication\",\"params\":{\"providerId\":\"64cda0c3-567a-4292-9a0d-efebc33147e3\",\"message\":\"test otp\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"2063920332\"},\"active\":false}],\"status\":\"Available\",\"appData\":{\"name\":\"stratus1000_https\",\"description\":\"Endpoint HTTPS\",\"url\":\""
                },
                {
                  "type": "text",
                  "text": "https://10.97.201.67\",\"colorCode\":2},\"appDatas\":[{\"name\":\"stratus1000_https\",\"description\":\"Endpoint"
                },
                {
                  "type": "text",
                  "text": " HTTPS\",\"url\":\""
                },
                {
                  "type": "text",
                  "text": "https://10.97.201.67\",\"colorCode\":2},{\"name\":\"stratus1000_http\",\"description\":\"Endpoint"
                },
                {
                  "type": "text",
                  "text": " HTTP\",\"url\":\""
                },
                {
                  "type": "text",
                  "text": "http://10.97.201.67\",\"colorCode\":14}],\"displayName\":\"stratus1000_https\",\"name\":\"stratus1000_https\"}}},\"jsonrpc\":\"2.0\"}"
                },
                {
                  "type": "text",
                  "text": "\nJan 31 11:19:34.734949 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 771 bytes in IPC read buffer: F Q049NGM0MjAwYTFiMzg2NDZhMWE1NjI0MTBkMjJiNTAyYmMsQ049c3RyYXR1czEwMDAsT1U9cmFkaXVz {\"method\":\"app-update\",\"params\":{\"apps\":{\"stratus1000_tcp\":{\"remedies\":[{\"method\":\"OtpAuthentication\",\"params\":{\"providerId\":\"64cda0c3-567a-4292-9a0d-efebc33147e3\",\"message\":\"test otp\",\"claimSuffix\":\"test\",\"actionIdentifier\":\"2063920332\"},\"active\":false}],\"status\":\"Available\",\"appData\":{\"name\":\"stratus1000_https\",\"description\":\"Endpoint HTTPS\",\"url\":\""
                },
                {
                  "type": "text",
                  "text": "https://10.97.201.67\",\"colorCode\":2},\"appDatas\":[{\"name\":\"stratus1000_https\",\"description\":\"Endpoint"
                },
                {
                  "type": "text",
                  "text": " HTTPS\",\"url\":\""
                },
                {
                  "type": "text",
                  "text": "https://10.97.201.67\",\"colorCode\":2},{\"name\":\"stratus1000_http\",\"description\":\"Endpoint"
                },
                {
                  "type": "text",
                  "text": " HTTP\",\"url\":\""
                },
                {
                  "type": "text",
                  "text": "http://10.97.201.67\",\"colorCode\":14}],\"displayName\":\"stratus1000_https\",\"name\":\"stratus1000_https\"}}},\"jsonrpc\":\"2.0\"}"
                },
                {
                  "type": "text",
                  "text": "\nJan 31 11:19:34.734949 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] 1 IPC messages have been extracted from the read buffer\nJan 31 11:19:34.734949 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [14] itc_add_write(): Skipping 0 1992 1\nJan 31 11:19:34.734949 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_read()\nJan 31 11:19:34.735078 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [Session] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] Prepared client app-update: f9da405fb9fccace317eeb86767773997807e1e9 [ available: 1 remedy: 0 blocking: 0 ] remedys( active: 0 inactive: 1 )\nJan 31 11:19:34.735163 envy-10-97-140-3.devops cz-sessiond[58463]: INFO [Session] [CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] ->client : app-update (f9da405fb9fccace317eeb86767773997807e1e9)\nJan 31 11:19:36.713743 envy-10-97-140-3.devops systemd[1]: systemd-hostnamed.service: Succeeded.\nJan 31 11:19:47.536983 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] Forwarding unsubscription of \"CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius\" to sessiond from [C 7f81672f6700]\nJan 31 11:19:47.536983 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [8] ipc_add_write(): 0x7f8160001960 139\nJan 31 11:19:47.536983 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] [14] ITC bytes written: 1003\nJan 31 11:19:47.536983 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] itc_erase_bytes_written(): 0x7f8160001c00 1003 bytes\nJan 31 11:19:47.536983 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [R 7f81683c1700] Cleaning up value of connection thread [C 7f81672f6700]\nJan 31 11:19:47.536983 envy-10-97-140-3.devops cz-vpnd@1[57717]: INFO    [C 7f81672f6700 CN=4c4200a1b38646a1a562410d22b502bc,CN=stratus1000,OU=radius] Connection closed by client"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1643629995457
      }
    ]
  },
  {
    "key": "SA-18361",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "discriminator:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0propertyName: type\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0mapping:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# The mapped providers need to be on the root document. "
            },
            {
              "type": "text",
              "text": "https://github.com/Rebilly/ReDoc/issues/556"
            },
            {
              "type": "text",
              "text": "\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Saml: '#/components/schemas/SamlProvider'\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Radius: '#/components/schemas/RadiusProvider'\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Ldap: '#/components/schemas/LdapProvider'\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LdapCertificate: '#/components/schemas/LdapCertificateProvider'\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LocalDatabase: '#/components/schemas/LocalDatabaseProvider'\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Connector: '#/components/schemas/ConnectorProvider"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Right now we miss the fields defined in those mappings"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18410",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Mapping is defined as"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "        discriminator:\n          propertyName: type\n          mapping:\n            # The mapped providers need to be on the root document. "
            },
            {
              "type": "text",
              "text": "https://github.com/Rebilly/ReDoc/issues/556"
            },
            {
              "type": "text",
              "text": "\n            Saml: '#/components/schemas/SamlProvider'\n            Radius: '#/components/schemas/RadiusProvider'\n            Ldap: '#/components/schemas/LdapProvider'\n            LdapCertificate: '#/components/schemas/LdapCertificateProvider'\n            LocalDatabase: '#/components/schemas/LocalDatabaseProvider'\n            IotConnector: '#/components/schemas/IoTConnectorProvider'"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "but the type is missing from the enum:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "            enum:\n              - LocalDatabase\n              - Ldap\n              - LdapCertificate\n              - Radius\n              - Saml"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18463",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Description"
            }
          ],
          "attrs": {
            "level": 3
          }
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "We need to add "
                    },
                    {
                      "type": "text",
                      "text": "X-pkgmgr: npm",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": "  to each copyright entry like so "
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "Files: /var/www/html/cz-ui/\nUpstream-Name: estraverse\nX-pkgmgr: npm\nSources: "
                    },
                    {
                      "type": "text",
                      "text": "http://github.com/estools/estraverse.git"
                    },
                    {
                      "type": "text",
                      "text": "\nLicense: BSD-2-Clause (original text)"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": " I guess we can update the script to ad this line"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "It looks like we are missing dompurify license too, so we should make sure it's included"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18495",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "cz-backup does some funky output with BDR3.7: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "cellsons@cellsons ~/Projects/purple-pants master $ ./thomas_backup.sh                                                                                                                                                                                   \n15:49:01 Discovering API version for "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n15:49:01 API version is 17\n15:49:01 Authenticating to "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443"
            },
            {
              "type": "text",
              "text": "..."
            },
            {
              "type": "text",
              "text": "\n15:49:02 Authentication succeeded\n15:49:02 Authorizing...\n15:49:03 Starting backup on 1 appliances:\n15:49:03 All files will be stored in backups/appgate_backup_1645541341.8418746/\n15:49:03 Starting backup creation on aws - purple10\n15:49:03 Backup creation started on aws - purple10\n15:49:03 Backup in progress on appliance: aws - purple10\n15:49:06 Backup in progress on appliance: aws - purple10\n15:49:09 Backup in progress on appliance: aws - purple10\n15:49:13 Backup in progress on appliance: aws - purple10\n15:49:16 Backup in progress on appliance: aws - purple10\n15:49:19 Backup in progress on appliance: aws - purple10\n15:49:22 Backup complete on appliance: aws - purple10\n15:49:22 Appliance 801db367-58d0-4876-84ae-f6d1fdab6c0d reported the following issues:\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\npg_dump: NOTICE:  skipped replication for captured DDL command \"LOCK TABLE\" in replication sets (appgatecollective): this statement type is not replicated by BDR\n15:49:22 Downloading backup from aws - purple10 in backups/appgate_backup_1645541341.8418746/aws - purple10.bkp\n15:49:24 Download complete for appliance: aws - purple10\n15:49:24 Removed remote download for appliance: aws - purple10\n15:49:24 Some issues were encountered during the backup process. The downloaded files might not work or contain incomplete data."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18509",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Should be mostly a presentation of how it works with some practical examples using dbs."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://docs.google.com/presentation/d/1-fqbzKkvpapfSMjlDtRJv2cmyPCEpQnzG8",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://docs.google.com/presentation/d/1-fqbzKkvpapfSMjlDtRJv2cmyPCEpQnzG8"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "mgoZKZ2I/edit#slide=id.g123dd7154b4",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0"
                },
                {
                  "type": "text",
                  "text": "222",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1649682098900
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "mkdir /mnt/data/democd /mnt/data/demowget ",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage_Build/release-6.0/artifact/appgate-6.0.0-29005-beta.img.zip?is-build-type-id=true",
                  "marks": [
                    {
                      "type": "code"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage_Build/release-6.0/artifact/appgate-6.0.0-29005-beta.img.zip?is-build-type-id=true"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "]("
                },
                {
                  "type": "text",
                  "text": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "Build/release-6.0/artifact/appgate-6.0.0-29005-beta.img.zip?is-build-type-id=true)",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " -O appgate.img.zipunzip appgate.img.zipmkdir imagemount -o loop appgate-*.img /mnt/data/demo/imagecp -r /etc/dbd/current /etc/dbd/mydbmkdir -p /mnt/data/postgresql/state2/12/mainchown postgres:postgres /mnt/data/postgresql/state2/12/mainmkdir /run/cz-dbd/dbd-mydbdchown postgres:postgres /run/cz-dbd/dbd-mydbdcat > /etc/dbd/mydb/dbd.conf << EOFDBD_IMAGE=/mnt/data/demo/imageDBD_PKI=mnt/state/pkiDBD_RUN=run/cz-dbd/dbd-mydbDBD_DATA=mnt/data/postgresql/state2/12/mainDBD_POSTGRES_VERSION=12DBD_LOG_LEVEL=INFODBD_ENABLE_IP_ALLOCATION_INDEX_UPDATE=TrueDBD_ENABLE_BDR=trueDBD_PG_SYSLOG_IDENT=mydbEOFsystemctl start cz-dbd",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "mydbcz",
                    "text": "@mydbcz",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-dbs -i mydb statuscz-dbs -i current statuscz-dbs -i mydb pg configure --port 8444 --listen-address 127.0.0.1 --hba-entry \"host all all 127.0.0.1/32 trust\"/usr/bin/sudo -i -u postgres pgcli -p 8444 -h 127.0.0.1 controller# Do the join!",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " NODE"
                },
                {
                  "type": "text",
                  "text": "NAME=\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "cz-dbs node get -j |jq -r .[0].name",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\" && echo \"Node name is: ${NODE"
                },
                {
                  "type": "text",
                  "text": "NAME}\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "NODE"
                },
                {
                  "type": "text",
                  "text": "DSN=\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "cz-dbs node get -j |jq -r .[0].dsn",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "\" && echo \"Node DSN is: \"${NODE"
                },
                {
                  "type": "text",
                  "text": "DSN}\"\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cz-dbs -i mydb node join --local foo --node foo \"host=127.0.0.1 port=8444 dbname=controller sslmode=disable\" --node \"${NODE_NAME}\" \"${NODE_DSN}\"cz-dbs node part \"${NODE_NAME}\"# Go to the UI, the data is still herecz-dbs node wipe# Go to the UI, its broken!vi /etc/cz-controllerd/config.yamlsystemctl restart cz-controllerd"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1649682113781
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will make this into an interactive script for the demo so we don't need to copy paste all commands 1 by 1. "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "#!/usr/bin/env python3\nimport io\nimport os\nimport re\nimport subprocess\n\nimport xtermcolor\n\ncommands = \"\"\"\\\n# Let's download an appliance image and mount it somewhere\nmkdir /mnt/data/demo\nwget "
                },
                {
                  "type": "text",
                  "text": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage_Build/release-6.0/artifact/appgate-6.0.0-29172-beta.img.zip?is-build-type-id=true"
                },
                {
                  "type": "text",
                  "text": " -O /mnt/data/demo/appgate.img.zip\nunzip -d /mnt/data/demo /mnt/data/demo/appgate.img.zip\nmkdir /mnt/data/demo/image\nmount -o loop /mnt/data/demo/appgate-*.img /mnt/data/demo/image\n\n# OK, now time to setup another instance of dbd!\ncp -r /etc/dbd/current /etc/dbd/mydb\nmkdir -p /mnt/data/postgresql/state2/12/main\nchown postgres:postgres /mnt/data/postgresql/state2/12/main\nmkdir /run/cz-dbd/dbd-mydb\nchown postgres:postgres /run/cz-dbd/dbd-mydb\n\ncat > /etc/dbd/mydb/dbd.conf << EOF\nDBD_IMAGE=/mnt/data/demo/image\nDBD_PKI=mnt/state/pki\nDBD_RUN=run/cz-dbd/dbd-mydb\nDBD_DATA=mnt/data/postgresql/state2/12/main\nDBD_POSTGRES_VERSION=12\nDBD_LOG_LEVEL=INFO\nDBD_ENABLE_IP_ALLOCATION_INDEX_UPDATE=True\nDBD_ENABLE_BDR=true\nDBD_PG_SYSLOG_IDENT=mydb\nEOF\n\nsystemctl start cz-dbd@mydb\ncz-dbs -i mydb status\ncz-dbs -i current status\ncz-dbs -i mydb pg configure --port 8444 --listen-address 127.0.0.1 --hba-entry \"host all all 127.0.0.1/32 trust\"\n/usr/bin/sudo -i -u postgres pgcli -p 8444 -h 127.0.0.1 controller\n\n# Do the join!\nNODE_NAME=\"`cz-dbs node get -j |jq -r .[0].name`\"\nNODE_DSN=\"`cz-dbs node get -j |jq -r .[0].dsn`\"\ncz-dbs -i mydb node join --local foo --node foo \"host=127.0.0.1 port=8444 dbname=controller sslmode=disable\" --node \"${NODE_NAME}\" \"${NODE_DSN}\"\ncz-dbs -i mydb node del \"${NODE_NAME}\"\n\n# Go to the UI, the data is still here\ncz-dbs node wipe\n\n# Go to the UI, its broken!\n# Let's just point the controller to our new database.\nsed -i 's/socketFactoryArg: \\/run\\/cz-dbd\\/dbd-current\\/.s.PGSQL.443/socketFactoryArg: \\/run\\/cz-dbd\\/dbd-mydb\\/.s.PGSQL.8444/' /etc/cz-controllerd/config.yaml\nsystemctl restart cz-controllerd\n\n# And back again!!!\ncz-dbs node join --local \"${NODE_NAME}\" --node foo \"host=127.0.0.1 port=8444 dbname=controller sslmode=disable\" --node \"${NODE_NAME}\" \"${NODE_DSN}\"\ncz-dbs node del foo\ncz-dbs -i mydb node wipe\nsed -i 's/socketFactoryArg: \\/run\\/cz-dbd\\/dbd-mydb\\/.s.PGSQL.8444/socketFactoryArg: \\/run\\/cz-dbd\\/dbd-current\\/.s.PGSQL.443/' /etc/cz-controllerd/config.yaml\nsystemctl restart cz-controllerd\n\n# All back to normal now :)\ncz-dbs status\n\"\"\"\n\n\nlines = enumerate(iter(io.StringIO(commands)))\nenv = os.environ.copy()\nwhile True:\n    try:\n        lineno, line = next(lines)\n    except StopIteration:\n        break\n\n    line = line.rstrip()\n    if not line:\n        continue\n\n    if line.startswith(\"#\"):\n        print(xtermcolor.colorize(line, ansi=2))\n        continue\n\n    cmd_input = None\n    name = None\n\n    # Handle multi-line input\n    if m := re.match(r\"^.* << (\\w+)$\", line):\n        marker = m.group(1)\n        cmd = line[:-len(f\" << {marker}\")]\n        cmd_input = b\"\"\n        while True:\n            _, line = next(lines)\n            if line.startswith(marker):\n                break\n            cmd_input += line.encode(\"utf-8\")\n    # Handle variable assignment\n    elif m := re.match(r'^(\\w+)=\"`(.*)`\"$', line):\n        name = m.group(1)\n        cmd = m.group(2)\n    # Regular command\n    else:\n        cmd = line\n\n    # Command prompt\n    question = f\"Do you want to run (line {lineno}): {cmd}\"\n    if cmd_input:\n        question += f\"\\n{cmd_input.decode('utf-8')}\\nWith the given input\"\n    if name:\n        question += f\"\\nAssigning the result to {name!r}\"\n    question += \" [y/N]\"\n    y = input(question)\n    if y != \"y\":\n        cmd_input = None\n        continue \n\n    # Run command\n    if name:\n        output = subprocess.check_output(cmd, shell=True, env=env).decode('utf-8').rstrip()\n        print(f\"Setting {name} to {output}\")\n        env[name] = output\n    else:\n        subprocess.run(cmd, check=True, shell=True, input=cmd_input, env=env)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1651828387975
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sdp-dbd.pdf",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "sdp-dbd.pdf"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1652965354530
      }
    ]
  },
  {
    "key": "SA-18559",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "WARNING Missing Copyright information on cz-logging from cz-logging\nWARNING Missing Copyright information on rc from cz-kibana\nWARNING Missing Copyright information on cz-auditgen from cz-auditgen\nWARNING Missing Copyright information on logd-client from python3-logd\nWARNING Missing Copyright information on mustache.js for Java from cz-elasticsearch\nWARNING Missing Copyright information on yaml from cz-logd"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since we did a release to master just. is this still valid?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646061614926
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I guess so, it's not about the url but about the copyright field"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1646062263350
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So.. Is this something that should be done on release-5.5?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646062447991
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What is missing from the rc library?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646063649057
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "WARNING Missing Copyright information on cz-auditgen from cz-auditgen\nWARNING Missing Copyright information on logd-client from python3-logd"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " there i almost see as your area"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646063945379
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-logging/pull/446",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-logging/pull/446"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "  here is some shit"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646064220181
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I also dont see whats wrong with the mustach "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Files: /usr/cz-elasticsearch/modules/lang-mustache/lang-mustache-client-6.8.6.jar\nX-pkgmgr: maven\nX-License-Url: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/elastic/elasticsearch/blob/master/LICENSE.txt"
                },
                {
                  "type": "text",
                  "text": "\nSources: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/elastic/elasticsearch"
                },
                {
                  "type": "text",
                  "text": "\nUpstream-Name: elasticsearch mustache client\nLicense: Apache License 2.0\n\nFiles: /usr/cz-elasticsearch/modules/lang-mustache/compiler-0.9.3.jar\nX-pkgmgr: maven\nX-License-Url: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/spullara/mustache.java/blob/main/LICENSE"
                },
                {
                  "type": "text",
                  "text": "\nSources: "
                },
                {
                  "type": "text",
                  "text": "https://github.com/spullara/mustache.java"
                },
                {
                  "type": "text",
                  "text": "\nUpstream-Name: mustache.js for Java\nLicense: Apache License 2.0"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646064306250
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Please comment in the top story to avoid the same discussion on every task."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1646120695450
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I honestly do not know why it complains about rc in kibana..  in theory since its npm also.. its should not be a requirement for GCP."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646128242031
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "![](image.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646130053779
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So..  For now we should skip the elasticsearch/kibana parts."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646130075734
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So. that leaves the logd."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646130103816
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Haha good to make it external download :D"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I guess logd doesn't have such a crazy amount."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I've seen that sessiond does have the copyright fields"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1646136261080
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah.. different persons implemented them.. so logd/had etc is created by Daniel..   and sessiond has been done by Anton"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646142974427
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since Daniel is out off office. i will try to make a fix there"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1646143001205
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this must be obsolute"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1649233849046
      }
    ]
  },
  {
    "key": "SA-18576",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "DELETE\n\t"
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/admin/admin-messages?message=API"
            },
            {
              "type": "text",
              "text": " version \"application/vnd.appgate.peer-v13 json\" is still in use by \"Appgate Policy Evaluator/1.0 - 212.16.176.132\" (current version is \"application/vnd.appgate.peer-v17 json\"). Please update any external scripts as support for this version will be removed."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " the message needs to be URL encoded."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-18640",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "All explained in this commit: "
            },
            {
              "type": "text",
              "text": "https://github.com/Nexus-Mods/Vortex/commit/5ac245bf5af9931901e529df3106596b51fd7766",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://github.com/Nexus-Mods/Vortex/commit/5ac245bf5af9931901e529df3106596b51fd7766"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "First sketchy thing with this is how you add the dependency "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\"winapi-bindings\": \"Nexus-Mods/node-winapi-bindings\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " as oppose to assigning a version like a decent dependency."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Then, it depends on "
                },
                {
                  "type": "text",
                  "text": "node-gyp",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to do native integration and it's the worst native integration tool ever. It requires both python and visual studio installation. "
                },
                {
                  "type": "text",
                  "text": "npm install",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " failed with this on my machine: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "npm ERR! git dep preparation failed\nnpm ERR! command C:\\Program Files\\nodejs\\node.exe C:\\Users\\natan.abolafya\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js install --force --cache=C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache --prefer-offline=false --prefer-online=false --off\nline=false --no-progress --no-save --no-audit --include=dev --include=peer --include=optional --no-package-lock-only --no-dry-run\nnpm ERR! > winapi-bindings@2.4.0 install\nnpm ERR! > autogypi && node-gyp configure build\nnpm ERR! npm WARN using --force Recommended protections disabled.\nnpm ERR! npm WARN deprecated har-validator@5.1.3: this library is no longer supported\nnpm ERR! npm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See "
                },
                {
                  "type": "text",
                  "text": "https://v8.dev/blog/math-random"
                },
                {
                  "type": "text",
                  "text": " for details.\nnpm ERR! npm WARN deprecated request@2.88.2: request has been deprecated, see "
                },
                {
                  "type": "text",
                  "text": "https://github.com/request/request/issues/3142"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp info it worked if it ends with ok\nnpm ERR! gyp info using node-gyp@6.1.0\nnpm ERR! gyp info using node@16.13.0 | win32 | x64\nnpm ERR! gyp info find Python using Python version 3.8.10 found at \"C:\\Users\\natan.abolafya\\AppData\\Local\\Programs\\Python\\Python38\\python.exe\"\nnpm ERR! gyp http GET "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/node-v16.13.0-headers.tar.gz"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http 200 "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/node-v16.13.0-headers.tar.gz"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http GET "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/SHASUMS256.txt"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http GET "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/win-x86/node.lib"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http GET "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/win-arm64/node.lib"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http GET "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/win-x64/node.lib"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http 200 "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/win-x86/node.lib"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http 200 "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/SHASUMS256.txt"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http 404 "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/win-arm64/node.lib"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp http 200 "
                },
                {
                  "type": "text",
                  "text": "https://nodejs.org/download/release/v16.13.0/win-x64/node.lib"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp ERR! find VS\nnpm ERR! gyp ERR! find VS msvs_version not set from command line or npm config\nnpm ERR! gyp ERR! find VS VCINSTALLDIR not set, not running in VS Command Prompt\nnpm ERR! gyp ERR! find VS unknown version \"undefined\" found at \"C:\\Program Files\\Microsoft Visual Studio\\2022\\Professional\"\nnpm ERR! gyp ERR! find VS checking VS2019 (16.11.32002.261) found at:\nnpm ERR! gyp ERR! find VS \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional\"\nnpm ERR! gyp ERR! find VS - \"Visual Studio C++ core features\" missing\nnpm ERR! gyp ERR! find VS could not find a version of Visual Studio 2017 or newer to use\nnpm ERR! gyp ERR! find VS looking for Visual Studio 2015\nnpm ERR! gyp ERR! find VS - not found\nnpm ERR! gyp ERR! find VS not looking for VS2013 as it is only supported up to Node.js 8\nnpm ERR! gyp ERR! find VS\nnpm ERR! gyp ERR! find VS **************************************************************\nnpm ERR! gyp ERR! find VS You need to install the latest version of Visual Studio\nnpm ERR! gyp ERR! find VS including the \"Desktop development with C++\" workload.\nnpm ERR! gyp ERR! find VS For more information consult the documentation at:\nnpm ERR! gyp ERR! find VS "
                },
                {
                  "type": "text",
                  "text": "https://github.com/nodejs/node-gyp#on-windows"
                },
                {
                  "type": "text",
                  "text": "\nnpm ERR! gyp ERR! find VS **************************************************************\nnpm ERR! gyp ERR! find VS\nnpm ERR! gyp ERR! configure error\nnpm ERR! gyp ERR! stack Error: Could not find any Visual Studio installation to use\nnpm ERR! gyp ERR! stack     at VisualStudioFinder.fail (C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\find-visualstudio.js:121:47)\nnpm ERR! gyp ERR! stack     at C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\find-visualstudio.js:74:16\nnpm ERR! gyp ERR! stack     at VisualStudioFinder.findVisualStudio2013 (C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\find-visualstudio.js:351:14)\nnpm ERR! gyp ERR! stack     at C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\find-visualstudio.js:70:14\nnpm ERR! gyp ERR! stack     at C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\find-visualstudio.js:372:16\nnpm ERR! gyp ERR! stack     at C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\util.js:54:7\nnpm ERR! gyp ERR! stack     at C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\\node_modules\\node-gyp\\lib\\util.js:33:16\nnpm ERR! gyp ERR! stack     at ChildProcess.exithandler (node:child_process:404:5)\nnpm ERR! gyp ERR! stack     at ChildProcess.emit (node:events:390:28)\nnpm ERR! gyp ERR! stack     at maybeClose (node:internal/child_process:1064:16)\nnpm ERR! gyp ERR! System Windows_NT 10.0.19044\nnpm ERR! gyp ERR! command \"C:\\\\Program Files\\\\nodejs\\\\node.exe\" \"C:\\\\Users\\\\natan.abolafya\\\\AppData\\\\Local\\\\npm-cache\\\\_cacache\\\\tmp\\\\git-cloneDjuIPT\\\\node_modules\\\\node-gyp\\\\bin\\\\node-gyp.js\" \"configure\" \"build\"\nnpm ERR! gyp ERR! cwd C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\nnpm ERR! gyp ERR! node -v v16.13.0\nnpm ERR! gyp ERR! node-gyp -v v6.1.0\nnpm ERR! gyp ERR! not ok\nnpm ERR! npm ERR! code 1\nnpm ERR! npm ERR! path C:\\Users\\natan.abolafya\\AppData\\Local\\npm-cache\\_cacache\\tmp\\git-cloneDjuIPT\nnpm ERR! npm ERR! command failed\nnpm ERR! npm ERR! command C:\\WINDOWS\\system32\\cmd.exe /d /s /c autogypi && node-gyp configure build"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I would not bother with this. But in case you want to, I'm assigning this to you "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "per.allansson",
                    "text": "@per.allansson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " :). Feel free to close it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1647966337100
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Oh that looks nasty...."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1647970114066
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, the combination of needing to update node-gyp to support newer VS releases, together with a bad versioning scheme in node-gyp and/or referring to the soon-to-be-obsolete version of node-gyp in the project dependencies makes the use of native compilation a bit \"interesting\". Oh, and it's not possible to override the node-gyp version dependency of dependency. Lots of great fallout from how npm \"works\"..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Anyhow, using a different native registry module (like a true JS ninja does) works."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1648119751299
      }
    ]
  },
  {
    "key": "SA-18742",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Currently we always have to select the IdentityProvider we want to login in the AdminUI. In order to have a seamless experience in ASC we want to have the ability to pass the IdentityProvider in the URL so the user is automatically redirected to the external IdP instead of having to select it and click \"Sign in with browser\"."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "https://mydomain.com:8443/ui/?idp=AzureAD&login=true"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Assign this to me if you like. I'm used to messing up Frontend login page :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1648050686645
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "well, I meant that for the "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "Frontend",
                    "text": "@Frontend",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " Team :D. I can talk to them I guess."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1648109626762
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "All I can add is that from a UX pov this would be awesome!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.svensson",
        "created": 1648110124876
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm trying to test this feature but the UI never loads:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "![](image.png)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "arturo.garcia",
        "created": 1651088979706
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "do you have anything in the Console?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1651140140979
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "also try "
                },
                {
                  "type": "text",
                  "text": "ui/index.html?idp....",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1651140171188
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "dismiss this... it works!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "arturo.garcia",
        "created": 1651192624985
      }
    ]
  },
  {
    "key": "SA-18894",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Still one thing to fix, it seems like its not passing with multiple controllers, using this scenario "
                },
                {
                  "type": "text",
                  "text": "lhr-controller-ha",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "v4"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot test get -t nightly_backup_restore\naitorbot ['nightly_backup_restore'] | 2022-04-13 22:45:04\n\tid:   b034e267-c686-46a1-a899-1974d6d197cf\n\turl:  "
                },
                {
                  "type": "text",
                  "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/995284"
                },
                {
                  "type": "text",
                  "text": "\n\tpassed: 0/3"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1649919756016
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Reopening"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1650543292613
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And its green, well done!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1651214980001
      }
    ]
  },
  {
    "key": "SA-18914",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "What happened?"
            }
          ],
          "attrs": {
            "level": 2
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I renewed my client token on purple I couldn't reach purple admin UI anymore but it looks like I am still connected"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](Selection"
            },
            {
              "type": "text",
              "text": "1663.png) Submitting the OTP actually reconnects to GCP",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Can you reproduce it at will?"
            }
          ],
          "attrs": {
            "level": 2
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "appgate_logs-2022-04-13.zip",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "appgate_logs-2022-04-13.zip"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "When trying to reproduce I got the expected behavior, connected for 5 min and then losing access to all sites"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1649853025116
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[2022-04-13T11:56:19.982Z] Info : Token revocation for [0e6bd65d-368a-4511-a469-232cb2c35d56] is received by 'aws - purple10'. Will update the token.\n[2022-04-13T11:56:19.982Z] Info : Token revocation for [683c1571-5606-4905-8fc0-e049500817be] is received by 'got - purple2'. Will update the token.\n[2022-04-13T11:56:19.982Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'got - purple2'. Will update the token.\n[2022-04-13T11:56:19.983Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'aws - purple10'. Will update the token.\n[2022-04-13T11:56:19.989Z] Info : Token revocation for [855d1db0-8022-49d5-b1bf-37dbc00d4e23] is received by 'aws - purple40'. Will update the token.\n[2022-04-13T11:56:19.989Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'aws - purple40'. Will update the token.\n[2022-04-13T11:56:19.992Z] Info : Token revocation for [591a3eba-7308-4142-a439-763c01e4ea4b] is received by 'gcp - purple31'. Will update the token.\n[2022-04-13T11:56:19.996Z] Info : Token revocation for [a2c299dc-ad23-4db6-8de6-a266352e2957] is received by 'lhr - purple80'. Will update the token.\n[2022-04-13T11:56:19.996Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'gcp - purple31'. Will update the token.\n[2022-04-13T11:56:19.996Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'lhr - purple80'. Will update the token.\n[2022-04-13T11:56:20.000Z] Info : Token revocation for [e3287b0f-bcdd-4ee7-8178-1a6826b6b4d4] is received by 'azure - purple21'. Will update the token.\n[2022-04-13T11:56:20.001Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'azure - purple21'. Will update the token.\n[2022-04-13T11:56:20.048Z] Info : Retrieving claims token.\n[2022-04-13T11:56:20.050Z] Info : Resolving hostname 'purple.appgate.com'\n[2022-04-13T11:56:20.062Z] Info : Resolved IPs: [35.157.235.196, 35.177.27.1, 35.157.222.129]\n[2022-04-13T11:56:20.062Z] Info : Trying to connect 'purple.appgate.com/35.157.222.129' with SPA key name 'CryptZone'.\n[2022-04-13T11:56:20.198Z] Info : Token revocation for [c33d060e-b1ce-4356-ab33-8fb140640153] is received by 'aws - purple60'. Will update the token.\n[2022-04-13T11:56:20.198Z] Info : Token revocation for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'aws - purple60'. Will update the token.\n[2022-04-13T11:56:20.483Z] Info : Authentication to '"
                },
                {
                  "type": "text",
                  "text": "https://purple.appgate.com/'"
                },
                {
                  "type": "text",
                  "text": " has been redirected to an external SAML provider while renewing claims token. Prompting user to re-authenticate.\n[2022-04-13T11:56:20.742Z] Info : Starting HTTP Server to receive SAML token.\n[2022-04-13T11:56:20.742Z] Info : 'WwwFormRestServer': Started listening on '[::ffff:127.0.0.1]:29001'.\n[2022-04-13T11:56:20.742Z] Info : Opening the URL on default browser.\n[2022-04-13T11:56:21.938Z] Info : A new HTTP connection has been opened to the client.\n[2022-04-13T11:56:21.938Z] Info : Parsed HTTP header. Waiting for payload.\n[2022-04-13T11:56:21.938Z] Info : Received SAML token. Will send it to controller.\n[2022-04-13T11:56:21.955Z] Info : Retrieving claims token.\n[2022-04-13T11:56:21.956Z] Info : Fetching on-boarding cookie for 'onboardingcookie-90:fb:88:e1:44:a8:a6:8f:8d:2b:e6:5c:5f:7b:5f:de:9a:ff:d7:62:82:6f:cd:e1:fc:03:eb:d4:22:a3:6c:7a-AppGate Azure AD SAML Client-hadrien.luttiau-f3d85c83-fd6e-458a-ba76-dbf56f683032' from secure storage.\n[2022-04-13T11:56:21.958Z] Info : On-boarding cookie available for 'onboardingcookie-90:fb:88:e1:44:a8:a6:8f:8d:2b:e6:5c:5f:7b:5f:de:9a:ff:d7:62:82:6f:cd:e1:fc:03:eb:d4:22:a3:6c:7a-AppGate Azure AD SAML Client-hadrien.luttiau-f3d85c83-fd6e-458a-ba76-dbf56f683032'.\n[2022-04-13T11:56:22.024Z] Info : 2FA required while updating claims token at '"
                },
                {
                  "type": "text",
                  "text": "https://purple.appgate.com/'"
                },
                {
                  "type": "text",
                  "text": "."
                },
                {
                  "type": "text",
                  "text": "\n[2022-04-13T11:56:22.043Z] Info : Initializing on-boarding OTP seed.\n[2022-04-13T11:56:22.088Z] Info : OTP seed is already initialized for this user."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "later followed by"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[2022-04-13T11:56:31.974Z] Info : Session removed for [abf04f06-62d5-47aa-bd8b-586ce3e6e43b] is received by 'gcp - purple31'. Will update the token if not logging out.\n[2022-04-13T11:56:32.076Z] Info : 'VPN Driver': Closing connection - waiting for prerequisites (re-authenticate || VPN certificate || Suspend).\n[2022-04-13T11:56:32.090Z] Info : 'GCP Europe West 3': VPN failure with status 'Disconnected'. Error 'Disconnected by gateway'.\n[2022-04-13T11:56:32.105Z] Info : 'GCP Europe West 3': Site connection lost\n[2022-04-13T11:56:32.109Z] Info : 'GCP Europe West 3': App source is offline with 1 client app."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ui logs only have this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[2022-04-13T11:56:20.666Z] Info: Showing action 'renew-saml' immediately.\n[2022-04-13T11:56:22.123Z] Info: Showing action 'mfa-renewal' immediately.\n[2022-04-13T11:56:27.149Z] Info: Navigated to /. Cancelling app shortcut actions (if any).\n[2022-04-13T12:04:02.522Z] Info: Navigated to /. Cancelling app shortcut actions (if any)."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "otherwise client logs are just full of adapter crap:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[2022-04-13T11:56:23.021Z] Info : Checking adapter lo.\n[2022-04-13T11:56:23.022Z] Info : Processing address 127.0.0.1 for adapter lo.\n[2022-04-13T11:56:23.022Z] Info : Processing address ::1 for adapter lo.\n[2022-04-13T11:56:23.022Z] Info : Checking adapter enp0s31f6.\n[2022-04-13T11:56:23.022Z] Info : Checking adapter wlp61s0.\n[2022-04-13T11:56:23.022Z] Info : Processing address 10.101.2.19 for adapter wlp61s0.\n[2022-04-13T11:56:23.022Z] Info : Processing address fe80::a4d9:d625:461e:b53b%3 for adapter wlp61s0.\n[2022-04-13T11:56:23.022Z] Info : Checking adapter enx0050b6a4cca7.\n[2022-04-13T11:56:23.022Z] Info : Processing address 192.168.111.110 for adapter enx0050b6a4cca7.\n[2022-04-13T11:56:23.022Z] Info : Processing address 2a01:2b0:302c:60:192:168:111:110 for adapter enx0050b6a4cca7.\n[2022-04-13T11:56:23.022Z] Info : Processing address fe80::edc:d5a:a083:b24b%4 for adapter enx0050b6a4cca7.\n[2022-04-13T11:56:23.022Z] Info : Checking adapter docker0.\n[2022-04-13T11:56:23.022Z] Info : Adapter docker0 is ignored.\n[2022-04-13T11:56:23.022Z] Info : Checking adapter tun0.\n[2022-04-13T11:56:23.022Z] Info : Adapter tun0 is ignored."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1649917439317
      }
    ]
  },
  {
    "key": "SA-18946",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2022-04-14T08:09:18.537945+0000 cz-webd[8059]: WARNING [domain] No matcher found for mpower.mdcbms.ae\n2022-04-14T08:09:18.537945+0000 cz-webd[8059]: WARNING [router][cookie=0bc83d2dd2][dn=CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local][srcIP=91.75.87.6][url=postCookie] %v does not match allowed domains"
            },
            {
              "type": "text",
              "text": "https://mpower.mdcbms.ae:443/OA_HTML/AppsLogin"
            },
            {
              "type": "text",
              "text": "\n2022-04-14T08:10:16.892481+0000 cz-webd[8059]: WARNING [router][cookie=0bc83d2dd2][dn=CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local][srcIP=91.75.87.6][url=postCookie] URL doesn't have the proper host/port/uri format.\n2022-04-14T08:11:30.949357+0000 cz-webd[8059]: INFO    [session][clientID=9033][cookie=0bc83d2dd2][dn=CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local][loggedIn=true][srcIP=91.75.87.6] Memcache update 0bc83d2dd2 -> {\"blockLocalDnsRequests\":false,\"distinguishedName\":\"CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local\",\"dnsSearchDomains\":[],\"dnsServers\":[\"10.36.50.21\"],\"loggedIn\":true,\"clientId\": 9033}\n2022-04-14T08:11:30.950078+0000 cz-webd[8059]: INFO    [session][clientID=9033][cookie=0bc83d2dd2][dn=CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local][loggedIn=true][srcIP=91.75.87.6] Memcache update 0bc83d2dd2 -> {\"blockLocalDnsRequests\":false,\"distinguishedName\":\"CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local\",\"dnsSearchDomains\":[],\"dnsServers\":[\"10.36.50.21\"],\"loggedIn\":true,\"clientId\": 9033}\n2022-04-14T08:11:34.463681+0000 cz-webd[8059]: WARNING [domain] No matcher found for mpower.mdcbms.ae\n2022-04-14T08:11:34.463681+0000 cz-webd[8059]: WARNING [router][cookie=0bc83d2dd2][dn=CN=4909da3c203d48f69730ddb46736f5b7,CN=test,OU=local][srcIP=91.75.87.6][url=postCookie] %v does not match allowed domains"
            },
            {
              "type": "text",
              "text": "https://mpower.mdcbms.ae:443/OA_HTML/AppsLogin"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-5804",
    "description": {
      "version": 1,
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Else it can't download appliance upgrades from the cryptzone download center."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "See "
            },
            {
              "type": "text",
              "text": "https://askubuntu.com/questions/920156/curl-unable-to-obtain-local-certificate-on-ubuntu",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://askubuntu.com/questions/920156/curl-unable-to-obtain-local-certificate-on-ubuntu"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "  wget -P /tmp/ -nv https://www.digicert.com/CACerts/DigiCertSHA2SecureServerCA.crt\n  openssl x509 -in /tmp/DigiCertSHA2SecureServerCA.crt -inform DER \\\n               -out /tmp/DigiCertSHA2SecureServerCA.pem -outform PEM\n  sudo cp -uv /tmp/DigiCertSHA2SecureServerCA.pem /etc/ssl/certs\n  sudo c_rehash"
            }
          ]
        }
      ]
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And I assume this magic is being done to 3.2.1?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1502457581029
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yes"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1502457681048
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "omg :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1502462459922
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1392",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1392"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1502695964433
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Can you do this retrospectively to an existing appliance?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1502699600905
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "hmmm yeah by running the code in the link at the top. It will disappear after a reboot though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1502701995355
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As a reminder, here is why ubuntu doesn't want the cert in by default "
                },
                {
                  "type": "text",
                  "text": "https://bugs.launchpad.net/ubuntu/+source/ca-certificates/+bug/1700757",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://bugs.launchpad.net/ubuntu/+source/ca-certificates/+bug/1700757"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1502714407770
      }
    ]
  },
  {
    "key": "SA-5774",
    "description": {
      "version": 1,
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Sometimes teamcity build step fails before it can start with this:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[15:03:56][Step 1/1] ['C:\\\\Program Files\\\\Python35\\\\python.exe', '-m', 'testy', '-r', 'console', 'end2end', '--test-root', 'C:\\\\users\\\\admin\\\\artifacts\\\\cz-stratus-tests\\\\cases', '--scenario-root', 'C:\\\\users\\\\admin\\\\artifacts\\\\cz-stratus-tests\\\\scenarios', '--shared-settings', 'C:\\\\users\\\\admin\\\\artifacts\\\\cz-stratus-tests\\\\shared_settings', '--log-level', 'STREAM', '--scenario', 'simple', '-p', 'reporting.end2end.purpose=commit', 'reporting.end2end.test-plan-id=6666', 'reporting.end2end.cases-by-run=284993:16505594/41740281/42699718/10128/10129/10131/867625/10347;284994:867662/867663/27752253/6129266;284995:847076/847077', 'reporting.end2end.testyd-report-url=https://testyd.ad.cryptzone.com/testsd/', 'reporting.end2end.test-execution-uuid=13b8b3e2-8ddf-402b-bfcd-6844164d0722', '--tags', '16505594', '41740281', '42699718', '10128', '10129', '10131', '867625', '10347', '867662', '867663', '27752253', '6129266', '847076', '847077']\n[15:03:56][Step 1/1] Exception found: Madre puta! testy exited with error code: 2"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I've seen it a few times already and not sure what error code 2 is, so.."
            }
          ]
        }
      ]
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/284992",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://testrail.ad.cryptzone.com/index.php?/plans/view/284992"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1501858912505
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[15:03:56][Step 1/1] Running: net start W32Time\n[15:03:56][Step 1/1] The requested service has already been started.\n[15:03:56][Step 1/1]\n[15:03:56][Step 1/1] More help is available by typing NET HELPMSG 2182.\n[15:03:56][Step 1/1] "
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Could this be related?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Do we have any more examples?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1502717068966
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "no, I think that happens every time. probably should be cleaned, but not related."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1502717188505
      },
      {
        "body": {
          "type": "doc",
          "version": 1,
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In that example (and seems that also in this one "
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=202968&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner&tab=buildLog&_focus=399",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=202968&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner&tab=buildLog&_focus=399"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ") "
                },
                {
                  "type": "text",
                  "text": "testy",
                  "marks": [
                    {
                      "type": "strong"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " tries to start a service that it's running and then it fails with error 2 (first problem). After that aitorbot tries to upload logs (maybe we should not try it there) and to finish the test which fails because testy did not report any change."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think that we should fix 2 things:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "1 The reason why testy fails"
                },
                {
                  "type": "hardBreak"
                },
                {
                  "type": "text",
                  "text": "2 To destroy the test instead of finishing it in that case, then the environment/test will be destroyed/archived"
                }
              ]
            }
          ]
        },
        "author": "aitor.iturri",
        "created": 1502717629327
      }
    ]
  },
  {
    "key": "SA-5767",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Associated to the image-url IMAGE\\"
            },
            {
              "type": "text",
              "text": "URL option we need to be able specify optional username:password so for instance we can upgrade from a secured source such as ",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "https://www.cryptzone.com/downloadcenter/appgate",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://www.cryptzone.com/downloadcenter/appgate"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Currently the script just times out with Upgrade Failed and leaves the Controllers in non HA and running the old version."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Tried using ["
            },
            {
              "type": "text",
              "text": "https://user",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://user"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":pass[@download]........]("
            },
            {
              "type": "text",
              "text": "https://user",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://user"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "pass"
            },
            {
              "type": "mention",
              "attrs": {
                "id": "download",
                "text": "@download",
                "accessLevel": ""
              }
            },
            {
              "type": "text",
              "text": "........). and it failed the same way."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will test against "
                },
                {
                  "type": "text",
                  "text": "https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1502451138491
      },
      {
        "body": {
          "version": 1,
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Actually basic auth in the URL works, the issue is the certificate on our download website isn't valid according to the ubuntu CA store."
                },
                {
                  "type": "hardBreak"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "In [3]: requests.get('https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip')\nSSLError: (\"bad handshake: Error([('SSL routines', 'ssl3_get_server_certificate', 'certificate verify failed')],)\",)\n\nIn [4]: requests.get('https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip', verify=False)\nOut[4]: <Response [401]>\n\nIn [8]: requests.get('<https://cz-ag:<password> redacted>@download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip', verify=False)"
                }
              ]
            },
            {
              "type": "heading",
              "attrs": {
                "level": 1
              },
              "content": [
                {
                  "type": "text",
                  "text": "Works"
                }
              ]
            }
          ]
        },
        "author": "thomas.cellerier",
        "created": 1502451839159
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Cert is missing from the Appliance build............."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1502454735267
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And I guess we need to document this."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1502457743234
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " So will the syntax ["
                },
                {
                  "type": "text",
                  "text": "https://user",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://user"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":pass[@download].......]("
                },
                {
                  "type": "text",
                  "text": "https://user",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://user"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "pass"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "download",
                    "text": "@download",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": ".......). now work? If so I should document this."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1502699505477
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes it works."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1502702542911
      }
    ]
  },
  {
    "key": "SA-5681",
    "description": {
      "version": 1,
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I tried both with the built-in key and with a new key, giving the full URL to the client."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Proxyd showed this"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Jul 17 09:44:31 envy-172-17-122-1.devops cz-proxyd: [M 7f6a66e9bc00] spa_yaml_parse(): key with name \"Built-in-be85360895242\" will be used\nJul 17 09:44:31 envy-172-17-122-1.devops cz-proxyd: [M 7f6a66e9bc00] spa_yaml_parse(): key with name \"pinocammino\" will be used"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "(pinocammino is the other key I had created)."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "On the client I get"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "jul 17 12:03:34 salvo-VirtualBox Main[12566]: AppGate Service: Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://envy-172-17-122-1.devops/' has failed. Details: Connection failed."
            }
          ]
        }
      ]
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Known issue. We broke SPA compatibility on 3.2."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "3.1 client should work with 3.2 controller (TCP) though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1500286194640
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Gah, change the test text accordingly then! :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1500286304730
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "What should this test be testing then? "
                },
                {
                  "type": "text",
                  "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/44216746",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/44216746"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1500286340793
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "disable SPA, test the rest of the stuff."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We don't have any process to update the texts as that would take huge time for us. Volunteers like you should ;)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1500286534744
      }
    ]
  },
  {
    "key": "SA-5585",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Connecting to purple, with SPA. SPA passes but then nginx refuses the certificate apparently."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The UI, never shows the window to accept the certificate fingerprint, like it used to do last week."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is a known issue with corrupt gnome keyring, which we managed to fix by removing the login keyring file manually. but not installed shouldn't trigger that as libsecret should be able to figure that out."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499174252782
      },
      {
        "body": {
          "version": 1,
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "lug 04 14:13:20 mongibello AppGate[26483]: Debug - [ApplicationContext - LogFunction:66] SHIM: '0x7f4c1c2b50a0: SSL_connect, ssl_error=5, error:00000005:lib(0):func(0):DH lib verify_result=1'\nlug 04 14:13:20 mongibello AppGate[26483]: Debug - [ApplicationContext - LogFunction:66] SHIM: '0x7f4c1c2b50a0: write(connect) failed'\nlug 04 14:13:20 mongibello AppGate[26483]: Debug - [ApplicationContext - LogFunction:66] SHIM: '0x7f4c1c2a5040: failed to connect: 3'"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "According to the logs, it fails to verify the certificate. No CA certificate should be supplied to SHIM at this point."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Only happens Salvatore's machine atm."
                }
              ]
            }
          ]
        },
        "author": "natan.abolafya",
        "created": 1499176522573
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "you can bet some guy in rackspace doesn't have gnome-keyring, the guy even asked to support KDE's kwallet on that call"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499176779544
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I don't believe this issue is related to gnome-keyring. The problem occurs before gnome-keyring is utilized."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499176914841
      },
      {
        "body": {
          "type": "doc",
          "version": 1,
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Having seen \"ssl_error=5\", thought it may be related to the 5 we receive when certificate doesn't match the hostname. That prints a different log, namely:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "2017-07-04T14:00:08.616Z Debug - [ApplicationContext - LogFunction:66] SHIM: '0538F020: certificate host/ip mismatch (test.envy/172.17.112.1)'\n2017-07-04T14:00:08.618Z Debug - [ApplicationContext - LogFunction:66] SHIM: '0591B440: failed to connect: 5'\n2017-07-04T14:00:08.618Z Debug - [ApplicationContext - LogFunction:66] SHIM: '0538F020: write(connect) failed'"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": []
            }
          ]
        },
        "author": "natan.abolafya",
        "created": 1499176979152
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "uninstalled my gnome-keyring. It works."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Though when I restart the client, it doesn't anymore because spa key is not stored anywhere. But that's a different issue."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499179789939
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[Per Allansson]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"per.allansson\") what do you need from "
                },
                {
                  "type": "text",
                  "text": "Salvatore Tomaselli",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                        "title": "salvatore.tomaselli"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " tcp dump again?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499243035352
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "one that includes all packets :)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "tcpdump -s 0 -w packets.dump -i <ethX> host <gatewayip> and port 443"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499244129290
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I have the same one i took yesterday."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499244346416
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but the one from yesterday didn't contain the return traffic from the gateway"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499244544954
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I had just set to capture \"any\" on wireshark I can take it again"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499244594491
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "wireshark has issues sometimes capturing, especially when on any"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499246938827
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "some text"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499249081531
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thanks. There are a lot of SSL connects there that are closed down immediately after the client sends the first HELLO packet. Are we sure there are no interesting logs in nginx as to why this happens?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499280651085
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Right that's what the ticket says..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499280683667
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The thing is, there is no certificate sent in first Client Hello so it doesn't make sense that server complains about it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499280972385
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I have no access to purple logs :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499327979260
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "let me know when you want to watch live logs and we can gather somewhere."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499329242762
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "try with this client:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "["
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient\\",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient\\"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "Linux/193712",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":id/appgate\\_3.2.0-7037-2067\\_amd64.deb]("
                },
                {
                  "type": "text",
                  "text": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient_Linux/193712",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient_Linux/193712"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "id/appgate"
                },
                {
                  "type": "text",
                  "text": "3.2.0-7037-2067",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "amd64.deb)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "and do touch /tmp/shimdebug2 before starting it - shim will then debug log to /tmp/shimdebug.log which you can copy to this support case"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1499331548997
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "By the way keyring is unrelated. I installed it and still had the same issue."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499345338536
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It works fine connecting to my own env."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499355035540
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hm, sooo some news, it works ONLY if my env allows the predefined SPA key, once I delete it, I am no longer able to login. Both TCP or UDP."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499356524990
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We made some tests with "
                },
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". It seems that deleting the config+pasting the URL in the client seems to mostly work, while clicking on the link seems to always fail."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "After one of these failures, the client will ALWAYS fail to connect to an SPA with a custom key, whatever you do."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499432919561
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another thing we saw is that, after failing with the built-in key, he copies the full url and presses sign in. What we see on proxyd is that SPA succeeds for the first time and then the client proceeds to reconnect (retrieve certificate and verify it), which fails with proxyd saying \"it's Built-in key, and I don't know anything about it\"."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This does not happen when we clear the config, start appgate and enter the full url using copy paste (something fishy with clicking the URL..)."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Which makes me think of this far fetch suspicion: Salvatore rebuilds stuff for Debian, missing some details, which leads to some memory problems in shim/spa implementation where it ends up reusing the old setting somehow."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499443415064
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "That's a build log from my machine."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499673004361
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Kosmas Valianos",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/kosmas.valianos",
                        "title": "kosmas.valianos"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " could you take a look at the last comments and make up theories? :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499673182067
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Post the logs allan requested as well."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "do touch /tmp/shimdebug2 before starting it - shim will then debug log to /tmp/shimdebug.log which you can copy to this support case"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It's the only way to get the shim logs"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "(latest client shall be enable to do this. No need to use the client PR)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499675366017
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It causes the client to crash, there is a conversation on the client channel."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499675979161
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Try this. I tried right now and worked fine for me! While on beta branch:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "git pull\n\nsudo make clean\n\n./make-linux.sh ipt\n\nsudo chown -R kosmas:kosmas /opt/appgate/\n\ncp src/client/Lib/libcryptzone\\_ssl.so /opt/appgate/service/\n\ntouch /tmp/shimdebug2\n\nless +F /tmp/shimdebug.log"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Start AppGate client after that. I am able to see shim logs live like that (Ubuntu 16.04)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499676882597
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "(This is very useful if you want to edit something in the cryptzone\\"
                },
                {
                  "type": "text",
                  "text": "ssl.c in the stupid debug\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "init() to make your OS log (in case it still crashes for X reason for your OS)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499677193997
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "sudo chown -R kosmas:kosmas /opt/appgate/\n\ncp src/client/Lib/libcryptzone\\_ssl.so /opt/appgate/service/"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "or better yet, "
                },
                {
                  "type": "text",
                  "text": "sudo cp",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " :P"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499678695551
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hm how to put this it's kinda working today. But only if I paste the link instead of clicking on it."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "If I click on it then it fails and after failure, pasting will never work."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " could this be related to the fact that I change /etc/machine-id every day? (personal workaround to avoid the annoying onboarding failure)."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499679830633
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "or better yet, sudo cp :P"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "old remains when the log path was in that path which is root owned instead of the /tmp ;)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499680231223
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "could this be related to the fact that I change /etc/machine-id every day? (personal workaround to avoid the annoying onboarding failure)."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "no, but"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image.png]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499680423306
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "That's the \"magic\" log"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "1499679628: spa\\_encrypt(): Setting the psk's name: \"CryptZone\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Some of them say build-in!!! Correlate which key is used when, depending to what you do. Clicking the link or copy paste or whatevah you do."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499680426045
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Names should be self explicative."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499689797511
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The just paste has at the end 2 times:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "1499689581: spa\\"
                },
                {
                  "type": "text",
                  "text": "encrypt(): Setting the psk's name: \"CryptZone\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the click on link NEVER has that. Only build in so click on link does not work then ?!"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The click on link plus paste bla the same"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499690378805
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So it looks the proper params are not passed to the internals from the what the user is actually entering."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499690670679
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe some quoting is needed in the .desktop file? I can try :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499690826483
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "there might be two issues here:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  clicking the link only takes the hostname part not the whole thing (probably)"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  spa config getting lost at some point (this is what we should focus first I think)"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499691003284
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "clicking the link only takes the hostname part not the whole thing (probably)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Nope. The process gets launched with the correct command line."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "/opt/appgate/AppGate --url=appgate://purple.cryptzone.com/eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoiQ3J5cHRab25lIiwia2V5IjoiY2QzMzdiMmE1OTU1Yjg3OTk3YzlkYzRjNGRhZTM1ZDRmNTA1ZTE0ZmZhZWU3NWFlZjVhZDZhZjQ1M2M5ODgyOCJ9fQ=="
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499691335118
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok. weird as there is nothing platform specific how we handle the url received. unless you have some buggy mono or something which would be a really buggy one."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499691494679
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2093",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2093"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "here is a PR with better logs with detailed SPA info, so we can isolate the issue better. "
                },
                {
                  "type": "text",
                  "text": "Salvatore Tomaselli",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                        "title": "salvatore.tomaselli"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " please test with this and paste the logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499781358782
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is what happened."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499784867129
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The logs posted are shim. I think natan wants the business logic logs as this is what the PR changed"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "btw the click link thing is definitely broken. This file has not a single custom key. All of them report \"Built-in-be85360895242\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499787119637
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "asd"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499787495567
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well here for sure a crystal clear problem. Client C# part reverts back to the build-in... (after the warning issues?!)."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'.\nlug 11 16:50:46 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\nlug 11 16:50:57 mongibello AppGate[18774]: Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\nlug 11 16:50:57 mongibello AppGate[18774]: Info - [LoginHandler - Start] User input required for 'ControllerUrlLoginHandler'.\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Received a new URL config from user. Parsing..\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [UrlFormatter - ParseUrlConfig] URL config parsed. SPA mode: UdpTcp, Name: CryptZone\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://purple.cryptzone.com/'.\nlug 11 16:51:13 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [UrlLookup - Lookup] Resolving hostname 'purple.cryptzone.com'\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'CryptZone'.\nlug 11 16:51:15 mongibello AppGate[18774]: Info - [ControllerFetcherFactory - CreateControllerFetcher] Using Controller API V4\nlug 11 16:51:15 mongibello AppGate[18774]: Info - [UrlLookup - Lookup] Resolving hostname 'purple.cryptzone.com'\nlug 11 16:51:15 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'CryptZone'.\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [ControllerFetcherFactory - CreateControllerFetcher] Using Controller API V4\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Storing new SPA config.\nlug 11 16:51:16 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:16 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://purple.cryptzone.com/'.\nlug 11 16:51:16 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [UrlLookup - Lookup] Resolving hostname 'purple.cryptzone.com'\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\nlug 11 16:51:26 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "A second issue is that the click link looks definitely broken in the tomaselian logs. The latest click\\"
                },
                {
                  "type": "text",
                  "text": "link.bz2 file has not a single \"custom key\". All of them report \"Built-in-be85360895242\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1499845584621
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yeah, if you continue, there are ones with 'Cryptzone' and they seemed to work. As I can't correlate the timestamps when you clicked, when you pasted to the logs; can't say much about that."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499847827201
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I made different files for when I just pasted, just clicked or both. When I did both, I tried once clicking, waited, then pasted. Shouldn't it be deterministic?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499850741182
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "those are only the shim logs. I need the service logs. Lemme know when I can watch you do it and check the logs at the same time."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499852415785
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "mind blowing.. After "
                },
                {
                  "type": "text",
                  "text": "\"Storing new SPA config.\"",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", it should just go to certificate trust stuff. But instead it goes back to setting url for some reason? what the hell."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499861865682
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "maybe your window system (and electron) is trolling us and somehow clicks \"Sign in\" twice which triggers this issue somehow.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "could you enable debug logs and trigger the issue please?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "~/.config/appgatexdp-service/user.settingsInfo -> Debug",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499862994535
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "asd"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1499873156617
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "wtf, I can see the full url reaches the mono service when you click actually. But disappears at some point? This is so weird."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As for the other scenario, I can see this:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Debug - [LoginHandler - Finish:179] Finish handler with new state 'TrustCertificate'"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but then it moves on to SetControllerUrl again for some reason. And I think it thinks it's in auto-login session:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Debug - [LoginHandler - AutoLogin:96] Task could not complete on autologin"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And this makes no sense whatsoever. Sounds like a super far-fetch bug triggered by only you. I'm off till Monday. Maybe "
                },
                {
                  "type": "text",
                  "text": "Petter Gustafsson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/petter.gustafsson",
                        "title": "petter.gustafsson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " can make some sense. Bug him if he has time, otherwise we can continue on Monday :)."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "P.S."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Another thing that's different on your env is locale btw. May be relevant."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1499876738331
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will take a look :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "petter.gustafsson",
        "created": 1499932408002
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2103",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2103"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this may have fixed the problem. Salvatore, could you try again?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1500466613954
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "No difference."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1500471097774
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Issue is still there btw"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1507037041351
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Kosmas has the same issue on Ubuntu, so it's really not a magic thing that only happens for me. He uses ubuntu."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1511778282944
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeah, last time I tried by clicking on appgate://hostname/base64\\"
                },
                {
                  "type": "text",
                  "text": "data the AppGate client indeed started but the base64 data were not used. I thought there is a task specifically for this problem but I cannot find it atm. Maybe I just whined in slack but didn't make a task",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1511778389011
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Kosmas, can you retry and post the logs?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1511778463216
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Actually it was in my laptop so will try again there and post the logs"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1511791280406
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok, my problem is in Windows 10 actually when I click the link from the mail app. URL with base64 mess. Created a task for it [SA-6721](SA-6721). but "
                },
                {
                  "type": "text",
                  "text": "Salvatore Tomaselli",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                        "title": "salvatore.tomaselli"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " check if it is actually similar/same issue"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[2017-11-27T21:27:26.284Z] Info : UI has connected to service.\n[2017-11-27T21:27:26.448Z] Info : UI is ready.\n[2017-11-27T21:27:26.449Z] Info : UI connected.\n[2017-11-27T21:27:26.457Z] Info : Connecting to TUN driver.\n[2017-11-27T21:27:26.461Z] Info : Setting log level of TUN driver to Info.\n[2017-11-27T21:27:26.477Z] Info : Setting locale to en-US.\n[2017-11-27T21:27:26.531Z] Info : Received a URL config from storage. Parsing..\n[2017-11-27T21:27:26.533Z] Warn : Invalid URL config received. Invalid length for a Base-64 char array or string.. config: eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoiQ3J5cHRab25lIiwia2V5IjoiY2QzMzdiMmE1OTU1Yjg3OTk3YzlkYzRjNGRhZTM1ZDRmNTA1ZTE0ZmZhZWU3NWFlZjVhZDZhZjQ1M2M5ODgyOCJ9fQ\n[2017-11-27T21:27:26.534Z] Info : Setting controller URL to 'https://purple.cryptzone.com/'.\n[2017-11-27T21:27:26.544Z] Info : CA certificate found in the storage for 'purple.cryptzone.com'.\n[2017-11-27T21:27:26.548Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-11-27T21:27:26.634Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.209Z] Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.519Z] Error : First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\n[2017-11-27T21:27:27.523Z] Info : User input required for 'ControllerUrlLoginHandler'."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1511820014524
      }
    ]
  },
  {
    "key": "SA-5521",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Typical IPv6 environment creation with aitorbot"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Entering URL: "
            },
            {
              "type": "text",
              "text": "envy-fd00-ffff-a-300-172-17-300-1.devops",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " and clicking NEXT => Connection failed"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Logs from business logic",
              "marks": [
                {
                  "type": "strong"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2017-06-28T11:27:58.931Z Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/'.\n2017-06-28T11:27:58.931Z Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\n2017-06-28T11:27:58.932Z Info - [OpenSslSocket - Connect] Trying to connect using IP address 'fd00:ffff:a:300::1'.\n2017-06-28T11:27:58.932Z Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/' has failed. Details: Connection failed."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "tun-service is not used as it is early in the flow. No logs there"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "sudo tcpdump -n ip6",
              "marks": [
                {
                  "type": "strong"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "tcpdump does not show any DNS requests/SSL packets so it feels no packets are being send ?!"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "IPv6 settings on the Mac same as another machine [Windows 10 VM] which has been verified it can connect to the environment"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Gateway: fd00:ffff:a:60::254\n\nIPv6: fd00:ffff:a:60:192:168:111:153\n\nPrefix Length: 64\n\nDNS 1: fd00:ffff:a:40:172:17:40:9\n\nDNS 2: fd00:ffff:a:40:172:17:40:8"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " nslookup can resolve the "
            },
            {
              "type": "text",
              "text": "envy-fd00-ffff-a-300-172-17-300-1.devops",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " in a proper IPv6 address and pinging a fellow IPv6 workstation and the office DNS servers/office Gateway worked fine so IPv6 settings are fine"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                        "title": "per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " could you try locally with your mac some time?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1498650715084
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "2017-06-29T11:29:08.756Z Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/'.\n2017-06-29T11:29:08.764Z Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\n2017-06-29T11:29:08.770Z Info - [OpenSslSocket - Connect] Trying to connect using IP address 'fd00:ffff:a:300::1'.\n2017-06-29T11:29:08.771Z Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/' has failed. Details: Connection failed."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Accessing webui though at ["
                },
                {
                  "type": "text",
                  "text": "https://envy-fd00-ffff-a-300-172-17-300-1.devops",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-fd00-ffff-a-300-172-17-300-1.devops"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":444]("
                },
                {
                  "type": "text",
                  "text": "https://envy-fd00-ffff-a-300-172-17-300-1.devops",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-fd00-ffff-a-300-172-17-300-1.devops"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "444) through a browser works, so it is definitely a problem what we saw for IPv6"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1498736617428
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "shim logs:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "1498741507: Connecting to envy-fd00-ffff-a-300-172-17-300-1.devops/fd00:ffff:a:300::1 ...\n\n1498741507: connect() failed for UDP socket: 65/No route to host"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " so IPv6 + OS X + connect() in UDP socket = issue"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1498738163878
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2024",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2024"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1498747543439
      }
    ]
  },
  {
    "key": "SA-5383",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For now there is only limited help:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "cz@envy-172-17-116-1:~$ which cz-upgrade\n/usr/sbin/cz-upgrade\ncz@envy-172-17-116-1:~$ cz-upgrade --help\nusage: cz-upgrade [-h] [--port PORT] [--device-id DEVICE_ID]\n                  [--username USERNAME] [--provider PROVIDER] [--no-verify]\n                  [--cacert CACERT] [--peer-api-version PEER_API_VERSION]\n                  --image-url IMAGE_URL [-y]\n                  hostname\n\npositional arguments:\n  hostname              AppGate Controller hostname or ip\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --port PORT           AppGate Controller admin port\n  --device-id DEVICE_ID\n  --username USERNAME\n  --provider PROVIDER\n  --no-verify           Do NOT verify the server certificate\n  --cacert CACERT       Path to CA cert file\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, will be auto-discovered\n                        if not set\n  --image-url IMAGE_URL\n                        Upgrade image url\n  -y, --yes             Batch mode, don't ask for confirmation"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This should include some instructions and examples."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The file is in the appliance repo under "
            },
            {
              "type": "text",
              "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/tree/master/stratus/upgrader",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/tree/master/stratus/upgrader"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Simple upgrade:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ ./cz-upgrade envy-172-17-134-1.devops --no-verify --image-url https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-3.1.1-5282-master.img.zip\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-134-1.devops:444\nPeer API version is 5\nAuthorizing\n\nUpgrade plan:\n\nUpgrade controller(s): controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\n\nUpgrade gateway(s): gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\n\nUpgrading controllers...\nStarting appliance upgrade for controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\nWaiting for appliances to come back online: controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 ...\nAppliance controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is online and in state single_controller_ready\n\nUpgrading gateways...\nStarting appliance upgrade for gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\nWaiting for appliances to come back online: gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 ...\nAppliance gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is online and in state upgrading\nAppliance gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is now offline\nAppliance gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is now online and in state appliance_ready\n\nUpgrade done!\nAll appliances are now running version 3.1.1-5282-master"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Multi-controller upgrade:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Discovering peer API version for https://envy-172-17-130-2.devops:444...\nPeer API version is 5\nAuthenticating to https://envy-172-17-130-2.devops:444...\nAuthorizing...\n\nUpgrade plan:\n1. Disable controller role on the following appliance(s): controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\n2. Upgrade first controller: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1\n3. Upgrade additional controllers: controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\n4. Enable controller role on the following appliance(s): controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\n5. Upgrade gateway(s): gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1\n\nWaiting for appliance(s) to come back online in state multi_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1, controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state multi_controller_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state multi_controller_ready\n\nDisabling controller on controller-7e60c460-22c0-4281-8c25-9314747ba800-site1...\nWaiting for appliance(s) to come back online in state single_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is offline and in state unknown\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now online and in state single_controller_ready\nWaiting for appliance(s) to come back online in state appliance_ready: controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state appliance_ready\n\nUpgrading controllers...\nStarting appliance upgrade for controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1\nWaiting for appliance(s) to come back online in state single_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state single_controller_ready\nStarting appliance upgrade for controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\nWaiting for appliance(s) to come back online in state appliance_ready: controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state upgrading\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now offline\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now online and in state data_migration\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state appliance_ready\n\nEnabling controller on controller-7e60c460-22c0-4281-8c25-9314747ba800-site1...\nWaiting for appliance(s) to come back online in state multi_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1, controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state single_controller_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state appliance_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state waiting_bdr_joining\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state multi_controller_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state multi_controller_ready\n\nUpgrading gateways...\nStarting appliance upgrade for gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1\nWaiting for appliance(s) to come back online in state appliance_ready: gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state upgrading\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now offline\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now online and in state data_migration\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state appliance_ready\n\nUpgrade done!\nAll appliances are now running version 3.2.0-5439-master"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Example of setting password via env variable and user cancelling an upgrade:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ CZ_UPGRADE_PASSWORD=admin ./cz-upgrade --image-url http://blah:8080/thang envy-fd00-ffff-a-300-172-17-300-1.devops --no-verify\nDiscovering peer API version for https://envy-fd00-ffff-a-300-172-17-300-1.devops:444...\nPeer API version is 5\nAuthenticating to https://envy-fd00-ffff-a-300-172-17-300-1.devops:444...\nAuthorizing...\n\nUpgrade plan:\n\n1. Upgrade controller(s): envy-fd00-ffff-a-300-172-17-300-1_devops\n2. Upgrade gateway(s): gateway-151dbc56-feb7-421b-8004-ddff0be464d9-site1\n\nDo you want to continue [Y/n]? n\nUpgrade cancelled by user!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1496313809529
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Example of a failed upgrade from upgrading purple:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ ./cz-upgrade purple10.cryptzone.com --cacert ca-cert-purple.pem --image-url https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-3.2.0-5447-master.img.zip\nDiscovering peer API version for https://purple10.cryptzone.com:444...\nPeer API version is 5\nEnter password for username admin and provider name local:\nAuthenticating to https://purple10.cryptzone.com:444...\nAuthorizing...\n\nUpgrade plan:\n\n1. Disable controller role on the following appliance(s): aws - purple11\n2. Upgrade first controller: aws - purple10\n3. Upgrade additional controllers: aws - purple11\n4. Enable controller role on the following appliance(s): aws - purple11\n5. Upgrade gateway(s): got - purple1\n6. Upgrade gateway(s): gce - purple30, azure - purple20, got - purple3, got - purplex, got - purple2\n\nDo you want to continue [y/N]? y\nWaiting for appliance(s) to come back online in state multi_controller_ready: aws - purple11, aws - purple10 ...\nAppliance aws - purple11 is online and in state multi_controller_ready\nAppliance aws - purple10 is online and in state multi_controller_ready\n\nDisabling controller on aws - purple11...\nWaiting for appliance(s) to come back online in state single_controller_ready: aws - purple10 ...\nAppliance aws - purple10 is offline and in state unknown\nAppliance aws - purple10 is now online and in state single_controller_ready\nWaiting for appliance(s) to come back online in state appliance_ready: aws - purple11 ...\nAppliance aws - purple11 is online and in state appliance_ready\n\nUpgrading controllers...\nStarting appliance upgrade for aws - purple10\nWaiting for appliance(s) to come back online in state single_controller_ready: aws - purple10 ...\nAppliance aws - purple10 is online and in state data_migration\nAppliance aws - purple10 is now in state cloud_initializing\nAppliance aws - purple10 is now in state single_controller_ready\nStarting appliance upgrade for aws - purple11\nWaiting for appliance(s) to come back online in state appliance_ready: aws - purple11 ...\nAppliance aws - purple11 is online and in state upgrading\nAppliance aws - purple11 is now offline\nUpgrade failed: Appliances [Appliance(name=\"aws - purple11\", peer_hostname=\"purple11.cryptzone.com\", role={'controller', 'gateway'}, site=06590afe-3eae-4437-aff6-523c06045103)] never came online in state appliance_ready!\n$ echo $?  # Script exit code is 0 on success, 1 on failure \n\n1"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1496396570157
      }
    ]
  },
  {
    "key": "SA-5348",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "May 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: [upgrade] Downloaded http://testyd.devops:6640/testyd/api/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appga\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: [upgrade] Deleting upgrade file: /mnt/data/download/appgate-3.2.0-5394-master.img.zip?is-build-type-id\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: [config-control] Failed to upgrade the appliance: Not an upgrade image file: /mnt/data/download/appgate-3.2.0-5394-master.img.zip?\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: Traceback (most recent call last):\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:   File \"/usr/cz-configd/configd/upgrade.py\", line 193, in upgrade_task\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:     upgrade(*args, next_state=next_state, **kwargs)\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:   File \"/usr/cz-configd/configd/upgrade.py\", line 144, in upgrade\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:     raise UpgradeError('Not an upgrade image file: {}'.format(image_path))\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: configd.upgrade.UpgradeError: Not an upgrade image file: /mnt/data/download/appgate-3.2.0-5394-master.img.zip?is-build-type-id"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1259",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1259"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495802732770
      }
    ]
  },
  {
    "key": "SA-5328",
    "comments": [
      {
        "body": {
          "version": 1,
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I had similar issues when initially testing xenial on virtualbox and added this hack:"
                },
                {
                  "type": "hardBreak"
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/blob/master/initramfs/local-top/lvm2#L66-L68",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/blob/master/initramfs/local-top/lvm2#L66-L68"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Doesn't work without this for some reason\nSee https://bugs.launchpad.net/ubuntu/+source/lvm2/+bug/1573982\nvgchange -ay"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It never happened afterwards so forgot about it."
                },
                {
                  "type": "hardBreak"
                },
                {
                  "type": "text",
                  "text": "The current issue seems related."
                }
              ]
            }
          ]
        },
        "author": "thomas.cellerier",
        "created": 1495528147726
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I had taken the \"fix\" from that comment on the linked issue:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "My workaround is as I explained in the issue description: I added a script in /etc/initramfs-tools/scripts/local-top/ folder which performs "
                },
                {
                  "type": "text",
                  "text": "vgchange -ay",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495528193817
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Adding this to the boot command line fixes it for some weird reason:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "scsi\\"
                },
                {
                  "type": "text",
                  "text": "mod.scan=sync",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Found here "
                },
                {
                  "type": "text",
                  "text": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=616689",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=616689"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495533153205
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "With that fix our patched initramfs/local-top/lvm2 can be removed to use the default one."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495533662844
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "With that fix our patched initramfs/local-top/lvm2 can be removed to use the default one."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Taking that back, doesn't work now."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495533845737
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Added this in local-top/lvm2 before vgchange:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "lvm vgscan --mknodes"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And set this in etc/lvm/lvm.conf:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "use\\"
                },
                {
                  "type": "text",
                  "text": "lvmetad = 0",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495534819219
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1253",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1253"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495543931310
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The debian bug mentions that bug being fixed in initramfs-tools 0.119, however we are running 0.122:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\# dpkg --list|grep initramfs-tools ii initramfs-tools 0.122ubuntu8.8 all generic modular initramfs generator (automation) ii initramfs-tools-bin 0.122ubuntu8.8 amd64 binaries used by initramfs-tools ii initramfs-tools-core 0.122ubuntu8.8 all generic modular initramfs generator (core tools)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495552032116
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "maybe the actually problem is this with logic in the local-top/lvm script:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "    /dev/mapper/*)\n            eval $(dmsetup splitname --nameprefixes --noheadings --rows \"${dev#/dev/mapper/}\")\n            if [ \"$DM_VG_NAME\" ] && [ \"$DM_LV_NAME\" ]; then\n                    lvchange_activate \"$DM_VG_NAME/$DM_LV_NAME\"\n            fi\n            ;;\n    /dev/*/*)\n            # Could be /dev/VG/LV; use lvs to check\n            if lvm lvs -- \"$dev\" >/dev/null 2>&1; then\n                    lvchange_activate \"$dev\"\n            fi\n            ;;"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "for some reason its not matching our devices"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495552471818
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "root"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "envy",
                    "text": "@envy",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-172-17-136-2:~# dmsetup splitname --nameprefixes --noheadings --rows \"${dev#/dev/mapper/}\" DM\\"
                },
                {
                  "type": "text",
                  "text": "VG\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NAME='' DM\\"
                },
                {
                  "type": "text",
                  "text": "LV\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "NAME='' DM\\"
                },
                {
                  "type": "text",
                  "text": "LV\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "LAYER=''"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495552489862
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "root"
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "envy",
                    "text": "@envy",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "-172-17-136-2:~# lvm lvs  \"/dev/mapper/czvg\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "LV VG Attr LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "data czvg -wi-ao- 23.75g"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "image1 czvg -wi-ao- 2.00g"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "state1 czvg -wi-ao- 1.00g"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1495552668715
      }
    ]
  },
  {
    "key": "SA-5222",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This means a client can impersonate an appliance and push audit logs."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "location /ffwd {\n    if ($ssl_client_verify = NONE) {\n        return 401;\n    }\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_pass <http://127.0.0.1:9011;>\n}"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We need to go through all the appliance-appliance comms to make sure we always check DNs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494323331223
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Same for ffwd:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "location /ffwd {\n    if ($ssl_client_verify = NONE) {\n        return 401;\n    }\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_pass <http://127.0.0.1:%(ffwd_server)d;>\n}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Which means anybody can push AUDIT logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494323628248
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "False alarm for sessiond:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "location /sessions { if ($ssl\\"
                },
                {
                  "type": "text",
                  "text": "client\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "verify = NONE) { return 401; } if ($ssl\\"
                },
                {
                  "type": "text",
                  "text": "client\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "s\\"
                },
                {
                  "type": "text",
                  "text": "dn != \"/CN=AppGate XDP CA\") { return 401; } proxy\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:%(sessiond\\",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1:%(sessiond\\"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "port)d/sessions; }",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494325293307
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In [14]: requests.post('["
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-106-2.devops",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-172-17-106-2.devops"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":444/sessions/revocations']("
                },
                {
                  "type": "text",
                  "text": "https://envy-172-17-106-2.devops",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://envy-172-17-106-2.devops"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ":"
                },
                {
                  "type": "text",
                  "text": "444/sessions/revocations'), cert=('cert.pem', 'key.pem'), verify='cacert.pem', data='LOL', headers={'Accept': 'application/vnd.cryptzone.peer-v4+json'}).text"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Out[14]: '<html>\\\\r\\\\n<head><title>401 Authorization Required</title></head>\\\\r\\\\n<body bgcolor=\"white\">\\\\r\\\\n<center><h1>401 Authorization Required</h1></center>\\\\r\\\\n<hr><center>nginx</center>\\\\r\\\\n</body>\\\\r\\\\n</html>\\\\r\\\\n'"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494325427210
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well that sucks..."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "import websocket\nimport uuid\n\nserver = 'envy-172-17-106-1.devops'\nport = 514\nc = websocket.create_connection('wss://{}:444/ffwd/TCP/{}'.format(server, port), sslopt={'keyfile': 'key.pem', 'certfile': 'cert.pem', 'ca_certs': 'cacert.pem'}, header={'Accept': 'application/vnd.cryptzone.peer-v1+json'})\nc.send_binary('<%d>%s' % (0 + 3*8, 'testing testing!!! HACK ALERT!!! %s\\n' % str(uuid.uuid4())))\nc.close()"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494332772442
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "May 9 12{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "26}}47 testing testing!!! HACK ALERT!!! 8f61f147-b2ca-46ba-8f40-fbdd9d74c239"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494332818963
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1201",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1201"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1494337242470
      }
    ]
  },
  {
    "key": "SA-4948",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Then you can press it many times and this log happens:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "2017-03-30T07:25:02.419Z Info - [IdentitityProviderLoginHandler - HandleInput] provider 'Cryptzone Inc. SAML' selected.\n2017-03-30T07:25:02.528Z Info - [LoginHandler - Start] Starting handler 'ConnectSamlLoginHandler'\n2017-03-30T07:25:03.632Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:03.636Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:03.636Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:03.750Z Info - [ConnectLoginHandler - TryLogin] Redirection to an external identity provider is received. URL: https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml\n2017-03-30T07:25:03.754Z Info - [SamlHandler - ListenToken] Starting HTTP Server to receive SAML token.\n2017-03-30T07:25:03.754Z Info - [SamlHandler - ListenToken] Starting the browser to https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml.\n2017-03-30T07:25:05.070Z Info - [SamlHandler - ListenToken] Received SAML token. Will send it to controller.\n2017-03-30T07:25:05.070Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:05.074Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:05.074Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:05.294Z Info - [ControllerLogic - HandlePostAuthentication] Authentication succeeded. Claims Token: [TokenId: acf8e40b-1405-4b3e-a8ac-2f63d0412a02, DistinguishedName: CN=3ea4534c93444931a91289f6606e6422,CN=natan.abolafya,OU=OKTA, FirstName: Natan, LastName: Abolafya, ExpirationTime: 2017-03-30 22:25:04], On-demand Claims: [[]], Custom Scripts: [[]]\n2017-03-30T07:25:05.450Z Info - [UntrustedClaimsHandler - RetriveNewUntrustedClaimsToken] Processing on-demand Claims: []\n2017-03-30T07:25:05.454Z Info - [ConnectLoginHandler - RetrieveEntitlementToken] Getting entitlement tokens for the first time.\n2017-03-30T07:25:05.454Z Info - [ControllerLogic - UpdateEntitlementToken] Retrieving new entitlement tokens.\n2017-03-30T07:25:06.458Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:06.458Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:06.458Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:06.534Z Info - [ControllerLogic - UpdateEntitlementToken] New 4 entitlement tokens retrieved.\n2017-03-30T07:25:06.542Z Info - [ConnectLoginHandler - UpdateVpnToken] Updating vpn certificate\n2017-03-30T07:25:06.542Z Info - [ControllerLogic - RetrieveVpnCertificate] No VPN certificate found in secure storage for CN=3ea4534c93444931a91289f6606e6422,CN=natan.abolafya,OU=OKTA. Generating a key-pair for a new one.\n2017-03-30T07:25:06.590Z Info - [ConnectLoginHandler - TryLogin] Redirection to an external identity provider is received. URL: https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml\n2017-03-30T07:25:06.590Z Info - [SamlHandler - ListenToken] Starting HTTP Server to receive SAML token.\n2017-03-30T07:25:06.594Z Info - [SamlHandler - ListenToken] Starting the browser to https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml.\n2017-03-30T07:25:07.277Z Info - [SamlHandler - ListenToken] Received SAML token. Will send it to controller.\n2017-03-30T07:25:07.281Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:07.281Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:07.281Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:07.489Z Info - [ControllerLogic - HandlePostAuthentication] Authentication succeeded. Claims Token: [TokenId: 8bfa011d-ca6a-4fcf-a4db-c7b6970bcd7f, DistinguishedName: "
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-4781",
    "description": {
      "version": 1,
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We get "
            },
            {
              "type": "text",
              "text": "err_spdy_protocol_error",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " on some pages at random times: "
            },
            {
              "type": "text",
              "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=157664&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyWindowsRunner&tab=buildLog&state=33#_state=33&focus=5266",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=157664&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyWindowsRunner&tab=buildLog&state=33#_state=33&focus=5266"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "[Step 1/1]     2017-03-09T06:42:48,835774Z [STREAM] [admin_ui\\basic_test] [Admin UI Browser] [2017-03-09 07:41:47.498000] https://envy-172-17-100-1.devops:444/ui/bower_components/angular/angular.js - Failed to load resource: net::ERR_SPDY_PROTOCOL_ERROR",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "According to article: "
            },
            {
              "type": "text",
              "text": "https://ma.ttias.be/nginx-spdy-error-neterr_spdy_protocol_error/",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://ma.ttias.be/nginx-spdy-error-neterr_spdy_protocol_error/"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": " this can be due to "
                    },
                    {
                      "type": "text",
                      "text": "/usr/local/nginx/fastcgi_temp/",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " not having proper permissions which can be fixed by: "
                    },
                    {
                      "type": "text",
                      "text": "chown nginx:nginx /usr/local/nginx/fastcgi_temp/ -R",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": " can also be a space issue on appliance so temp dir is not writeable (no solution for this)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": " we can disable spdy in chrome in e2e tests via starting chrome with options: "
                    },
                    {
                      "type": "text",
                      "text": "--use-spdy=npn-http",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": []
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Spotted by "
            },
            {
              "type": "text",
              "text": "Hadrien Luttiau",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://got-youtrack.agi.appgate.com:8112/users/hadrien.luttiau"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " & "
            },
            {
              "type": "text",
              "text": "Natan Abolafya",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya"
                  }
                }
              ]
            }
          ]
        }
      ]
    }
  },
  {
    "key": "SA-5988",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "good old "
            },
            {
              "type": "text",
              "text": "--extra-purposes",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "but I guess something like"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "aitorbot test create --purpose commit --purpose nightly",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "should be enough."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Use case: Nightly does not include commit tests because in most cases, commit tests are covered during the day; so no need to run them again."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "However, when I'm running Fedora nightly or IPv6 tests once a day, I want both nightly tests and commit tests at once, because there is no IPv6 hourly test."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I cannot seem to get this working.."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "G:\\Code\\stratus-client-shared\\src\\ui>aitorbot test create --purpose runme --purpose commit\nCreating a multipurpose test, we will query aitorbot for the test case ids now\nCojones! POST /executions HTTP 400: Errors on client input: Some of the tests cases provided could not be resolved.\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test create --purpose nightly --purpose commit\nCreating a multipurpose test, we will query aitorbot for the test case ids now\nJoder! POST /executions HTTP 400: Errors on client input: Some of the tests cases provided could not be resolved.\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test purposes\nusage: main.py test purposes [-h] [--project-id PROJECT_ID]\n                                 {list,cases} ...\nmain.py test purposes: error: the following arguments are required: purposescmd\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test purposes list\namazon amazondebug ax-e ax-s azure backuprestore commit controllerha dont care esxi gce ha headless highavail lrt nightly nightly-candidate nousage physical physical-candidate runme template test-debug ui upgrade\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test create --purpose nightly --purpose commit --client windows\nCreating a multipurpose test, we will query aitorbot for the test case ids now\nMadre puta! POST /executions HTTP 400: Errors on client input: Some of the tests cases provided could not be resolved.\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot version\n4.1.46"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Aitor Iturri",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/aitor.iturri",
                        "title": "aitor.iturri"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1507307667103
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/testyd/pull/422",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/testyd/pull/422"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " ./scripts/aitorbot test create --purpose commit --purpose runme\nCreating a multipurpose test, we will query aitorbot for the test case ids now\neof:\n        id:   c7966b8e-61db-40e3-905e-9ba90ead1234\n        url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/320642"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "aitor.iturri",
        "created": 1507635441653
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "works great"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1507798320898
      }
    ]
  },
  {
    "key": "SA-5917",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Example usage from tyron:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": " cz-upgrade --username tyronturner --provider local --cacert c:\\tmp\\AppGate_CA.der --image-url https://cz-ag:passwd@download.cryptzone.com/files/download/AppGate-3.2.1/bin/AppGate-3.2.1.img.zip hqxdpc01.cryptzone.com hqxdpc01.cryptzone.com"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "There seems to be a python stdlib function for that "
            },
            {
              "type": "text",
              "text": "https://docs.python.org/3/library/ssl.html#ssl.DER\\_cert\\_to\\_PEM\\_cert",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://docs.python.org/3/library/ssl.html#ssl.DER_cert_to_PEM_cert"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "So we could support it without adding any additional requirements."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1429/files",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1429/files"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1503995583803
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "For docs: the cacert argument now accepts either a DER format certificate or a PEM format ceritificate."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1504860033711
      }
    ]
  },
  {
    "key": "SA-5909",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The user may think OTP was actually accepted. Really weird."
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Setup controller and initiate OTP remedy on the client."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  ssh to controller, kill identityd "
                    },
                    {
                      "type": "text",
                      "text": "sudo service cz-identityd stop",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  enter OTP"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Remedy card disappears with the following logs:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": {},
                  "content": [
                    {
                      "type": "text",
                      "text": "[2017-08-25T14:38:07.034Z] Info : Sending OTP pin to controller. [ClaimSuffix: 'a', ProviderId: '03542d1e-733c-4c43-a567-d28fbc4649a7', State: '']\n[2017-08-25T14:38:07.053Z] Info : Existing REST connection lost. Reconnecting.\n[2017-08-25T14:38:07.054Z] Info : Resolving hostname 'envy-172-17-102-1.devops'\n[2017-08-25T14:38:07.058Z] Info : Trying to connect 'envy-172-17-102-1.devops/172.17.102.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-08-25T14:38:08.100Z] Info : REST connection could not be established. 'Internal Server Error'. Will try the next IP address.\n[2017-08-25T14:38:08.103Z] Info : Initializing OTP seed for 03542d1e-733c-4c43-a567-d28fbc4649a7\n[2017-08-25T14:38:08.106Z] Info : Resolving hostname 'envy-172-17-102-1.devops'\n[2017-08-25T14:38:08.109Z] Info : Trying to connect 'envy-172-17-102-1.devops/172.17.102.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-08-25T14:38:09.139Z] Info : REST connection could not be established. 'Internal Server Error'. Will try the next IP address.\n[2017-08-25T14:38:09.142Z] Error : Request to controller 'https://envy-172-17-102-1.devops/' during OTP initialization has been rejected. Reason: (HTTP 500) Internal Server Error\n[2017-08-25T14:38:09.145Z] Info : Otp Action with message 'aa' has been cancelled by the user."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "not sure why we even try to initialize OTP again in this scenario."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1503672388258
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok, initialization happens because of lack of parantheses on non-radius case. but for radius case, the problem persists."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1503673085164
      }
    ]
  },
  {
    "key": "SA-5860",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Be it envy, teamcity, testrail or github."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Right now teamcity down gives something like that:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "thomas@thomas:~$ aitorbot env create --scenario controller_ha\nMadre puta! POST /executions HTTP 502: <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">\n\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">\n    <head>\n        <title>The page is temporarily unavailable</title>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n        <style type=\"text/css\">\n            /<![CDATA[/\n            body {\n[...]"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-7484",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Occasional UI freezes"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  cant click it to see the status in ios"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  it messes up onboarding cookie somehow after failure(s)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  on-boarding cookie issues."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  saml screen doesn't show"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "does not support token renewals properly"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1520429537046
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "it messes up onboarding cookie somehow after failure(s)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1520440687581
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "saml screen doesn't show"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1520512073783
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Mar  8 13:26:45 Cryptzones-iPad iOSClient[560] <Notice>: [2018-03-08T12:26:45.401Z] Info : Starting HTTP Server to receive SAML token.\nMar  8 13:26:45 Cryptzones-iPad iOSClient[560] <Notice>: [2018-03-08T12:26:45.404Z] Info : Starting the browser to https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml.\nMar  8 13:26:45 Cryptzones-iPad iOSClient(WebKit)[560] <Notice>: 0x1c00deca0 - UIProcess is taking a background assertion because a page load started\nMar  8 13:26:45 Cryptzones-iPad iOSClient(WebKit)[560] <Notice>: 0x136d0de18 - UIProcess is taking a foreground assertion because the view is visible\nMar  8 13:26:45 Cryptzones-iPad iOSClient(UIKit)[560] <Error>: Unable to simultaneously satisfy constraints.\nMar  8 13:26:45 Cryptzones-iPad iOSClient(UIKit)[560] <Error>: Unable to simultaneously satisfy constraints.\nMar  8 13:27:15 Cryptzones-iPad mediaserverd(AudioToolbox)[25] <Notice>: 1171: pid 560(iOSClient)\nMar  8 13:27:20 Cryptzones-iPad iOSClient(UIKit)[560] <Notice>: XPC connection interrupted\nMar  8 13:27:31 Cryptzones-iPad ReportCrash[563] <Notice>: Formulating report for corpse[560] iOSClient"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1520512641251
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "3.3.3 client seems to work, still. A 4.0 client built with 3.3.3 shim+packettunnel is just as bad as the plain 4.0 version."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1520512784004
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [14:01]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "client built from "
                },
                {
                  "type": "text",
                  "text": "3a7e6b70fb36519455b615617526020dfa764fa9",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-logging/commit/3a7e6b70fb36519455b615617526020dfa764fa9"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " (Jan 12) works"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson [14:08]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "client built from 7b8bed5 (PR 2729 ios autorotate) doesn't work "
                },
                {
                  "type": "text",
                  "text": ":slightly\\_smiling\\_face:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Silvercast Nguyen [14:09]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "yup, the blocking mainthread is due to webview view manipulating"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1520515017252
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "client built from b875612a (PR 2675 iOS native nav) doesn't work (edited)"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "client built from 9a12f359f - PR merge before b875612a - works"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so it's PR 2675 that is the breaker"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1520516889593
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is a fix/improvement for when we keep getting token renewals from GW, but UI is napping -"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "eventually the packettunnel extension will run out of memory: "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2790",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2790"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1520593015503
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2791",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2791"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " this is a fix for napping UI. Other UI issues will be solved in the same PR."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "silvercast.nguyen",
        "created": 1520594079323
      }
    ]
  },
  {
    "key": "SA-7402",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Client was happy sending SPA-UDP and using the custom key i.e. it was using the custom URL with the settings. After I upgraded to latest master I couldn't connect to controller anymore. I noticed in the logs that the client was trying to reach the controller using the default settings i.e. with the build-in key. It has lost the URL with the settings. I had to reseed it"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Platform, distribution etc."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1519652694189
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ubuntu LTS 16.04"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1519652845062
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Some logs after the upgrade and when the build-in key started being used"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "feb 26 13:42:19 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-b3:38:b7:f3:e8:82:d9:37:63:3f:13:61:36:a0:ff:99:e8:81:ea:53:04:1d:28:75:b4\nfeb 26 13:42:19 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-15:f9:bc:22:13:3e:ba:0a:91:b2:e0:8e:e9:0e:89:a4:e7:91:ff:b5:39:f5:fc:c1:7a\nfeb 26 13:42:19 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-a7:3a:62:12:61:3f:f4:01:bd:5d:02:93:3f:36:6c:c8:e4:e3:46:8b:79:0a:9e:54:60\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-f3:85:48:6a:4a:08:37:30:85:1d:25:55:dc:24:bb:df:78:c5:ba:e4:67:75:95:fb:ac\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : Running as user 'kosmas'.\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : Process starting.\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : ApplicationVersion: 4.0.0-10024-master\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : UI has connected to service.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : UI is ready.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : UI connected.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Connecting to TUN driver.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting locale to en-US.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting log level of TUN driver to Info.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting controller URL to 'https://purple.cryptzone.com/'.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : CA certificate found in the storage for 'purple.cryptzone.com'.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Resolving hostname 'purple.cryptzone.com'\nfeb 26 13:42:22 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be853608952\nfeb 26 13:42:32 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be853608952\nfeb 26 13:42:42 kosmas-VirtualBox appgate-sdp[14568]: Error : First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\nfeb 26 13:42:42 kosmas-VirtualBox appgate-sdp[14568]: Info : User input required for 'ControllerUrlLoginHandler'.\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting controller URL to 'https://purple.cryptzone.com/'.\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : CA certificate found in the storage for 'purple.cryptzone.com'.\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : Resolving hostname 'purple.cryptzone.com'\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be853608952\nfeb 26 13:42:58 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be853608952"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1519653438202
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2758",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2758"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "silvercast.nguyen",
        "created": 1519738461009
      }
    ]
  },
  {
    "key": "SA-7396",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "feb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Controller password update for controller : L5aURZIq15;I5:A\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] UUID update for gateway : 4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] UUID update for endpoint : 4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1\nfeb 23 10:42:57 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Initializing Terraform: /opt/envy/terraform init\nfeb 23 10:42:57 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Exec, dir:/var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:42:57 envy envy[12019]: [golang-sh]$ /opt/envy/terraform init\nfeb 23 10:42:58 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Execute : /var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:42:58 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Exec, dir:/var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:42:58 envy envy[12019]: [golang-sh]$ /opt/envy/terraform apply\nfeb 23 10:43:12 envy envy[12019]: 23/Feb/2018:10:43:12 +0100 404 121s \"GET /env/82c7c4ac-bada-4b6c-97cb-d5f9c4331540 HTTP/1.0\" - \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ch\nfeb 23 10:43:12 envy envy[12019]: 23/Feb/2018:10:43:12 +0100 404 45s \"GET /favicon.ico HTTP/1.0\" - \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.3\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: s:[]json.InterfaceJson(nil), Hostname:\"\", ApiUsername:\"\", ApiPassword:\"\", SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string(nil), Healthchec\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: controller status: Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Starting to provision : controller\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: gateway status: Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Starting to provision : gateway\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: endpoint status: Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Starting to provision : endpoint\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Using default controller api username\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Using default controller api password\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller provisioning dispatched for controller\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] Could not establish a connection (SSH) to the controller. Unable to find the path to the private key: No priva\nfeb 23 10:44:01 envy envy[12019]: Will try connecting using password authentication.\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Provisioning dispatched for gateway\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Waiting for controller to be ready\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller status is Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Endpoint provisioning finished!\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: ssword:\"\", SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string{\"172.17.106.1\"}, Healthchecks:[]*status.NodeStatusInfoHealthcheck(nil), Provide\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller username update for controller : admin\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller password update for controller : admin\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]:  SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string{\"172.17.106.1\"}, Healthchecks:[]*status.NodeStatusInfoHealthcheck(nil), Provider:\"vsphere\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: controller status: Provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]:  SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string{\"172.17.106.1\"}, Healthchecks:[]*status.NodeStatusInfoHealthcheck(nil), Provider:\"vsphere\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: n{Ip:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xac, 0x11, 0x69, 0x0}, Network:(*net.IPNet)(0xc4219ee630), NetworkString:\"172.17.105.0/24\"}}},\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: gateway status: Provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: endpoint status: Running\nfeb 23 10:44:01 envy envy[12019]: Verification error: &url.Error{Op:\"Get\", URL:\"https://172.17.106.1:444/appliance/status\", Err:(*net.OpError)(0xc420472fa0)}\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] Controller is down\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] Verify service failed The controller service is down\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] HealthCheck of controller failed The controller service is down\nfeb 23 10:44:07 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Adding new status listener\nfeb 23 10:44:08 envy envy[12019]: [Restserver][WARNING] Unable to send on websocket\nfeb 23 10:44:08 envy envy[12019]: 23/Feb/2018:10:44:07 +0100 0 489512s \"GET /env/ws/4ac34bc0-8b53-4d9e-8189-b1cf31df8253 HTTP/1.0\" - \"wCS/1.0\"\nfeb 23 10:44:08 envy envy[12019]: 23/Feb/2018:10:44:07 +0100 200 274s \"GET /env/4ac34bc0-8b53-4d9e-8189-b1cf31df8253 HTTP/1.0\" - \"http4s-blaze/0.15.11a\"\nfeb 23 10:44:08 envy envy[12019]: [Restserver][INFO] Sending interrupt to masterHandler : 4ac34bc0-8b53-4d9e-8189-b1cf31df8253\nfeb 23 10:44:08 envy envy[12019]: 23/Feb/2018:10:44:08 +0100 0 72s \"DELETE /env/4ac34bc0-8b53-4d9e-8189-b1cf31df8253 HTTP/1.0\" - \"http4s-blaze/0.15.11a\"\nfeb 23 10:44:08 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Trying to destroy an environment...\nfeb 23 10:44:08 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][INFO] Executing the Terraform destroy command\nfeb 23 10:44:08 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Exec, dir:/var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:44:08 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:08 envy envy[12019]: e:\"\", ApiUsername:\"\", ApiPassword:\"\", SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string(nil), Healthchecks:[]*status.NodeStatusInfoHealthche\nfeb 23 10:44:08 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][INFO] Status update for: controller status: Destroying\nfeb 23 10:44:08 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][INFO] Status update for: gateway status: Destroying"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1519638964941
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I cant reproduce the issue via create->destroy->create but.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "My env disappeared during weekend so I tried creating one first thing in the morning and started getting "
                },
                {
                  "type": "text",
                  "text": "Error occured",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " every time. Don't know what happened during the weekend."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Edit: can repro via create->destroy->create cycle again.. but my disappearing env during weekend remains a mystery.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1519641665082
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/envy/pull/221",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/envy/pull/221"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " this should do it.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1519911636849
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "noice"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "teoman.soygul",
        "created": 1519915507319
      }
    ]
  },
  {
    "key": "SA-7380",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "For example to resize an AWS or Azure instance."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Adding support for extending an existing volume in cz-resize-data "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1894",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1894"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519308827579
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Installing part probe in appliances "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1895",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1895"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519308841779
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Here is a walk through on resizing an AWS instance:"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "In the AWS console"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Take a snapshot of the instance's volume."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Stop the instance."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Click on the instance, block devices, and click on the volume link, for example "
                        },
                        {
                          "type": "text",
                          "text": "vol-062fd64977435e526",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "From the volume page, right click modify volume and enter the desired disk space, for example 100 for 100 GiB."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Start the instance."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "On the appliance"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "orderedList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "SSH and get a root console on the appliance with "
                        },
                        {
                          "type": "text",
                          "text": "sudo -s",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Make sure the disk has been expanded by running "
                        },
                        {
                          "type": "text",
                          "text": "fdisk -l",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "The first line should show the new disk size, for example "
                        },
                        {
                          "type": "text",
                          "text": "100 GiB",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "fdisk -l\nDisk /dev/xvda: 100 GiB, 107374182400 bytes, 209715200 sectors\n[...]"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Find the name of the lvm partition on the appliance with pvdisplay in the PV Name column, here it is "
                        },
                        {
                          "type": "text",
                          "text": "/dev/xvda2",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ":"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "#pvdisplay\n\n  --- Physical volume ---\n  PV Name               /dev/xvda2\n  VG Name               czvg\n  PV Size               199.75 GiB / not usable 2.00 MiB\n  Allocatable           yes\n  PE Size               4.00 MiB\n  Total PE              51135\n  Free PE               1280\n  Allocated PE          49855\n  PV UUID               N417eY-ZPMZ-fo5W-pmq9-Agmr-1BxP-5fAp8B"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Verify the size of the data partition before, here it is "
                        },
                        {
                          "type": "text",
                          "text": "13G",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": ":"
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "\\# df -h /dev/czvg/data \n\nFilesystem      Size  Used Avail Use% Mounted on\n\n/dev/czvg/data     14G  197M   13G   2% /mnt/data"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Get the script, copy it to the appliance and make it executable."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "https://github.ad.cryptzone.com/raw/cryptzone/stratus-appliance/master/scripts/cz-resize-data?token=AAAAGZ76acwSMzhZ6eZYbqU4homc0mACks5amArxwA%3D%3D",
                          "marks": [
                            {
                              "type": "link",
                              "attrs": {
                                "href": "https://github.ad.cryptzone.com/raw/cryptzone/stratus-appliance/master/scripts/cz-resize-data?token=AAAAGZ76acwSMzhZ6eZYbqU4homc0mACks5amArxwA%3D%3D"
                              }
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "wget https://s3.amazonaws.com/appgatedownload/cz-resize-data\nchmod +x cz-resize-data"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Run the script with the lvm partition as a parameter."
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "\\# ./cz-resize-data /dev/xvda2"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Verify that the data partition was expanded, here it's size was increased to "
                        },
                        {
                          "type": "text",
                          "text": "93G",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    },
                    {
                      "type": "codeBlock",
                      "attrs": {},
                      "content": [
                        {
                          "type": "text",
                          "text": "\\# df -h /dev/czvg/data \n\nFilesystem      Size  Used Avail Use% Mounted on\n\n/dev/czvg/data     93G  215M   89G   1% /mnt/data"
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": " Note that the script will reserve 5 GiB for upgrades (image2 and state2 lvm logical volumes) since appliance versions lesser than 3.3 do not have the capability to resize the data partition on upgrade to make room for the image and state."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519309412298
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This worked with datadog"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519373661263
      }
    ]
  },
  {
    "key": "SA-7363",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "["
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group\\",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group\\"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "by=cases",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": ":title&group\\_order=asc&group\\_id=-1]("
            },
            {
              "type": "text",
              "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group_by=cases",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group_by=cases"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": ":"
            },
            {
              "type": "text",
              "text": "title&group"
            },
            {
              "type": "text",
              "text": "order=asc&group",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "id=-1)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "not sure if its related but i see a lot of this in rsyslog's own logs"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Feb 20 10:35:34 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:34 envy-172-17-122-1.devops rsyslogd[17654]: Child 19360 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:34 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:35 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:35 envy-172-17-122-1.devops rsyslogd[17654]: Child 19368 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:35 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:36 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:36 envy-172-17-122-1.devops rsyslogd[17654]: Child 19379 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:36 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:37 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:37 envy-172-17-122-1.devops rsyslogd[17654]: Child 19387 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:38 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:39 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:39 envy-172-17-122-1.devops rsyslogd[17654]: Child 19394 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:39 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519122970316
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It didn't start failing with the new rsyslog actually but after that, weird "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1876",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1876"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519124201238
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Seems related to log2audit which itself is related to the latest logd client update:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-122-1:~# cz-log2audit\nTraceback (most recent call last):\n File \"/usr/bin/cz-log2audit\", line 14, in <module>\n   import logdclient  # type: ignore\n File \"/usr/local/lib/python3.5/dist-packages/logdclient/init.py\", line 4, in <module>\n   from . import logc\n File \"/usr/local/lib/python3.5/dist-packages/logdclient/logc.py\", line 28, in <module>\n   _logc = swig_import_helper()\n File \"/usr/local/lib/python3.5/dist-packages/logdclient/logc.py\", line 24, in swig_import_helper\n   _mod = imp.load_module('_logc', fp, pathname, description)\n File \"/usr/lib/python3.5/imp.py\", line 242, in load_module\n   return load_dynamic(name, filename, file)\n File \"/usr/lib/python3.5/imp.py\", line 342, in load_dynamic\n   return _load(spec)\nImportError: /usr/local/lib/python3.5/dist-packages/logdclient/_logc.so: undefined symbol: logc_send_guaranteed_no_reconnect"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519124763508
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Caused by updated the python library but not the underlying appliance library"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-contrib/pull/178",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-contrib/pull/178"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1882",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1882"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Fixed by per here:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1887",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1887"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1519125182514
      }
    ]
  },
  {
    "key": "SA-7213",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I guess the X should not be there - or should not create the new entry!"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "SA-7248",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "SA-7248"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1518183452423
      }
    ]
  },
  {
    "key": "SA-7273",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "According to Thomas, controller returns 'Conflict' for filename after the file upload is complete. That means, the stream handling is not really as we want on the controller side."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think this is fine (except possibly nginx caching?), eller "
                },
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1518613603777
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I don't think it's nginx caching as it's the whole file. But yeah close it if you want."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1518616110016
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "didn't you say it was 20% when you got the conflict today?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1518616200435
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "No it was 20% when uploading against a 3.3 controller which doesn't even have the API. Which is why I made this PR "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1873",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1873"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I have to check, I might have increased the upload limit for 4.0 unnecessarily since it is disabled in particular for the file repository api."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "EDIT:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is the location in 4.0:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "location /admin/files { proxy\\"
                },
                {
                  "type": "text",
                  "text": "set\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "header X-Forwarded-For $remote\\"
                },
                {
                  "type": "text",
                  "text": "addr; proxy\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "pass "
                },
                {
                  "type": "text",
                  "text": "http://127.0.0.1:9130/peer/files",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://127.0.0.1:9130/peer/files"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": " proxy\\"
                },
                {
                  "type": "text",
                  "text": "request\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "buffering off; client\\"
                },
                {
                  "type": "text",
                  "text": "max\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "body\\"
                },
                {
                  "type": "text",
                  "text": "size 2g; }",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1518617005742
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ah, right. ok, so still a problem."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1518617101236
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Failed.. Jersey (the REST part of dropwizard) waits for full upload before starting the process. I tried a bunch of things but didn't help. It could very well be how HTTP works."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I was able to start processing right away with a change but failed to read the file this time. However, curl looks like this then:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "* Connected to localhost (127.0.0.1) port 9130 (#0)\nPUT /peer/files HTTP/1.1\nUser-Agent: curl/7.35.0\nHost: localhost:9130\nAccept: application/vnd.appgate.peer-v7+json\nContent-Length: 816884983\nExpect: 100-continue\nContent-Type: multipart/form-data; boundary=------------------------2e5e265bd20f44bc\n\n< HTTP/1.1 100 Continue\n< HTTP/1.1 204 No Content\n< Date: Fri, 23 Feb 2018 13:17:30 GMT\n<\n\n* Send failure: Broken pipe\n* Closing connection 0\ncurl: (55) Send failure: Broken pipe"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1519392932714
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Stackoverflow here I come."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1519393095216
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://stackoverflow.com/questions/10615410/jersey-multipart-streaming-without-disk-buffering-at-the-receiving-server",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://stackoverflow.com/questions/10615410/jersey-multipart-streaming-without-disk-buffering-at-the-receiving-server"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "for reference"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -X PUT --header \"Accept: application/vnd.appgate.peer-v10+json\" --header \"Authorization: Bearer eyJjbGFpbXNUb2tl\nbiI6ImV5SmhiR2NpT2lKU1V6VXhNaUlzSW5wcGNDSTZJa1JGUmlJc0luUjVjQ0k2SWtwWFZDSjkuZUp5dGt0dHU0akFRaHQ4bHQ1RFd6c0Z4a0pDV0lLQlF\nvSlJ5WHZYQ3NSMXdTZUxnaEZNcTNyME9XMjMzQWZadVBQN0cvL2lmK1RRS3VlZHBueGtOZytEUVJoQkVwa1VCTXgwcjlFenN1Y0IwR1NRQSs2SHYyOUNvR3\nlMUGo3emlMUUI5RTJBVFdqUG9OQnk3NGFJSGhQMk5admdsRTRybi8wTDJEd1E4cDRLWXlBdVJibzhpMzNFMkpnblhlSHZjMUpMSWpTemsyYmJuUU0vR2JnZ\n2pSam5Bb1I5aUJ1dWFJU3dSYWYxbDNvd2xKWEVsbUZKMXpRck8yakVSaVJiK05ESnlqU1dwR3MyNmsyUGVrcWRhTWZmUHRjMEFyZWdZbjd0clhiZm4xenRN\nWlZvb0djZGNhVDdZalpQbFM4WlYvL1R4dEpvSG84VnNhOUhSZVRuSUxtdFlQRjdLYzN0MGNDWHR0Tk01UUtSUHl5eVlUdC9zVGJlZDJNT29WT3RUc2lnazV\n2NndIRVZ4TnluWHkrRUZBdEh1dlI2Z014Rnk4UHcyN1J4YWJMZFk5N0lXdnlhcmFQbzZMYk55T1ZidTRubWRnbGJ0TXJOMndhYjdrVXUyNzVEQlpIL2RQTD\nRFbzlmZEV3aDZNN2EwdHJOTzA3amQ2a2FtUDUzKy9Kd25STVE2K20zY2ZmcDFQejlRbVJqdmRTTVNLaSsrM1E2T0l0WWowRDdFNUcreVZkWG8wU2hTU0tXd\nnNwMU1xN3dPeWJaNi9uL09UVENlRnFLNFRwUTg2VmpkRnpGME9mRm9CRXpFUGRlRWtEdW1qNEd0MXdnQUN3RHFFNFNNVzFXc1laZmJTS2RZdGF2SWRHQ29Z\nZGYzVEFTZ0J5Mk1JWEdwRmpybVhLVi9lcjAzb1ZNRjJkNU5DcjlkZUwvZHZnQ0VzUEdkLlNVUG9XQUhrTlF5VWFnTytZNVZFVktzOHpHKzlSVzRxRmZEUGF\nOVXgvVmd5Q0JHa0Q4aEZadEdDbnZuOFhjRDVNdFhGaEE2b01wKzUvdDNSRUU1dGVWQVJxMzVXQ1huV3UvSllpVTNpTVhYdWhoUGRoWUdqSnQ1b0RpQXd3Sm\nRLekFWNFdwNThzTTZwdGlPTWpVOVBSV1hSSEhkODhtSXBwM3J2RFZoc3hyST0iLCJhZG1pbmlzdHJhdGlvblRva2VuIjoiZXlKaGJHY2lPaUpTVXpVeE1pS\nXNJbnBwY0NJNklrUkZSaUlzSW5SNWNDSTZJa3BYVkNKOS5lSnhOa0R0ckF6RVFoUDlLVUowMXE1Tk9qK3RjcG82ckJCZDZuUkc1RjVJY1lnNy85MGdoTVdH\nYlhlYWJHZGlkbFBVakxDK2VETVM1VVRLRkFvUWZGWERVQWl4YUNxTjNETDNodlJ3TmVTWXg1MnRvZklkVUF5cWczWW55Z2JPaGx3ZUIrRmFaOExYRkZQSi9\npUDFCNG9DU044aE5Kczc1OU9nM3lqSkJjWVRPb1FmZVdRbEs5Z2k5cHdhVnRsb3pXbTFwblZyeSswNWljMWswM2pxQklJUG5RR25nWUxscG5ZZ2RvdE5HaU\n9wYXpCd3EvWHJMSmN4UFJ6L0hKZWFTVEluclV1VXR4Yzg0aGN0dmNybHRqVDVPVTlXS1NaZFFIbWQyYXhOM1l1bzVsSFFOOVNlKytjNk52ZnhzOS91NXpqZ\nTR5V1RpLlBCYnNZeStSK21oOTNQekxRQzBmSG9GcE5HdGVHZFo3eGdWcG45MjhjaXhTREljWnl6dWhHbzBmQXVSTGdiSmM2ZC9jbngzcUZlQzl6RmdzRFpr\nUm5BeW95Mk93SG1MMDFTSXU3MXNBNFBCNUdVdWJjVGQySGFwOWVEQzcrdTdZWnlUbHlvRFNmUUdrZkRTTUxQVmk0Z2g4bSsycHJUYWIzejAzMlZ3cWt1bz0\nifQ==\" http://localhost:9130/admin/files -F \"file=@C:\\\\Users\\\\natan.abolafya\\\\Downloads\\\\appgate-5.0.0-14972-master.img\n.zip\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1565621293840
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "In nginx it looks like we need set http 1.1 protocol too or else it doesn't proxy the chunked encoding. "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "        proxy_http_version 1.1;"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1565793372519
      }
    ]
  },
  {
    "key": "SA-7095",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The passphrase remains set."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "could you tell me in which case?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadi.misagh",
        "created": 1516619084294
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is what normally happens if I try to backup a newly created appliance:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " $ python3 appgate-backup.pyz https://envy-172-17-116-1.devops:444 --no-verify\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-116-1.devops:444...\nAuthentication succeeded\nAuthorizing...\nStarting backup on 1 appliances:\n\ncontroller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nFailed to start backup creation.\nHTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Backup passphrase is not set. Please contact your administrator.\"}\n\n"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But if I do this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ aitorbot test create --purpose backuprestore --scenario controller\\_ha --ex 4910c1be-a896-4889-b31b-f332ac4844ea "
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "After, this is what happens:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ python3 appgate-backup.pyz https://envy-172-17-116-1.devops:444 --no-verify\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-116-1.devops:444...\nAuthentication succeeded\nAuthorizing...\nStarting backup on 1 appliances:\n\ncontroller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nBackup creation started.\nAll files will be stored in /tmp/1517223805.21248/\nBackup complete on appliance: controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nDownloading backup from controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1 in /tmp/1517223805.21248/controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nDownload complete for appliance: controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nRemoved remote download for appliance: controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, as you can see, the state of the appliance after the test is not the same as before."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1517223971166
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1452",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1452"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1517392763237
      }
    ]
  },
  {
    "key": "SA-7057",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The upgrade API got expanded quite a lot during the 4.0.0 development cycle from a single API call POST /upgrade to a set of API calls."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The main functionality that was added was:"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Upgrade status"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The appliance now maintains an upgrade status that can be queries, allowing the upgrade script and command to get feedback on the progress of an upgrade. This allows discovering common errors like failing to download an upgrade file or a signature verification failure. The upgrade script now uses this functionality automatically if the controller and target appliance support it."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Prepared upgrades"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It is possible to prepare an upgrade before starting it's installation. That means downloading the upgrade file on an appliance and making sure it's signature is correct. This means errors can be discovered before the critical upgrade installation as well as time saved during the installation. To prepare an upgrade pass the "
                },
                {
                  "type": "text",
                  "text": "--prepare",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " flag to the upgrade script. Once the preparation is successful, run the script again with the "
                },
                {
                  "type": "text",
                  "text": "--install",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " flag."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Hosting upgrade files on the controller"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This allows appliances to download the upgrade image from a controller, not requiring extra ips and ports to be allowed in firewalls since all appliances already require access to the controller. If passing a local file to the controller using the "
                },
                {
                  "type": "text",
                  "text": "--image",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " flag the upgrade script will upload the file to the controller. If using an URL, the appliances will download from the URL directly. The controller can be instructed to download the file first using the "
                },
                {
                  "type": "text",
                  "text": "--host-image-on-controller",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " flag. The appliances will then download the file from the controller."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516204614720
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " assume the parameter-options are changing; or at least you are adding new ones?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Current ones are here: "
                },
                {
                  "type": "text",
                  "text": "https://help.cryptzone.com/adminguide/v3.3/upgrading-appliances.html?anchor=collective-upgrade",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://help.cryptzone.com/adminguide/v3.3/upgrading-appliances.html?anchor=collective-upgrade"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1516721544002
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes they are changing quite a lot, I will add a comment here detailing the changes to the CLI."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516723662291
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Changes to the command line interface"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "These changes implied a bunch of changes on the command line interface."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Script file name change"
                }
              ],
              "attrs": {
                "level": 4
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The script extension changed so the script name changed from "
                },
                {
                  "type": "text",
                  "text": "appgate-upgrade.py",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to "
                },
                {
                  "type": "text",
                  "text": "appgate-upgrade.pyz",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". It is still called in the same way, that is "
                },
                {
                  "type": "text",
                  "text": "python(3) appgate-upgrade.pyz <arguments>",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The technical reason for this is that we split the upgrade script code into several submodules and shared some with the backup script. In the future we will be able to share that code with any \"admin script\", for example that could be used for the autoscaling script as well."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Python allows you to package several scripts in a single zip file with the "
                },
                {
                  "type": "text",
                  "text": "pyz",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " extension and call it like you would call single "
                },
                {
                  "type": "text",
                  "text": "py",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " script."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Actions"
                }
              ],
              "attrs": {
                "level": 4
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The upgrade script was fairly simple before, it only had one possible action which was to upgrade a collective. With the addition of prepared upgrades we need a lot more actions. The different actions available are now:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  run: Perform a full upgrade. This is equivalent to what the upgrade script has been doing up to now."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  prepare: Prepare an upgrade but do NOT install it. This means the upgrade file will be downloaded/uploaded to all the appliances, the signature verified as well as any other preconditions applicable at this point."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  install: Install a prepared upgrade."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  cancel: Cancel a prepared upgrade."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Most of the command line flags are shared between all actions. Only a few differ like "
                        },
                        {
                          "type": "text",
                          "text": "--image",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": " and "
                        },
                        {
                          "type": "text",
                          "text": "--host-on-controller",
                          "marks": [
                            {
                              "type": "code"
                            }
                          ]
                        },
                        {
                          "type": "text",
                          "text": "."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Install"
                }
              ],
              "attrs": {
                "level": 4
              }
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ python3 appgate-upgrade.pyz run --help\nusage: appgate-upgrade.pyz run [-h] --image IMAGE [--host-on-controller]\n                               [-c CONTROLLER] [--cacert CACERT] [--port PORT]\n                               [--username USERNAME] [--provider PROVIDER]\n                               [-y] [-l {debug,error,info,warning}]\n                               [--peer-hostname PEER_HOSTNAME]\n                               [--target-version TARGET_VERSION]\n                               [--ignore-target-version] [--no-verify]\n                               [--device-id DEVICE_ID]\n                               [--peer-api-version PEER_API_VERSION] [--color]\n                               [--no-color]\n\nRun full upgrade.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --image IMAGE         Upgrade image file or URL\n  --host-on-controller  Host upgrade image file on controller\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Prepare"
                }
              ],
              "attrs": {
                "level": 4
              }
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ python3 appgate-upgrade.pyz prepare --help\nusage: appgate-upgrade.pyz prepare [-h] --image IMAGE [--host-on-controller]\n                                   [-c CONTROLLER] [--cacert CACERT]\n                                   [--port PORT] [--username USERNAME]\n                                   [--provider PROVIDER] [-y]\n                                   [-l {debug,error,info,warning}]\n                                   [--peer-hostname PEER_HOSTNAME]\n                                   [--target-version TARGET_VERSION]\n                                   [--ignore-target-version] [--no-verify]\n                                   [--device-id DEVICE_ID]\n                                   [--peer-api-version PEER_API_VERSION]\n                                   [--color] [--no-color]\n\nPrepare an upgrade.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --image IMAGE         Upgrade image file or URL\n  --host-on-controller  Host upgrade image file on controller\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Install"
                }
              ],
              "attrs": {
                "level": 4
              }
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ python3 appgate-upgrade.pyz install --help\nusage: appgate-upgrade.pyz install [-h] [-c CONTROLLER] [--cacert CACERT]\n                                   [--port PORT] [--username USERNAME]\n                                   [--provider PROVIDER] [-y]\n                                   [-l {debug,error,info,warning}]\n                                   [--peer-hostname PEER_HOSTNAME]\n                                   [--target-version TARGET_VERSION]\n                                   [--ignore-target-version] [--no-verify]\n                                   [--device-id DEVICE_ID]\n                                   [--peer-api-version PEER_API_VERSION]\n                                   [--color] [--no-color]\n\nInstall a prepared upgrade.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "Cancel"
                }
              ],
              "attrs": {
                "level": 4
              }
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ python3 appgate-upgrade.pyz cancel --help\nusage: appgate-upgrade.pyz cancel [-h] [-c CONTROLLER] [--cacert CACERT]\n                                  [--port PORT] [--username USERNAME]\n                                  [--provider PROVIDER] [-y]\n                                  [-l {debug,error,info,warning}]\n                                  [--peer-hostname PEER_HOSTNAME]\n                                  [--target-version TARGET_VERSION]\n                                  [--ignore-target-version] [--no-verify]\n                                  [--device-id DEVICE_ID]\n                                  [--peer-api-version PEER_API_VERSION]\n                                  [--color] [--no-color]\n\nCancel a prepared upgrade\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516873906876
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "cz-config upgrade"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "cz-config upgrade also got updated to reflect the new capabilities"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ cz-config upgrade --help\nusage: cz-config upgrade [-h] [--no-delete] [--no-wait] [-n] [--force]\n                         [--prepare] [--install] [--finalize] [--cancel]\n                         [--status]\n                         [FILE]\n\npositional arguments:\n  FILE             Absolute URL to upgrade file, using the file://, http:// or\n                   https:// protocol, or absolute path to file\n\noptional arguments:\n  -h, --help       show this help message and exit\n  --no-delete      Do not delete the appliance upgrade image after upgrade\n  --no-wait        Don't wait for the upgrade to complete before returning\n  -n, --no-reboot  Do not reboot the appliance after upgrade\n  --force          Ignore peer API validation errors when installing the\n                   upgrade\n  --prepare        Prepare the upgrade but don't install the image\n  --install        Install a prepared upgrade\n  --finalize       Finalize a successful upgrade, this will trigger a reboot\n  --cancel         Cancel a prepared upgrade\n  --status         Print upgrade status"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516875765309
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is now done and available here "
                },
                {
                  "type": "text",
                  "text": "https://sdphelp.cyxtera.com/adminguide/v4.0/upgrading-appliances.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://sdphelp.cyxtera.com/adminguide/v4.0/upgrading-appliances.html"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "However the terminology used in cz-config and the upgrade script need changeing to match."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1517300242240
      }
    ]
  },
  {
    "key": "SA-7047",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "By default the upgrade script would still run a full upgrade."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This would add two flags:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  prepare"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  install"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Prepare would make sure all appliances have the upgrade file downloaded and verified."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Install would actually install the previously prepared upgrade."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "There could also be a cancel flag to cancel a prepared upgrade."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "This would only be available if all appliances in the collective have peer API version >= 7."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "First shot:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "$ python3 -m appgate_upgrade --image-url https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8508-master.img.zip?is-build-type-id --username admin --no-verify envy-172-17-128-1.devops --prepare\nDiscovering peer API version for https://envy-172-17-128-1.devops:444...\nPeer API version is 7\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-128-1.devops:444...\nAuthentication succeeded\nAuthorizing...\n\nPrepared upgrade plan:\n\nPrepare upgrade on the following appliances: controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1, gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1\nAppliances will be prepared for upgrade to version 4.0.0-8508-master\n\nDo you want to continue [y/N]? y\n\nPrepare upgrade on the following appliances: controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1, gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1\nUpgrade status for gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to downloading: https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8508-master.img.zip?is-build-type-id\nUpgrade status for controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to downloading: https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8508-master.img.zip?is-build-type-id\nUpgrade status for controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to verifying: appgate-4.0.0-8508-master.img.zip\nUpgrade status for gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to verifying: appgate-4.0.0-8508-master.img.zip\nUpgrade status for controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 reached expected value ready: /mnt/data/download/appgate-4.0.0-8508-master.img.zip\nUpgrade status for gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 reached expected value ready: /mnt/data/download/appgate-4.0.0-8508-master.img.zip\n\nReady for upgrade!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516207078978
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1809",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1809"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516283441595
      }
    ]
  },
  {
    "key": "SA-6934",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Renewed CA certificate:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "12-21 15:48:21.490  2400  2630 I Appgate : Info : SiteStatus {\"simple_setup Site\":{\"gw-id\":null,\"host\":null,\"ip\":null,\"status\":\"disconnected\",\"error\":null,\"code\":0,\"protocol-version\":0}}\n12-21 15:48:21.493  2400  2400 I Appgate : Info : TUN failure on site 'simple_setup Site'.\n12-21 15:48:21.494  2400  2400 I Appgate : Info : Site connection lost on 'simple_setup Site'.\n12-21 15:48:26.493  2400  2630 V Appgate : [simple_setup Site] Connect...\n12-21 15:48:26.496  2400  2630 V Appgate : [simple_setup Site] Connecting to envy-172-17-140-2.devops:443 (172.17.140.2) with tls.\n12-21 15:48:26.496  2400  2630 V Appgate : shim_connect(): Connecting to TLS://envy-172-17-140-2.devops|172.17.140.2:443 (tunnel: yes) ...\n12-21 15:48:26.497  2400  2707 V Appgate : Sending SPA data encapsulated in a DNS query\n12-21 15:48:26.497  2400  2707 V Appgate : Sending DTLS ClientHello with SPA extension\n12-21 15:48:27.299  2400  2630 V Appgate : shim_connect(): Connected to envy-172-17-140-2.devops/172.17.140.2\n12-21 15:48:27.306  2400  2708 V Appgate : shim_ssl_connect(): Verification enabled for host name: envy-172-17-140-2.devops\n12-21 15:48:27.559  2400  2630 V Appgate : [simple_setup Site] ResendCachedTokens\n12-21 15:48:27.565  2400  2630 I Appgate : Info : SiteStatus {\"simple_setup Site\":{\"gw-id\":\"gateway-7a56989e-5682-4917-9b3c-f0d8032e9a3a-site1\",\"host\":\"envy-172-17-140-2.devops\",\"ip\":\"172.17.140.2\",\"status\":\"connected\",\"error\":null,\"code\":0,\"protocol-version\":1}}\n12-21 15:48:27.566  2400  2400 I Appgate : Info : TUN connected on site 'simple_setup Site'.\n12-21 15:48:27.567  2400  2400 I Appgate : Info : Site connection recovered on 'simple_setup Site'.\n12-21 15:48:27.568  2400  2630 V Appgate : [simple_setup Site] RunPacketLoop\n12-21 15:48:27.703  2400  2630 V Appgate : [simple_setup Site] SENDTO\n12-21 15:48:27.703  2400  2630 V Appgate : [simple_setup Site] Compression: 0\n12-21 15:48:27.704  2400  2630 I Appgate : Info : SendTo reply {\"id\":null,\"site-id\":\"simple_setup Site\",\"message\":{\"error\":{\"code\":3,\"message\":\"claimstoken_invalid\"},\"id\":13377331,\"jsonrpc\":\"2.0\"}}\n12-21 15:48:27.904  2400  2699 I Appgate : Info : Logging in to gateway 'envy-172-17-140-2.devops'.\n12-21 15:48:27.907  2400  2400 I Appgate : Info : SendTo {\"id\":null,\"site-id\":\"simple_setup Site\",\"message\":{\"jsonrpc\":\"2.0\",\"method\":\"login\",\"params\":{\"claimsToken\":\"eyJhbGciOiJSUzUxMiIsInppcCI6IkRFRiIsInR5cCI6IkpXVCJ9.eJytVtfOo1gSfpf/lvaYcEgttbQYm2STwYBXc0E45GSyGfW7L9272p0H2LtS6TuVT33119fUVbCVk6/vX3HCYCRJJCcIk+QEMAw9MSgenwg2TFI6wtMIJF/fvopxnOEvPI5i9AnDTzjmYOA7oL6T+B8YQ70ODNz6YoDj30H430AU/guUFONUtNlcjDlMtLCBB5zXflAolrB4mFAEYHCSohgGZY+wQiKJABuC8NuBibrom+7+qLs4rH+5a+Ph008w4euwaA63f3314afuwl9hYqEkxkmyv16j5yLJakjV+waga49v2WgSNDXR27b1sZFktkVY9eh15dpUK0NorVuMCq6G0FABGlx3Noi6VcJ55EIrs9AR7JvgZ7EQrSbvTOycokw51H2akF3P3gntPsRnNElqjX+BxcYmE6RTMWPd7p6LWLeJBUOBmeiqMUc8F7/6LbpFRXrH5OpGR2rk3Qy1vIqrsNoMnpW41dICNk5lmnAivPRt17WVfclkY8Zeev6QtLca+YQeewFfGRb2agA1wkT/5E09pVXizhdbTFv+gyBP9obmgXu3EaPAROpBGkvfsJrPuilqFspuNZlnWIDRH1fgdrTzDFzpCrKxrDCEd8M57mj9SfkZGDCcENXrRjllODebhJmft+xrqb9T+LSYZK+8bfvSRaZyq731x4+jVxX8/G5Q3LXT0NU1HI4ePRWd7DxjE7KlWD1UIRDNLdbiyWxpbxtL62MUc7Z2yUZJoEPsJsirY40QJLdz/5maJ/VZo7hzH+qLOKPOYCmuosltRkjC55MUJpSht5ZkGeHPh4INZNWxdLmk54UxSEJ6A80kOJLGyxe/RGd2KGogTcGtiUve6YlVuV8KrtTP16UbzXMnhRJfYsXLtfXWhAVFKfJdfazkQzxXaHK1p8Gb3p5rLM2tCD5Q83YnD0SVUObV6WJB8s9570DoLlsvCau2HeUBrqdI2sgLjCI671xQPih2caz8RYlPCY6GS6Ble8kM2a/Mtafu1mVU6DoieGNGck/bHohHTeGNwwNildztHNESx7K4eRHvmQOugG9mY8kngqYK3ji3ecoRZSDGpZbupCCUNyuHdyh9mM4qdixIrjyFXHhyJguNW+lPdr5P1s5voZ8RVZDLouUL4Drshb3bjvq5eHGxbaNtXVr0fumMF5htMlBqIjs7yOjcN3kdREMt4jHcKSIvgRF74l28Gr7gzxMQtweJkLLIJzfI7z5Fci4jO7YaLbEQZuX17UE+T33N85PCIBB0jBxlfIq3nYvvQbjEdxuVtopq4e4oHwuEmXwrDe6Kl9nzXeQ+J8HVTy+V0vdDQOqLEkRljOdylqLJs3QMzx+J7oElmLbUHaJ/rAaSIN60vo8RRgbDlh17Ar8FwvIMuAsnZr9mGOA0m4ZseIqiMD0BPGVPERZHJ4IgkhQNmZgE2DHVR7rtqHIzVZKCxYqb8V5q3Xtj1g2EYOQxfwYpGiSEP5OuSgheZfGPy4Taoq4sCiKYerYNI2e+MCZ6S5B9Tw9vCJ9GIp7tI1/RiIpiDlL8ZoVW9wyk/ZicHCf05ROYOee9WlPC4nazHSCVYRbPMWp160MIbxGX+owxXC5IvJCvNapjpixbrSBu+bVbVvR+Dpg166xjiO99KVJq7CzypizyzraJ5HiUIRitXSGNCFXFsvswhmwcDwMId1CrJXolEA5vmPWFD9s7mwlzErh7dv2UYlcH1wrTJdQ2o2vkzmnyIkPVZF2tsoYnRan7Wp9xR0gaBlToKOLuqw6YnMkoTzGcmY+c8VJH3vIeelXg5wuXx1T7isnUxwfvNhRepaMVwrbhu311SXVniUV79SExRiKCWkqu2maIGGPnPXfEGfAe5SM6zW4ofOh3WoYhLGzpUYavwS4lWbnu8v6sRJpgVWlYlYnR56tS8ySc23rb80ADETHLqnTem49yVzD+vI6QAvfWQvTMn1W7z01RrtOq7SFhP/VEeAKvaSfBthdhNB5pQ+MpY9Z5YRmy++A12/C9K73w/XhWcJqfK7x6jJyhw+FRVuJbb0RXSYJih6jKypZgvDlUjqoLpyGFQR9LVmmyow13t0yPbWtj4kZ0Al2U01vnRWp/kzml4sTbZFV+irbLY0iVkko342qZP75+/vz21R/02f6PQ2ETFvUh/fPr4Nt/TGFUw/GPuGu+/vz2lRbDOP2HtI8NFn2Ob1GH/1U5v8GHLsx+WSoS2E7F9DGGbjnk4fe9EZEwpOMUPVGQJk8YBsGJZVDihDIoiqNozIYU9X88E478it/3AEgZNqaZE3s8PQEa0ofEghN52IkZKiEgwA+38wiH9t/eDjOHYgqz37UY4TT3X3/+/PkvlgX85A==.SLxNj8JFmaTa6WkHuXDEeAY/Dvlyb61lIBiEk0qUeBY/vWUMsF7IM9qGdncyXkkft0yuy7uxiqJE7yogGmrrX/v3ETTRHM+IkEHG4cpZEzuqelrGNx/bahkEeDv2Lc22kGbNdidSkAzkZz2CjuSDR6G4p18n57XgTpsfan3NPsPPJ6CGomQUATRI5KLNCeV3+QupJTihYnD255D7pqT/63wdmojxOQDyDszAva/9ooZHKJyGvtIGC+I1Uv10Lsa8DuSy3vTj5VPXwJw8WEx1tz7wN6IoxGox+63thSezk2xgr4oyUD91bd6NPIjmvodwrjPOQCxTFNubS2yvN5WRr7Or4CXXxhx61lpWLcd9olo2E+vwRP+gDwFmimQQVX0PGJ8QaFX3tu5UHUbyiCLHUt2D7DssUMTbRb0qq+GEOMp0Mrx9zBTys7UsVt6wp55WYj2e7j5l77GbWuQPUKBT/t0fOBhf5fITK9Hui8gidFqB83CetimyPI8s9qyI5QUj2LXEutc4r1GiVWNqQMevz9xmiSZzXypjBpEL+WvP7mFX7dCWeiTagW7WPXARwx/NsrBwd1ZD38aXBcJiOXVwnRLnbI1Lb5a+aBxUKco4U9bpcK2q4Nm3jU3hHo/qMdJyR3FZROoMN8VOOw9qmwo4IHRCyfw6kYj2w38WBlcErQE=\",\"entitlementToken\":\"eyJhbGciOiJSUzUxMiIsInppcCI6IkRFRiIsInR5cCI6IkpXVCJ9.eJylk2tr2zAYhf+LPkeeJEvx5dtGs9ZhpGV1Ye0IQTenIr6oke0uhPz3SmkozWBbYQhkOO8jnXOwvQd9t9FtoUAOkhTHGBMOE1RVkBKSQU5TBRmTGddapCJDYAKMc4MOPEE4gZhAgktMczrNGYlilDx4Rv+yZqvdb1BygkiaBUjW3DSufPOXKsWMxQpqrRSkGCOYIiJhnHFVJYJUgip/jNd1J3mvVWFBvgcj9Ucxi5Bf2I/H6dEV4VyJNEenhSnyGzj4aG1v+lo3/vmFO62+d0Nv2jXIK147fTb3+X/uQcsb7a90prG1XjndD3Y1W5Srq7K8CXFkb7r2Fe13NqCF/Syldu5t6rWQ+tkLbhAnqpd2NVgvPXbuaAVwQiKcRDhOIgKWE2C77esgRWB58IIyztZ8t/h7Itm1ygTbb93ayODdqvdyuHJ5mPy52U2xuPyfZkY2/6oWyOMAQcLYh9qdUn2s3fJcAVdPl9Vds50/PRbsq76e19fjLLuY34KzF34rt8aGwKDY3F+4WW02xTi9323uFB/ED/Np9Pzaf3vPfFeoY35KkqziGYdC8PDTVBkUWAoYx7GqEE8lo9jXewGQgRAI.k6N6FCiUyy2cf4CBwf21hGEnOYJWds8OzxyDVzOcX7BM25G3P90D86N2wQPQz1JpAZY7uL8bzE7JY3YhMEeeIX9Hjoc2laVpTrv0vWm5Mch9L1skn5NT7JHAvsKkDyPBVq7hI/cTzxB+mNGt3mnskZHTDorjlISR8bamRmDnujUUp3j3\n12-21 15:48:27.907  2400  2400 V Appgate : [simple_setup Site] UpdateCachedTokens: method: login\n12-21 15:48:27.907  2400  2400 V Appgate : [simple_setup Site] UpdateCachedTokens: updated\n12-21 15:48:27.916  2400  2630 V Appgate : [simple_setup Site] SENDTO\n12-21 15:48:27.916  2400  2630 V Appgate : [simple_setup Site] Compression: 0\n12-21 15:48:27.917  2400  2630 I Appgate : Info : SendTo reply {\"id\":null,\"site-id\":\"simple_setup Site\",\"message\":{\"error\":{\"code\":3,\"message\":\"claimstoken_invalid\"},\"id\":2,\"jsonrpc\":\"2.0\"}}\n12-21 15:48:28.908  2400  2476 W Appgate : Warn : Gateway 'envy-172-17-140-2.devops' rejected the claims token. Will get a new claims token from controller. Reason: ClaimsTokenInvalid\n12-21 15:48:29.911  2400  2446 I Appgate : Info : Retrieving claims token.\n12-21 15:48:29.911  2400  2446 I Appgate : Info : Fetching on-boarding cookie for 'OnBoardingCookie-44:c2:36:94:7f:ed:80:66:ee:4c:b0:af:00:ab:93:df:b3:c7:21:6a:31:86:87:94:99:6e:29:b5:e1:f8:c6:ae-local-bob' from secure storage.\n12-21 15:48:29.923  2400  2446 I Appgate : Info : On-boarding cookie available for 'OnBoardingCookie-44:c2:36:94:7f:ed:80:66:ee:4c:b0:af:00:ab:93:df:b3:c7:21:6a:31:86:87:94:99:6e:29:b5:e1:f8:c6:ae-local-bob'.\n12-21 15:48:29.925  2400  2446 I Appgate : Info : Existing REST connection lost. Reconnecting.\n12-21 15:48:29.925  2400  2446 I Appgate : Info : Resolving hostname '172.17.140.1'\n12-21 15:48:29.925  2400  2446 I Appgate : Info : Trying to connect '/172.17.140.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n12-21 15:48:29.925  2400  2446 V Appgate : shim_connect(): Connecting to TLS://|172.17.140.1:443 (tunnel: no) ...\n12-21 15:48:29.927  2400  2709 V Appgate : Sending SPA data encapsulated in a DNS query\n12-21 15:48:29.927  2400  2709 V Appgate : Sending DTLS ClientHello with SPA extension\n12-21 15:48:30.728  2400  2446 V Appgate : shim_connect(): Connected to /172.17.140.1\n12-21 15:48:30.731  2400  2710 V Appgate : shim_ssl_connect(): Verification enabled for IP: 172.17.140.1\n12-21 15:48:30.832  2400  2710 V Appgate : TLS alert write:fatal:unknown CA\n12-21 15:48:30.833  2400  2710 V Appgate : connection_thread(): 0x981c0000 write(connect) failed\n12-21 15:48:30.835  2400  2446 I Appgate : Info : REST connection could not be established. 'Invalid certificate provided.'. Will try the next IP address.\n12-21 15:48:30.838  2400  2446 E Appgate : Error : SSL certificate of controller 'https://172.17.140.1/' is not accepted. Will check next CA certificate. Reason: Invalid certificate provided."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK, I debugged a bit and it looks like it verifies just fine. The logs above happen when sessiond is restarted but not yet vpnd with the new CA. My emulator reconnects too quickly I suppose."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "However, shim returns ERR\\"
                },
                {
                  "type": "text",
                  "text": "CONNECT\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "CERT\\"
                },
                {
                  "type": "text",
                  "text": "ERROR which is the same code we use for VPN cert failure. That still works but makes the client do some extra unnecessary rounds.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Either, the assumption is wrong and VPN cert error happens with ERR\\"
                },
                {
                  "type": "text",
                  "text": "CONNECT\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "SSL\\"
                },
                {
                  "type": "text",
                  "text": "ERROR or shim needs to return a different error for bad server certificate.",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1514046335135
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe add the extra error handling on to this commit? "
                },
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2627",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2627"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1514538588254
      }
    ]
  },
  {
    "key": "SA-6933",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When I go on the UI, appliances, and click download logs, I get an error saying that the controller is offline."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is what happens on the appliance. It never seems to reach configd at all."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Dec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 0\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 0\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 126 \"-\" \"python-requests/2.14.2\" 10\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 145 \"-\" \"python-requests/2.14.2\" 12\nDec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Identity (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 0\nDec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 210 \"-\" \"python-requests/2.14.2\" 15\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 107 \"-\" \"python-requests/2.14.2\" 9\nDec 21 14:39:56 envy-172-17-158-1.devops nginx[4587]: 192.168.100.87 - - [21/Dec/2017:14:39:56 +0000] \"GET /admin/appliances/0e7bb42e-9753-48a8-911a-5dba2a6a3190/logs HTTP/2.0\" 406 161 \"https://envy-172-17-158-1.devops:444/ui/appliances\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36\"\nDec 21 14:39:56 envy-172-17-158-1.devops cz-managed[3252]: 192.168.100.87 - - [21/Dec/2017:14:39:56 +0000] \"GET /peer/appliances/0e7bb42e-9753-48a8-911a-5dba2a6a3190/logs HTTP/1.0\" 406 161 \"https://envy-172-17-158-1.devops:444/ui/appliances\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36\" 6\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Identity (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 145 \"-\" \"python-requests/2.14.2\" 8\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 107 \"-\" \"python-requests/2.14.2\" 9\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 0\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 0\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 126 \"-\" \"python-requests/2.14.2\" 5\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 210 \"-\" \"python-requests/2.14.2\" 10"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It's a UI issue where it doesn't send the "
                },
                {
                  "type": "text",
                  "text": "......appgate-zip",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " (it sends ....appgate-json which was working until this version). It's fixed in the new UI. We're not maintaining the old UI."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1513868993124
      }
    ]
  },
  {
    "key": "SA-6909",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2017-12-19T10:31:55.608Z] Info : UI has connected to service.\n[2017-12-19T10:31:55.803Z] Info : UI is ready.\n[2017-12-19T10:31:55.804Z] Info : UI connected.\n[2017-12-19T10:31:55.824Z] Info : Setting locale to en-US.\n[2017-12-19T10:31:55.883Z] Info : Connecting to TUN driver.\n[2017-12-19T10:31:55.886Z] Info : Setting log level of TUN driver to Info.\n[2017-12-19T10:31:55.940Z] Info : Setting controller URL to 'https://envy-172-17-140-1.devops/'.\n[2017-12-19T10:31:55.945Z] Info : CA certificate found in the storage for 'envy-172-17-140-1.devops'.\n[2017-12-19T10:31:55.949Z] Info : Resolving hostname 'envy-172-17-140-1.devops'\n[2017-12-19T10:31:55.962Z] Info : Trying to connect 'envy-172-17-140-1.devops/172.17.140.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-12-19T10:31:56.603Z] Info : Using Controller API V4\n[2017-12-19T10:31:56.623Z] Info : Certificate is already trusted. Moving on..\n[2017-12-19T10:31:56.630Z] Info : Retrieving provider names from controller.\n[2017-12-19T10:31:56.658Z] Info : Provider names: [local]\n[2017-12-19T10:31:56.679Z] Info : Provider 'local' selected.\n[2017-12-19T10:31:56.682Z] Info : User input required for 'ConnectCredentialsLoginHandler'.\n[2017-12-19T10:32:07.506Z] Info : User input required for 'ControllerUrlLoginHandler'.\n[2017-12-19T10:32:08.600Z] Info : Received a new URL config from user. Parsing..\n[2017-12-19T10:32:08.620Z] Info : URL config parsed. SPA mode: UdpTcp, Name: CryptZone\n[2017-12-19T10:32:08.623Z] Info : Setting controller URL to 'https://purple.cryptzone.com/'.\n[2017-12-19T10:32:08.628Z] Info : No CA certificate found in storage. Retrieving from controller.\n[2017-12-19T10:32:08.631Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-12-19T10:32:08.673Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'CryptZone'.\n[2017-12-19T10:32:12.685Z] Info : Using Controller API V4\n[2017-12-19T10:32:12.728Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-12-19T10:32:12.732Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'CryptZone'.\n[2017-12-19T10:32:13.743Z] Info : Using Controller API V4\n[2017-12-19T10:32:13.762Z] Info : Storing new SPA config.\n[2017-12-19T10:32:13.941Z] Info : User input required for 'TrustCertificateLoginHandler'.\n[2017-12-19T10:32:17.372Z] Info : Certificate accepted. Storing it.\n[2017-12-19T10:32:17.476Z] Info : User input required for 'IdentityProviderLoginHandler'."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-6859",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This is to be able to download and verify the upgrade file in advance of the actual upgrade."
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  "
                    },
                    {
                      "type": "text",
                      "text": "POST /upgrade/prepare {\"image-url\": \"[file://..](file://..).\"}",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  "
                    },
                    {
                      "type": "text",
                      "text": "POST /upgrade {\"image-url\": \"file://<name>\"}",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " Will use a relative path to install the upgrade image previously prepared. This will also verify the upgrade file and run the actual upgrade. This returns with HTTP 202 and an upgrade id."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The image-url now supports specifying a controller with the "
                    },
                    {
                      "type": "text",
                      "text": "controller://<hostname>:<port>/<name>",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " scheme."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Download the upgrade file from the controller and verify it (checksum, signature etc...). This returns with HTTP 202 and an upgrade id."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "This API needs to be reflected on the controller on a per appliance level."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think checking signature is already enough by itself no?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1513250725216
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, how do we get the expected checksum?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1513250736820
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I think checking signature is already enough by itself no?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "True"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, how do we get the expected checksum?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It's already there in the zip."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1513253902992
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The cyxtera keyring is in /usr/share/keyrings/cyxtera-keyring.pgp"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "You need to pass it to gpg to use that one to verify the signature. (You probably need to rebase)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1513330130359
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1753",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1753"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Add POST /upgrade/prepare route. This will download the upgrade file but"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "not actually install it. The upgrade can be resumed from the installed upgrade"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "file later."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Added cz-config upgrade prepare flag to use this feature from the command line."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The cz-config upgrade command now waits for the upgrade to complete, printing the upgrade"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "status changes along the way."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Added cz-config upgrade no-wait flag to return to the previous behavior."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The upgrade now returns an error if the destination file for an upgrade file download already exists."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The upgrade download now supports downloading the upgrade file from a controller using appliance"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "authentication."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Example usage with cz-config:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Prepare"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-132-2:~# cz-config upgrade --prepare https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8105-master.img.zip?is-build-type-id\nUpgrade status changed to downloading: https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8105-master.img.zip?is-build-type-id\nUpgrade status changed to ready: /mnt/data/download/appgate-4.0.0-8105-master.img.zip"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Install"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-132-2:~# cz-config upgrade --no-reboot /mnt/data/download/appgate-4.0.0-8105-master.img.zip\n\nAppliance upgrade started using /mnt/data/download/appgate-4.0.0-8105-master.im\ng.zip...                                                                               \nUpgrade status changed to installing: /mnt/data/download/appgate-4.0.0-8105-master.img.zip\n\nAppliance upgrade done, a reboot is required for the upgrade to go into effect.                                                                               \nUpgrade status changed to success: a reboot is required for the upgrade to go into effect"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1513686975094
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1786",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1786"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-controller/pull/1267",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-controller/pull/1267"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1516177389872
      }
    ]
  },
  {
    "key": "SA-6802",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "1> Add help URLs for the pages in the manual. This will make it easy to maintain all manual related text and link in one place - and make sure things end up in the right place."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "So for the Sites example "
            },
            {
              "type": "text",
              "text": "https://help.cryptzone.com/adminguide/v3.3/sites-configure.html",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://help.cryptzone.com/adminguide/v3.3/sites-configure.html"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "2> Do something so it is easy to (automatically) to insert / change the the v3.3 according to the version being built?"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hum on the frontend it is easier if we keep the URL as it is right now. We are composing the URL on everypage using"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "const URL_base =  'https://help.cryptzone.com/adminguide'\nconst version = '3.3'\nconst directory = 'sites-configure'\n\nreturn final_URL = '{URL_base}/{version}/{directory}.html'"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " And we can also export these constants aside of the "
                },
                {
                  "type": "text",
                  "text": "helper-text.json",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1512564094480
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok but the version should be 3.3 in the above case as we don't plan on supporting point releases. So you would limit the version to x.y and strip any .z"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1513093241806
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes it is actually without the "
                },
                {
                  "type": "text",
                  "text": ".z",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " I don't know why I added it. I'll update"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1513093392057
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Move these variables into the json file at the top."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1513243687267
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Add language info"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1513245109542
      }
    ]
  },
  {
    "key": "SA-6721",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Clicking the custom URL through Windows 10 mail app delivers wrong base64 to AppGate. Apparently there is some mess with URL and base64. We probably need to URL\\"
            },
            {
              "type": "text",
              "text": "encode(base64(data)) or some trick of some sort to avoid the confusions",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2017-11-27T21:27:26.284Z] Info : UI has connected to service.\n[2017-11-27T21:27:26.448Z] Info : UI is ready.\n[2017-11-27T21:27:26.449Z] Info : UI connected.\n[2017-11-27T21:27:26.457Z] Info : Connecting to TUN driver.\n[2017-11-27T21:27:26.461Z] Info : Setting log level of TUN driver to Info.\n[2017-11-27T21:27:26.477Z] Info : Setting locale to en-US.\n[2017-11-27T21:27:26.531Z] Info : Received a URL config from storage. Parsing..\n[2017-11-27T21:27:26.533Z] Warn : Invalid URL config received. Invalid length for a Base-64 char array or string.. config: eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoiQ3J5cHRab25lIiwia2V5IjoiY2QzMzdiMmE1OTU1Yjg3OTk3YzlkYzRjNGRhZTM1ZDRmNTA1ZTE0ZmZhZWU3NWFlZjVhZDZhZjQ1M2M5ODgyOCJ9fQ\n[2017-11-27T21:27:26.534Z] Info : Setting controller URL to 'https://purple.cryptzone.com/'.\n[2017-11-27T21:27:26.544Z] Info : CA certificate found in the storage for 'purple.cryptzone.com'.\n[2017-11-27T21:27:26.548Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-11-27T21:27:26.634Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.209Z] Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.519Z] Error : First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\n[2017-11-27T21:27:27.523Z] Info : User input required for 'ControllerUrlLoginHandler'."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "On linux it seems to be passed correctly, I haven't seen such error, so I don't think it's related."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1511858899212
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " checked and confirmed"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "Roy.nard",
        "created": 1512986982655
      }
    ]
  },
  {
    "key": "SA-6501",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[16:14:19][Step 1/1] java (3s)\n[16:14:19][java] make[1]: Entering directory '/home/builderbob/buildAgent/work/81fe2044905f47d9/java'\n[16:14:19][java] fakeroot ./build.sh\n[16:14:19][java] --2017-10-30 15:14:20--  http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz\n[16:14:20][java] Resolving download.oracle.com (download.oracle.com)... 80.239.237.17, 80.239.237.8\n[16:14:20][java] Connecting to download.oracle.com (download.oracle.com)|80.239.237.17|:80... connected.\n[16:14:20][java] HTTP request sent, awaiting response... 302 Moved Temporarily\n[16:14:20][java] Location: https://edelivery.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz [following]\n[16:14:20][java] --2017-10-30 15:14:20--  https://edelivery.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz\n[16:14:20][java] Resolving edelivery.oracle.com (edelivery.oracle.com)... 2.23.151.234, 2a02:26f0:18:499::2d3e, 2a02:26f0:18:489::2d3e\n[16:14:20][java] Connecting to edelivery.oracle.com (edelivery.oracle.com)|2.23.151.234|:443... connected.\n[16:14:20][java] HTTP request sent, awaiting response... 302 Moved Temporarily\n[16:14:20][java] Location: http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz?AuthParam=1509376580_943c57005242c86ea2e8833269dbd91e [following]\n[16:14:20][java] --2017-10-30 15:14:20--  http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz?AuthParam=1509376580_943c57005242c86ea2e8833269dbd91e\n[16:14:20][java] Connecting to download.oracle.com (download.oracle.com)|80.239.237.17|:80... connected.\n[16:14:23][java] HTTP request sent, awaiting response... 404 Not Found\n[16:14:23][java] 2017-10-30 15:14:23 ERROR 404: Not Found.\n[16:14:23][java]\n[16:14:23][java] make[1]: *** [package] Error 8"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This is a file and not an APT package so that would need to be hosted on some file server."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1509439380308
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I see it's http as well, no https link available from oracle?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1509439407353
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https works fine too actually, but no real point in using it as we check against checksum anyway"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1509610358362
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "From where do we get the ckecksum, so that we can do the comparison actually? Obviously if it is downloaded as well from the internetz through http then doesn't add any security..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1509612030455
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We use the checksum provided by Oracle, which we check manually each time."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1509612917569
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://www.oracle.com/webfolder/s/digest/8u151checksum.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.oracle.com/webfolder/s/digest/8u151checksum.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1509613070253
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We could host the binaries in nexus (akira) which seems to have binary capabilities."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1510216049265
      }
    ]
  },
  {
    "key": "SA-6465",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2017-10-25T14:10:33.714Z] Info : Recieved requested configuration '{\n  \"username\": null,\n  \"password\": null,\n  \"controllerurl\": \"appgate://envy-172-17-114-1.devops/eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoidGVzdCIsImtleSI6ImIxZTM4ZmE0MDRjNTZmNjI4NDc1MmUxYzQ3ZTVlNjcxNzdjNjhlOGJmNmQ4N2VkMjAwMTNlZTU5NDc4MDdhZWIifX0=\",\n  \"identityProvider\": null,\n  \"trustedCertificatePath\": null,\n  \"authenticationCertificateName\": null,\n  \"authenticationCertificatePassword\": null\n}'\n[2017-10-25T14:10:33.794Z] Info : Trying to connect 'envy-172-17-114-1.devops/172.17.114.1' with SPA UdpTcp and key name 'test'.\n[2017-10-25T14:10:37.199Z] Info : Using Controller API V4\n[2017-10-25T14:10:37.199Z] Info : Storing new SPA config.\n[2017-10-25T14:10:37.209Z] Info : Certificate is already trusted. Moving on..\n[2017-10-25T14:10:37.309Z] Info : Retrieving provider names from controller.\n[2017-10-25T14:10:37.349Z] Info : Provider names: [AD, local]\n[2017-10-25T14:10:37.349Z] Info : User input required for 'IdentityProviderLoginHandler'.\n[2017-10-25T14:10:37.349Z] Info : Provider 'local' selected.\n[2017-10-25T14:10:37.449Z] Info : User input required for 'ConnectCredentialsLoginHandler'.\n[2017-10-25T14:10:37.449Z] Info : Logging in using 'local'.\n[2017-10-25T14:10:37.459Z] Info : Authenticating for the first time. RememberMe: False, Credentials: [Username '']\n[2017-10-25T14:10:37.459Z] Info : Retrieving claims token.\n[2017-10-25T14:10:37.469Z] Info : Fetching on-boarding cookie for 'OnBoardingCookie-66:aa:47:ad:6e:ba:b0:aa:99:4c:9a:ff:75:fb:39:5d:ec:82:58:a5:b3:4a:f6:4d:c3:6e:61:c1:28:29:2b:d3-local-' from secure storage.\n[2017-10-25T14:10:37.469Z] Info : No on-boarding cookie found.\n[2017-10-25T14:10:37.559Z] Warn : Controller 'https://envy-172-17-114-1.devops/' rejected authentication on login."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, after that it rejects any connection attempts from plap."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1508946750330
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\[2017-10-26T07:51:57Z\\] Warn : \\[ConnectableCredential::ConnectAndCheckConfiguration:453\\] Service is not correctly configured\n\n\\[2017-10-26T07:51:57Z\\] Error : \\[ConnectableCredential::GetSerialization:675\\] There was an error with status '5' during login to AppGate"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1509004373309
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok, failure turned out to be irrelevant. However, authenticating with empty username is not a good idea. Maybe it's not audit logged (because of empty username) but still, each PLAP client will basically spam the controller for no reason."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1509009395124
      }
    ]
  },
  {
    "key": "SA-6340",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Oct 12 06:53:23 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] SaveStateLabelAction done\nOct 12 06:53:23 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"POST /configuration HTTP/1.0\" 204 0 \"\" \"Service.Management (appliance-connector)\" 460\nOct 12 06:53:24 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 562 \"\" \"Service.Management (appliance-connector)\" 433\nOct 12 06:53:53 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"POST /event HTTP/1.0\" 204 0 \"\" \"python-requests/2.14.2\" 0\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO [StateMachine] Received event BDRNodeKickedEvent(pull_config=False, delay=10), transitioning from state waiting_bdr_removal to appliance_ready\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO Leaving BDR group and disabling controller\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] Running action LeaveBDRGroupAction(node_name='envy-172-17-100-2.devops') ...\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO [LeaveBDRGroupAction] Leaving BDR group...\nOct 12 06:54:01 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr extension in database controller_authorization\nOct 12 06:54:01 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping btree_gist extension in database controller_authorization\nOct 12 06:54:08 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr extension in database controller_identity\nOct 12 06:54:08 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping btree_gist extension in database controller_identity\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr extension in database controller_management\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping btree_gist extension in database controller_management\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr supervisor database\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] LeaveBDRGroupAction done\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] Running action ApplyServicesAction(force=True) ...\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [ApplyServicesAction] Applying services configuration with current configuration /mnt/state/config/20171012-065323-ek6hq45n and previous configurat\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-proxyd stop (reason: base system, service is disabled)\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] postgresql@9.4-main stop (reason: controller, service is disabled)\nOct 12 06:54:13 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 521 \"\" \"Service.Management (appliance-connector)\" 408\nOct 12 06:54:18 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-authd stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-authord stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-identityd stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-managed stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-elasticrestore start (reason: log server, service is enabled, required files are present)\nOct 12 06:54:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 511 \"\" \"Service.Management (appliance-connector)\" 171\nOct 12 06:55:21 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 521 \"\" \"Service.Management (appliance-connector)\" 408\nOct 12 06:56:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 161\nOct 12 06:57:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 161\nOct 12 06:58:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 162\nOct 12 06:59:21 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 521 \"\" \"Service.Management (appliance-connector)\" 409\nOct 12 07:00:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 165\nOct 12 07:01:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 163\nOct 12 07:02:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 163\nOct 12 07:03:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 165\nOct 12 07:04:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 159\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Stopping AppGate appliance configuration daemon...\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Stopped AppGate appliance configuration daemon.\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Starting AppGate appliance configuration daemon...\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Started AppGate appliance configuration daemon.\nOct 12 07:05:19 envy-172-17-100-2.devops cz-configd[8370]: INFO [logger] Set log level to info\nOct 12 07:05:19 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting configuration daemon...\nOct 12 07:05:19 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Loading appliance configuration plugin stratus...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting State Machine...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] Running action InitStateMachineAction(recovery_state='waiting_bdr_removal') ...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting JsonRPCActor service...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [JsonRPCEventsActor] Spawning config control thread...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [JsonRPCEventsActor] Waiting for requests...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] InitStateMachineAction done\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] Chaining event InitStateMachineEvent(recovery_state='waiting_bdr_removal', has_inbox=False)\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [StateMachine] Received event InitStateMachineEvent(recovery_state='waiting_bdr_removal', has_inbox=False), transitioning from state init to waiting\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] Running action ApplyServicesAction(force=True) ...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting Seeding Thread service...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting REST service on main thread...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [rest] Starting REST service on http://unix:/run/cz-configd/configd.socket ...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ApplyServicesAction] Applying services configuration with current configuration /mnt/state/config/20171012-065323-ek6hq45n and previous configurati\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: serving on http://unix:/run/cz-configd/configd.socket\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [service] cz-elasticrestore start (reason: log server, service is enabled, required files are present)\nOct 12 07:05:21 envy-172-17-100-2.devops cz-configd[8370]: INFO [rest] \"GET /status HTTP/1.0\" 200 509 \"\" \"Service.Management (appliance-connector)\" 426"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Same happened to "
                },
                {
                  "type": "text",
                  "text": "Jamie Bodley-Scott",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/jamie.bodley-scott",
                        "title": "jamie.bodley-scott"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " with waiting\\"
                },
                {
                  "type": "text",
                  "text": "bdr\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "joining."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1510910984231
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "One solution would be to not save these two states to"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1517569620108
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "One solution would be to not save these two states to disk."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1517569620108
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1853",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1853"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1517569947221
      }
    ]
  },
  {
    "key": "SA-6217",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "<13>Sep 28 12:10:29 cz-restore: Restoring ElasticSearch...\nElasticsearch is up, starting restore procedure\nThu Sep 28 12:10:29 UTC 2017\nRestoring: logstash-2017.09.27_restore\nUrl: http://localhost:9300/logstash-2017.09.27_restore\nGot none accepted status during put 400\npayload: {\"mappings\": {\"default\": {\"properties\": {\"geoip\": {\"dynamic\": true, \"type\": \"object\", \"properties\": {\"ip\": {\"type\": \"ip\"}, \"location\": {\"type\": \"geo_point\"}}}, \"@timestamp\": {\"type\": \"date\"}, \"message\": {\"index\": \"analyzed\", \"type\": \"string\"}}}}}\nTraceback (most recent call last):\n  File \"/usr/cz-elasticsearch/scripts/backup_restore.py\", line 216, in <module>\n    main()\n  File \"/usr/cz-elasticsearch/scripts/backup_restore.py\", line 213, in main\n    put_everything(args, \"http://localhost:9300\")\n  File \"/usr/cz-elasticsearch/scripts/backup_restore.py\", line 81, in put_everything\n    payload_with_meta = json.loads(line)\n  File \"/usr/lib/python3.5/json/init.py\", line 319, in loads\n    return _default_decoder.decode(s)\n  File \"/usr/lib/python3.5/json/decoder.py\", line 339, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n  File \"/usr/lib/python3.5/json/decoder.py\", line 357, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nThu Sep 28 12:10:29 UTC 2017\nDb restore done\n<13>Sep 28 12:10:29 cz-restore: The services will be running again momentarily\nroot@envy-172-17-140-1:/mnt/data# "
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I of course can't replicate this on my env"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1507204824390
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I tried both normal and HA"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1507204837672
      }
    ]
  },
  {
    "key": "SA-6150",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Right now it can be hard to see what id corresponds to what test:"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "thomas@thomas:~$ for client in linux windows osx fedora android; do aitorbot test create -d aitorbot 403 --client $client -t testing_aitorbot_on_$client; done\nthomas:\nid:   eb550063-0a52-49c9-9225-3521cf4609d6\nurl:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309530\nthomas:\nid:   b440c81b-9a35-4ede-b1fb-dfa58e661e7e\nurl:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309536\nthomas:\nid:   7d1e416f-03f5-475e-9a23-501f9c040765\nurl:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309541\nthomas:\nid:   575b35a8-dfeb-4bb1-984f-8d723e1aacab\nurl:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309545\nthomas:\nid:   d9b10fcb-45db-41c8-a5e0-8c83d5c04ffa\nurl:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309549"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-6145",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Err:4 https://dl.yarnpkg.com/debian stable InRelease             \n  The following signatures couldn't be verified because the public key is not available: NO_PUBKEY E074D16EB6FF4DE3\nGet:6 https://deb.nodesource.com/node_6.x stretch/main amd64 Packages [1005 B]                                                                                                        \nFetched 17.1 kB in 6s (2719 B/s) "
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "could you give some background here "
                },
                {
                  "type": "text",
                  "text": "Salvatore Tomaselli",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                        "title": "salvatore.tomaselli"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1507542489744
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I tried to run updates on the chroot. This is needed since we statically link stuff, so we might need the security fixes that get released later on."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1507551585395
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "aha ok. generally we create chroot from scratch, so not a big deal."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1507552079091
      }
    ]
  },
  {
    "key": "SA-12019",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We sitll have problems with the radix search stuff for url access, e.g. \\"
            },
            {
              "type": "text",
              "text": "/tests-dev\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " conflicts with \\"
            },
            {
              "type": "text",
              "text": "/tests/status\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ". I set up 2 different entitlements for \\"
            },
            {
              "type": "text",
              "text": "aitorbot\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " and \\"
            },
            {
              "type": "text",
              "text": "aitorbot --dev-mode\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": ". Adding the separate \\"
            },
            {
              "type": "text",
              "text": "/tests-dev\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " entitlement results in: \\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "403 Forbidden"
            }
          ],
          "attrs": {
            "level": 1
          }
        },
        {
          "type": "rule"
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "nginx"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "\\"
            },
            {
              "type": "text",
              "text": "\\",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": "\\"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "kosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-contrib/nginx$ aitorbot env show\nCojones! GET /executions HTTP 401: <html>\n<head><title>401 Authorization Required</title></head>\n<body>\n<center><h1>401 Authorization Required</h1></center>\n<hr><center>nginx</center>\n</body>\n</html>\n\nkosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-contrib/nginx$ aitorbot env show\nkosmas-valianos [] | 2019-09-17 13:51:51\nid:      11587a4e-7b94-498c-bd21-95a37215a810\nstate:    finished-execution\nappliance build from beta[#15605] https://teamcity.ad.cryptzone.com/viewLog.html?buildId=429226&buildTypeId=StratusAppliance_BuildStratusAppliance_2\nscenario: simple_v4\nkeep on error: False\nnodes:\ncontroller\nroles:   controller, logserver\nweb ui:  https://envy-172-17-150-1.devops:444\nconnect: appgate://envy-172-17-150-1.devops\nstatus:  Running\nip:      172.17.150.1\nnetwork: 172.17.150.0/24\nhostname: envy-172-17-150-1.devops\nadmin username: admin\nadmin password: admin\ngateway\nroles:   gateway\nstatus:  Running\nip:      172.17.150.2\nnetwork: 172.17.150.0/24\nhostname: envy-172-17-150-2.devops\nendpoint\nroles:   endpoint\nstatus:  Running\nip:      172.17.157.2\nnetwork: 172.17.157.0/24\nhostname: envy-172-17-157-2.devops\nkosmas@kosmas-CELSIUS-W530-Power:~/git/stratus-contrib/nginx$"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1568733946710
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I can confirm it works fine for me too now."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1568790033727
      }
    ]
  },
  {
    "key": "SA-12106",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Remember is undefined, "
            },
            {
              "type": "text",
              "text": "Failed to sign in with credentials. Mot de passe ou nom d'utilisateur incorrect",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " And raises a warning when updated "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Warning: A component is changing an uncontrolled input of type checkbox to be controlled. Input elements should not switch from uncontrolled to controlled (or vice versa). Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://fb.me/react-controlled-components\n    in input (created by CredentialsLogin)\n    in div (created by CredentialsLogin)\n    ..."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-12125",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "36:16]\n[rsyslog] E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/m/mysql-5.7/libmysqlclient20_5.7.26-0ubuntu0.18.04.1_amd64.deb  404  Not Found [IP: 194.71.11.173 80]\n[08:36:16]\n[rsyslog] E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/m/mysql-5.7/libmysqlclient-dev_5.7.26-0ubuntu0.18.04.1_amd64.deb  404  Not Found [IP: 194.71.11.173 80]\n[08:36:16]\n[rsyslog] E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/c/curl/libcurl4-gnutls-dev_7.58.0-2ubuntu3.7_amd64.deb  404  Not Found [IP: 194.71.11.173 80]\n[08:36:16]\n[rsyslog] E: Failed to fetch http://security.ubuntu.com/ubuntu/pool/universe/z/zeromq3/libzmq3-dev_4.2.5-1ubuntu0.1_amd64.deb  404  Not Found [IP: 194.71.11.173 80]```"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Probably just needs an apt-get update before."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-12162",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Initial crappy attempt, note the 0.0.0.0 ip: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "sep 26 16:53:47 thomas appgate-sdp[12111]: Info : Updating tokens at gateway 'envy-172-17-142-3.devops'.\nsep 26 16:53:47 thomas appgate-sdp[12111]: Error : Client update download error: http://0.0.0.0:8000/appgate_5.0.0%2B17610%2Bbeta_amd64.deb , System.Net.WebException: IPv4 address 0.0.0.0 and IPv6 address ::0 are unspecified addresses that cannot be used as a target address.\n                                           Parameter name: hostName IPv4 address 0.0.0.0 and IPv6 address ::0 are unspecified addresses that cannot be used as a target address.\n                                           Parameter name: hostName ---> System.Net.Http.HttpRequestException: IPv4 address 0.0.0.0 and IPv6 address ::0 are unspecified addresses that cannot be used as a target address.\n                                           Parameter name: hostName ---> System.ArgumentException: IPv4 address 0.0.0.0 and IPv6 address ::0 are unspecified addresses that cannot be used as a target address.\n                                           Parameter name: hostName\n                                              at System.Net.Dns.HostResolutionBeginHelper(String hostName, Boolean justReturnParsedIp, Boolean throwOnIIPAny, AsyncCallback requestCallback, Object state)\n                                              at System.Net.Dns.BeginGetHostAddresses(String hostNameOrAddress, AsyncCallback requestCallback, Object state)\n                                              at System.Net.Sockets.MultipleConnectAsync.StartConnectAsync(SocketAsyncEventArgs args, DnsEndPoint endPoint)\n                                              at System.Net.Sockets.Socket.ConnectAsync(SocketType socketType, ProtocolType protocolType, SocketAsyncEventArgs e)\n                                              at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)\n                                              --- End of inner exception stack trace ---\n                                              at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)\n                                              at System.Threading.Tasks.ValueTask1.get_Result()                                               at System.Net.Http.HttpConnectionPool.CreateConnectionAsync(HttpRequestMessage request, CancellationToken cancellationToken)                                               at System.Threading.Tasks.ValueTask1.get_Result()\n                                              at System.Net.Http.HttpConnectionPool.WaitForCreatedConnectionAsync(ValueTask1 creationTask)                                               at System.Threading.Tasks.ValueTask1.get_Result()\n                                              at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean doRequestAuth, CancellationToken cancellationToken)\n                                              at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)\n                                              at System.Net.Http.HttpClient.FinishSendAsyncUnbuffered(Task1 sendTask, HttpRequestMessage request, CancellationTokenSource cts, Boolean disposeCts)                                               at System.Net.HttpWebRequest.SendRequest()                                               at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)                                               --- End of inner exception stack trace ---                                               at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)                                               at System.Net.WebClient.GetWebResponse(WebRequest request, IAsyncResult result)                                               at System.Net.WebClient.GetWebResponseTaskAsync(WebRequest request)                                               at System.Net.WebClient.DownloadBitsAsync(WebRequest request, Stream writeStream, AsyncOperation asyncOp, Action3 completionDelegate)\nsep 26 16:53:47 thomas appgatedriver[23932]: Deployment update successful"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Second attempt with a valid URL, no go :( "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "sep 26 16:56:15 thomas appgate-sdp[12111]: Info : 1 new entitlement token(s) retrieved.\nsep 26 16:56:15 thomas appgate-sdp[12111]: Info : Entitlements for 'Default Site': endpoint\nsep 26 16:56:15 thomas appgate-sdp[12111]: Info : Starting downloading package to '/tmp/.appgatesdp-updates-j2qscpom.piv/appgate_5.0.0+17610+beta_amd64.deb' from 'http://thomas0.ad.cryptzone.com:8000/appgate_5.0.0%2B17610%2Bbeta_amd64.deb'.\nsep 26 16:56:15 thomas appgate-sdp[12111]: Info : New entitlement token supplied for gateway 'envy-172-17-142-3.devops'. Will send it.\nsep 26 16:56:15 thomas appgate-sdp[12111]: Info : Checking next CA certificate.\nsep 26 16:56:15 thomas appgate-sdp[12111]: Error : Error during downloading file. An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance. An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance.\nsep 26 16:56:15 thomas appgate-sdp[12111]: Warn : File download possibly failed due to: An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance.\nsep 26 16:56:15 thomas appgate-sdp[12111]: Error : Client update download error: http://thomas0.ad.cryptzone.com:8000/appgate_5.0.0%2B17610%2Bbeta_amd64.deb , System.Net.WebException: An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance. An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance. ---> System.Net.Http.HttpRequestException: An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance. ---> System.InvalidOperationException: An asynchronous socket operation is already in progress using this SocketAsyncEventArgs instance.\n                                              at System.Net.Sockets.SocketAsyncEventArgs.ThrowForNonFreeStatus(Int32 status)\n                                              at System.Net.Sockets.SocketAsyncEventArgs.StartOperationCommon(Socket socket, SocketAsyncOperation operation)\n                                              at System.Net.Sockets.Socket.ConnectAsync(SocketType socketType, ProtocolType protocolType, SocketAsyncEventArgs e)\n                                              at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)\n                                              --- End of inner exception stack trace ---\n                                              at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)\n                                              at System.Threading.Tasks.ValueTask1.get_Result()                                               at System.Net.Http.HttpConnectionPool.CreateConnectionAsync(HttpRequestMessage request, CancellationToken cancellationToken)                                               at System.Threading.Tasks.ValueTask1.get_Result()\n                                              at System.Net.Http.HttpConnectionPool.WaitForCreatedConnectionAsync(ValueTask1 creationTask)                                               at System.Threading.Tasks.ValueTask1.get_Result()\n                                              at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean doRequestAuth, CancellationToken cancellationToken)\n                                              at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)\n                                              at System.Net.Http.HttpClient.FinishSendAsyncUnbuffered(Task1 sendTask, HttpRequestMessage request, CancellationTokenSource cts, Boolean disposeCts)                                               at System.Net.HttpWebRequest.SendRequest()                                               at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)                                               --- End of inner exception stack trace ---                                               at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)                                               at System.Net.WebClient.GetWebResponse(WebRequest request, IAsyncResult result)                                               at System.Net.WebClient.GetWebResponseTaskAsync(WebRequest request)                                               at System.Net.WebClient.DownloadBitsAsync(WebRequest request, Stream writeStream, AsyncOperation asyncOp, Action3 completionDelegate)\nsep 26 16:56:15 thomas appgate-sdp[12111]: Info : No next CA certificate in the system."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "A client restart is required to actually get the update file."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "interesting"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1569520433584
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Doing dispose, resetting etc did nothing. We need to rip this WebClient out and replace it with HttpClient for next release."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "manuel.moraga",
        "created": 1569832229375
      }
    ]
  },
  {
    "key": "SA-12171",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "After login with credentials and trying to access a resource that requires SAML password remedy user interaction, the SAML flow is triggered but then nothing happens on the client as the SAML Remedy cards remains the same and no access to the resource is granted."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "IMPORTANT: A login using SAML were performed before this test, so there was no need to retype SAML credentials on Remedy Action."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](image.png)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "![](image1.png)"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tested with: Version: 5.0.0-18586-beta"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "arturo.garcia",
        "created": 1569595562190
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "could you upload the logs?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1569595668102
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[2019-09-27T14:48:01.374Z] Info : Starting HTTP Server to receive SAML token.\n[2019-09-27T14:48:01.374Z] Info : Starting the browser to https://adfs-test.czse.local/adfs/ls/idpinitiatedsignon?SAMLRequest=fZDBSgMxEEDvfkWY%2B9YkTW0zbFIKIizoRasHLyVNs7qwm9RMVvx8V6tQLx4HhvfeTL3%2BGHr2HjJ1KRoQMw4sRJ8OXXwx8Li9qVawthc1uaGXR9yM5TXeh7cxUGHNtYFdq%2BervfRXcxWEF1q2wnOn2pbvAw9KamAN0RiaSMXFYkByoSuuK7ncCoVqiYvFTCr1DOzpN0J%2BRUxZkfCkNTDmiMlRRxjdEAiLx4fN3S1Oq3jMqSSferCnSvwW5nPC%2FwBHFHKZ1GDdoaVdmY6rL89Z9mf8%2BwD7CQ%3D%3D.\n[2019-09-27T14:48:05.644Z] Info : A new HTTP connection has been opened to the client.\n[2019-09-27T14:48:05.644Z] Info : Parsed HTTP header. Waiting for payload.\n[2019-09-27T14:48:05.644Z] Info : Received SAML token. Will send it to controller.\n[2019-09-27T14:48:05.645Z] Info : Sending Password to controller. [ClaimSuffix: 'ClaimSuffix username, ProviderId c629c2b9-977d-45d0-8b49-37b0f981a465, EntitlementName ']]\n[2019-09-27T14:48:06.057Z] Error : Request to controller during Password authentication has been rejected. Reason: (HTTP 401) Unauthorized"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "arturo.garcia",
        "created": 1569595756489
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "hmm, looks like controller didn't accept the token. The username from the SAML provider needs to match the username you used during login. Probably because of that. Try it like that."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Not showing a SAML error seems to be a regression though, so that's still a bug."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1569595985957
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeah, it worked using same username as SAML when login. local: test1 - saml: test1 works!"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "arturo.garcia",
        "created": 1569596422836
      }
    ]
  },
  {
    "key": "SA-12200",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The problem is that it sometimes deploys new CA old VPN cert to tun driver."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:00,648840Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:00.252Z] Info : TUN driver rejected the gateway certificate. Will check for the next CA certificate. [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:02,753549Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.338Z] Info : SSL certificate of controller 'envy-fd00-ffff-a-302-172-17-302-1.devops' was not accepted. Trying the next CA certificate stored in the system. [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:02,754634Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.341Z] Info : Resolving hostname 'envy-fd00-ffff-a-302-172-17-302-1.devops' [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:02,756793Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.344Z] Info : Trying to connect 'envy-fd00-ffff-a-302-172-17-302-1.devops/fd00:ffff:a:302::1' with SPA key name 'Built-in-be85360895242'. [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,024851Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:02.923Z] Info : [simple_setup Site] Connecting to TLS://[fd00:ffff:a:302::2]:443 ... [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,025850Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:02.924Z] Info : [simple_setup Site] Client DN: CN=ed3d2a428072e3776f3e761be8d4a149,CN=bob,OU=local [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,026849Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:02.925Z] Info : [simple_setup Site] Verification enabled for envy-fd00-ffff-a-302-172-17-302-2.devops [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,337103Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:02.927Z] Info : [simple_setup Site] Sending SPA-DNS/DTLS packets [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,338179Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.234Z] Info : [simple_setup Site] Stopped sending SPA-DNS/DTLS packets [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,338179Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.246Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,338179Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.249Z] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"staticid\", \"sites\": { \"simple_setup Site\": {\"gw-id\": \"gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1\", \"status\": \"down\", \"error\": \"Certificate error: server sent no valid certificate - self signed certificate in certificate chain\", \"code\": 8}} }}> [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,339275Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.251Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,360513Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.863Z] Info : Using Controller API V4 [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,361590Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.863Z] Info : Next CA certificate is in use. Migrating storage. [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,361590Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.881Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-ldap_cert-user1-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-ldap_cert-user1-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,361590Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.891Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-local-bob1-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-local-bob1-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:03] : [Step 1/1]  [35m    2019-10-02T05:12:03,362676Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.909Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-ldap-stratus1001-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-ldap-stratus1001-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,363756Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.926Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-adfs-test1-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-adfs-test1-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,363756Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.944Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-ldap-stratus1000-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-ldap-stratus1000-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,363756Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.969Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-local-bob-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-local-bob-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,365918Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:02.986Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-local-test1-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-local-test1-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,366998Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.003Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-local-bob0-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-local-bob0-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,368082Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.027Z] Info : Renaming credential '$AppGateSDP:onboardingcookie-3c:4b:b1:d3:6b:7b:38:02:e2:ed:78:b4:38:f0:dc:ed:2b:f5:9b:b7:db:7b:86:77:f5:d9:5c:73:db:71:3c:08-ldap-stratus1002-ed3d2a42-8072-e377-6f3e-761be8d4a149' to '$AppGateSDP:onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-ldap-stratus1002-ed3d2a42-8072-e377-6f3e-761be8d4a149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,369162Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.048Z] Info : Retrieving claims token. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,369162Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.049Z] Info : Fetching on-boarding cookie for 'onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-local-bob-ED3D2A42-8072-E377-6F3E-761BE8D4A149' from secure storage. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,370168Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.056Z] Info : On-boarding cookie available for 'onboardingcookie-35:57:3b:ea:46:cf:4e:61:be:03:1c:f1:92:60:76:72:73:d8:f5:d8:d1:22:d6:db:63:dc:37:0e:fe:33:2b:2c-local-bob-ED3D2A42-8072-E377-6F3E-761BE8D4A149'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,370168Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.097Z] Info : Authentication succeeded. Claims Token: [TokenId: 84f8d4bc-441d-4ff2-89e4-dee62553a8bf, DistinguishedName: CN=ed3d2a428072e3776f3e761be8d4a149,CN=bob,OU=local, FirstName: Bobby, LastName: Tables, ExpirationTime: 2019-10-03 07:12:00], On-demand Claims: [[]], Device Scripts: [[]] [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,371250Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.098Z] Info : New claims token [84f8d4bc-441d-4ff2-89e4-dee62553a8bf] supplied for gateway 'envy-fd00-ffff-a-302-172-17-302-2.devops'. Will send it. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,371250Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.278Z] Info : Processing on-demand Claims: [] [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,372335Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.281Z] Info : Retrieving entitlement tokens. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,372335Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.344Z] Info : 1 new entitlement token(s) retrieved. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,372335Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.344Z] Info : Entitlements for 'simple_setup Site': simple_setup_ENT_HTTP, simple_setup_ENT_PING [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,373420Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.345Z] Info : New entitlement token supplied for gateway 'envy-fd00-ffff-a-302-172-17-302-2.devops'. Will send it. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,373420Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.345Z] Info : Checking next CA certificate. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,374491Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.346Z] Info : Existing REST connection lost. Reconnecting. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,374491Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.346Z] Info : Resolving hostname 'envy-fd00-ffff-a-302-172-17-302-1.devops' [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:03,375573Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.346Z] Info : Trying to connect 'envy-fd00-ffff-a-302-172-17-302-1.devops/fd00:ffff:a:302::1' with SPA key name 'Built-in-be85360895242'. [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:04,066539Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.963Z] Info : Got request from client <{\"jsonrpc\":\"2.0\",\"method\":\"deploy\",\"params\":{\"clientp12\":\"\",\"cacert\":\"\",\"sites\":[{\"id\":\"simple_setup Site\",\"ip4\":\"15.0.0.0\",\"ip6\":\"2001:db8:0:0:0:0:1400:0\",\"gateways\":[{\"id\":\"gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1\",\"address\":\"envy-fd00-ffff-a-302-172-17-302-2.devops:443\",\"protocol\":\"tls\",\"weight\":100}],\"entitlement-based-routing\":false,\"routes\":[\"fd00:ffff:a:303::/64\"],\"excluded-routes\":[],\"spa\":{\"mode\":\"udp-tcp\",\"name\":\"74f2c610-ec4c-4398-b8d8-8a0eff3a6bcb\",\"key\":\"*\"}}],\"id\":\"staticid\",\"dns-servers\":[],\"dns-search-domains\":[],\"controllers\":[\"envy-fd00-ffff-a-302-172-17-302-1.devops:443\"],\"block-local-dns\":false,\"ringfence-rules\":[],\"verify-firewall\":true,\"verify-routes\":true}}> [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:04,066622Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.968Z] Warn : Certificate validation failure - error:0407008A:rsa routines:RSA_padding_check_PKCS1_type_1:invalid padding (407008a) [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:04,066622Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.970Z] Warn : Error when handling request: Certificate validation failure - invalid padding (7) [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:04,067708Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:03.971Z] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"error\": { \"code\": 7, \"message\": \"Certificate validation failure - invalid padding\" }, \"id\": null}> [0m\n[07:12:04] : [Step 1/1]  [35m    2019-10-02T05:12:04,479465Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.961Z] Info : REST connection could not be established. 'Connection failed.'. Will try the next IP address. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:04,479465Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.961Z] Error : Connection to controller 'https://envy-fd00-ffff-a-302-172-17-302-1.devops/' has failed. Reason: Connection failed. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:04,479465Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.976Z] Warn : TUN driver returned error 'BadCertificate'. Message: Certificate validation failure - invalid padding [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:04,480533Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:03.976Z] Info : TUN driver rejected the VPN certificate with 'Certificate validation failure - invalid padding'. Will renew it. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,023036Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:05.920Z] Info : [simple_setup Site] Connecting to TLS://[fd00:ffff:a:302::2]:443 ... [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,023036Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:05.922Z] Info : [simple_setup Site] Client DN: CN=ed3d2a428072e3776f3e761be8d4a149,CN=bob,OU=local [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,024119Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:05.923Z] Info : [simple_setup Site] Verification enabled for envy-fd00-ffff-a-302-172-17-302-2.devops [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,340491Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:05.925Z] Info : [simple_setup Site] Sending SPA-DNS/DTLS packets [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,340491Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:06.236Z] Info : [simple_setup Site] Stopped sending SPA-DNS/DTLS packets [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,340491Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:06.252Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,341591Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:06.254Z] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"staticid\", \"sites\": { \"simple_setup Site\": {\"gw-id\": \"gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1\", \"status\": \"down\", \"error\": \"Certificate error: server sent no valid certificate - self signed certificate in certificate chain\", \"code\": 8}} }}> [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,342682Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:06.255Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:06,585539Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:06.257Z] Info : TUN driver rejected the gateway certificate. Will check for the next CA certificate. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:07,688761Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:07.387Z] Info : SSL certificate of controller 'envy-fd00-ffff-a-302-172-17-302-1.devops' was not accepted. Trying the next CA certificate stored in the system. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:07,688761Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:07.388Z] Info : No next CA certificate found. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:07,689844Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:07.388Z] Info : Checking next CA certificate. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:07,689844Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:07.388Z] Info : Resolving hostname 'envy-fd00-ffff-a-302-172-17-302-1.devops' [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:07,689844Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:07.391Z] Info : Trying to connect 'envy-fd00-ffff-a-302-172-17-302-1.devops/fd00:ffff:a:302::1' with SPA key name 'Built-in-be85360895242'. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:08,294611Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:07.923Z] Info : No next CA certificate in the system. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,027832Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:08.925Z] Info : [simple_setup Site] Connecting to TLS://[fd00:ffff:a:302::2]:443 ... [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,028920Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:08.926Z] Info : [simple_setup Site] Client DN: CN=ed3d2a428072e3776f3e761be8d4a149,CN=bob,OU=local [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,028920Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:08.928Z] Info : [simple_setup Site] Verification enabled for envy-fd00-ffff-a-302-172-17-302-2.devops [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,334322Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:08.930Z] Info : [simple_setup Site] Sending SPA-DNS/DTLS packets [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,335321Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:09.231Z] Info : [simple_setup Site] Stopped sending SPA-DNS/DTLS packets [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,336395Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:09.242Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,336395Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:09.244Z] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"staticid\", \"sites\": { \"simple_setup Site\": {\"gw-id\": \"gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1\", \"status\": \"down\", \"error\": \"Certificate error: server sent no valid certificate - self signed certificate in certificate chain\", \"code\": 8}} }}> [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,337480Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:09.245Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,398177Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:09.247Z] Info : TUN driver rejected the gateway certificate. Will check for the next CA certificate. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,399258Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:09.334Z] Info : SSL certificate of controller 'envy-fd00-ffff-a-302-172-17-302-1.devops' was not accepted. Trying the next CA certificate stored in the system. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:09,399258Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:09.336Z] Info : No next CA certificate found. [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:12,027219Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:11.924Z] Info : [simple_setup Site] Connecting to TLS://[fd00:ffff:a:302::2]:443 ... [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:12,027219Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:11.926Z] Info : [simple_setup Site] Client DN: CN=ed3d2a428072e3776f3e761be8d4a149,CN=bob,OU=local [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:12,028302Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:11.927Z] Info : [simple_setup Site] Verification enabled for envy-fd00-ffff-a-302-172-17-302-2.devops [0m\n[07:12:12] : [Step 1/1]  [35m    2019-10-02T05:12:12,344645Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:11.929Z] Info : [simple_setup Site] Sending SPA-DNS/DTLS packets [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,344680Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:12.240Z] Info : [simple_setup Site] Stopped sending SPA-DNS/DTLS packets [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,344680Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:12.251Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,345762Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:12.253Z] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"staticid\", \"sites\": { \"simple_setup Site\": {\"gw-id\": \"gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1\", \"status\": \"down\", \"error\": \"Certificate error: server sent no valid certificate - self signed certificate in certificate chain\", \"code\": 8}} }}> [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,345762Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-02T05:12:12.254Z] Info : [simple_setup Site] [gateway-7d680dad-0080-4ab6-9989-7646be57e840-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,504920Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:12.257Z] Info : TUN driver rejected the gateway certificate. Will check for the next CA certificate. [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,504920Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:12.355Z] Info : SSL certificate of controller 'envy-fd00-ffff-a-302-172-17-302-1.devops' was not accepted. Trying the next CA certificate stored in the system. [0m\n[07:12:21] : [Step 1/1]  [35m    2019-10-02T05:12:12,505994Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-02T05:12:12.356Z] Info : No next CA certificate found. [0m\n.... and so on"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like not fixed :("
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:08,749436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.567Z] Info : Authentication succeeded. Claims Token: [TokenId: 39492b46-7a6f-45a7-84b0-6028b5ce4506, DistinguishedName: CN=be532a42943366f68b8fd40238b01ef8,CN=bob,OU=local, FirstName: Bobby, LastName: Tables, ExpirationTime: 2019-10-30 11:10:07], On-demand Claims: [[]], Device Scripts: [[]] [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:08,749436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.568Z] Info : Waiting for VPN certificate to be updated before deploying. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:08,753438Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.568Z] Info : New claims token [39492b46-7a6f-45a7-84b0-6028b5ce4506] supplied for gateway 'envy-172-17-166-2.devops'. Will send it. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:08,755436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.568Z] Info : Waiting for VPN certificate to be updated before deploying. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,343436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.860Z] Info : Processing on-demand Claims: [] [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,343436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.865Z] Info : Retrieving entitlement tokens. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,345437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.866Z] Info : Existing REST connection lost. Reconnecting. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,345437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.873Z] Info : Resolving hostname 'envy-172-17-166-1.devops' [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,346436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:08.877Z] Info : Trying to connect 'envy-172-17-166-1.devops/172.17.166.1' with SPA key name 'Built-in-be85360895242'. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,977437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:09.389Z] Info : REST connection could not be established. 'Connection failed.'. Will try the next IP address. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:09,978437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:09.390Z] Error : Connection to controller 'https://envy-172-17-166-1.devops/' has failed. Reason: Connection failed. [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:11,427437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.324Z] Info : [simple_setup Site] Connecting to TLS://172.17.166.2:443 ... [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:11,427437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.326Z] Info : [simple_setup Site] Client DN: CN=be532a42943366f68b8fd40238b01ef8,CN=bob,OU=local [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:11,428437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.328Z] Info : [simple_setup Site] Verification enabled for envy-172-17-166-2.devops [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:11,738441Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.329Z] Info : [simple_setup Site] Sending SPA-DNS/DTLS packets [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:11,741431Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.631Z] Info : [simple_setup Site] Stopped sending SPA-DNS/DTLS packets [0m\n[11:10:11] :     [Step 1/1]  [35m    2019-10-29T10:10:11,742436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.643Z] Info : [simple_setup Site] [gateway-28a74895-f04c-4f0a-9dde-8411c54b42ea-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:11,742436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.644Z] Info : Sending reply to client <{ \"jsonrpc\": \"2.0\", \"method\": \"status\", \"params\": { \"id\": \"staticid\", \"sites\": { \"simple_setup Site\": {\"gw-id\": \"gateway-28a74895-f04c-4f0a-9dde-8411c54b42ea-site1\", \"status\": \"down\", \"error\": \"Certificate error: server sent no valid certificate - self signed certificate in certificate chain\", \"code\": 8}} }}> [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:11,743437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [tun-service/stdout] [2019-10-29T10:10:11.646Z] Info : [simple_setup Site] [gateway-28a74895-f04c-4f0a-9dde-8411c54b42ea-site1] Closing (Certificate error: server sent no valid certificate - self signed certificate in certificate chain) [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:12,090437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:11.649Z] Info : VPN driver rejected the gateway certificate. Will check for the next CA certificate. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,203436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:12.943Z] Info : SSL certificate of controller 'envy-172-17-166-1.devops' was not accepted. Trying the next CA certificate stored in the system. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,209437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:12.945Z] Info : No next CA certificate found. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,218437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:12.946Z] Info : Retrieving entitlement tokens. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,219436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:12.947Z] Info : Resolving hostname 'envy-172-17-166-1.devops' [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,219436Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:12.960Z] Info : Trying to connect 'envy-172-17-166-1.devops/172.17.166.1' with SPA key name 'Built-in-be85360895242'. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,826431Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:13.565Z] Info : 1 new entitlement token(s) retrieved. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,826431Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:13.566Z] Info : Entitlements for 'simple_setup Site': simple_setup_ENT_PING, simple_setup_ENT_HTTP [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,826431Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:13.566Z] Info : Waiting for VPN certificate to be updated before deploying. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,827489Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:13.566Z] Info : New entitlement token supplied for gateway 'envy-172-17-166-2.devops'. Will send it. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,827489Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:13.566Z] Info : Checking next CA certificate. [0m\n[11:10:18] :     [Step 1/1]  [35m    2019-10-29T10:10:13,828437Z [STREAM] [ca_renewal\\ca_renewal_client_connected] [client-service/stdout] [2019-10-29T10:10:13.574Z] Info : No next CA certificate in the system. [0m"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1572346544779
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nop, still failing"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1573750813606
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the last one probably was a false alarm as it hasn't failed once for the past 10 days."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1578502993621
      }
    ]
  },
  {
    "key": "SA-12227",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "On the login page we get "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Warning: componentWillReceiveProps has been renamed, and is not recommended for use. See https://fb.me/react-unsafe-component-lifecycles for details.\n\nMove data fetching code or side effects to componentDidUpdate.\n\nIf you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://fb.me/react-derived-state\n\nRename componentWillReceiveProps to UNSAFE_componentWillReceiveProps to suppress this warning in non-strict mode. In React 17.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run npx react-codemod rename-unsafe-lifecycles in your project source folder.\n\nPlease update the following components: Locations"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I believe that one comes from the router, anyways changing the router is a good idea."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "mikael.harsjo",
        "created": 1570178347161
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Task to remove the UNSAFE"
                },
                {
                  "type": "text",
                  "text": "CWRP leftover ",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "https://code.cyxtera.com/appgate/stratus-frontend/pull/2560",
                  "marks": [
                    {
                      "type": "em"
                    },
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://code.cyxtera.com/appgate/stratus-frontend/pull/2560"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The router change will fix the error above in a different PR"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1570542692556
      }
    ]
  },
  {
    "key": "SA-12238",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We have several options:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Host binaries on akira."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Build from source, (see "
                    },
                    {
                      "type": "text",
                      "text": "https://github.com/cockroachdb/cockroach)",
                      "marks": [
                        {
                          "type": "link",
                          "attrs": {
                            "href": "https://github.com/cockroachdb/cockroach)"
                          }
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": "."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Building from source gives us the possibility of applying patches. We could start with having the binaries on akira if it makes our life easier."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As we discussed, we can create a debian package to install it like everything else on the appliance. The debian package can be versioned by the cockroachdb major version so we can have multiple versions at the  same time."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1570525980267
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/cockroachdb/cockroach/pull/41464",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/cockroachdb/cockroach/pull/41464"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1570626877100
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I probably named the mypy branch wrong :D :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1570705912587
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "haha"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1570711548299
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The thing uses git submodules to download a bunch of stuff then compile it, then fail because they stick to some old commit that no longer works because C++11 deprecated something and gcc is now enforcing it."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I am going to try to just make it use the versions that are already built and working in debian instead. That will save build time and I hope also hassle."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1570787406396
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OK sounds good if its such a pain to build. We should try going with pull requests to the official repo for our changes anyways."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1570787909121
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm not sure how feasible that is though I made the 1 simple pull request. The tests are failing but I have no access to the tests so ???????"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Nobody else commented anything on my PR."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1570788000220
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/cockroachdb/cockroach/issues/41531",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/cockroachdb/cockroach/issues/41531"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1570791728859
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "All the changes I'm making are tracked on this fork "
                },
                {
                  "type": "text",
                  "text": "https://github.com/ltworf/cockroach/tree/yarnpkg",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/ltworf/cockroach/tree/yarnpkg"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " I made it on my personal so I can make prs if they make sense in general."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1570801925986
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Status update: I managed to build it on my machine."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I cherry picked a patch that one developer made after I reported a bug. I had to make a similar one."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We need to have a discussion if we want to keep the fork internally or on public github to be able to send prs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571063964439
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We can discuss in person but I think public github is best and we try to get our fixes upstream. For last resort patches we can patch in the deb build with patch files no?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571124978451
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeah that'd be possible as well. Anyway I opened another bugreport asking them to cherrypick the facebook branch where they fix the issue I bumped into, while I just \"fixed\" it by telling gcc to ignore the error :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571125952100
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/cockroachdb/rocksdb/issues/66",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/cockroachdb/rocksdb/issues/66"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571142051458
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So I forked their repo internally. Meanwhile they pushed one fix due to a bug i had opened so i bumped and removed my changes for that. There are still changes however. I will try to bug them more."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Their makefile has a target to generate a .tar.gz that includes all the submodules."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "My plan for the moment is to manually run this, put the .tar.gz in contrib and from there compile it and make the .deb package. In that way we avoid having to set up submodules and subsubmodules on the contrib repo and the packaging would look more normal."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "However we might also consider doing a separate build instead. On my machine it takes a bit more than 10 minutes to build. We should add the time to compress and so on."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571237145314
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes I think it would be good to split both the BDR and Cockroach builds on teamcity, even though they run from the same git repo."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571296596825
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Of course now that it builds on my machine, it won't build in a clean chroot."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571310029737
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "With this awesome error message: "
                },
                {
                  "type": "text",
                  "text": "make: * [Makefile:6: buildoss] Error 2",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571310063495
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/cockroachdb/cockroach/pull/41799",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/cockroachdb/cockroach/pull/41799"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571740077785
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://github.com/cockroachdb/cockroach/issues/41796",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/cockroachdb/cockroach/issues/41796"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571740108556
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "remote: Resolving deltas: 100% (3/3), completed with 1 local object.\nremote: error: GH001: Large files detected. You may want to try Git Large File Storage - https://git-lfs.github.com.\nremote: error: File cockroach/cz-cockroachdb_1.orig.tar.gz is 110.00 MB; this exceeds GitHub Enterprise's file size limit of 100.00 MB\nTo code.cyxtera.com:appgate/stratus-contrib.git"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571757498393
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hah. Can we host it on akira instead?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571816899015
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I guess so. I don't think I have access there to the web thing. Just ssh."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1571817524824
      }
    ]
  },
  {
    "key": "SA-12293",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "After waiting 15-20 minutes the upgrade of the second controller had not completed and the upgrade script was still showing installing. The dashboard showed status of healthy and the appliance as only an Appliance and not a controller. A cz-config upgrade --status  showed upgrade status is success: a reboot is required for the upgrade to go into effect. After running the sudo cz-config upgrade --switch-partition command the appliance rebooted. We then waited a couple of minutes but the upgrade script did not have any change and the upgrade appeared to not have continued. However in the time it took us to grab information and create the case, approximately 5-10 minutes after the switch partition command was run, the script did kick back in and the upgrade completed without any further issues."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The 5.0 upgrade script should be the one that was used."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "T-Mobile would like a root cause of why this happened and how we will prevent it going forward. Logs are too large to add to youtrack but they are in the case. Case created in SNOW: CS1189844 "
            },
            {
              "type": "text",
              "text": "https://cyxtera.service-now.com/nav",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://cyxtera.service-now.com/nav"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "to.do?uri=sn",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "customerservice"
            },
            {
              "type": "text",
              "text": "case.do?sys",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": "id=268ffbdfdb94c890a4a99eb6db961984%26sysparm"
            },
            {
              "type": "text",
              "text": "view=case",
              "marks": [
                {
                  "type": "em"
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "As far as I can see from the logs the second controller never got the reboot order, could you grab the logs from the first controller if they are still available? Also the output of the upgrade script would have been good."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The log download from the second controller got truncated because the disk was too slow, maybe something fishy with that VM."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571125994006
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Logs from the first controller have been attached to the SNOW case but they are too big to put in youtrack."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "tristan.cooper",
        "created": 1571207165142
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It looks like for some reason the second controller wasn't connected to the first controller when getting the switch partition order. I don't think there is anything we can fix right other than saying that there was a connectivity glitch."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571402166124
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Oct 10 18:40:15.627902 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.102:15164] Received websocket message.\nOct 10 18:40:15.629048 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.107:11830] Received websocket message.\nOct 10 18:40:15.631746 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.103:15216] Received websocket message.\nOct 10 18:40:15.810790 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:15 +0000] \"GET /admin/stats/appliances HTTP/1.0\" 200 6921 \"https://admin.controller.appgate.t-mobile.com:444/ui/\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0\" 245\nOct 10 18:40:17.162452 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:17 +0000] \"GET /admin/appliances/04f8f611-682a-4f56-9e0c-9459c60aceca/upgrade HTTP/1.0\" 200 61 \"-\" \"Python-urllib/3.7\" 54\nOct 10 18:40:22.304848 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:22 +0000] \"GET /admin/appliances/04f8f611-682a-4f56-9e0c-9459c60aceca/upgrade HTTP/1.0\" 200 87 \"-\" \"Python-urllib/3.7\" 51\nOct 10 18:40:22.464442 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:22 +0000] \"POST /admin/appliances/04f8f611-682a-4f56-9e0c-9459c60aceca/upgrade/switchPartition HTTP/1.0\" 200 45 \"-\" \"Python-urllib/3.7\" 56\nOct 10 18:40:22.790771 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:22 +0000] \"POST /admin/appliances/0c72fcf2-7b21-489b-9eb4-5b8c313f471c/upgrade/switchPartition HTTP/1.0\" 200 45 \"-\" \"Python-urllib/3.7\" 227\nOct 10 18:40:22.948301 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:22 +0000] \"POST /admin/appliances/3d4548b5-83a1-4d01-83f3-f450fd78ae89/upgrade/switchPartition HTTP/1.0\" 200 45 \"-\" \"Python-urllib/3.7\" 58\nOct 10 18:40:23.278005 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:23 +0000] \"POST /admin/appliances/abb996fa-6162-4769-b5f7-45262bdc3b6d/upgrade/switchPartition HTTP/1.0\" 200 45 \"-\" \"Python-urllib/3.7\" 236\nOct 10 18:40:23.403123 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.217:15258] Received websocket message.\nOct 10 18:40:23.406368 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.214:15240] Received websocket message.\nOct 10 18:40:23.406536 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/127.0.0.1:63294] Received websocket message.\nOct 10 18:40:23.407463 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.220:14378] Received websocket message.\nOct 10 18:40:23.440535 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.102:15164] Received websocket message.\nOct 10 18:40:23.447385 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.107:11830] Received websocket message.\nOct 10 18:40:23.451417 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.103:15216] Received websocket message.\nOct 10 18:40:23.452016 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygttn22.t-mobile.com:444 [cygttn22.t-mobile.com/208.54.108.105] failed: Connection refused (Connection refused)\nOct 10 18:40:23.452142 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygpol01.t-mobile.com:444 [cygpol01.t-mobile.com/208.54.152.216] failed: Connection refused (Connection refused)\nOct 10 18:40:23.452244 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygpol22.t-mobile.com:444 [cygpol22.t-mobile.com/208.54.152.219] failed: Connection refused (Connection refused)\nOct 10 18:40:23.452330 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygttn02.t-mobile.com:444 [cygttn02.t-mobile.com/208.54.108.101] failed: Connection refused (Connection refused)\nOct 10 18:40:23.453838 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:23 +0000] \"GET /admin/stats/appliances HTTP/1.0\" 200 7444 \"-\" \"Python-urllib/3.7\" 76\nOct 10 18:40:33.625190 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.217:15258] Received websocket message.\nOct 10 18:40:33.625754 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/127.0.0.1:63294] Received websocket message.\nOct 10 18:40:33.627190 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.214:15240] Received websocket message.\nOct 10 18:40:33.627339 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.220:14378] Received websocket message.\nOct 10 18:40:33.666296 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.102:15164] Received websocket message.\nOct 10 18:40:33.667108 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.107:11830] Received websocket message.\nOct 10 18:40:33.671350 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.103:15216] Received websocket message.\nOct 10 18:40:33.672139 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygttn22.t-mobile.com:444 [cygttn22.t-mobile.com/208.54.108.105] failed: Connection refused (Connection refused)\nOct 10 18:40:33.672262 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygpol01.t-mobile.com:444 [cygpol01.t-mobile.com/208.54.152.216] failed: Connection refused (Connection refused)\nOct 10 18:40:33.672348 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygpol22.t-mobile.com:444 [cygpol22.t-mobile.com/208.54.152.219] failed: Connection refused (Connection refused)\nOct 10 18:40:33.672434 cycpol01.t-mobile.com cz-controllerd[3097]: WARN [AppliancesStatsProvider] Error on appliance status check. javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to cygttn02.t-mobile.com:444 [cygttn02.t-mobile.com/208.54.108.101] failed: Connection refused (Connection refused)\nOct 10 18:40:33.673666 cycpol01.t-mobile.com cz-controllerd[3097]: 76.121.54.18 - - [10/Oct/2019:18:40:33 +0000] \"GET /admin/stats/appliances HTTP/1.0\" 200 7444 \"-\" \"Python-urllib/3.7\" 70\nOct 10 18:40:43.792261 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/127.0.0.1:63294] Received websocket message.\nOct 10 18:40:43.792903 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.214:15240] Received websocket message.\nOct 10 18:40:43.793032 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.217:15258] Received websocket message.\nOct 10 18:40:43.795325 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.152.220:14378] Received websocket message.\nOct 10 18:40:43.834245 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.102:15164] Received websocket message.\nOct 10 18:40:43.834473 cycpol01.t-mobile.com cz-controllerd[3097]: INFO [PeerWebSocketEndpoint] [/208.54.108.107:11830] Received websocket message."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571402189455
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I don't think there is much we can do about this for now without the matching upgrade script logs. I haven't been able to reproduce it either. It's probably linked to the fact that controller1 was running 5.0 and controller2 4.3 plus some timing issue and bad luck but I'm just speculating here as there are no relevant errors in the logs."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1571644025390
      }
    ]
  },
  {
    "key": "SA-12387",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Hotspot Controllerd: (idle)\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                                 \n\n17524 czd-ca    20   0 13.392g 633.2m  24.1m S   0.0  3.2   0:33.45 java                                                                                                                                    \n\nOpenJ9 Controllerd: (idle)\n\n28878 czd-ca    20   0 13.263g 535.2m  20.7m S   0.0  2.7   0:11.78 java\n\nHotspot Sessiond (idle):\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                                 \n\n27078 czd-priv  20   0 3822.5m 259.8m  19.8m S   0.7  5.2   0:24.77 java \n\nOpenJ9 Sessiond: (idle)\n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                                 \n\n 6685 czd-priv  20   0 3815.1m 224.3m  18.6m S   0.7  4.5   0:08.09 java  "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571993494191
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Per Allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                        "title": "per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " can you share your finding here... by using OpenJ9 in systemtest"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571993526710
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Sessiond mem use from a stress test with 3000 users x 256 actions, with no -Xms/x arguments to java:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "jdk8:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "COMMAND     VSZ   RSS\n\njava     14354244 701408"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "jdk8-j9:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "\\# ps -o fname,vsz,rss -p 18014\n\nCOMMAND     VSZ   RSS\n\njava     5385996 389196"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1571993675920
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[Gokhan Berberoglu]("
                },
                {
                  "type": "text",
                  "text": "http://got-youtrack.agi.appgate.com:8112/users/gokhan.berberoglu",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/gokhan.berberoglu"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " \"gokhan.berberoglu\") "
                },
                {
                  "type": "text",
                  "text": "Natan Abolafya",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                        "title": "natan.abolafya"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " Any objections in moving into OpenJ9 instead.. it feels like it give quite a boost.. atleast memory wise.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571993803806
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Reminder: We need to modify/scrap the -Xms/-Xmx arguments for J9 - it doesn't even accept giving a too high value for -Xms for example."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1571993916525
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "as long as it works."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1571994030152
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. Assigning you "
                },
                {
                  "type": "text",
                  "text": "Per Allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                        "title": "per.allansson"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to this.. Feels like we should test it out a bit more.. like checking that the perfomance of controller/sessiond has not degraded.. i mean it needs to be atleast \"on par\" with hotspot.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "but so far, it looks really good"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571994314184
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "i guess we are going to need some configd changes later on also for the -Xms/-Xmx things.. so dragging in "
                },
                {
                  "type": "text",
                  "text": "Thomas Cellerier",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                        "title": "thomas.cellerier"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " into the info loop aswell"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571994388431
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Also, if someone whats to try.. a easy way to install it, and try it.. is running the following commands:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "wget -qO - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | sudo apt-key add -\nsudo apt-get install -y software-properties-common\nsudo add-apt-repository --yes https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/\nsudo apt-get install adoptopenjdk-8-hotspot\nsudo ln -s -f /usr/lib/jvm/adoptopenjdk-8-hotspot-amd64/bin/java /etc/alternatives/java\n\nsudo service cz-sessiond restart\nsudo service cz-controllerd restart"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571994556289
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nah, those are defined in the systemd file which are in the repo of each project"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1571994566989
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "they are in shell scripts actually as they adjust the values a bit - some further expirements show that we need to set both -Xms and -Xmx - as J9 doesn't seem to adjust the max if we only set the min"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1571995876426
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sessiond mem use, 3000 users x 3000 actions, -Xms1g -Xmx4g:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "jdk8"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "COMMAND     VSZ   RSS\n\njava     10208360 4343580"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "jdk8-j9"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "COMMAND     VSZ   RSS\n\njava     9132960 2284900"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1571995949562
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Should we not generate these values actually.. ( -Xms -Xmx ) feels like it would be sane that they flollow the amount of ram that is available.. If the appliance is a stand-alone controller for example.. it feels like Xmx percent wise of the memory should be quite high.. and then adjusted to if its combined in different ways.. But.. thats a completly different story (not this task)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571996099327
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Those a really nice numbers "
                },
                {
                  "type": "text",
                  "text": "Per Allansson",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                        "title": "per.allansson"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1571996190946
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Attached graph over some more sessiond tests."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1572246563525
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I get no visible difference in login times in either controllerd or sessiond with J9 - and controllerd RSS mem use is lower with J9 as well - 1.4G vs 1.9G."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So looks golden to me."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1572855940419
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "That sounds awsome.. then i think we should switch in 5.1"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573030583867
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We should also make tests for running on Graalvm .. Since Oracle is throwing out nashorn from the JDK.. then there is need for a replacement.. So, it might come to, that we need to run on Graal in the future.. So, if we can get the same performance on Graalvm compared to OpenJ9, then Graalvm is probaly the way to go"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573207765026
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-11969",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-11969"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " fyi"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1573208944185
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "i see it as 2 different tasks.. because the Graalvm seems to be a comple JVM... so you should be able to run any java application on it without doing any changes.... so it would be very interesting to just run using this JVM, to see if it works... Then.. if we are in luck, and the performance is acceptable, we can also change the scripengine to use the graal instead of the nashorn"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573209744476
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I was able to get sessiond running atleast using the following command:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "`cd ~"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "wget "
                },
                {
                  "type": "text",
                  "text": "https://github.com/oracle/graal/releases/download/vm-19.2.1/graalvm-ce-linux-amd64-19.2.1.tar.gz",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/oracle/graal/releases/download/vm-19.2.1/graalvm-ce-linux-amd64-19.2.1.tar.gz"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "tar xvf graalvm-ce-linux-amd64-19.2.1.tar.gz"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sudo mv graalvm-ce-19.2.1 /usr/lib/jvm/"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sudo ln -s /usr/lib/jvm/graalvm-ce-19.2.1 /usr/lib/jvm/graalvm"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/graalvm/bin/java 1"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sudo update-alternatives --config java"
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "choose 1"
                }
              ],
              "attrs": {
                "level": 3
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "sudo service cz-sessiond restart`"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573210355647
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ah, I didn't read much about GraalVM. It seems it's a bigger concept than a javascript engine."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1573210601166
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "graalvm is said to be (even more) memory hungry though..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1573210971241
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Would however be nice, to know for sure.. to see the numbers"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573211247236
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://www.youtube.com/watch?v=eO6OaVnbqaY",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.youtube.com/watch?v=eO6OaVnbqaY"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1573211505530
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\=)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573211534169
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will try to see if i can do native compiling.. seems like graal is able todo so even from a jar.. so let see"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573211589348
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, i have done some more investigation, You can actually run GraalJs without GraalVm , here is a example "
                },
                {
                  "type": "text",
                  "text": "https://github.com/graalvm/graal-js-jdk11-maven-demo",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/graalvm/graal-js-jdk11-maven-demo"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " so that makes it a opener fr openJ9 again.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1573227137688
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Too late for 5.1 now, moving to 5.2"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1576681706791
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "very good.. really want to test the graal before going all openJ9 also"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1576682054874
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "per.allansson",
                    "text": "@per.allansson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": "  i dont think there is a dependency  between the jvm and the js-engine. Its for example possible to run the GraalJS on hotspot for example"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1584974065404
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Well, that depends on if the GraalJS is so much faster on GraalVM that the speed improvement is to be preferred over the memory use improvements in OpenJ9."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1585040349182
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OpenJ9 will not work with ELK though: "
                },
                {
                  "type": "text",
                  "text": "https://www.elastic.co/support/matrix#matrix",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.elastic.co/support/matrix#matrix"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "jvm",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1585040405067
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And I have tested the GraalVM with sessiond, and the memory use is pretty much exactly as with OpenJDK."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1585041032969
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ok.. thats shit.  i was expecting better =("
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1585121263415
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ah ok.. maybe graal is more going into the AOT "
                },
                {
                  "type": "text",
                  "text": "https://www.graalvm.org/docs/why-graal/",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.graalvm.org/docs/why-graal/"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " model .. and its probably there it shines.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1585121466866
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So updated graph with OpenJRE-11, OpenJ9-11 and GraalVM"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1585822339111
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The numbers don't look the same as the previous tests, but that's because test is different. The interesting part is the difference anyhow."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Tests were using: -Xms2g"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The ones with -Xmx were using -Xmx{4,6,8}g depending on how much memory was needed."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OpenJ9 is clearly the best one in terms of memory use - but using -Xmx on Oracle makes it a lot better as well - although that number needs to be kept high enough to support whatever use case the customer has - so it's hard to autotune."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1585822548818
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, how does controllerd compare with J9 vs Oracle? The difference in memory use is not as visible as for sessiond - J9 generally keeps a lower profile but over time they end up very close to each other. J9 seems to be on the order of 10% slower on a typical login flow though."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1586180229730
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So to sum it up, J9 looks good for sessiond, not really for controllerd, and it can't be used for ELK stuff."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since Oracle JVM memory use can be made better by add -Xmx flags - and then it's lower than J9 without -Xmx - and the difference J9 vs Oracle is less when both use -Xmx - I think it makes more sense to keep Oracle JVM to have a single JVM that we use everywhere, and instead look at setting some reasonable -Xmx - and/or having it as some extra tuning parameter that we can apply on an install basis."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1586180516842
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Interesting turnout =)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1586258086006
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "close the task?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1588086391955
      }
    ]
  },
  {
    "key": "SA-12405",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Oct 22 23:20:49 cyxsdp-gw01.cyxtera.com cz-configd[622]: ERROR [jsonrpcapp] Internal server error\n                                                         Traceback (most recent call last):\n                                                           File \"/usr/cz-configd/configd/jsonrpcapp.py\", line 228, in handle_request\n                                                             return handler.function(request)\n                                                           File \"/usr/cz-configd/configd/jsonrpcapp.py\", line 200, in typed_fn\n                                                             result = fn(params)\n                                                           File \"/usr/cz-configd/configd/webservice.py\", line 596, in handle_get_session_info\n                                                             return sessiond_get_session_info(params.distinguished_name)\n                                                           File \"/usr/cz-configd/configd/sessiond.py\", line 91, in sessiond_get_session_info\n                                                             return sessiond_request('sessions', 'info', distinguished_name).json()\n                                                           File \"/usr/cz-configd/configd/sessiond.py\", line 82, in sessiond_request\n                                                             r.raise_for_status()\n                                                           File \"/usr/lib/python3/dist-packages/requests/models.py\", line 935, in raise_for_status\n                                                             raise HTTPError(http_error_msg, response=self)\n                                                         requests.exceptions.HTTPError: 404 Client Error: Not Found for url: http://127.0.0.1:9200/sessions/info/CN=1104eb6742784661bc0347772b791bd6,CN=jorge.briceno,OU=Cyxtera Corp AD\nOct 22 23:20:49 cyxsdp-gw01.cyxtera.com cz-configd[622]: INFO [jsonrpcapp] cyxsdp-ctrl01.cyxtera.com 12925 \"get_session_info\" fail 2"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybes is nothing but have a look at it. The journal even compressed cannot be uploaded here but we have it"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1572335403373
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The client is not found in sessiond."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1574841687349
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I could improve the jsonrpc error message to say client not found but that's it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1574841720392
      }
    ]
  },
  {
    "key": "SA-12439",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "es-tools",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " contains this"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "import sys\nimport requests\nimport logdclient\nimport json\nif len(sys.argv) != 2 :\n    print(\"\"\"Example:%s logstash-2017-06-11\"\"\" % sys.argv[0])\n    sys.exit(1)\nresponse = requests.delete(\"http://localhost:9300/%s\" % sys.argv[1])\nif response.ok :\n    logd_client = logdclient.LogdClient('cz-appliance')\n    logd_client.send(json.dumps({\n        \"event_type\":\"index_removed\",\n        \"name\": sys.argv[1],\n    }))\nelse:\n    print(\"Could not delete %s. Got status %d from elasticsearch\" % (sys.argv[1], response.status_code))\n    exit(1)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I simplified it into this"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "import logdclient\nimport json\n\nlogd_client = logdclient.LogdClient('cz-test')\n\na = {\"event_type\":\"ciao\", \"name\": \"aaaa\"}\nlogd_client.send(json.dumps(a))"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "And I ran it."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I can't see anything at all in kibana."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Probably because the call is completely wrong"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "sendto(-1, \"{\\\"method\\\":\\\"audit\\\",\\\"params\\\":{\\\"version\\\":2, \\\"timestamp\\\":\\\"2019-11-05T12:18:34.493Z\\\", \\\"daemon\\\":\\\"cz-appliance\\\", \\\"log\\\":{\\\"event_type\\\": \\\"index_removed\\\", \\\"name\\\": \\\"pigna\\\"}},\\\"jsonrpc\\\":\\\"2.0\\\"}\\n\", 179, MSG_NOSIGNAL, NULL, 0) = -1 EBADF (Bad file descriptor)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "and it tries to send data to a "
            },
            {
              "type": "text",
              "text": "-1",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " file descriptor, and later on it connects to the socket, so it can never possibly work."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It seems the problem is more minor. After uselessly trying to send it to an invalid file descriptor, it creates a connection and tries again."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "salvatore.tomaselli",
        "created": 1572957413835
      }
    ]
  },
  {
    "key": "SA-12474",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We come across this a couple of times where the SAML provider has two choices for signature. Whole token or assertion. Today we only support assertion. We can support the whole token too, so less support headache."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<samlp:Response Destination=\"http://127.0.0.1:29001/saml\" IssueInstant=\"2020-02-26T16:32:48.563Z\" ID=\"I1lfZBD0urwHhDDjCDMQKBhBzssHsnhhAM80dvGduF8HFzTaeTsQ\" Version=\"2.0\"\n    xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\">\n    <saml:Issuer\n        xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\">https://pingone.com/idp/cd-1240574988.cyxtera\n    </saml:Issuer>\n    <ds:Signature\n        xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n        ds:SignedInfo\n            <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n            <ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/>\n            <ds:Reference URI=\"#I1lfZBD0urwHhDDjCDMQKBhBzssHsnhhAM80dvGduF8HFzTaeTsQ\">\n                ds:Transforms\n                    <ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/>\n                    <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n                </ds:Transforms>\n                <ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\n                ds:DigestValuemVyNHTwv70X38rUBD8pAi/Pbh+NVzREBn2wGh/byVFM=</ds:DigestValue>\n            </ds:Reference>\n        </ds:SignedInfo>\n        ds:SignatureValue\nxkZmtxWrm2BI7BktR9meBNfUasLPF14X23CGpSo0PpN5Zr63Z/qTr6dw5tuTkJfuZN8xTTf8aJlf\nzpBhEFHYQSmmQkDbh9HaX1um5AzMd3waJVljZ16s0q6SVzC/Yj7B1yazJlO+pdXS/UkAjEiJwupP\nJ1yT+TiK7j1fnKPPGwL7GDH42/ZTtftL9p7dWNuRQvvXmb50sdiUIcUDgQCQeDC/EvK8JtIIZwtV\n8YnAB4SKPqW+FHbombc0o/GDJjpMb84es229v6cWqlmD6CPcUbpRAr0zZvJ/MUsmDEf4JT4BAjhJ\nDpZoZC0FvEHYqPxJX/dhpxYIOK3mNTh7hVkSOw==\n</ds:SignatureValue>\n        ds:KeyInfo\n            ds:X509Data\n                ds:X509Certificate\nMIIDWjCCAkKgAwIBAgIGAV5R6OrxMA0GCSqGSIb3DQEBCwUAMG4xCzAJBgNVBAYTAlVTMQswCQYD\nVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRYwFAYDVQQKEw1QaW5nIElkZW50aXR5MSkwJwYDVQQD\nEyA1OTMyY2RhZjAwYmI0YjY1ODBlZmI5YjIzYzhkNGEyODAeFw0xNzA5MDUxMTU5MzJaFw0yMDA5\nMDQxMTU5MzJaMG4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRYw\nFAYDVQQKEw1QaW5nIElkZW50aXR5MSkwJwYDVQQDEyA1OTMyY2RhZjAwYmI0YjY1ODBlZmI5YjIz\nYzhkNGEyODCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN8Bci8fB8g/N96iaWmMrSFs\n4G4riau4hcsHDwgRO5Goxe5Nu4S8u7okdZJefxUTCY1fchpOxnxkAvYlW5p4Yr108QYHURGNYX1y\nO729vt4CnCxmovHtJBLB199gMMSUBKy9F9+eXMvTBgGwjjDamL9266oJ07d7KngbD9Jduix/HCMg\noj6HgwYQjGcrOpIMb3G0nHX7oN0MDNeSkaD5AMEwvEmpaQut3r6+lc1zXMWAREVrditsVSwbFPf2\nLHA6hLyqpLY7MRLf0G+sg4+eaeUAy3geIj3incTqusj7GszNzDWK1PaRk9V0Oe6PtLC89ooJKEOq\nH2S8/Tes9gcArRsCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAM24um0Eqf+0e9xQ3pzk28EVFd8I+\nmNOBy1s4w9sstxuWQUcTqtGn6ATvkH9/TRLa2xYJICAgTm8mh3xuJZ/PFqOvCgnd1t5oQA4jeBnb\ntMRT6LPsoq6Nlg4LO+kDUG2uIJIqF9Lj/DPFyf2FUmt0UAFYU0KvIu3sOTLPtkPASy97PpJOX2iv\nAKypchLxmYDY3bKTjL48vSXosd2RnyIGFPaBJG+wCMPrJkJk8tNK5AAF8zA0seskWmmXZN/X6rK9\nVnUwjHG05S3OHDS3jkjhX1QOfanqUWMLi6A7WwRWouZFBpD/XbjPJmyQ0wkdD0kt+nWkFwCFm3h4\nbH3bvI33/Q==\n</ds:X509Certificate>\n            </ds:X509Data>\n            ds:KeyValue\n                ds:RSAKeyValue\n                    ds:Modulus\n3wFyLx8HyD833qJpaYytIWzgbiuJq7iFywcPCBE7kajF7k27hLy7uiR1kl5/FRMJjV9yGk7GfGQC\n9iVbmnhivXTxBgdREY1hfXI7vb2+3gKcLGai8e0kEsHX32AwxJQErL0X355cy9MGAbCOMNqYv3br\nqgnTt3sqeBsP0l26LH8cIyCiPoeDBhCMZys6kgxvcbScdfug3QwM15KRoPkAwTC8SalpC63evr6V\nzXNcxYBERWt2K2xVLBsU9/YscDqEvKqktjsxEt/Qb6yDj55p5QDLeB4iPeKdxOq6yPsazM3MNYrU\n9pGT1XQ57o+0sLz2igkoQ6ofZLz9N6z2BwCtGw==\n</ds:Modulus>\n                    ds:ExponentAQAB</ds:Exponent>\n                </ds:RSAKeyValue>\n            </ds:KeyValue>\n        </ds:KeyInfo>\n    </ds:Signature>\n    samlp:Status\n        <samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n    </samlp:Status>\n    <saml:Assertion Version=\"2.0\" IssueInstant=\"2020-02-26T16:32:48.563Z\" ID=\"I1aj0Qj3thRQrfoDRD-OGJkS5YzmWYsHxkmzxbU4p7u410zUnv7Q\"\n        xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n        saml:Issuer<https://pingone.com/idp/cd-1240574988.cyxtera</saml:Issuer>>\n        saml:Subject\n            <saml:NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress\">natan.abolafya@cyxtera.com</saml:NameID>\n            <saml:SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\">\n                <saml:SubjectConfirmationData NotOnOrAfter=\"2020-02-26T16:47:48.563Z\" Recipient=\"http://127.0.0.1:29001/saml\"/>\n            </saml:SubjectConfirmation>\n        </saml:Subject>\n        <saml:Conditions NotOnOrAfter=\"2020-02-26T16:47:48.563Z\" NotBefore=\"2020-02-26T16:27:48.563Z\">\n            saml:AudienceRestriction\n                saml:Audienceappgate-test</saml:Audience>\n            </saml:AudienceRestriction>\n        </saml:Conditions>\n        <saml:AuthnStatement AuthnInstant=\"2020-02-26T16:32:48.564Z\" SessionIndex=\"I1rEWL8sLc4prfNB7jDIePK7I2euAZS0FZ_IekZclob_1WpQNDEA\">\n            saml:AuthnContext\n                saml:AuthnContextClassRefurn:oasis:names:tc:SAML:2.0:ac:classes:Password</saml:AuthnContextClassRef>\n                saml:AuthenticatingAuthority<https://pingone.com/idp/cd-1240574988.cyxtera</saml:AuthenticatingAuthority>>\n            </saml:AuthnContext>\n        </saml:AuthnStatement>\n        <saml:AttributeStatement\n            xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"emails\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">natan.abolafya@cyxtera.com\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"firstName\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">Natan\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"lastName\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">Abolafya\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"PingOne.idpid\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">40af977b-c9ce-4883-90e4-88ad54b74c6c\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"PingOne.AuthenticatingAuthority\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">https://pingone.com/idp/cd-1240574988.cyxtera\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"username\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">natan.abolafya@cyxtera.com\n                </saml:AttributeValue>\n            </saml:Attribute>\n        </saml:AttributeStatement>\n    </saml:Assertion>\n</samlp:Response>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1582734820335
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Any settings or anything?  or do we just look and see what we get and if we like it we move on......"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1590488545800
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the latter. First we look at the assertion signature like we used to. If we can't find it, we look at the token signature."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1590488719863
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Is the example above showing both or?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1591284733018
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " maybe show me an example of both and I will update the detailed SAML paper we have written"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1591341400717
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The above was the new style: token signature."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The below is an assertion signature example:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<?xml version=\"1.0\"?>\n<samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\"_3a753188-0bdc-44c9-af49-f9218a2e0a27\" Version=\"2.0\" IssueInstant=\"2016-04-19T10:18:23.509Z\" Destination=\"https://turquoise.cryptzone.com/saml\" Consent=\"urn:oasis:names:tc:SAML:2.0:consent:unspecified\">\n<Issuer xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\"><http://adfs-test.czse.local/adfs/services/trust</Issuer>>\nsamlp:Status\n    <samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n</samlp:Status>\n<Assertion xmlns=\"urn:oasis:names:tc:SAML:2.0:assertion\" ID=\"_d6f94926-fded-4157-a1d3-a1bacc9f4f06\" IssueInstant=\"2016-04-19T10:18:23.509Z\" Version=\"2.0\">\n    <Issuer><http://adfs-test.czse.local/adfs/services/trust</Issuer>>\n    <ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n    ds:SignedInfo\n        <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n        <ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/>\n        <ds:Reference URI=\"#_d6f94926-fded-4157-a1d3-a1bacc9f4f06\">\n            ds:Transforms\n                <ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/>\n                <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n            </ds:Transforms>\n            <ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\n            ds:DigestValueihZOd0op/onEoHMsS+ALDkee9BGbHoYsqlbQ8OmP7J4=</ds:DigestValue>\n        </ds:Reference>\n    </ds:SignedInfo>\n    ds:SignatureValueka1ZflX26Ad19Sqbx5gq7DMmin3DbMrPMZWdt5mwyrom7YsZKl8nCCRk8N3ygrVsx0VZpBrAFI8DS5zCg+5Cil963/wyTY1QzdvhzRzmA6iXnzqKhG7tdJN/WxMCgurJdWDvsVBJU3gJTu2Lxk8t7RlwQxIMzhB3zG4ovdYFnI7yPEKCDvzDfTm5TH5APguaUdF0d6xzVQJD2oTnpPiTQY+DoTeaTzcIidBB05Pz9Y4ZZfXqarqZy/kyz+h1DjV24UWncGAjLnc6iFxE2gD4qN6UHIugskrYc1IzVvJr6Ih4LsD+NLP3/cUDrJPEOsDmyjBW4bus4QQOQ7wUGmLCRQ==</ds:SignatureValue>\n    <KeyInfo xmlns=\"http://www.w3.org/2000/09/xmldsig#\">\n    ds:X509Data\n        ds:X509CertificateMIIC5DCCAcygAwIBAgIQEOu46DWrZ5hDn60ZG9px1zANBgkqhkiG9w0BAQsFADAuMSwwKgYDVQQDEyNBREZTIFNpZ25pbmcgLSBhZGZzLXRlc3QuY3pzZS5sb2NhbDAeFw0xNTA5MDgwODQ1NDlaFw0xNjA5MDcwODQ1NDlaMC4xLDAqBgNVBAMTI0FERlMgU2lnbmluZyAtIGFkZnMtdGVzdC5jenNlLmxvY2FsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3c6j34fXJmguutMd1Qy6VoNr7T+62bI7JVgFvP12fJBCm1qB1sVM4gGoWqMhnsYozZyGTwn62t/Elt0+RFnqpdkRdCcUBGLSaXvdsybAeKwcOhChKilAYpTsYPEWejIQ5hXjJnwofu6DDCEbw04JAXMRFWV6v2Vz6khuKoDJMJ9mjaY4BHYpUQXS3nSjGn4HSmN42FQeW4dEwkpdbmsMuwsQTLtpKDouXbfbCgN/6adTASRKwQz5mPMsuemEjvoRQxMw3Mt0KcEL02G83llNiKceuIjnDaKQXzvoa1YeWK/unYod+ErhSnOR56udlG5i5LQr5cBr8xK9Ix6zLyg9KQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQDb+vNVXAluh7Evt8TSE1IyZYFJ1s3OIep57ClxlSvTkfUE4CVxpxjsKnizgEF/IXxm3iq6FVrTW22Vog0gThbpLlRGaJjDLYQllUCG2v1uh072EQUMnCdLTBrKbyX5bQa3evk+A0iRSRk/3PBNyULritmsrgaQp3wrqkgGvn/WHqzF6ItWtJfqI1iy/ls8HYjxeUt3c2i0rQSfsoU/JIsc2SkpM+59+O2eRozYEENNfLWZryUDMXCTgO5CgmO2g9GyyOwxKKdCXJlroBSUXmpqSuF8GYZtfLhRCYPa26Qgj+ZiB/YH8k2+JPeRDIVapHGfkLtH4YyBkqfK+VLLUQgS</ds:X509Certificate>\n    </ds:X509Data>\n</KeyInfo>\n</ds:Signature>\n<Subject>\n    <SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\">\n        <SubjectConfirmationData NotOnOrAfter=\"2016-04-19T10:23:23.509Z\" Recipient=\"https://turquoise.cryptzone.com/saml\"/>\n    </SubjectConfirmation>\n</Subject>\n<Conditions NotBefore=\"2016-04-19T10:18:23.506Z\" NotOnOrAfter=\"2016-04-19T11:18:23.506Z\">\n    <AudienceRestriction>\n        <Audience>adfs_test</Audience>\n    </AudienceRestriction>\n</Conditions>\n<AttributeStatement>\n    <Attribute Name=\"emails\">\n        <AttributeValue>test1@cryptzone.com</AttributeValue>\n    </Attribute>\n    <Attribute Name=\"id\">\n        <AttributeValue>xiWdImmyMEKo8HqxLKWaHg==</AttributeValue>\n    </Attribute>\n    <Attribute Name=\"username\">\n        <AttributeValue>test1</AttributeValue>\n    </Attribute>\n    <Attribute Name=\"firstName\">\n        <AttributeValue>Test1</AttributeValue>\n    </Attribute>\n    <Attribute Name=\"lastName\">\n        <AttributeValue>Lastname 1</AttributeValue>\n    </Attribute>\n    <Attribute Name=\"groups\">\n        <AttributeValue>CN=test group,OU=adfstest,DC=czse,DC=local</AttributeValue>\n    </Attribute>\n</AttributeStatement>\n<AuthnStatement AuthnInstant=\"2016-04-19T10:18:23.445Z\">\n    <AuthnContext>\n        <AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport</AuthnContextClassRef>\n    </AuthnContext>\n</AuthnStatement>\n</Assertion>\n</samlp:Response>"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591347173809
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "eh, this looks wrong "
                },
                {
                  "type": "text",
                  "text": "Jamie Bodley-Scott",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/jamie.bodley-scott",
                        "title": "jamie.bodley-scott"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ", I'll be updating the example above."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591348065204
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So, the difference is:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Token signature (new) has the signature under \"Response - Signature\""
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Assertion Signature (old) has the signature under \"Response - Assertion - Signature\""
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1591348379699
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "thx all very clear - have updated the SAML paper."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1593185133293
      }
    ]
  },
  {
    "key": "SA-12634",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The only way to make NTLM authentication work is to have a configuration with an explicit upstream block with the "
                },
                {
                  "type": "text",
                  "text": "keepalive",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " directive and in the "
                },
                {
                  "type": "text",
                  "text": "proxy_pass",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " directive replace "
                },
                {
                  "type": "text",
                  "text": "$host:$server_port$request_uri",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " with that upstream block e.g. :"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "<samlp:Response Destination=\"http://127.0.0.1:29001/saml\" IssueInstant=\"2020-02-26T16:32:48.563Z\" ID=\"I1lfZBD0urwHhDDjCDMQKBhBzssHsnhhAM80dvGduF8HFzTaeTsQ\" Version=\"2.0\"\n    xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\">\n    <saml:Issuer\n        xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\">https://pingone.com/idp/cd-1240574988.cyxtera\n    </saml:Issuer>\n    <ds:Signature\n        xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n        ds:SignedInfo\n            <ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n            <ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/>\n            <ds:Reference URI=\"#I1lfZBD0urwHhDDjCDMQKBhBzssHsnhhAM80dvGduF8HFzTaeTsQ\">\n                ds:Transforms\n                    <ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/>\n                    <ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n                </ds:Transforms>\n                <ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\n                ds:DigestValuemVyNHTwv70X38rUBD8pAi/Pbh+NVzREBn2wGh/byVFM=</ds:DigestValue>\n            </ds:Reference>\n        </ds:SignedInfo>\n        ds:SignatureValue\nxkZmtxWrm2BI7BktR9meBNfUasLPF14X23CGpSo0PpN5Zr63Z/qTr6dw5tuTkJfuZN8xTTf8aJlf\nzpBhEFHYQSmmQkDbh9HaX1um5AzMd3waJVljZ16s0q6SVzC/Yj7B1yazJlO+pdXS/UkAjEiJwupP\nJ1yT+TiK7j1fnKPPGwL7GDH42/ZTtftL9p7dWNuRQvvXmb50sdiUIcUDgQCQeDC/EvK8JtIIZwtV\n8YnAB4SKPqW+FHbombc0o/GDJjpMb84es229v6cWqlmD6CPcUbpRAr0zZvJ/MUsmDEf4JT4BAjhJ\nDpZoZC0FvEHYqPxJX/dhpxYIOK3mNTh7hVkSOw==\n</ds:SignatureValue>\n        ds:KeyInfo\n            ds:X509Data\n                ds:X509Certificate\nMIIDWjCCAkKgAwIBAgIGAV5R6OrxMA0GCSqGSIb3DQEBCwUAMG4xCzAJBgNVBAYTAlVTMQswCQYD\nVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRYwFAYDVQQKEw1QaW5nIElkZW50aXR5MSkwJwYDVQQD\nEyA1OTMyY2RhZjAwYmI0YjY1ODBlZmI5YjIzYzhkNGEyODAeFw0xNzA5MDUxMTU5MzJaFw0yMDA5\nMDQxMTU5MzJaMG4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRYw\nFAYDVQQKEw1QaW5nIElkZW50aXR5MSkwJwYDVQQDEyA1OTMyY2RhZjAwYmI0YjY1ODBlZmI5YjIz\nYzhkNGEyODCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN8Bci8fB8g/N96iaWmMrSFs\n4G4riau4hcsHDwgRO5Goxe5Nu4S8u7okdZJefxUTCY1fchpOxnxkAvYlW5p4Yr108QYHURGNYX1y\nO729vt4CnCxmovHtJBLB199gMMSUBKy9F9+eXMvTBgGwjjDamL9266oJ07d7KngbD9Jduix/HCMg\noj6HgwYQjGcrOpIMb3G0nHX7oN0MDNeSkaD5AMEwvEmpaQut3r6+lc1zXMWAREVrditsVSwbFPf2\nLHA6hLyqpLY7MRLf0G+sg4+eaeUAy3geIj3incTqusj7GszNzDWK1PaRk9V0Oe6PtLC89ooJKEOq\nH2S8/Tes9gcArRsCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAM24um0Eqf+0e9xQ3pzk28EVFd8I+\nmNOBy1s4w9sstxuWQUcTqtGn6ATvkH9/TRLa2xYJICAgTm8mh3xuJZ/PFqOvCgnd1t5oQA4jeBnb\ntMRT6LPsoq6Nlg4LO+kDUG2uIJIqF9Lj/DPFyf2FUmt0UAFYU0KvIu3sOTLPtkPASy97PpJOX2iv\nAKypchLxmYDY3bKTjL48vSXosd2RnyIGFPaBJG+wCMPrJkJk8tNK5AAF8zA0seskWmmXZN/X6rK9\nVnUwjHG05S3OHDS3jkjhX1QOfanqUWMLi6A7WwRWouZFBpD/XbjPJmyQ0wkdD0kt+nWkFwCFm3h4\nbH3bvI33/Q==\n</ds:X509Certificate>\n            </ds:X509Data>\n            ds:KeyValue\n                ds:RSAKeyValue\n                    ds:Modulus\n3wFyLx8HyD833qJpaYytIWzgbiuJq7iFywcPCBE7kajF7k27hLy7uiR1kl5/FRMJjV9yGk7GfGQC\n9iVbmnhivXTxBgdREY1hfXI7vb2+3gKcLGai8e0kEsHX32AwxJQErL0X355cy9MGAbCOMNqYv3br\nqgnTt3sqeBsP0l26LH8cIyCiPoeDBhCMZys6kgxvcbScdfug3QwM15KRoPkAwTC8SalpC63evr6V\nzXNcxYBERWt2K2xVLBsU9/YscDqEvKqktjsxEt/Qb6yDj55p5QDLeB4iPeKdxOq6yPsazM3MNYrU\n9pGT1XQ57o+0sLz2igkoQ6ofZLz9N6z2BwCtGw==\n</ds:Modulus>\n                    ds:ExponentAQAB</ds:Exponent>\n                </ds:RSAKeyValue>\n            </ds:KeyValue>\n        </ds:KeyInfo>\n    </ds:Signature>\n    samlp:Status\n        <samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/>\n    </samlp:Status>\n    <saml:Assertion Version=\"2.0\" IssueInstant=\"2020-02-26T16:32:48.563Z\" ID=\"I1aj0Qj3thRQrfoDRD-OGJkS5YzmWYsHxkmzxbU4p7u410zUnv7Q\"\n        xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\">\n        saml:Issuer<https://pingone.com/idp/cd-1240574988.cyxtera</saml:Issuer>>\n        saml:Subject\n            <saml:NameID Format=\"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress\">natan.abolafya@cyxtera.com</saml:NameID>\n            <saml:SubjectConfirmation Method=\"urn:oasis:names:tc:SAML:2.0:cm:bearer\">\n                <saml:SubjectConfirmationData NotOnOrAfter=\"2020-02-26T16:47:48.563Z\" Recipient=\"http://127.0.0.1:29001/saml\"/>\n            </saml:SubjectConfirmation>\n        </saml:Subject>\n        <saml:Conditions NotOnOrAfter=\"2020-02-26T16:47:48.563Z\" NotBefore=\"2020-02-26T16:27:48.563Z\">\n            saml:AudienceRestriction\n                saml:Audienceappgate-test</saml:Audience>\n            </saml:AudienceRestriction>\n        </saml:Conditions>\n        <saml:AuthnStatement AuthnInstant=\"2020-02-26T16:32:48.564Z\" SessionIndex=\"I1rEWL8sLc4prfNB7jDIePK7I2euAZS0FZ_IekZclob_1WpQNDEA\">\n            saml:AuthnContext\n                saml:AuthnContextClassRefurn:oasis:names:tc:SAML:2.0:ac:classes:Password</saml:AuthnContextClassRef>\n                saml:AuthenticatingAuthority<https://pingone.com/idp/cd-1240574988.cyxtera</saml:AuthenticatingAuthority>>\n            </saml:AuthnContext>\n        </saml:AuthnStatement>\n        <saml:AttributeStatement\n            xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"emails\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">natan.abolafya@cyxtera.com\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"firstName\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">Natan\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"lastName\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">Abolafya\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"PingOne.idpid\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">40af977b-c9ce-4883-90e4-88ad54b74c6c\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"PingOne.AuthenticatingAuthority\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">https://pingone.com/idp/cd-1240574988.cyxtera\n                </saml:AttributeValue>\n            </saml:Attribute>\n            <saml:Attribute NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\" Name=\"username\">\n                <saml:AttributeValue xsi:type=\"xs:string\"\n                    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">natan.abolafya@cyxtera.com\n                </saml:AttributeValue>\n            </saml:Attribute>\n        </saml:AttributeStatement>\n    </saml:Assertion>\n</samlp:Response>"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There is a major gotcha here. The "
                },
                {
                  "type": "text",
                  "text": "proxy_pass",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " ends up pointing to a fixed IP:Port instead of the dynamic "
                },
                {
                  "type": "text",
                  "text": "$host:$server_port",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": ". This means that you have to set the IP:Port in the upstream block yourself with an appliance customization. Note that if you have multiple backend servers you have to add an upstream block for each one of them along with equal amount of "
                },
                {
                  "type": "text",
                  "text": "proxy_pass",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to those blocks."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1575454048832
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The problem in the first place is the NTLM authentication (note "
                },
                {
                  "type": "text",
                  "text": "WWW-Authenticate: NTLM ...",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "), AKA Windows Authentication."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "NTLM authentication authenticates connections instead of requests, and this is somewhat contradicts HTTP protocol, which is expected to be stateless. As a result it doesn't generally work through proxies, including nginx."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Simplest solution would be to change authentication to \"Basic\" on IIS side. If this not an option for some reason, other possibilities include:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Use stream proxy as available in nginx 1.9.x. This will map connections from clients to upstream server, and thus NTLM authentication will work."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "  Use ntlm feature as available in commercial nginx version."
                        }
                      ]
                    },
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Note that there are some recommendations to use upstream with keepalive for NTLM authentication to work. These recommendations are incorrect and harmful - unless you are using the proxy for just one user. And the worst thing is that it may appear to work correctly. The problem is that keepalive connections to upstream server are kept in a common cache, and these connections can be used for all clients. So if there is an authenticated connection in the cache, an unrelated client who happens to use this connection will be able to bypass authentication."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1575454876804
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Re-opening this to PoC some stuff. cz-configd could talk with cz-sessiond and generate the proper upstream (stream proxy) and server blocks required, depending on the Action objects"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1576443284755
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I'm pretty sure that's not happening in 5.1 so moving it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1579076903964
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Will add the word PoC in the story as here I just tried different approaches/implementation. I have only the nginx official ntlm support to PoC so it can be 5.1"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1579267207571
      }
    ]
  },
  {
    "key": "SA-12685",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "cool =)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1576063265615
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "muy bien "
                },
                {
                  "type": "text",
                  "text": "Kosmas Valianos",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "http://got-youtrack.agi.appgate.com:8112/users/kosmas.valianos",
                        "title": "kosmas.valianos"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " lets do this"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1576068878682
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Remember that you must be able to handle a scenario like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "  ALLOW https://example.com/somewebapplication\n  ALLOW wss://example.com/somewebapplication/websocket\n  BLOCK https://example.com/"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1576070835851
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yeap. The only way is to play with the headers so the module can figure what \"type\" of request it is. They will also arrive in different virtual server as it will be different marking"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1576071547137
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "here is a example from sessiond tests.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Configured URLS:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "`wss://192.168.111.111:8080/somepath"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "ws://192.168.111.111:8080/somepath`"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "NGINX:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "`{"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"uris\": [{"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"uri\": \"192.168.111.111:8080/somepath\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"allow-ips\": [\"dead{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0:beef\", \"10.0.1.1\"],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"report-ips\": [],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"block-ips\": [],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"name\": \"TCP/URL Entitlement 0-0\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"scheme\": \"wss\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}, {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"uri\": \"192.168.111.111:8080/somepath\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"allow-ips\": [\"dead{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0:beef\", \"10.0.1.1\"],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"report-ips\": [],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"block-ips\": [],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"name\": \"TCP/URL Entitlement 1-0\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"scheme\": \"ws\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"ip-to-dn\": [{"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"ip\": \"dead{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "0}}0:beef\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"dn\": \"CN=c42f8f1c95c54975a7f925f922c8f679,CN=stratus6,OU=OKTA\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}, {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"ip\": \"10.0.1.1\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"dn\": \"CN=c42f8f1c95c54975a7f925f922c8f679,CN=stratus6,OU=OKTA\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"debug\": false"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}`"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "VPND:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "`{"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"method\": \"access-control-list\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"params\": {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"entitlement-based-routing\": false,"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"dn\": \"CN=c42f8f1c95c54975a7f925f922c8f679,CN=stratus6,OU=OKTA\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"token-id\": \"cd00946f-b2c8-413e-aeda-15ce59bb0ca2\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"acl-rules\": [{"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"protocol\": \"tcp\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"action-id\": \"a45d5483-6427-3b9d-9164-a761e076f4ed\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"name\": \"TCP\\/URL Entitlement 1-0\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"rule\": \"allow\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"subnets\": [\"192.168.111.111\\/32\"],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"url-access\": \"ws\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"ports\": [\"8080\"],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"direction\": \"up\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}, {"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"protocol\": \"tcp\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"action-id\": \"dbc1ca22-4fb0-3e09-8e36-ab35edb0dc01\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"name\": \"TCP\\/URL Entitlement 0-0\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"rule\": \"allow\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"subnets\": [\"192.168.111.111\\/32\"],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"url-access\": \"wss\","
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"ports\": [\"8080\"],"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"direction\": \"up\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "},"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\"jsonrpc\": \"2.0\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "}`"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1576075810364
      }
    ]
  },
  {
    "key": "SA-12711",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this might be a good start:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "#!/usr/bin/python3\nimport argparse\nimport json\nimport os\nimport sys\nimport requests\n\ndef print_hits(args, hits):\n    for log in hits['hits']:\n        if args.include_es_meta:\n            print(json.dumps(log))\n        else:\n            print(json.dumps(log['_source']))\n\ndef export_logs(args) :\n    r = requests.get(\"%s/_cat/indices?format=json\" % args.es_base)\n    if r.status_code <= 200 or r.status_code > 299:\n        indexes = []\n        tmp = json.loads(r.text)\n        for index_meta in tmp:\n            index_name = index_meta['index']\n            if index_name.startswith('logstash') :\n                indexes.append(index_meta['index'])\n        request_session = requests.Session()\n        for index in indexes:\n            headers = {'Content-Type': 'application/json'}\n            url = \"%s/%s/_search?scroll=1m&pretty\" % (args.es_base, index)\n            search = {\n                \"size\": 100,\n                \"query\": {\n                    \"match_all\" : {}\n                }\n            }\n            if args.event_type != None:\n                search[\"query\"] = {\n                        \"terms\":{\n                            \"event_type\":[args.event_type]\n                        }\n                }\n            scoll = False\n            while True:\n                if scoll:\n                    url = url = \"%s/_search/scroll\" % args.es_base\n                    search = {\"scroll_id\": scoll_id}\n                r = request_session.post(url, data=json.dumps(search), headers=headers)\n                if r.status_code <= 200 or r.status_code > 299:\n                    result = json.loads(r.text)\n                    hits = result['hits']\n                    if len(hits['hits']) == 0 :\n                        break\n                    print_hits(args, hits)\n                    if not scoll :\n                        scoll_id = result['_scroll_id']\n                    scoll = True\n                else:\n                    break\n    else:\n        print(\"Not Ok status from ES: %d\" % r.status_code)\n\ndef add_arguments(parser) :\n    parser.add_argument(\"--event_type\", help=\"Export by event_type\", default=None)\n    parser.add_argument(\"--daemon\", help=\"Export by daemon\", default=None)\n    parser.add_argument(\"--es_base\", default=\"http://localhost:9300\", help=\"Elasticsearch base url\")\n    parser.add_argument(\"--include_es_meta\", default=False, help=\"Include elasticsearch related data\")\n\ndef main() :\n    parser = argparse.ArgumentParser()\n    add_arguments(parser)\n    args = parser.parse_args()\n    export_logs(args)\n\nif name == \"main\":\n    main()"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1576850790518
      }
    ]
  },
  {
    "key": "SA-12769",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Since the new year, the ssl certificate used in the nutanix bootstrap img is invalid and causes failure on cURL"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "ubuntu@nutanix-bootstrap:~$ curl --verbose -o appgate.img.zip  \"https://artifacts.ad.cryptzone.com/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-5.1.0-16547-master.img.zip?is-build-type-id&build-number=16547\"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 52.238.255.154...\n\nTCP_NODELAY set\n\nConnected to artifacts.ad.cryptzone.com (52.238.255.154) port 443 (#0)\n\nALPN, offering h2\n\nALPN, offering http/1.1\n\nsuccessfully set certificate verify locations:\n\nCAfile: /etc/ssl/certs/ca-certificates.crt\nCApath: /etc/ssl/certs\n} [5 bytes data]\n\nTLSv1.3 (OUT), TLS handshake, Client hello (1):\n} [512 bytes data]\n\nTLSv1.3 (IN), TLS handshake, Server hello (2):\n{ [108 bytes data]\n\nTLSv1.2 (IN), TLS handshake, Certificate (11):\n{ [2906 bytes data]\n\nTLSv1.2 (IN), TLS handshake, Server key exchange (12):\n{ [300 bytes data]\n\nTLSv1.2 (IN), TLS handshake, Server finished (14):\n{ [4 bytes data]\n\nTLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n} [37 bytes data]\n\nTLSv1.2 (OUT), TLS change cipher, Client hello (1):\n} [1 bytes data]\n\nTLSv1.2 (OUT), TLS handshake, Finished (20):\n} [16 bytes data]\n\nTLSv1.2 (IN), TLS handshake, Finished (20):\n{ [16 bytes data]\n\nSSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\n\nALPN, server accepted to use http/1.1\n\nServer certificate:\n\nsubject: C=US; ST=Florida; L=Coral Gables; O=Cyxtera Technologies, Inc.; CN=*.cyxtera.com\n\nstart date: Aug 13 00:00:00 2018 GMT\n\nexpire date: Oct  7 12:00:00 2020 GMT\n\nsubjectAltName does not match artifacts.ad.cryptzone.com\n\nSSL: no alternative certificate subject name matches target host name 'artifacts.ad.cryptzone.com'\n\nstopped the pause stream!\n0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n\nClosing connection 0\n} [5 bytes data]\n\nTLSv1.2 (OUT), TLS alert, Client hello (1):\n} [2 bytes data]\ncurl: (51) SSL: no alternative certificate subject name matches target host name 'artifacts.ad.cryptzone.com'\nubuntu@nutanix-bootstrap:~$ \n\n"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " The cert is a copy of "
            },
            {
              "type": "text",
              "text": "https://code.cyxtera.com/appgate/helvetest/blob/master/certs/DigiCertSHA2SecureServerCA.crt",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://code.cyxtera.com/appgate/helvetest/blob/master/certs/DigiCertSHA2SecureServerCA.crt"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": " and located in located /usr/share/ca-certificates/appgate/DigiCertSHA2SecureServerCA.crt on bootstrap img. on the nutanix bootstrap img "
            },
            {
              "type": "text",
              "text": "88dd2f03-39ff-4b96-9ef5-df26253113c1",
              "marks": [
                {
                  "type": "code"
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "resolved, Tyron fixed it, it was problems with the DNS."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "daniel.nilsson",
        "created": 1578040692299
      }
    ]
  },
  {
    "key": "SA-12772",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Check if there is something we need todo to prepare for 7.X"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "the folloing configuration seems to get the node started atleast:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "cluster.name: appgate\ncluster.routing.allocation.disk.watermark.high: 94%\ncluster.routing.allocation.disk.watermark.low: 93%\ndiscovery.zen.minimum_master_nodes: 1\ndiscovery.zen.ping.unicast.hosts: []\ngateway.expected_nodes: 0\nhttp.max_header_size: 256kb\nhttp.port: 9300\nnetwork.host: 127.0.0.1\nnode.name: ${HOSTNAME}\npath:\n  data: /mnt/data/elasticsearch5/data/\n  logs: /mnt/data/elasticsearch5/log/\n  repo:\n    - /tmp/kibanaBackup\n    - /mnt/data/elasticsearch5/backup\nthread_pool.search.queue_size: '10000'\ntransport.publish_port: 9350\ntransport.tcp.keep_alive: false\ntransport.tcp.port: 9301"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1577977817319
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "an 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "08}}24 envy-172-17-104-1.devops cz-elasticsearch[32564]: [WARN ][o.e.d.c.s.Settings ] [envy-172-17-104-1.devops] [discovery.zen.ping.unicast.hosts] setting was deprecated in Elasticsearch and will be removed in a future release! See the breaking changes documentation for the next major version."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "08}}24 envy-172-17-104-1.devops cz-elasticsearch[32564]: [WARN ][o.e.d.c.s.Settings ] [envy-172-17-104-1.devops] [discovery.zen.minimum"
                },
                {
                  "type": "text",
                  "text": "master",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "nodes] setting was deprecated in Elasticsearch and will be removed in a future release! See the breaking changes documentation for the next major version."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "08}}26 envy-172-17-104-1.devops cz-elasticsearch[32564]: [INFO ][o.e.d.DiscoveryModule ] [envy-172-17-104-1.devops] using discovery type [zen] and seed hosts providers [settings]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1577977843430
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "08}}30 envy-172-17-104-1.devops cz-elasticsearch[32564]: [INFO ][o.e.c.r.a.AllocationService] [envy-172-17-104-1.devops] Cluster health status changed from [RED] to [YELLOW] (reason: [shards started [[.kibana\\"
                },
                {
                  "type": "text",
                  "text": "7][0]]]).",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "08}}30 envy-172-17-104-1.devops cz-elasticsearch[32564]: [WARN ][o.e.d.a.b.BulkRequestParser] [envy-172-17-104-1.devops] [types removal] Specifying types in bulk requests is deprecated."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "l"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1577977871208
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}05 envy-172-17-104-1.devops cz-elasticsearch[31604]: [INFO ][o.e.h.AbstractHttpServerTransport] [envy-172-17-104-1.devops] publish"
                },
                {
                  "type": "text",
                  "text": "address {127.0.0.1:9300}, bound",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "addresses {127.0.0.1:9300}"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}05 envy-172-17-104-1.devops cz-elasticsearch[31604]: [INFO ][o.e.n.Node ] [envy-172-17-104-1.devops] started"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}05 envy-172-17-104-1.devops cz-elasticsearch[31604]: [INFO ][o.e.g.GatewayService ] [envy-172-17-104-1.devops] recovered [0] indices into cluster"
                },
                {
                  "type": "text",
                  "text": "state",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}06 envy-172-17-104-1.devops cz-elasticsearch[31604]: [INFO ][o.e.c.m.MetaDataIndexTemplateService] [envy-172-17-104-1.devops] adding template [kibana"
                },
                {
                  "type": "text",
                  "text": "template] for index patterns [.kibana]",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}06 envy-172-17-104-1.devops cz-elasticsearch[31604]: [INFO ][o.e.c.m.MetaDataIndexTemplateService] [envy-172-17-104-1.devops] adding template [logstash"
                },
                {
                  "type": "text",
                  "text": "template] for index patterns [logstash-",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "]"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}06 envy-172-17-104-1.devops cz-elasticsearch[31604]: [INFO ][o.e.r.RepositoriesService] [envy-172-17-104-1.devops] put repository [kibana"
                },
                {
                  "type": "text",
                  "text": "backup]",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan 02 15{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "07}}06 envy-172-17-104-1.devops cz-elasticsearch[31604]: [WARN ][o.e.s.RestoreService ] [envy-172-17-104-1.devops] [snapshot"
                },
                {
                  "type": "text",
                  "text": "1/J8",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "VazJR8qe1OtVNs9UEw] failed to restore snapshot",
                  "marks": [
                    {
                      "type": "strong"
                    },
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Jan"
                },
                {
                  "type": "text",
                  "text": "\\",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so.. it seems like it does not like the default .kibana index.. will be intresting to update from a elasticsearch 6 to 7.. so see if there is a issue.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But feels like the \"original\" .kibana snapshot (for the saved searches) needs to rebuilt."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1577978197823
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Looks like the kibana-6 index is at replica mode 1 for some reason:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-104-1:~# es-tools -c list-shards\nindex               shard prirep state      docs  store ip        node\nlogstash-2020-01-02 0     p      STARTED      33 96.3kb 127.0.0.1 envy-172-17-104-1.devops\n.kibana-6           0     p      STARTED       9 12.3kb 127.0.0.1 envy-172-17-104-1.devops\n.kibana-6           0     r      UNASSIGNED                       \n.kibana_7           0     p      STARTED      23 12.7kb 127.0.0.1 envy-172-17-104-1.devops\nroot@envy-172-17-104-1:~# "
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1577978314902
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "following kibana config, kind of works:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "console.enabled: false\nnewsfeed.enabled: false\nelasticsearch.hosts:\n\nhttp://127.0.0.1:9300\nelasticsearch.preserveHost: true\nelasticsearch.ssl.verificationMode: full\nkibana.defaultAppId: discover\nkibana.index: .kibana\nmap.tilemap.url: https://tiles.elastic.co/v2/default/{z}/{x}/{y}.png\npath.data: /mnt/data/kibana/data/\npid.file: /run/czd/kibana.pid\nserver.basePath: /auditlogs\nserver.host: 127.0.0.1\nserver.port: 9310\nserver.rewriteBasePath: true\n\n"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578037614068
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "seems like the temple.js.hbs has a less vital role into kibana.... it has moved to ./src/legacy/ui/ui\\"
                },
                {
                  "type": "text",
                  "text": "render/bootstrap/template.js.hbs the \"legacy\" feels like its being phased out.. anyway the auth.lua seems to work, after changeing the destination of the \"mods\"",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578041610163
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "saved searches and such needs to be updated.. seems like the snapshot we have, is not compatible with the new kibana version.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will try to take another snapshot, using a empty kibana index. and see if that works.. Really really annoying is also that they changed the name of the .kibana index.."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "to .kibana\\"
                },
                {
                  "type": "text",
                  "text": "2 and .kibana\\",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "1 ... and in Appgate 5 we name them like .kibana\\"
                },
                {
                  "type": "text",
                  "text": "7 so... need to check for both.. before adding the snapshot",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578043334472
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "hum.. seems like the content type is needed now adays in the creation of snapshot location.. so README in logging repo will need a update.."
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -XPUT 'http://localhost:9300/_snapshot/kibana_backup' -H 'Content-Type: application/json' -d '{\n    \"type\": \"fs\",\n    \"settings\": {\n        \"compress\" : true,\n        \"location\": \"/tmp/kibanaBackup\"\n    }\n}'"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578043534817
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Maybe we should be using the \"kibana.index\" setting. "
                },
                {
                  "type": "text",
                  "text": "https://www.elastic.co/guide/en/kibana/current/settings.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.elastic.co/guide/en/kibana/current/settings.html"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " to specify the index.. so we always know its name"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578043978018
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "aha.. we already have that setting... so i guess kibana uses the name as a \"prefix\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578044781755
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "OR.. its a alias... because doing a snapshot of it.. like :"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@envy-172-17-104-1:/tmp/kibanaBackup# rm -rf *\nroot@envy-172-17-104-1:/tmp/kibanaBackup# cd ..\nroot@envy-172-17-104-1:/tmp# curl -XPUT 'http://localhost:9300/_snapshot/kibana_backup/snapshot_1?wait_for_completion=true&pretty' -H 'Content-Type: application/json' -d '{\n     \"indices\": \".kibana\",\n     \"ignore_unavailable\": \"false\",\n     \"include_global_state\": \"false\"\n}'\n{\n  \"snapshot\" : {\n    \"snapshot\" : \"snapshot_1\",\n    \"uuid\" : \"kVYW7ynGQ2OHYcrCQBT3Aw\",\n    \"version_id\" : 7050199,\n    \"version\" : \"7.5.1\",\n    \"indices\" : [\n      \".kibana_2\"\n    ],\n    \"include_global_state\" : false,\n    \"state\" : \"SUCCESS\",\n    \"start_time\" : \"2020-01-03T09:49:22.821Z\",\n    \"start_time_in_millis\" : 1578044962821,\n    \"end_time\" : \"2020-01-03T09:49:23.021Z\",\n    \"end_time_in_millis\" : 1578044963021,\n    \"duration_in_millis\" : 200,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 1,\n      \"failed\" : 0,\n      \"successful\" : 1\n    }\n  }\n}"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578045040096
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But.. adding and removing searches/visualizations/dashboards is not working like it used to..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "they however has added a new API.. that is experimental "
                },
                {
                  "type": "text",
                  "text": "https://www.elastic.co/guide/en/kibana/7.x/dashboard-import-api.html",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.elastic.co/guide/en/kibana/7.x/dashboard-import-api.html"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578047507466
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ok.. so if you know the id of a saved search.. you can do like :"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": " curl -X GET \"localhost:9310/auditlogs/api/saved\\_objects/search/SSH-access-log\""
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": " to export it.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578054903129
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And.. we can for example use the following command to change how the saved search looks.. (here we only include the event\\"
                },
                {
                  "type": "text",
                  "text": "type in the collumns for example)",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "curl -X POST \"localhost:9310/auditlogs/api/saved\\_objects/search/SSH-access-log?overwrite=true\" -H 'kbn-xsrf: true' -H 'Content-Type: application/json' -d'{\"attributes\":{\"hits\":0,\"columns\":\\[\"event\\_type\"\\],\"description\":\"\",\"sort\":\\[\"@timestamp\",\"desc\"\\],\"title\":\"SSH access log\",\"version\":1,\"kibanaSavedObjectMeta\":{\"searchSourceJSON\":\"{\\\\\"index\\\\\":\\\\\"logstash-\\*\\\\\",\\\\\"highlight\\\\\":{\\\\\"pre\\_tags\\\\\":\\[\\\\\"@kibana-highlighted-field@\\\\\"\\],\\\\\"post\\_tags\\\\\":\\[\\\\\"@/kibana-highlighted-field@\\\\\"\\],\\\\\"fields\\\\\":{\\\\\"\\*\\\\\":{}},\\\\\"require\\_field\\_match\\\\\":false,\\\\\"fragment\\_size\\\\\":2147483647},\\\\\"filter\\\\\":\\[{\\\\\"$state\\\\\":{\\\\\"store\\\\\":\\\\\"appState\\\\\"},\\\\\"meta\\\\\":{\\\\\"alias\\\\\":null,\\\\\"disabled\\\\\":false,\\\\\"index\\\\\":\\\\\"logstash-\\*\\\\\",\\\\\"key\\\\\":\\\\\"daemon\\\\\",\\\\\"negate\\\\\":false,\\\\\"value\\\\\":\\\\\"cz-appliance\\\\\"},\\\\\"query\\\\\":{\\\\\"match\\\\\":{\\\\\"daemon\\\\\":{\\\\\"query\\\\\":\\\\\"cz-appliance\\\\\",\\\\\"type\\\\\":\\\\\"phrase\\\\\"}}}}\\],\\\\\"query\\\\\":{\\\\\"query\\_string\\\\\":{\\\\\"analyze\\_wildcard\\\\\":true,\\\\\"query\\\\\":\\\\\"\\*\\\\\"}}}\"}}}'"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578055428788
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "so... using this.. i guess it would be possible to have all the latest version of searches/visualizations/dashboards.. and if they can not be found... they are inserted."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578055501246
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "per.leino",
                    "text": "@per.leino",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " - Is this just a task that is designed to keep "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "natan.abolafya",
                    "text": "@natan.abolafya",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " busy having to update the sprints or ???"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "jamie.bodley-scott",
        "created": 1609761313422
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Ha ha.. he does that with a script.. so dont worry about that.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1610441039116
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Elasticsearch 7 is something that needs to happen.. once elatic has releases a LTS version of elasticsearch 7..  and also a a first patch release.. it never good to run a 0 version."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1610441096245
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "So here is the list: "
                },
                {
                  "type": "text",
                  "text": "https://www.elastic.co/support/eol",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.elastic.co/support/eol"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "   we can see that 6.8.x is supported until 8..0.0 is relased.. and that has not happend yet.. 7.9.x for example. is only supported until 7.10.0..  so those releases are not good to use..  But it should happens any time now that a LTS release is released.. and then we should update.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1610441413046
      }
    ]
  },
  {
    "key": "SA-12783",
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Since "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-12782",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-12782"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " is implemented.. Then it would make sense, to remove the complete default index creation.. since its not needed anymore."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "it would be much better if kibana did that it self.. So since we are able to insert the saved searches and similar.. we can do the same thing with the index.."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578065022304
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "Jan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]: INFO [ActionsRunner] ApplyLogServerServicesAction done\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]: INFO [ActionsRunner] Running action KibanaExportService() ...\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]: usage: kibanaImpExp.py [-h] [--export_file EXPORT_FILE]\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]:                        [--output_dir OUTPUT_DIR] [--version VERSION]\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]:                        [--input_dir INPUT_DIR] [--kibana_saved KIBANA_SAVED]\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]:                        [--version_file VERSION_FILE] [--kibana_url KIBANA_URL]\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]: kibanaImpExp.py: error: unrecognized arguments: --elastic_search http://127.0.0.1:9300\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]: ERROR [ActionsRunner] Unhandled error while running action KibanaExportService(), carry on...\n                                                          Traceback (most recent call last):\n                                                            File \"/usr/cz-configd/configd/action/actions_runner.py\", line 155, in run\n                                                              action_result = action()\n                                                            File \"/usr/cz-configd/configd/logserver/actions.py\", line 66, in call\n                                                              'http://127.0.0.1:{}'.format(LocalhostPortsTcp.elasticsearch_http.value)])\n                                                            File \"/usr/lib/python3.6/subprocess.py\", line 311, in check_call\n                                                              raise CalledProcessError(retcode, cmd)\n                                                          subprocess.CalledProcessError: Command '['/usr/cz-kibanaBackup/kibanaImpExp.py', '--input_dir', '/usr/cz-kibanaBackup/', '--version_file', '/mnt/data/kib\nJan 08 09:18:13 envy-172-17-110-1.devops cz-configd[819]: INFO [ActionsRunner] Running action LogServerChangeNrOfReplicasAction(number_of_replicas=0) ..."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1578479117094
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This was fixed here "
                },
                {
                  "type": "text",
                  "text": "https://youtrack.ad.cryptzone.com/issue/SA-12782",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://youtrack.ad.cryptzone.com/issue/SA-12782"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.leino",
        "created": 1582882807775
      }
    ]
  },
  {
    "key": "SA-12786",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[2020-01-06T13:48:34.121Z] Info: Navigation: https://sdphelp.appgate.com/userguide/v5.1/\n[2020-01-06T13:48:42.453Z] Info: About by app menu.\n[2020-01-06T13:52:09.526Z] Info: About by app menu.\n[2020-01-06T17:18:50.252Z] Error: TypeError: Cannot read property 'selectedProfile' of undefined\n[2020-01-06T17:18:50.254Z] Error: Uncaught TypeError: Cannot read property 'selectedProfile' of undefined\n[2020-01-06T17:18:50.589Z] Info: Automatically signed out. Due to administrative policy, you have been signed out after staying idle for too long."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Only happens when you're on the about page lol."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1578413296989
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[^image1578413331278.png]"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1578413344267
      }
    ]
  },
  {
    "key": "SA-12851",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Controller"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  Frontend"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  purple auto-update script"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "  test redhat"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "minion@kg-centos8 ~]$ cat /etc/os-release\nNAME=\"CentOS Linux\"\nVERSION=\"8 (Core)\"\nID=\"centos\"\nID_LIKE=\"rhel fedora\"\nVERSION_ID=\"8\"\nPLATFORM_ID=\"platform:el8\"\nPRETTY_NAME=\"CentOS Linux 8 (Core)\"\nANSI_COLOR=\"0;31\"\nCPE_NAME=\"cpe:/o:centos:centos:8\"\nHOME_URL=\"https://www.centos.org/\"\nBUG_REPORT_URL=\"https://bugs.centos.org/\"\n\nCENTOS_MANTISBT_PROJECT=\"CentOS-8\"\nCENTOS_MANTISBT_PROJECT_VERSION=\"8\"\nREDHAT_SUPPORT_PRODUCT=\"centos\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"8\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1579184091562
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[minion@kg-centos7 ~]$ cat /etc/os-release\nNAME=\"CentOS Linux\"\nVERSION=\"7 (Core)\"\nID=\"centos\"\nID_LIKE=\"rhel fedora\"\nVERSION_ID=\"7\"\nPRETTY_NAME=\"CentOS Linux 7 (Core)\"\nANSI_COLOR=\"0;31\"\nCPE_NAME=\"cpe:/o:centos:centos:7\"\nHOME_URL=\"https://www.centos.org/\"\nBUG_REPORT_URL=\"https://bugs.centos.org/\"\n\nCENTOS_MANTISBT_PROJECT=\"CentOS-7\"\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\nREDHAT_SUPPORT_PRODUCT=\"centos\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1579184111903
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "[minion@pantagruel ~]$ cat /etc/os-release\nNAME=\"Red Hat Enterprise Linux Workstation\"\nVERSION=\"7.7 (Maipo)\"\nID=\"rhel\"\nID_LIKE=\"fedora\"\nVARIANT=\"Workstation\"\nVARIANT_ID=\"workstation\"\nVERSION_ID=\"7.7\"\nPRETTY_NAME=\"Red Hat Enterprise Linux\"\nANSI_COLOR=\"0;31\"\nCPE_NAME=\"cpe:/o:redhat:enterprise_linux:7.7:GA:workstation\"\nHOME_URL=\"https://www.redhat.com/\"\nBUG_REPORT_URL=\"https://bugzilla.redhat.com/\"\n\nREDHAT_BUGZILLA_PRODUCT=\"Red Hat Enterprise Linux 7\"\nREDHAT_BUGZILLA_PRODUCT_VERSION=7.7\nREDHAT_SUPPORT_PRODUCT=\"Red Hat Enterprise Linux\"\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7.7\""
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1579184125299
      }
    ]
  },
  {
    "key": "SA-12877",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "http://nginx.org/en/docs/http/ngx\\_http\\_upstream\\_module.html#ntlm",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "http://nginx.org/en/docs/http/ngx_http_upstream_module.html#ntlm"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Subscribed for the 30 days trial of nginx plus. It works perfect... and the most important thing is that it works in the http level where our module hooks"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "nginx conf"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "upstream http_backend {\n    server 172.17.93.58;\n    ntlm;\n}\n\nserver {\n    listen 172.17.142.2:8080;\n    resolver 127.0.0.1:9253;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for\n\n    location /ntlm {\n       proxy_pass <http://http_backend;>\n       proxy_http_version 1.1;\n       proxy_set_header Connection \"\";\n    }\n\n}\n\n"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "kosmas.valianos",
        "created": 1580307269988
      }
    ]
  },
  {
    "key": "SA-12923",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Referencing this email from jamie: Quoting jamie "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Hi all\n\nIn v5 the resolver is completely broken (so no one is using it).\nIt may have worked in v4 but we realised that it returned internal IPs from within the container which the Gateways do not have access to - so the resolver does not do what was intended and could not have been used.\n\nSince multiple applications are hosted behind the same IP in Kubernetes, for access control, we've introduced url-filtering feature with v5.0, which restricts access based on hostname or path. For example you can create an entitlement that allows following apps: \"Allow https://app1.company.com\" or \"Allow https://apps.company.com/app1\".\n\nAs it is now (in 5.1) where it works again - it presents a security risk because the returned IPs are from an isolated network, different from the Gateway's network where the same IP address range might be used for some other purpose.\n\nIt is therefore my intention to make the K8S resolver disappear in the 5.1 release.\n\nDoes anyone have an issue with this late surprise?\n\nJ."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-12980",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "To be able to use the open api specification for code generation, we need to resolve the issue from the validator and generator (see attached files)"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "How to re-produce "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "the appgate_sdp_controller.json  file is downloaded from an appliance envrionment at https://controllerAddr.devops:444/api_specs.html\n\nRun open api validation\n\n docker run --rm -v ${PWD}:/local openapitools/openapi-generator-cli validate \\\n    -i /local/appgate_sdp_controller.json \n\nGenerate go code from the openAPI spec file\n\ndocker run --rm -v ${PWD}:/local openapitools/openapi-generator-cli generate \\\n    -i /local/appgate_sdp_controller.json \\\n    -g go \\\n    -o /local/out/go "
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "well, it complains about every API, not sure what I'm supposed to do :D"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1580132492861
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I don't either unfortunately, I'm not that familiar with openapi yet. need to debug further, any help is welcome :)"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "daniel.nilsson",
        "created": 1580137186890
      }
    ]
  },
  {
    "key": "SA-11867",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The following error (seen on purple31): "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "{'error': {'code': 403, 'message': 'Request had insufficient authentication scopes.', 'status': 'PERMISSION_DENIED'}}"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Results in a stack trace when parsing the error: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Aug 29 15:36:22 purple31.cryptzone.com cz-named[3544]: [DEBUG] [gcp] API Request https://cloudresourcemanager.googleapis.com/v1/projects - query: {'filter': 'lifecycleState:ACTIVE AND (appgate-dev)', 'fields': 'projects.projectId'} - response 403\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]: [DEBUG] [gcp] End of pagination, no more results for https://cloudresourcemanager.googleapis.com/v1/projects .\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]: [ERROR] [Resolver \"GCP Resolver - appgate-dev, GCP Resolver - product-team-222016\"] Error occurred when resolving uri label:deployment=test-harish\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]: Traceback (most recent call last):\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:   File \"/usr/cz-named/named/resolvers/resolver.py\", line 176, in resolve\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:     return await self.resolve_name(name=name, backoff_f=backoff_f)\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:   File \"/usr/cz-named/named/resolvers/gcp/resolver.py\", line 216, in resolve_name\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:     projects = list(await client.get_projects(project_filter=gcp_name.filter_project))\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:   File \"/usr/cz-named/named/resolvers/gcp/client.py\", line 259, in get_projects\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:     callback=instance_resolver_from_project_response))\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:   File \"/usr/cz-named/named/resolvers/gcp/client.py\", line 305, in traverse_request\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]:     for error in response.content['error']['errors']:\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]: KeyError: 'errors'\nAug 29 15:36:22 purple31.cryptzone.com cz-named[3544]: [DEBUG] [Resolver \"GCP Resolver - appgate-dev, GCP Resolver - product-team-222016\"] Names batch 0 resolved in 0.11 seconds"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-24085",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "One windows proxy test has been failing consistently for some time due to shim not liking some certificate."
            }
          ]
        },
        {
          "type": "blockquote",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "[ca_renewal\\ca_renewal_2fa_on_boarding] [client-service/stdout] [2024-07-02T05:34:32.666Z] Info : 'VPN Proxy Site': Connection to envy-10-98-131-3.devops (10.98.131.3) failed: DecodeError - Failed to decode PKCS12"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Seems to be happening since the morning of June 21."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "aitorbot test get -t proxy_windows -d 5\naitorbot ['proxy_windows'] | 2024-06-20 05:00:07\n        id:   224c144b-59b5-40a7-9987-9bbd3b71ce7d\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1324592"
            },
            {
              "type": "text",
              "text": "\n        passed: 22/22\naitorbot ['proxy_windows'] | 2024-06-21 05:00:07\n        id:   e85fcc2f-5c9c-4e70-844c-08b105f872f1\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1325051"
            },
            {
              "type": "text",
              "text": "\n        passed: 21/22\naitorbot ['proxy_windows'] | 2024-06-22 05:00:07\n        id:   a1edb0aa-a3e7-4b9e-a56d-83ab66274f0c\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1325450"
            },
            {
              "type": "text",
              "text": "\n        passed: 21/22\naitorbot ['proxy_windows'] | 2024-06-23 05:00:08\n        id:   3bc3e558-4407-491c-ba4e-4b42e77b56c0\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1325839"
            },
            {
              "type": "text",
              "text": "\n        passed: 21/22\naitorbot ['proxy_windows'] | 2024-06-24 05:00:07\n        id:   b9e8d058-78aa-4964-86be-f26177b4ea4b\n        url:  "
            },
            {
              "type": "text",
              "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1326228"
            },
            {
              "type": "text",
              "text": "\n        passed: 21/22"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Started happening after wolfSSL 5.7.0 update - shim/ipt use same code here, so it's strange that we don't see this problem with the normal client."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1719932262346
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But proxy tests seem unstable for other reason? Or well nightly passed, maybe I just start a bad test suite in my own tests - at least the decoding errors were gone from my runs anyhow."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1720502554117
      }
    ]
  },
  {
    "key": "SA-24160",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I see this when I start the client locally."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Here is the full text "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "WARNING in ./assets/styles/manifest.scss (../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./assets/styles/manifest.scss)\nModule Warning (from ../../node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 9, column 2 of file:///C:/Users/natan.abolafya/Code/stratus-client-shared/src/empower/ui/app/assets/styles/mixins/_truncate.scss:9:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n9 |   overflow: hidden;\n\n\napp\\assets\\styles\\mixins\\_truncate.scss 10:3    truncate()\napp\\components\\common\\button\\_button.scss 67:3  @forward\napp\\assets\\styles\\components\\_index.scss 5:1    @use\napp\\assets\\styles\\manifest.scss 7:1             root stylesheet\nWARNING in ./assets/styles/manifest.scss (../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./assets/styles/manifest.scss)\nModule Warning (from ../../node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 10, column 2 of file:///C:/Users/natan.abolafya/Code/stratus-client-shared/src/empower/ui/app/assets/styles/mixins/_truncate.scss:10:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n10 |   width: $width;\n\n\napp\\assets\\styles\\mixins\\_truncate.scss 11:3    truncate()\napp\\components\\common\\button\\_button.scss 67:3  @forward\napp\\assets\\styles\\components\\_index.scss 5:1    @use\napp\\assets\\styles\\manifest.scss 7:1             root stylesheet\nWARNING in ./assets/styles/manifest.scss (../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./assets/styles/manifest.scss)\nModule Warning (from ../../node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 21, column 2 of file:///C:/Users/natan.abolafya/Code/stratus-client-shared/src/empower/ui/app/components/common/app-launcher/_app-shortcut.scss:21:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n21 |   max-width: 100%;\n\n\napp\\components\\common\\app-launcher\\_app-shortcut.scss 22:3  @forward\napp\\assets\\styles\\components\\_index.scss 3:1                @use\napp\\assets\\styles\\manifest.scss 7:1                         root stylesheet\nWARNING in ./assets/styles/manifest.scss (../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./assets/styles/manifest.scss)\nModule Warning (from ../../node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 22, column 2 of file:///C:/Users/natan.abolafya/Code/stratus-client-shared/src/empower/ui/app/components/common/app-launcher/_app-shortcut.scss:22:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n22 |   transition: background-color .2s ease-in, color .2s ease-in, border .2s ease-in;\n\n\napp\\components\\common\\app-launcher\\_app-shortcut.scss 23:3  @forward\napp\\assets\\styles\\components\\_index.scss 3:1                @use\napp\\assets\\styles\\manifest.scss 7:1                         root stylesheet\nWARNING in ./assets/styles/manifest.scss (../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./assets/styles/manifest.scss)\nModule Warning (from ../../node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 23, column 2 of file:///C:/Users/natan.abolafya/Code/stratus-client-shared/src/empower/ui/app/components/common/app-launcher/_app-shortcut.scss:23:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n23 |   margin: 0;\n\n\napp\\components\\common\\app-launcher\\_app-shortcut.scss 24:3  @forward\napp\\assets\\styles\\components\\_index.scss 3:1                @use\napp\\assets\\styles\\manifest.scss 7:1                         root stylesheet\nWARNING in ./assets/styles/manifest.scss (../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./assets/styles/manifest.scss)\nModule Warning (from ../../node_modules/sass-loader/dist/cjs.js):\n66 repetitive deprecation warnings omitted."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The use of declarations after nested rules is currently deprecated in Sass",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " From "
                },
                {
                  "type": "text",
                  "text": "https://sass-lang.com/documentation/breaking-changes/mixed-decls/#deprecating-the-old-way",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://sass-lang.com/documentation/breaking-changes/mixed-decls/#deprecating-the-old-way"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It seems to be ok in the frontend"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1721227526948
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "h, my bad, I guess I didn't install the latest packages, we have the same issue in the admin UI It seem that the "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "include",
                    "text": "@include",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " m.dark-theme {",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " are triggering the error as well The admin UI task: "
                },
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com/issue/SA-24167/Go-through-CSS-deprecation-warnings",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-youtrack.agi.appgate.com/issue/SA-24167/Go-through-CSS-deprecation-warnings"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1721378439463
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I couldn't figure out how to see the warnings, but this is how I think these issues are solved. Currently, the dark theme SCSS is added like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ".selector {\n -color: white;\n \n @include m.dark-theme {\n   --color: black;\n }\n \n color: var(--color);\n \n &--other {\n ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There seems to be two options to fix it. As it is just code structure, the developers should agree on the best option and update every file accordingly."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "1. Move dark-theme"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Put it after any top-level property. Like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ".selector {\n -color: white;\n \n color: var(--color);// Property placed above the @include\n \n @include m.dark-theme { // Mixin places below the properties\n   --color: black;\n }\n \n &--other {\n ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Pros with this approach: No extra characters. More in line with how CSS is supposed to be written."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Cons with this approach: The light and dark color are separated by other properties."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "2. Wrap properties with a &"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Wrap the \"base\" properties like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ".selector {\n -color: white;\n \n @include m.dark-theme { // This stays as it is\n   --color: black;\n }\n \n & { // This & wraps all properties that are not wrapped by anything else\n   color: var(--color);\n }\n \n &--other {\n ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Pros with this approach: Dark color overrides are close to the light colors"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Cons with this approach: The & is added in lots of places. The "
                },
                {
                  "type": "text",
                  "text": ".selector",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will probably be added twice in the generated CSS."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "carina.olsson",
        "created": 1721637965484
      }
    ]
  },
  {
    "key": "SA-24167",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Description"
            }
          ],
          "attrs": {
            "level": 3
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The update of sass triggers warnings in the console"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "ex: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "[webpack-dev-server] WARNING in ./app/navigation/navigation/navigation.scss (./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./app/navigation/navigation/navigation.scss)\nModule Warning (from ./node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 26, column 2 of file:///home/hadrien/git/stratus-frontend/react/app/navigation/navigation/navigation.scss:26:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n26 |   display: flex;\n\n\napp/navigation/navigation/navigation.scss 27:3  root stylesheet\nindex.js:489\n[webpack-dev-server] WARNING in ./app/navigation/navigation/navigation.scss (./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./app/navigation/navigation/navigation.scss)\nModule Warning (from ./node_modules/sass-loader/dist/cjs.js):\nDeprecation Warning on line 27, column 2 of file:///home/hadrien/git/stratus-frontend/react/app/navigation/navigation/navigation.scss:27:2:\nSass's behavior for declarations that appear after nested\nrules will be changing to match the behavior specified by CSS in an upcoming\nversion. To keep the existing behavior, move the declaration above the nested\nrule. To opt into the new behavior, wrap the declaration in `& {}`.\n\nMore info: "
            },
            {
              "type": "text",
              "text": "https://sass-lang.com/d/mixed-decls"
            },
            {
              "type": "text",
              "text": "\n\n27 |   font-size: .875rem;\n\n\napp/navigation/navigation/navigation.scss 28:3  root stylesheet"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "See the client issue "
            },
            {
              "type": "text",
              "text": "https://got-youtrack.agi.appgate.com/issue/SA-24160/Go-through-CSS-deprecation-warnings",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://got-youtrack.agi.appgate.com/issue/SA-24160/Go-through-CSS-deprecation-warnings"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "it seems that the "
            },
            {
              "type": "mention",
              "attrs": {
                "id": "include",
                "text": "@include",
                "accessLevel": ""
              }
            },
            {
              "type": "text",
              "text": " m.dark-theme {",
              "marks": [
                {
                  "type": "code"
                }
              ]
            },
            {
              "type": "text",
              "text": " trigger the issue :("
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Definition of Done"
            }
          ],
          "attrs": {
            "level": 3
          }
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "No more warnings"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "hadrien.luttiau",
                    "text": "@hadrien.luttiau",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " Where are these errors displayed? What should I run to see them?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "carina.olsson",
        "created": 1721629573740
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "carina.olsson",
                    "text": "@carina.olsson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " I get them in the terminal when running yarn watch"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "viola.sorgato",
        "created": 1721633946751
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I couldn't figure out how to see the warnings, but this is how I think these issues are solved. Currently, the dark theme SCSS is added like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ".selector {\n -color: white;\n \n @include m.dark-theme {\n   --color: black;\n }\n \n color: var(--color);\n \n &--other {\n ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There seems to be two options to fix it. As it is just code structure, the developers should agree on the best option and update every file accordingly."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "1. Move dark-theme"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Put it after any top-level property. Like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ".selector {\n -color: white;\n \n color: var(--color);// Property placed above the @include\n \n @include m.dark-theme { // Mixin places below the properties\n   --color: black;\n }\n \n &--other {\n ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Pros with this approach: No extra characters. More in line with how CSS is supposed to be written."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Cons with this approach: The light and dark color are separated by other properties."
                }
              ]
            },
            {
              "type": "heading",
              "content": [
                {
                  "type": "text",
                  "text": "2. Wrap properties with a &"
                }
              ],
              "attrs": {
                "level": 2
              }
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Wrap the \"base\" properties like this:"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": ".selector {\n -color: white;\n \n @include m.dark-theme { // This stays as it is\n   --color: black;\n }\n \n & { // This & wraps all properties that are not wrapped by anything else\n   color: var(--color);\n }\n \n &--other {\n ..."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Pros with this approach: Dark color overrides are close to the light colors"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Cons with this approach: The & is added in lots of places. The "
                },
                {
                  "type": "text",
                  "text": ".selector",
                  "marks": [
                    {
                      "type": "code"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": " will probably be added twice in the generated CSS."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "carina.olsson",
        "created": 1721637935794
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I would go for the first suggestion, it feels like it's less intrusive & requires less changes. "
                },
                {
                  "type": "mention",
                  "attrs": {
                    "id": "viola.sorgato",
                    "text": "@viola.sorgato",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " what do you think ?"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "mention",
                  "attrs": {
                    "id": "carina.olsson",
                    "text": "@carina.olsson",
                    "accessLevel": ""
                  }
                },
                {
                  "type": "text",
                  "text": " do you have a preference ?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "hadrien.luttiau",
        "created": 1721638779745
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Yes, let's go for that. That is what Natan did for the client also."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "carina.olsson",
        "created": 1721650953682
      }
    ]
  },
  {
    "key": "SA-24172",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "A lot of Fedora nighlies are failing due to crash. This has been the case for a while but it was one or two failures and we could not reproduce out of e2e. Now that I've upgraded the test agent to Fedora 40, ~15 tests are failing due to crashes. We should probably investigate that."
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "After trying again and again, I got this on the agent:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "And the full-on journalctl:"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I get a very similar crash once in a while in the actual test device too but on that device it never generates a UI log. Just says \"Fatal process out of memory: Failed to reserve virtual memory for CodeRange)\" on stderr. This is quite strange."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "But I think this is a legit issue."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1721839417972
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Possibly related: "
                },
                {
                  "type": "text",
                  "text": "https://discussion.fedoraproject.org/t/selinux-execheap-denials/120638/56",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://discussion.fedoraproject.org/t/selinux-execheap-denials/120638/56"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1721839767097
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "https://issues.chromium.org/issues/350117526",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://issues.chromium.org/issues/350117526"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "per.allansson",
        "created": 1722253788891
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Seems like a potential kernel bug: "
                },
                {
                  "type": "text",
                  "text": "https://bugzilla.redhat.com/show_bug.cgi?id=2254434",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2254434"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "christoffer.karlsson",
        "created": 1723621292284
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reisner.marc                                                           2024-08-16 02{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "44}}02 UTC"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "The fix was merged into the mainline kernel.\n\n"
                },
                {
                  "type": "text",
                  "text": "https://lore.kernel.org/all/30fc5b38165e4eda57d640eca76b7df1@paul-moore.com/"
                },
                {
                  "type": "text",
                  "text": "\n\nIt just needs to be merged into the next stable kernel and released by Fedora. I'm guessing that will be next week.\n"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Comment 174",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://bugzilla.redhat.com/show_bug.cgi?id=2254434#c174"
                      }
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Steve                                                           2024-08-17 14{{COLON"
                },
                {
                  "type": "text",
                  "text": "NUM",
                  "marks": [
                    {
                      "type": "em"
                    }
                  ]
                },
                {
                  "type": "text",
                  "text": "27}}45 UTC"
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "(In reply to reisner.marc from comment #173)\n> The fix was merged into the mainline kernel.\n\nThanks for pointing that out.\n\nMainline kernels are usually released on Sundays:\n\n"
                },
                {
                  "type": "text",
                  "text": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/refs/"
                },
                {
                  "type": "text",
                  "text": "\n\nLinux v6.11-rc4 should have this merge commit, which includes the fix:\n\n"
                },
                {
                  "type": "text",
                  "text": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9d5906799f7d89c9e12f6d2e0fccb00713c945ab"
                },
                {
                  "type": "text",
                  "text": "\n\nI'm not sure about the release schedule for stable kernels, but Fedora users can look for kernel updates here:\n\n"
                },
                {
                  "type": "text",
                  "text": "https://bodhi.fedoraproject.org/updates/?packages=kernel"
                },
                {
                  "type": "text",
                  "text": "\n"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "christoffer.karlsson",
        "created": 1724076159927
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Kernel kernel-6.10.6-200.fc40 is hopefully the one solving this issue. It's was sent to Fedora testing repository last night."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "christoffer.karlsson",
        "created": 1724160624195
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Verified that issue is solved in Fedora kernel kernel-6.10.6-200.fc40. Closing bug. Should we mention this in some release notes or something?"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "christoffer.karlsson",
        "created": 1724664299835
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I will inform Brian O'Donnell about it."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1724664766099
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "I am updating the Fedora test agent also."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1724666162878
      }
    ]
  },
  {
    "key": "SA-24235",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Relevant discussion "
            },
            {
              "type": "text",
              "text": "https://appgate.slack.com/archives/CU6C3DVA8/p1723455876675569",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://appgate.slack.com/archives/CU6C3DVA8/p1723455876675569"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Right now we are getting rate limited."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "$ curl -I "
            },
            {
              "type": "text",
              "text": "https://api.github.com/meta",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://api.github.com/meta"
                  }
                }
              ]
            },
            {
              "type": "text",
              "text": "\n HTTP/2 200 \ndate: Mon, 12 Aug 2024 09:54:24 GMT\n"
            },
            {
              "type": "text",
              "text": "content-type: application/json; charset=utf-8\n cache-control: public, max-age=60, s-maxage=60\nvary: Accept,Accept-Encoding, Accept, X-Requested-With\netag: W/\"442c480b4cd89be2014144c0585cf510497ed6fbc8b795660ae26a2a61960f7a\"\nx-github-media-type: github.v3; format=json\nx-github-api-version-selected: 2022-11-28 access-control-expose-headers: ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Used, X-RateLimit-Resource, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type, X-GitHub-SSO, X-GitHub-Request-Id, Deprecation, Sunset\naccess-control-allow-origin: *\n"
            },
            {
              "type": "text",
              "text": "strict-transport-security: max-age=31536000; includeSubdomains; preload\nx-frame-options: deny\nx-content-type-options: nosniff\nx-xss-protection: 0\nreferrer-policy: origin-when-cross-origin, strict-origin-when-cross-origin\ncontent-security-policy: default-src 'none'\nserver: github.com\nx-ratelimit-limit: 60\nx-ratelimit-remaining: 46\nx-ratelimit-reset: 1723459655\nx-ratelimit-resource: core\nx-ratelimit-used: 14\naccept-ranges: bytes\nx-github-request-id: CE82:09C3:1605EA2:1751B0F:66B9DBCF"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Query every X minutes (e.g. 10) under rate limit and cache result. Public endpoint returns the cached value. Done."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1723456799866
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "will use Policy Engine caching instead. "
                },
                {
                  "type": "text",
                  "text": "https://sdphelp.appgate.com/adminguide/v6.3/external-calls.html?q=cache",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://sdphelp.appgate.com/adminguide/v6.3/external-calls.html?q=cache"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1723460228419
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "The entitlement script for reference: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "var fields = [\"hooks\", \"web\", \"api\", \"git\", \"pages\", \"importer\"];\n\nfunction fetchGithubHosts() {\n  var response = httpGet(\""
                },
                {
                  "type": "text",
                  "text": "https://api.github.com/meta\")"
                },
                {
                  "type": "text",
                  "text": ";"
                },
                {
                  "type": "text",
                  "text": "\n  if (response.statusCode != 200) {\n    console.log(\"Failed to query github.com hosts\");\n    return [];\n  }\n\n  var meta = JSON.parse(response.data);\n  var hosts = [];\n\n  for(var i in fields) { \n    hosts = hosts.concat(meta[fields[i]]);\n  }\n  return hosts;\n}\n\n// Cache github.com hosts for 30 minutes. Github rate limits this API to about\n// 60 calls per hour when used without a token and all gateways share the same public IP.\nreturn cache.get(\n  \"github.com hosts\",\n  () => fetchGithubHosts(),\n  30 * 60 // 30 minutes\n);"
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1723463039745
      }
    ]
  },
  {
    "key": "SA-24283",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Task description"
            }
          ],
          "attrs": {
            "level": 2
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Two text-only updates:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "[x] Instead of Unresponsive/Unresponsive Reports, the column header should say "
                    },
                    {
                      "type": "text",
                      "text": "No. of Reports",
                      "marks": [
                        {
                          "type": "code"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "[x] The intro text in the App Health Details modal should be:"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "blockquote",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "During the last 24 hours, Gateway B has reported issues with 4 apps."
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Link to design in SDP Admin / Views",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://www.figma.com/design/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?node-id=2524-4892"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Reasons of changes:"
            }
          ],
          "attrs": { "level": 3 }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Unresponsive Reports",
              "marks": [
                {
                  "type": "em"
                }
              ]
            },
            {
              "type": "text",
              "text": " makes it sound as is the reports are unresponsive, when the value is a number that displays the number of times the unresponsiveness has been reported."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "The current version of the intro text contains the entitlement name, although the entitlement is already in the modal header, which makes the text unnecessarily long."
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Location"
            }
          ],
          "attrs": {
            "level": 2
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Usage > App Health Reports"
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Definition of done"
            }
          ],
          "attrs": {
            "level": 2
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Text is updated accordingly."
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-24293",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "A possible upgrade sequence would look like this:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Set "
                    },
                    {
                      "type": "text",
                      "text": "all",
                      "marks": [
                        {
                          "type": "strong"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " controllers in maintenance mode. NOTE: This means the upgrade API needs to keep working in maintenance mode!"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Upgrade one controller at a time by doing \"the dance\" (create join new version node, wait for replication, part old version node)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Perform database schema migration, wait for replication."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Disable maintenance mode on "
                    },
                    {
                      "type": "text",
                      "text": "all",
                      "marks": [
                        {
                          "type": "strong"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "text": " controllers."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "As suggested by EDB support:"
            }
          ]
        },
        {
          "type": "blockquote",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Hi Thomas,"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Thanks for detailing the process. Please note that two different activities are being carried out:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Major upgrade (from PostgreSQL 12 to 14)."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Schema changes."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "At the end of the process we have a fully upgraded pg14+bdr4 cluster with the latest database schema via a rolling upgrade."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We can see from the tests that the objective has been achieved, but we suggest that you carry out the two activities separately:"
                }
              ]
            },
            {
              "type": "bulletList",
              "content": [
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Join PostgreSQL 14 node."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Wait for replication on all nodes."
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "listItem",
                  "content": [
                    {
                      "type": "paragraph",
                      "content": [
                        {
                          "type": "text",
                          "text": "Part PostgreSQL 12 node."
                        }
                      ]
                    }
                  ]
                }
              ]
            },

            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Then perform the schema upgrade."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "Regards,"
                },
                { "type": "hardBreak" },
                {
                  "type": "text",
                  "text": "Raphael"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "See "
            },
            {
              "type": "text",
              "text": "https://techsupport.enterprisedb.com/company/tickets/39705",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://techsupport.enterprisedb.com/company/tickets/39705"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This was already partially done in "
                },
                {
                  "type": "text",
                  "text": "https://got-youtrack.agi.appgate.com/issue/SA-24344/Database-migration-should-be-run-with-all-Postgres-BDR-nodes-on-the-same-major-version",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://got-youtrack.agi.appgate.com/issue/SA-24344/Database-migration-should-be-run-with-all-Postgres-BDR-nodes-on-the-same-major-version"
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "We now do the DB migration before adding the first new postgres/bdr version node."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "There are further improvements we can do to our migrations though to minimize downtime and increase flexibility."
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See advice from EDB:"
                }
              ]
            },
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Hi Thomas,"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Thanks for joining the call. It was great to discuss the multiple approaches as well as do a live troubleshooting session with you."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "First of all, we established that you are separating the major upgrade procedure (from BDR 3.7 / PG 12 to PGD 4 / PG 14) from the schema migration procedure, to which you leverage the Liquibase tool. >"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The first suggestion we provided to eliminate the conflicts that are happening on the Liquibase tables is to remove them from the replication set, for example: >"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "SELECT bdr.replication_set_remove_table('databasechangelog');"
                    }
                  ]
                },

                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Another idea was to make sure the Liquibase tables are created in a separate schema instead of together with the user tables in the public schema. Apparently it's possible to do this with Liquibase as you can see from the docs. >"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Then we focused on the schema migration for the entire remainder of the call. First we established that the schema migration looks like this, for example to add a column with a default value and a NOT NULL constraint: "
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "alter table on_boarded_device add column device_type text;\nalter table on_boarded_device alter column device_type set default 'Client';\nupdate on_boarded_device set device_type = 'Client';\nalter table on_boarded_device alter column device_type set not null;"
                    }
                  ]
                },

                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The challenge here is do this while the table is receiving a lot of write operations on other nodes."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The problem with this approach, as you reported, is the migration fails because of a Global Lock Timeout. Which is expected given the table is busy on the other nodes, so Raft Consensus fails to acquire a local lock on each table, which is required for the Global Lock. >"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Disabling the Global Lock by setting bdr.ddl locking = off, as recommended in our KB article, is not possible in your case either, because then the migration still fails with:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "ERROR:  column \"device_type\" of relation \"on_boarded_device\" contains null values"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "This error happens at the ALTER TABLE ... SET NOT NULL, even after running the UPDATE to set all existing rows to the default value. But there are transactions arriving from the other nodes, so the table content has changed between the UPDATE and the ALTER TABLE ... SET NOT NULL."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The challenge here is to add a column with NOT NULL in a distributed system having write operations happening on multiple nodes."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "So together we worked on multiple different approaches during the live troubleshooting session. Here I outline the most suitable procedure, which is based on the node by node schema migration strategy, with a few modifications after further discussion with you on the call and further internal analysis."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "1- On node 1, prevent application from doing new connections: "
                    }
                  ]
                },

                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "BEGIN;\nSET LOCAL bdr.ddl_replication = off;\nALTER ROLE role_name SET NOLOGIN;\nCOMMIT;"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Replacing role name with the name of the role used by application"
                    }
                  ]
                },

                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "2- Wait until the existing application connections on node 1 have been organically disconnected, or if needed (and safe from your business point of view), cancel them."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "IMPORTANT!!: We need application downtime on the node where you are applying the migration, because otherwise it might be difficult, if possible at all, to acquire the exclusive lock when running the first ALTER TABLE."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "3- From node 1, make sure there is no lag among the nodes:"
                    }
                  ]
                },

                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "SELECT jsonb_pretty(\n> bdr.run_on_all_nodes($$\n> SELECT bdr.wait_slot_confirm_lsn(NULL, NULL);\n> $$)::jsonb\n>);"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "4- On node 1, disable incoming transactions from the other nodes:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "SELECT bdr.alter_subscription_disable(sub_name, true)\nFROM bdr.subscription_summary;"
                    }
                  ]
                },

                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "5- On node 1, run the actual migration with transaction replication disabled:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "BEGIN;\nSET LOCAL bdr.xact_replication = off;\nalter table on_boarded_device add column device_type text;\nalter table on_boarded_device alter column device_type set default 'Client';\nupdate on_boarded_device set device_type = 'Client';\nalter table on_boarded_device alter column device_type set not null;\nCOMMIT;"
                    }
                  ]
                },

                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "As the UPDATE and ALTER TABLE ... SET NOT NULL happen in the same transaction, then you shouldn't see the error:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "ERROR:  column \"device_type\" of relation \"on_boarded_device\" contains null values"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "6- On node 1, enable incoming transactions from the other nodes:"
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "SELECT bdr.alter_subscription_enable(sub_name)\nFROM bdr.subscription_summary;"
                    }
                  ]
                }
              ]
            },
            {
              "type": "blockquote",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Here if transactions from the other nodes start to arrive for this table, they won't have the new column device type. In this case, a source_column_missing conflict will happen on node 1, which has a default conflict resolver of use_default_value, which means that the row from the other node will be still applied with the default value for the new column, is what we want."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "7- On node 1, finally allow connections from the application: "
                    }
                  ]
                },
                {
                  "type": "codeBlock",
                  "attrs": { "language": "sql" },
                  "content": [
                    {
                      "type": "text",
                      "text": "BEGIN;\n> SET LOCAL bdr.ddl_replication = off;\n> ALTER ROLE role_name SET LOGIN;\n> COMMIT;\n"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Replacing role_name with the name of the role used by application."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Applications will start doing transactions on node 1, which now has the new column. These transactions will be replicated to the other nodes, but they still don't have the new column. In this case, a target_column_missing conflict will happen, which has a default conflict resolver of ignore_if_null. In this case the value won't ever be NULL because of the NOT NULL constraint, so the conflict can't be ignored and replication from node 1 to the other nodes will break."
                    }
                  ]
                },

                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Which is again what we want to happen. We need to prevent transactions from nodes with the new column to flow to other nodes until they have the new column too."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "8- Repeat steps 1 to 7 above to the other nodes, one by one."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "We understand it can be challenge to adapt this procedure to your Liquibase setup, but please let us know your thoughts about this procedure and how it goes."
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Warm regards,"
                    },
                    {
                      "type": "hardBreak"
                    },
                    {
                      "type": "text",
                      "text": "William"
                    }
                  ]
                },
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Access your ticket status and details easily on the EDB Support Portal at:"
                    },
                    {
                      "type": "text",
                      "text": "https://techsupport.enterprisedb.com/company/tickets/39705",
                      "marks": [
                        {
                          "type": "link",
                          "attrs": {
                            "href": "https://techsupport.enterprisedb.com/company/tickets/39705"
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1725431689741
      },
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "This was actually already decoupled in 6.3.4/6.4.0 by moving the database migration before adding the new node. I will close this task as obsolete, we can open a new one if needed."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1728894910641
      }
    ]
  },
  {
    "key": "SA-24305",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "When it actually has."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "e.g."
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "15:41:37 \n      2024-08-22T15:41:37,350397Z [INFO] [upgrade/appliance_sdpctl_upgrade] Preparing upgrade with image_url="
            },
            {
              "type": "text",
              "text": "https://got02-helvetest.agi.appgate.com:443/testsd/project/666/StratusImage_Build/release-6.4/artifact/appgate-6.4.0-38258-beta.img.zip?is-build-type-id"
            },
            {
              "type": "text",
              "text": "\n15:41:37 \n      2024-08-22T15:41:37,351059Z [INFO] [upgrade/appliance_sdpctl_upgrade] Running sdpctl command: /home/devops/buildAgent/temp/buildTmp/sdpctl_test_config_n0bv130y/sdpctl appliance upgrade prepare --image "
            },
            {
              "type": "text",
              "text": "https://got02-helvetest.agi.appgate.com:443/testsd/project/666/StratusImage_Build/release-6.4/artifact/appgate-6.4.0-38258-beta.img.zip?is-build-type-id"
            },
            {
              "type": "text",
              "text": " --force --dev-keyring --no-interactive --ci-mode\n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=info COMMAND=\"sdpctl appliance upgrade prepare\" SDPCTL_VERSION=2024.08.16\n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"version check disabled\"\n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"found docker registry address\" URL=\""
            },
            {
              "type": "text",
              "text": "https://got02-nexus01.agi.appgate.com:5001"
            },
            {
              "type": "text",
              "text": "\n15:41:37 \n  sdpctl_version: 2024.08.16\n15:41:37 \n  commit: eaa3a0c5a5795c5994802ad8a84c7cfff51ee1f7\n15:41:37 \n  build date: 2024-08-16T08:41:36Z\n15:41:37 \n  \n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"primary controller\" appliance=controller-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1\n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"upgrade version information\" primary-controller=controller-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1 target-version=6.4.0-beta+38258 version=6.3.3-beta+38257\n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"upgrade information\" current_version=6.3.3-beta+38257 skipping= target_version=6.4.0-beta+38258 upgrading=\"controller-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1, controller2-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1, gateway-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1\"\n15:41:37 \n  \n15:41:37 \n  PREPARE SUMMARY\n15:41:37 \n  \n15:41:37 \n  1. Bundle and upload LogServer docker image\n15:41:37 \n  2. Upload upgrade image appgate-6.4.0-38258-beta.img.zip to Controller\n15:41:37 \n  3. Prepare upgrade on the following appliances:\n15:41:37 \n  \n15:41:37 \n    Appliance                                                 Online    Current version     Prepare version\n15:41:37 \n    ---------                                                 ------    ---------------     ---------------\n15:41:37 \n    controller-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1              6.3.3-beta+38257    6.4.0-beta+38258\n15:41:37 \n    controller2-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1             6.3.3-beta+38257    6.4.0-beta+38258\n15:41:37 \n    gateway-c9934ce3-f44e-4187-9128-c8f46b10ed74-site1                 6.3.3-beta+38257    6.4.0-beta+38258\n15:41:37 \n  \n15:41:37 \n  \n15:41:37 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"downloading image layers for logserver-latest.zip\"\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"wrote layer\" path=cz-opensearch/latest.json size=948\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"wrote layer\" path=cz-opensearchdashboards/latest.json size=948\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"wrote layer\" path=cz-opensearchdashboards/07a08a2ab691a8983e91d2410ce9aec24420212d4aa9611202a0a5b18bdc3762.json size=6334\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"downloading image layer\" layer=4f4fb700ef54461cfa02571ae0db9a0dc1e0cdb5577484a6d75e68dc38e8acc1\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"downloading image layer\" layer=e4fff0779e6ddd22366469f08626c3ab1884b5cbe1719b26da238c95f247b305\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"downloading image layer\" layer=714926751fa783e638d2bf4d3880083b246acae60d08341a5f1a333babffb292\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"wrote layer\" path=cz-opensearchdashboards/image.json size=77\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=debug msg=\"wrote layer\" path=cz-opensearch/01d8c16f03054d452569e7d785818edf7fff02625f6377d14850b697c49b7110.json size=6365\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"downloading image layer\" layer=4f4fb700ef54461cfa02571ae0db9a0dc1e0cdb5577484a6d75e68dc38e8acc1\n15:41:38 \n  time=\"2024-08-22T17:41:37+02:00\" level=info msg=\"downloading image layer\" layer=e4fff0779e6ddd22366469f08626c3ab1884b5cbe1719b26da238c95f247b305"
            }
          ]
        }
      ],
      "version": 1
    }
  },
  {
    "key": "SA-24363",
    "description": {
      "type": "doc",
      "version": 1,
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": ""
            }
          ]
        }
      ]
    }
  },
  {
    "key": "SA-24429",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Every time I click download logs this happens"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "WARN [ApplianceWebSocketStore] Appliance 'envy-10-98-151-2_devops' did not respond in time for 'status' method with ID '6'. InterruptedException - null\n192.168.100.99 - CN=3032626534354231a535633963613330,CN=admin,OU=local \"GET /admin/appliances/status?range=0-30 HTTP/1.0\" 200 1650 \""
            },
            {
              "type": "text",
              "text": "https://envy-10-98-151-2.devops:8443/ui/system/appl>"
            },
            {
              "type": "text",
              "text": "\n{\"id\":\"a082356a-eae4-450b-befa-6259fb9b69fc\",\"timestamp\":\"2024-09-11T12:22:03.988795377Z\",\"version\":21,\"distinguished_name\":\"CN=3032626534354231a535633963613330,CN=admin,OU=local\",\"cl>\n192.168.100.99 - CN=3032626534354231a535633963613330,CN=admin,OU=local \"GET /admin/admin-messages/summarize HTTP/1.0\" 200 387 \""
            },
            {
              "type": "text",
              "text": "https://envy-10-98-151-2.devops:8443/ui/system/appliance>"
            },
            {
              "type": "text",
              "text": "\n192.168.100.99 - CN=3032626534354231a535633963613330,CN=admin,OU=local \"GET /admin/my-preferences HTTP/1.0\" 200 30 \""
            },
            {
              "type": "text",
              "text": "https://envy-10-98-151-2.devops:8443/ui/system/appliances\""
            },
            {
              "type": "text",
              "text": " \"Mozilla>\nERROR[PeerWebSocketEndpoint] [/127.0.0.1:0] Error on websocket session.\njava.nio.channels.ClosedChannelException: null\n        at org.eclipse.jetty.websocket.core.internal.WebSocketSessionState.onEof(WebSocketSessionState.java:169)\n        at org.eclipse.jetty.websocket.core.internal.WebSocketCoreSession.onEof(WebSocketCoreSession.java:253)\n        at org.eclipse.jetty.websocket.core.internal.WebSocketConnection.fillAndParse(WebSocketConnection.java:491)\n        at org.eclipse.jetty.websocket.core.internal.WebSocketConnection.onFillable(WebSocketConnection.java:349)\n        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)\n        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\n        at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)\n        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\n        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\n        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\n        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)\n        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)\n        at java.base/java.lang.Thread.run(Thread.java:1583)\nINFO [PeerWebSocketEndpoint] [/127.0.0.1:0] Websocket close. CloseReason[1006,Session Closed]\n{\"id\":\"8187799e-f4b6-4257-a137-e54a0947b40e\",\"timestamp\":\"2024-09-11T12:22:19.385111522Z\",\"version\":21,\"entity_type\":\"Appliance\",\"distinguished_name\":\"CN=3032626534354231a535633963613>\nINFO [ApplianceWebSocketStore] [a5bceda8-3dcb-4cb1-a663-b027c3819449] Appliance is offline. Cancelling the request 'status'.\n192.168.100.99 - CN=3032626534354231a535633963613330,CN=admin,OU=local \"GET /admin/appliances/status?range=0-30 HTTP/1.0\" 200 1648 \""
            },
            {
              "type": "text",
              "text": "https://envy-10-98-151-2.devops:8443/ui/system/appl>"
            },
            {
              "type": "text",
              "text": "\n - controller-324347bf-e6eb-42b7-824d-6b836ebe38d1-site1 \"POST /peer/files/8339be87-9cdf-4e68-917e-ba5e79f17f72 HTTP/1.1\" 204 0 \"-\" \"Python/3.10 aiohttp/3.8.1\" 134437\n192.168.100.99 - CN=3032626534354231a535633963613330,CN=admin,OU=local \"POST /admin/appliances/a5bceda8-3dcb-4cb1-a663-b027c3819449/logs HTTP/1.0\" 200 452182391 \""
            },
            {
              "type": "text",
              "text": "https://envy-10-98-15>"
            },
            {
              "type": "text",
              "text": "\n127.0.0.1 - - \"GET /peer/ws HTTP/1.1\" 101 0 \"-\" \"Python/3.10 aiohttp/3.8.1\" 9\nINFO [PeerWebSocketEndpoint] [[/127.0.0.1:0] New websocket connection"
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "aha missed this task. Fixed here "
                },
                {
                  "type": "text",
                  "text": "https://github.com/appgate-sdp-int/stratus-controller/pull/3987",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://github.com/appgate-sdp-int/stratus-controller/pull/3987"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1727870433162
      }
    ]
  },
  {
    "key": "SA-24460",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "This can happen due to a crash or sudden network interruption."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We have seen it on purple10: "
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Sep 17 07:59:56 purple10.appgate.com cz-dbd@current[3265]: [INFO] Running now in node: purple10.appgate.com\nSep 17 07:59:56 purple10.appgate.com postgresql@current[3271]: [6-1] 2024-09-17 07:59:56.582 GMT   LOG:  checkpointer process (PID 10) was terminated by signal 39: Real-time signal 5\nSep 17 07:59:56 purple10.appgate.com postgresql@current[3271]: [7-1] 2024-09-17 07:59:56.582 GMT   LOG:  terminating any other active server processes\nSep 17 07:59:56 purple10.appgate.com postgresql@current[3271]: [8-1] 2024-09-17 07:59:56.598 GMT   LOG:  all server processes terminated; reinitializing\nSep 17 07:59:56 purple10.appgate.com postgresql@current[3379]: [9-1] 2024-09-17 07:59:56.649 GMT   LOG:  database system was interrupted; last known up at 2024-09-17 07:59:54 GMT\nSep 17 07:59:56 purple10.appgate.com postgresql@current[3380]: [9-1] 2024-09-17 07:59:56.649 GMT postgres controller FATAL:  the database system is in recovery mode\nSep 17 07:59:56 purple10.appgate.com cz-dbd@current[3265]: [ERROR] [run-on-all-nodes] Error running query SELECT bdr.wait_slot_confirm_lsn(NULL, NULL) on node purple10_appgate_com_1443000\n                                                           Traceback (most recent call last):\n                                                             File \"/usr/share/cz-dbd/dbd/bdr.py\", line 398, in run_on_all_nodes\n                                                               async with aiopg.connect(dsn) as conn:\n                                                             File \"/usr/lib/python3/dist-packages/aiopg/utils.py\", line 82, in __aenter__\n                                                               self._obj = await self._coro\n                                                             File \"/usr/lib/python3/dist-packages/aiopg/connection.py\", line 1225, in _connect\n                                                               await self._poll(self._waiter, self._timeout)  # type: ignore\n                                                             File \"/usr/lib/python3/dist-packages/aiopg/connection.py\", line 881, in _poll\n                                                               await asyncio.wait_for(self._waiter, timeout)\n                                                             File \"/usr/lib/python3.10/asyncio/tasks.py\", line 445, in wait_for\n                                                               return fut.result()\n                                                             File \"/usr/lib/python3/dist-packages/aiopg/connection.py\", line 788, in _ready\n                                                               state = self._conn.poll()\n                                                           psycopg2.OperationalError: FATAL:  the database system is in recovery mode"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "We should wait for the database to exit recovery mode in startup so we don't continue issuing commands too soon. In the best case this will cause an error and retry. In the worst case we have seen some SQL commands hang."
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Slack thread, including purple10 log bundle "
            },
            {
              "type": "text",
              "text": "https://appgate.slack.com/archives/GUGM5LV62/p1726560044495549",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://appgate.slack.com/archives/GUGM5LV62/p1726560044495549"
                  }
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "It is possible to check if the database is in recovery mode using the following command: "
                }
              ]
            },
            {
              "type": "codeBlock",
              "attrs": {},
              "content": [
                {
                  "type": "text",
                  "text": "root@purple10:/home/cz# cz-dbs pg cli\nRunning: /usr/bin/sudo --preserve-env=HOME,TERM -u postgres pgcli -p 443 -h /run/cz-dbd/dbd-current controller\nServer: PostgreSQL 14.13 (Ubuntu 14.13-0ubuntu0.22.04.2)\nVersion: 3.3.1\nHome: "
                },
                {
                  "type": "text",
                  "text": "http://pgcli.com"
                },
                {
                  "type": "text",
                  "text": "\ncontroller> select pg_is_in_recovery();\n+-------------------+\n| pg_is_in_recovery |\n|-------------------|\n| False             |\n+-------------------+\nSELECT 1\nTime: 0.015s\ncontroller>                                                                                                                                                                              \nGoodbye!"
                }
              ]
            },
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "See "
                },
                {
                  "type": "text",
                  "text": "https://www.postgresql.org/docs/14/functions-admin.html#FUNCTIONS-RECOVERY-CONTROL",
                  "marks": [
                    {
                      "type": "link",
                      "attrs": {
                        "href": "https://www.postgresql.org/docs/14/functions-admin.html#FUNCTIONS-RECOVERY-CONTROL"
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "thomas.cellerier",
        "created": 1726561422091
      }
    ]
  },
  {
    "key": "SA-24461",
    "description": {
      "type": "doc",
      "content": [
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "Description"
            }
          ],
          "attrs": {
            "level": 3
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "Ty reported a crash in lieu of the uprade screen"
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I saw it on my machine while being connected to purple UI"
            }
          ]
        },
        {
          "type": "codeBlock",
          "attrs": {},
          "content": [
            {
              "type": "text",
              "text": "Error: Minified React error #31; visit "
            },
            {
              "type": "text",
              "text": "https://reactjs.org/docs/error-decoder.html?invariant=31&args[]=object%20with%20keys%20%7Bdata%2C%20status%2C%20statusText%2C%20headers%2C%20config%2C%20request%7D"
            },
            {
              "type": "text",
              "text": " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\n    va "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    e "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    ko "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    xi "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    bs "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    vs "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    gs "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    as "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    ls "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    O "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/9057.7660ff088aecbf0bd512.js:2"
            },
            {
              "type": "text",
              "text": "\n    x "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/9057.7660ff088aecbf0bd512.js:2"
            },
            {
              "type": "text",
              "text": "\n2551.f4c84be5625bdf72ee4f.js:2:71408\nReact Router caught the following error during render Error: Minified React error #31; visit "
            },
            {
              "type": "text",
              "text": "https://reactjs.org/docs/error-decoder.html?invariant=31&args[]=object%20with%20keys%20%7Bdata%2C%20status%2C%20statusText%2C%20headers%2C%20config%2C%20request%7D"
            },
            {
              "type": "text",
              "text": " for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\n    va "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    e "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    ko "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    xi "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    bs "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    vs "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    gs "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    as "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    ls "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/2551.f4c84be5625bdf72ee4f.js:2"
            },
            {
              "type": "text",
              "text": "\n    O "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/9057.7660ff088aecbf0bd512.js:2"
            },
            {
              "type": "text",
              "text": "\n    x "
            },
            {
              "type": "text",
              "text": "https://purple10.agi.appgate.com:8443/ui/9057.7660ff088aecbf0bd512.js:2"
            },
            {
              "type": "text",
              "text": "\n "
            }
          ]
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": " Slack thread: "
            },
            {
              "type": "text",
              "text": "https://appgate.slack.com/archives/GTWMVPUSV/p1726559145315619",
              "marks": [
                {
                  "type": "link",
                  "attrs": {
                    "href": "https://appgate.slack.com/archives/GTWMVPUSV/p1726559145315619"
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "To Reproduce"
            }
          ],
          "attrs": {
            "level": 3
          }
        },
        {
          "type": "paragraph",
          "content": [
            {
              "type": "text",
              "text": "I have not tried but his step is:"
            }
          ]
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "Upgrade a collective"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "content": [
            {
              "type": "text",
              "text": "DoD"
            }
          ],
          "attrs": {
            "level": 3
          }
        },
        {
          "type": "bulletList",
          "content": [
            {
              "type": "listItem",
              "content": [
                {
                  "type": "paragraph",
                  "content": [
                    {
                      "type": "text",
                      "text": "The upgrade screen is shown as expceted"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "version": 1
    },
    "comments": [
      {
        "body": {
          "type": "doc",
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "text": "this can be reproduced by just stopping controller on the appliance."
                }
              ]
            }
          ],
          "version": 1
        },
        "author": "natan.abolafya",
        "created": 1727096696546
      }
    ]
  }
]
