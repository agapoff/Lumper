[
    {
        "key": "SA-21449",
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The cz-logd should look something like:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "     ztp\":{\n    \t    \"extraHeaders\": {\n                \"Authorization\": \"Bearer XXXXX\"\n            },\n\t        \"eventTypes\":[\"authorization_succeeded\"],\n            \"batchSize\": 400,\n            \"remoteURL\":\""
                                },
                                {
                                    "type": "text",
                                    "text": "http://ZTP_BASE/auth-info\""
                                },
                                {
                                    "type": "text",
                                    "text": "\n    },"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1678872740876
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Can e.g. "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "anton.lundgren",
                                        "text": "@anton.lundgren",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " attempt a pr?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1679991504571
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Sure, I can do this one"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "anton.lundgren",
                "created": 1679992167320
            }
        ]
    },
    {
        "key": "SA-21616",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Actions and Preconditions"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "orderedList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Seems to be Linux specific"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Set entitlement token expiration to a low number"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Log in with client"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "SSH to the controller appliance and stop cz-controllerd service"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Wait for entitlement token to expire"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Observation (with screenshots if applicable)"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "When the entitlement token expire the client tries to renew the token. After trying for a while \\~5 min all new connections (regardless of routing) are blocked due to failing DNS lookup. The established ones continue to work."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Client looks all green and happy."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Client needs to be suspended or stopped."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Expected"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Connections not routed through Appgate should not be blocked"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "CommenT"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This was kind of introduced in 6.1.3. 6.1.2 and earlier clients have the behavior but a few seconds after it appear the client is logged out so it solves itself."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Could it be related to "
                        },
                        {
                            "type": "text",
                            "text": "https://got-youtrack.agi.appgate.com/issue/SA-21352/shim-lock-up-after-resume",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://got-youtrack.agi.appgate.com/issue/SA-21352/shim-lock-up-after-resume"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "?"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs and/or testrail/slack links"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "07:32 - 07:42 is the interesting timeframe. I'm not totally sure but I think the Internet connections started being blocked around 07:38."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Repeatability: 3/3"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "[2023-04-13T07:34:40.189Z] Debug : [ApplicationContext - LogFunction:73] SHIM: '[envy-10-97-162-2.devops - 7]: Established connection to TLS://envy-10-97-162-2.devops|10.97.162.2:443 (controller)'\n[2023-04-13T07:34:40.189Z] Debug : [SslSocket - Connect:89] REST  (envy-10-97-162-2.devops:443) H140628974848496 [[14]] : Connect: Connected REST\n[2023-04-13T07:34:40.190Z] Debug : [HttpHeaderDictionary - Add:26] We already have a key for Accept overwriting...\n[2023-04-13T07:34:40.190Z] Debug : [HttpConnection - Request:76] [Request: method Get, uri [Uri: /authorization/], mimeType [Mime: application/json; charset=utf-8]]\n[2023-04-13T07:34:40.217Z] Debug : [SslSocket - Dispose:207] REST  (envy-10-97-162-2.devops:443) H140628974848496 [[14]] : Dispose REST\n[2023-04-13T07:34:40.217Z] Info : [RestFetcher - MakeRequest:155] REST connection could not be established. 'Bad Gateway'. Will try the next IP address.\n[2023-04-13T07:34:40.217Z] Error : [ControllerLogic - Process:131] Request to controller '"
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-10-97-162-2.devops/'"
                                },
                                {
                                    "type": "text",
                                    "text": " has been rejected. Reason: Bad Gateway"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I suppose the above is the problem? Which smells like a bug in the C# logic - it can connect fine to controller but ends up with \"Bad Gateway\" which indicates protocol error on http/rest levlel."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1681389549398
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "the above is intentional to trigger the bug that is losing all DNS access."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "On Windows and macOS, you lose access to gateways and stuff behind those gateways but can still access the internet. On Linux, you can't."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Which smells like systemd-resolved related but hard for me to say as I don't know how that's supposed to work."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1681389915095
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So there are two angles here I guess:"
                                }
                            ]
                        },
                        {
                            "type": "bulletList",
                            "content": [
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "driver should be able to handle DNS site being down, right? Or in general, not having any gateway connections"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "C# can also kill the driver connection in this case like suspend does. Because it knows it doesn't have a valid entitlement token."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "So the second approach would fix this issue but I think there might be an underlying issue which might show itself in another scenarios. Like gateway for DNS servers being down."
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1681390202763
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yes, the difference is most likely in how the resolver works. And the fix is to disconnect here - and yes there is a problem(=expected behaviour ) if the DNS site is down - which is what you see here - but figuring out how to go about that in the best way is not even 6.2 material."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1681393034047
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok, then I'll try to disconnect on C#"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1681393433516
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Sounds like a good solution."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "per.allansson",
                                        "text": "@per.allansson",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " - Could you make an task for 6.3 so that we don't forget it?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1681451338215
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Sure: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-youtrack.agi.appgate.com/issue/SA-21638/ipt-look-into-handling-DNS-better-when-the-site-serving-the-DNS-servers-is-down",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-youtrack.agi.appgate.com/issue/SA-21638/ipt-look-into-handling-DNS-better-when-the-site-serving-the-DNS-servers-is-down"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1681457300711
            }
        ]
    },
    {
        "key": "SA-22435",
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Initially it would allow pasting in the raw seed. Later we could have ZTP \"magic urls\" to seed things etc..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1695733161431
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "    location /send_seed/ {\n        proxy_pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://unix://run/cz-webseed/webseed.socket:/"
                                },
                                {
                                    "type": "text",
                                    "text": ";"
                                },
                                {
                                    "type": "text",
                                    "text": "\n        proxy_set_header X-Forwarded-For $remote_addr;\n    }\n    location /seed/ {\n        alias /usr/share/cz-webseed/html/;\n        try_files $uri index.html $uri;\n    }\n\n"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1696415949130
            }
        ]
    },
    {
        "key": "SA-22129",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Tried an envy upgrade and got this: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "It is strongly adviced that you upgrade your appliance to a supported version before executing any sdpctl command. Executing sdpctl commands on an unsupported API version can have serious unforseen consequenses.\nMinimum supported API version: 17\nCurrently using API version: 0\n\nConsider upgrading to a supported version of the appliance using the upgrade script provided in the 'Utilities' section in the admin UI: "
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-150-2.devops:8443/ui/system/utilities"
                        },
                        {
                            "type": "text",
                            "text": "\n\nsdpctl_version: 2023.06.19\ncommit: 3aa5f854e5117585fb5b98cdc17ae9a40f1316bb\nbuild date: 2023-06-20T07:08:48Z\n\n1 error occurred:\n\t* HTTP 200 - json: cannot unmarshal array into Go struct field StatsAppliancesList.query of type string"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-20497",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Saw on purple."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Looks like some sort of cancellation triggers it? "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Uncaught TypeError: E[e.id] is undefined\n    onCancel "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/app-11f72d03.f2adab52f4086e834d96.js:1"
                        },
                        {
                            "type": "text",
                            "text": "\n    value "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/app-d0bc28d0.00dd432c3d874a682b18.js:1"
                        },
                        {
                            "type": "text",
                            "text": "\n    value "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/app-d0bc28d0.00dd432c3d874a682b18.js:1"
                        },
                        {
                            "type": "text",
                            "text": "\napp-11f72d03.f2adab52f4086e834d96.js:1:20388\nUncaught TypeError: E[e.id] is undefined\n    onCancel "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/app-11f72d03.f2adab52f4086e834d96.js:1"
                        },
                        {
                            "type": "text",
                            "text": "\n    value "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/app-d0bc28d0.00dd432c3d874a682b18.js:1"
                        },
                        {
                            "type": "text",
                            "text": "\n    onCancel "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/app-d0bc28d0.00dd432c3d874a682b18.js:1"
                        },
                        {
                            "type": "text",
                            "text": "\n    De "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Be "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Ir "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Ir "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Ur "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Wr "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    ss "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Te "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    Wr "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    qn "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        },
                        {
                            "type": "text",
                            "text": "\n    $n "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/4448.edb4ab547c973d669afa.js:2"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image1.png){width=70%}"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Do you remember what you did during your session ? (to have a range on the pages we should look into)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1667828553058
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "can't say I remember anything special. Logged in, went to client profiles iirc."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667829624846
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Some js warning found along the way by "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "carina.olsson",
                                        "text": "@carina.olsson",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " ![](image.png){width=70%} ![](image2.png){width=70%}"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1668591857540
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I suppose this is the ticket to put screenshots of console errors. Here's another: ![](Screenshot 2022-11-17 at 13.15.33.png){width=70%}"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "carina.olsson",
                "created": 1668687408718
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I couldn't find your warning "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "natan.abolafya",
                                        "text": "@natan.abolafya",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " but fixed the other ones with "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-frontend/pull/4529",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-frontend/pull/4529"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We can update the task again if the issue shows up again"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1669043618559
            }
        ]
    },
    {
        "key": "SA-20455",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Nov 01 08:55:03 envy-10-97-144-3.devops cz-configd[63595]: spa.wolfssl.WolfSSLException: Read error: Peer closed underlying transport Error (Code -397)"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Nov 01 08:54:03 envy-10-97-144-2.devops cz-controllerd[1810]: INFO [PeerWebSocketEndpoint] /10.97.144.3:15346 8 \"revocation_list\" success 2\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: 127.0.0.1 - - [01/Nov/2022:08:54:32 +0000] \"POST /peer/files/1d14b4f4-b140-47e5-9be8-f59a72f59e6e HTTP/1.1\" 204 0 \"-\" \"Python/3.8 aiohttp/3.6.2\" 1800010\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: 192.168.100.42 - - [01/Nov/2022:08:54:32 +0000] \"POST /admin/appliances/c9d6bd70-3b39-4804-acee-ce54b4e47554/logs HTTP/1.0\" 200 285190407 \""
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-144-2.devops:8443/ui/system/appliances\""
                        },
                        {
                            "type": "text",
                            "text": " \"Mozilla/5.0 (X11; Linux x86_64; rv:106.0) Gecko/20100101 Firefox/106.0\" 1800108\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: ERROR[ApplianceResource] Error during streaming logs.\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: org.eclipse.jetty.io.EofException: Early EOF\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpInput$3.getError(HttpInput.java:1207)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpInput$3.noContent(HttpInput.java:1195)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpInput.read(HttpInput.java:333)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.makeAvailable(MultipartStream.java:1027)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.read(MultipartStream.java:931)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at java.base/java.io.InputStream.read(InputStream.java:218)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.google.common.io.ByteStreams.copy(ByteStreams.java:114)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.appgate.controller.resources.ApplianceResource.lambda$inputToOutputStream$45(ApplianceResource.java:1071)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.StreamingOutputProvider.writeTo(StreamingOutputProvider.java:55)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.StreamingOutputProvider.writeTo(StreamingOutputProvider.java:37)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor$TerminalWriterInterceptor.invokeWriteTo(WriterInterceptorExecutor.java:242)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor$TerminalWriterInterceptor.aroundWriteTo(WriterInterceptorExecutor.java:227)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.internal.JsonWithPaddingInterceptor.aroundWriteTo(JsonWithPaddingInterceptor.java:85)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.internal.MappableExceptionWrapperInterceptor.aroundWriteTo(MappableExceptionWrapperInterceptor.java:61)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.MessageBodyFactory.writeTo(MessageBodyFactory.java:1116)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$Responder.writeResponse(ServerRuntime.java:642)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$Responder.processResponse(ServerRuntime.java:373)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$Responder.process(ServerRuntime.java:363)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:258)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:292)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:274)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:244)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:684)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:358)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:311)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.websocket.server.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:292)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.servlets.ThreadNameFilter.doFilter(ThreadNameFilter.java:35)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.handle(AllowedMethodsFilter.java:47)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.doFilter(AllowedMethodsFilter.java:41)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.appgate.controller.dropwizard.application.CacheControlFilter.doFilter(CacheControlFilter.java:20)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.codahale.metrics.jetty9.InstrumentedHandler.handle(InstrumentedHandler.java:284)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jetty.RoutingHandler.handle(RoutingHandler.java:52)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:722)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jetty.ZipExceptionHandlingGzipHandler.handle(ZipExceptionHandlingGzipHandler.java:26)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.RequestLogHandler.handle(RequestLogHandler.java:54)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.Server.handle(Server.java:516)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at java.base/java.lang.Thread.run(Thread.java:833)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: ERROR[ServerRuntime$Responder] An I/O error has occurred while writing a response message entity to the container output stream.\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: org.glassfish.jersey.server.internal.process.MappableException: org.eclipse.jetty.io.EofException: Early EOF\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.internal.MappableExceptionWrapperInterceptor.aroundWriteTo(MappableExceptionWrapperInterceptor.java:67)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.MessageBodyFactory.writeTo(MessageBodyFactory.java:1116)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$Responder.writeResponse(ServerRuntime.java:642)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$Responder.processResponse(ServerRuntime.java:373)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$Responder.process(ServerRuntime.java:363)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:258)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:292)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:274)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:244)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:234)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:684)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:358)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:311)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.websocket.server.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:292)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.servlets.ThreadNameFilter.doFilter(ThreadNameFilter.java:35)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.handle(AllowedMethodsFilter.java:47)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.doFilter(AllowedMethodsFilter.java:41)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.appgate.controller.dropwizard.application.CacheControlFilter.doFilter(CacheControlFilter.java:20)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.codahale.metrics.jetty9.InstrumentedHandler.handle(InstrumentedHandler.java:284)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jetty.RoutingHandler.handle(RoutingHandler.java:52)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:722)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at io.dropwizard.jetty.ZipExceptionHandlingGzipHandler.handle(ZipExceptionHandlingGzipHandler.java:26)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.RequestLogHandler.handle(RequestLogHandler.java:54)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.Server.handle(Server.java:516)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at java.base/java.lang.Thread.run(Thread.java:833)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: Caused by: org.eclipse.jetty.io.EofException: Early EOF\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpInput$3.getError(HttpInput.java:1207)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpInput$3.noContent(HttpInput.java:1195)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.eclipse.jetty.server.HttpInput.read(HttpInput.java:333)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.makeAvailable(MultipartStream.java:1027)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.close(MultipartStream.java:971)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.apache.commons.fileupload.MultipartStream$ItemInputStream.close(MultipartStream.java:950)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at com.appgate.controller.resources.ApplianceResource.lambda$inputToOutputStream$45(ApplianceResource.java:1075)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.StreamingOutputProvider.writeTo(StreamingOutputProvider.java:55)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.StreamingOutputProvider.writeTo(StreamingOutputProvider.java:37)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor$TerminalWriterInterceptor.invokeWriteTo(WriterInterceptorExecutor.java:242)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor$TerminalWriterInterceptor.aroundWriteTo(WriterInterceptorExecutor.java:227)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.internal.JsonWithPaddingInterceptor.aroundWriteTo(JsonWithPaddingInterceptor.java:85)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         at org.glassfish.jersey.server.internal.MappableExceptionWrapperInterceptor.aroundWriteTo(MappableExceptionWrapperInterceptor.java:61)\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]:         ... 66 common frames omitted\nNov 01 08:54:32 envy-10-97-144-2.devops cz-controllerd[1810]: WARN [HttpConnection] Pending read in onCompleted HttpConnection@490f660e::SocketChannelEndPoint@21b8f5f6{l=/127.0.0.1:9130,r=/127.0.0.1:19084,OSHUT,fill=FI,flush=-,to=0/30000}{io=1/1,kio=1,kro=1}->HttpConnection@490f660e[p=HttpParser{s=CHUNKED_CONTENT,285190587 of -1},g=HttpGenerator@5d5cb03d{s=END}]=>HttpChannelOverHttp@517ed7bc{s=HttpChannelState@5a957d0c{s=IDLE rs=COMPLETED os=COMPLETED is=IDLE awp=false se=false i=false al=1},r=1,c=true/true,a=IDLE,uri=//127.0.0.1:9130/peer/files/1d14b4f4-b140-47e5-9be8-f59a72f59e6e,age=1800011} SocketChannelEndPoint@21b8f5f6{l=/127.0.0.1:9130,r=/127.0.0.1:19084,OSHUT,fill=FI,flush=-,to=1/30000}{io=1/1,kio=1,kro=1}->HttpConnection@490f660e[p=HttpParser{s=CHUNKED_CONTENT,285190587 of -1},g=HttpGenerator@5d5cb03d{s=END}]=>HttpChannelOverHttp@517ed7bc{s=HttpChannelState@5a957d0c{s=IDLE rs=COMPLETED os=COMPLETED is=IDLE awp=false se=false i=false al=1},r=1,c=true/true,a=IDLE,uri=//127.0.0.1:9130/peer/files/1d14b4f4-b140-47e5-9be8-f59a72f59e6e,age=1800011}\nNov 01 08:55:01 envy-10-97-144-2.devops CRON[17115]: pam_unix(cron:session): session opened for user root by (uid=0)\nNov 01 08:55:01 envy-10-97-144-2.devops CRON[17116]: (root) CMD (command -v debian-sa1 > /dev/null && debian-sa1 1 1)"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think controller is also blaming the other side."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "maybe we should look at nginx here.."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667299223446
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "could also be the browser giving up here.."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "anyway, I need to be able to reproduce it first."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667299709940
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The error comes directly from wolfssl, so it's not the usual python async messing up. Just wolfssl saying the descriptor is closed on the other end."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1667300508261
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "on first look, it doesn't look like it's killed after 3-5 seconds. it seems to hang for a loong loong time. you can also see in the logs above that the error occurs 1800108 milliseconds after the flow started. That's 30 minutes?"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "192.168.100.42 - - [01/Nov/2022:08:54:32 +0000] \"POST /admin/appliances/c9d6bd70-3b39-4804-acee-ce54b4e47554/logs HTTP/1.0\" 200 285190407 \""
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-10-97-144-2.devops:8443/ui/system/appliances\""
                                },
                                {
                                    "type": "text",
                                    "text": " \"Mozilla/5.0 (X11; Linux x86_64; rv:106.0) Gecko/20100101 Firefox/106.0\" 1800108"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667302214550
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "so, with your PR (5 seconds timeout), I started tcpdumps on both controller and gateway and started the flow. besides websocket pings, basically nothing is going on."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So I think this is something with asyncio. Passing it to you :)."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667302360638
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So I could remove the 2second timeout thing?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1667377163944
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "what 2 second timeout thing?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667377614879
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The one that emits ... when journald is slow, otherwise the connection is killed"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1667383570188
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "no. I haven't fixed anything. I believe it is not a controller issue. According to the logs, the connection is killed 30 minutes later, not 3 seconds. And from what I can see on the tcpdump, it's the appliance that's just not sending any data when there is a delay on data collection."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667383824885
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I'm talking about the 4-5 years old issue"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1667387564458
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I have not managed to observe what you're saying it's happening. I am observing that configd is just not sending data."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667392490129
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The entire idea is flawed. We are basically completely scanning the log db and changing the format while also running zip on the data. Yes it's slow, it can never be fast."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think we should change to sending a .tar stream of the raw log files instead, and maybe gzip the http connection. That would be lighter."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1667400433710
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "but here the underlying issue is something else. if zip is slow, it triggers it. tar might make it less likely to happen but there will probably be circumstances where tar will do the same.."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667400748484
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Well fast enough to not hit a timeout is what we need"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1667401918961
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think figuring out what that timeout would be helpful because it is very low and can be triggered easily even with fastest approach."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1667402404815
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The short timeout is still absolutely needed. I'm making it shorter."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1668176523560
            }
        ]
    },
    {
        "key": "SA-21526",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Issue description"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The name input doesn't support spaces, and if you enter one and submit, then you get an error, but the field isn't highlighted"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Location of the issue"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "http://localhost:8080/ui/access/criteria-scripts/create"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Steps to reproduce the issue"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "orderedList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": " enter a name with a space in it"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Submit"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "What's the expected result?"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "the name field should be highlighted with a validation message below"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "What's the actual result?"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "No highlight or message is shown"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Additional details / screenshot"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image (10).png){width=70%}"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-22397",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "\nSDPCTL_USERNAME=admin SDPCTL_PASSWORD=admin sdpctl --no-verify appliance upgrade prepare --image Scaricati/appgate-6.3.0-34679-master.img.zip  --force --dev-keyring --no-interactive --ci-mode\nINFO   [2023-09-18T08:43:28+02:00]                                               COMMAND=\"sdpctl appliance upgrade prepare\" SDPCTL_VERSION=2023.09.14\nINFO   [2023-09-18T08:43:28+02:00] version check already done today             \nsdpctl_version: 2023.09.14\ncommit: 6e5924d0cf1ba564ea295e029ac9a494300e4724\nbuild date: 2023-09-14T12:38:14Z\n\nINFO   [2023-09-18T08:43:28+02:00] primary controller                            appliance=controller-c4693d01-e03c-427b-a49f-3897cf83ea3d-site1\nINFO   [2023-09-18T08:43:28+02:00] upgrade information                           current_version=6.2.3+34652 skipping= target_version=6.3.0-master+34679 upgrading=\"controller-c4693d01-e03c-427b-a49f-3897cf83ea3d-site1, gateway-c4693d01-e03c-427b-a49f-3897cf83ea3d-site1\"\n\nPREPARE SUMMARY\n\n1. Bundle and upload LogServer docker image\n2. Upload upgrade image appgate-6.3.0-34679-master.img.zip to Controller\n3. Prepare upgrade on the following appliances:\n\n  Appliance                                                Online    Current version    Prepare version\n  ---------                                                ------    ---------------    ---------------\n  controller-c4693d01-e03c-427b-a49f-3897cf83ea3d-site1    \u2713         6.2.3+34652        6.3.0-master+34679\n  gateway-c4693d01-e03c-427b-a49f-3897cf83ea3d-site1       \u2713         6.2.3+34652        6.3.0-master+34679\n\n\n[2023-09-18T08:43:28+02:00] Preparing image bundle for LogServer:\nINFO   [2023-09-18T08:43:28+02:00] downloading image layers for logserver-6.3.zip \n2 errors occurred:\n        * failed to fetch image manifest: "
                        },
                        {
                            "type": "text",
                            "text": "https://public.ecr.aws/v2/appgate-sdp/cz-opensearchdashboards/manifests/6.3"
                        },
                        {
                            "type": "text",
                            "text": " - 404 Not Found\n        * failed to fetch image manifest: "
                        },
                        {
                            "type": "text",
                            "text": "https://public.ecr.aws/v2/appgate-sdp/cz-opensearch/manifests/6.3"
                        },
                        {
                            "type": "text",
                            "text": " - 404 Not Found\n\n"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This happened on an env that does not have the logserver enabled."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "So I would have expected that there was no download of logserver."
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-23282",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Actions and Preconditions"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "orderedList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Trigger refresh claims token flow (probably easiest is to renew certificate of a gateway)"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Logs say \"Warn : 'Gothenburg 1': Will try to refresh claims token once.\""
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Then it doesn't do it. Gets stuck in that."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Observation (with screenshots if applicable)"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I've enabled Controller on a purple Gateway. It triggered certificate renewal which makes claims tokens invalid (due to encryption with the certificate) for the gateway. This would be addressed by the refresh token flow but it didn't."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs and/or testrail/slack links"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The slack thread: "
                        },
                        {
                            "type": "text",
                            "text": "https://appgate.slack.com/archives/CU6C3DVA8/p1707994668949819?thread",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://appgate.slack.com/archives/CU6C3DVA8/p1707994668949819?thread"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "ts=1707994609.570699&cid=CU6C3DVA8",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs are in the comments."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Repeatability: Once"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "per.allansson",
                                        "text": "@per.allansson",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " relevant question when you're back. It looks like the driver keeps connecting to the same gateway when there are issues with client\\\\<-\\\\>sessiond; is that normal? The problem would have been solved if the driver connected to another gateway eventually."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1708000806186
            },
            {
                "body": {
                    "version": 1,
                    "type": "doc",
                        "content": [
                            {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                "type": "text",
                                "text": "[2024-02-15T06:52:04.990Z] Info : Process starting.\n[2024-02-15T06:52:05.030Z] Info : Running as user 'aitor'.\n[2024-02-15T06:52:05.030Z] Info : Client Version: 6.3.0-35076-master\n[2024-02-15T06:52:05.030Z] Info : OS Information: Ubuntu 22.04.3 LTS 22.04\n[2024-02-15T06:52:05.032Z] Info : Runtime Version: 8.0.0\n[2024-02-15T06:52:05.032Z] Info : Hostname: BNJLDK3\n[2024-02-15T06:52:05.034Z] Info : DNS Hostname: BNJLDK3\n[2024-02-15T06:52:05.037Z] Info : 'Service': Started listening on '/run/user/1001/appgate.service.sock'.\n[2024-02-15T06:52:05.647Z] Info : UI has connected to service.\n[2024-02-15T06:52:05.782Z] Info : Setting locale to en.\n[2024-02-15T06:52:05.936Z] Info : Creating session for profile profile group: 'Purple OIDC with Corp backup' (4e8d8366-e1c2-477e-bad3-4f56be6e1600) profile: 'AGI_Users' (-950587037).\n[2024-02-15T06:52:05.942Z] Info : NewLogicState 'loggingin', prev 'idle']\n[2024-02-15T06:52:05.942Z] Info : Creating session for profile profile group: 'Purple OIDC with Corp backup' (4e8d8366-e1c2-477e-bad3-4f56be6e1600) profile: 'Azure AD OIDC' (40816152).\n[2024-02-15T06:52:05.942Z] Info : NewLogicState 'loggingin', prev 'idle']\n[2024-02-15T06:52:05.942Z] Info : Creating session for profile 'AGI_Users' (-2081516145).\n[2024-02-15T06:52:05.943Z] Info : NewLogicState 'loggingin', prev 'idle']\n[2024-02-15T06:52:05.943Z] Info : Creating session for profile 'test' (1965183156).\n[2024-02-15T06:52:05.943Z] Info : NewLogicState 'loggingin', prev 'idle']\n[2024-02-15T06:52:05.943Z] Info : Switching profile to profile group: 'Purple OIDC with Corp backup' (4e8d8366-e1c2-477e-bad3-4f56be6e1600) profile: 'Azure AD OIDC' (40816152)\n[2024-02-15T06:52:05.947Z] Info : Resolving hostname 'purple.appgate.com'\n[2024-02-15T06:52:06.228Z] Info : Resolved IPs: [35.157.222.129, 35.177.27.1, 35.157.235.196]\n[2024-02-15T06:52:06.232Z] Info : Trying to connect 'purple.appgate.com/35.157.235.196' with SPA key name 'CryptZone'.\n[2024-02-15T06:52:06.721Z] Info : Switched to profile profile group: 'Purple OIDC with Corp backup' (4e8d8366-e1c2-477e-bad3-4f56be6e1600) profile: 'Azure AD OIDC' (40816152).\n[2024-02-15T06:52:06.724Z] Info : User input required for 'ConnectOidcLoginHandler'.\n[2024-02-15T06:52:23.491Z] Info : CA certificate found in the storage for 'purple.appgate.com'.\n[2024-02-15T06:52:23.491Z] Info : Resolving hostname 'purple.appgate.com'\n[2024-02-15T06:52:23.496Z] Info : Resolved IPs: [35.177.27.1, 35.157.222.129, 35.157.235.196]\n[2024-02-15T06:52:23.497Z] Info : Trying to connect 'purple.appgate.com/35.177.27.1' with SPA key name 'CryptZone'.\n[2024-02-15T06:52:24.050Z] Info : Identity Provider Appgate Azure AD OIDC found.\n[2024-02-15T06:52:24.050Z] Info : Fetching provider details for 'Appgate Azure AD OIDC'.\n[2024-02-15T06:52:24.090Z] Info : Posting token refresh request.\n[2024-02-15T06:52:25.141Z] Info : Logging in using 'Appgate Azure AD OIDC'.\n[2024-02-15T06:52:25.141Z] Info : Authenticating for the first time. Appgate Azure AD OIDC\n[2024-02-15T06:52:25.142Z] Info : Retrieving claims token.\n[2024-02-15T06:52:25.152Z] Info : Fetching on-boarding cookie for 'onboardingcookie-69:5c:78:68:76:64:91:2f:25:29:1d:b3:9a:e7:f9:7c:74:fa:5a:9c:6b:84:c0:a2:14:3e:be:f5:66:dd:bf:42-Appgate Azure AD OIDC-aitor.iturri@appgate.com-7dbdf7ce-b90a-4538-9b2c-c88f9b38bcd7' from secure storage.\n[2024-02-15T06:52:25.161Z] Info : On-boarding cookie available for 'onboardingcookie-69:5c:78:68:76:64:91:2f:25:29:1d:b3:9a:e7:f9:7c:74:fa:5a:9c:6b:84:c0:a2:14:3e:be:f5:66:dd:bf:42-Appgate Azure AD OIDC-aitor.iturri@appgate.com-7dbdf7ce-b90a-4538-9b2c-c88f9b38bcd7'.\n[2024-02-15T06:52:25.593Z] Info : Two factor authentication required for on-boarding.\n[2024-02-15T06:52:25.594Z] Info : Initializing on-boarding OTP seed.\n[2024-02-15T06:52:26.001Z] Info : OTP seed is already initialized for this user.\n[2024-02-15T06:52:26.208Z] Info : User input required for 'OnboardingOtpLoginHandler'.\n[2024-02-15T06:52:45.163Z] Info : Sending on-boarding OTP to controller.\n[2024-02-15T06:52:45.163Z] Info : Resolving hostname 'purple.appgate.com'\n[2024-02-15T06:52:45.169Z] Info : Resolved IPs: [35.177.27.1, 35.157.222.129, 35.157.235.196]\n[2024-02-15T06:52:45.170Z] Info : Trying to connect 'purple.appgate.com/35.157.222.129' with SPA key name 'CryptZone'.\n[2024-02-15T06:52:47.314Z] Info : Successfully on-boarded with OTP.\n[2024-02-15T06:52:47.314Z] Info : A new on-boarding cookie received, storing\n[2024-02-15T06:52:47.321Z] Info : Authentication succeeded. Claims Token: [TokenId: 2833d649-78dc-49a5-b416-4d5424470339, DistinguishedName: CN=7dbdf7ceb90a45389b2cc88f9b38bcd7,CN=aitor.iturri@appgate.com,OU=Appgate Azure AD OIDC, ExpirationTime: 2/22/2024 7:52:46 AM], On-demand Claims: [[]], Device Scripts: [[]]\n[2024-02-15T06:52:47.341Z] Info : Processing on-demand claims.\n[2024-02-15T06:52:47.344Z] Info : Getting entitlement tokens for the first time.\n[2024-02-15T06:52:47.345Z] Info : Retrieving entitlement tokens.\n[2024-02-15T06:52:48.811Z] Info : 8 new entitlement token(s) retrieved.\n[2024-02-15T06:52:48.812Z] Info : Entitlements for 'AWS US West 2': Purple - Appliance SSH - AWS US West 2, Dev - ZTP K8s Cluster API Endpoint, Dev - ZTP Test Environment, Dev - ZTP Dev Environment, Dev - ZTP Dev Databases\n[2024-02-15T06:52:48.814Z] Info : Entitlements for 'AWS EU Central 1': Purple - Admin UI - AWS EU Central, Purple - Appliance SSH Access - AWS EU Central, Test - Risk Based Access, Devops - Network Expansion Test, Purple - Kibana, Dev - x advice mongo test\n[2024-02-15T06:52:48.815Z] Info : Entitlements for 'AWS EU West 2': Purple - Admin UI - AWS EU West, Test - AWS West, Devops - CRL Server SSH, Purple - Appliance SSH - AWS EU West 2\n[2024-02-15T06:52:48.815Z] Info : Entitlements for 'AWS EU North 1': Devops - K8s - PTDeployer, RabbitMQ Web Console and Queue - Platform Dev, EKS Control Plane - Platform Dev, Purple - Appliance SSH - AWS EU North 1, Devops - K8s - PTDeployer Database\n[2024-02-15T06:52:48.815Z] Info : Entitlements for 'Gothenburg 1': Test - Exclude, Devops - Gateway - GOT, Dev - DNS - Devops, Dev - Teos Testlab, Dev - SecurID, Corp - Printers Ping - GOT, Test - Whatismyip dot com, Dev - Physical Test Environment, Dev - Kaspers Legacy, Dev - Devops Servers - GOT, Test - Soft-realtime UDP traffic, Corp - DNS - GOT, Dev - Client to Client Access, Corp - Production VMWare, Devops - SSH Jump, Test - Exclude Google, Dev - Illumio Test, Dev - VMWare - Devops, Dev - Developer Desktops, Corp - DNS Forwarder, Dev - Github, Corp - Secret Server, Corp - Printers - GOT, Test - All Remedy, Dev - Youtrack ICMP, Dev - ChatSDP, Test - Block Specific, Dev - Youtrack, Purple - Appliance SSH Access - GOT, Dev - SEDEV HYPERV01\n[2024-02-15T06:52:48.815Z] Info : Entitlements for 'GCP Europe West 3': Dev - Prometheus in GCP, Test - GCP, Purple - Appliance SSH Access - GCP\n[2024-02-15T06:52:48.815Z] Info : Entitlements for 'Azure North Europe': Purple - Appliance SSH - Azure\n[2024-02-15T06:52:48.815Z] Info : Entitlements for 'Gothenburg 3': Dev - Coverity, Test - LDAP, Devops - K8s - ArgoCD, Corp - SDP License Server, Dev - Grafana Dashboard, Dev - Devops Servers GOT03, Devops - Aitorbot, Dev - Teamcity, Dev - Terminal Servers, Dev - Artifact Repo, Devops - E2E Environments Scripted Lookup - GOT03, Test - SAML server, Corp - Support FTP, Dev - Vsphere Testing - LHR, Devops - K8s - Control Panel, Devops - K8s - Prometheus, Devops - GOT03 VC Admin, Dev - Envy GOT03, Dev - Aitorbot - Legacy, Test - Target - GOT03, Dev - Teamcity Agents GOT03, Devops - Kibana, Dev - Squid, Dev - Aitorbot Helvetest, Devops - E2E Environments - GOT03, Devops - Statsd Admin, Devops - K8s - Crates Caching Proxy, Corp - DNS - GOT03, Dev - E2E Enivronments - GOT03, Devops - K8s - Purple Reverse Controller, Corp - SDP Manual Server, Dev - Rust Proxy, Devops - GOT03 Vault, Dev - Terminal Services Test Farm, Devops - Gateway GOT03, Purple - Appliance SSH - GOT03, Dev - Testrail\n[2024-02-15T06:52:48.815Z] Info : Policies: All Developers Access, Azure Appliances SSH Access, Devops Engineers Policy-Access, DNS Policy - Europe, GBG Office Printers Policy-Access, Github Sweden Policy-Access, Purple appliances SSH-Access, Readonly Admins Policy-Access, VMWare Access Policy-Access, YT Override Policy-Access, ZTP Dev Environment, ZTP Test Environment\n[2024-02-15T06:52:48.816Z] Info : Profile configuration received: Profiles: Azure AD OIDC, AGI_Users\n[2024-02-15T06:52:48.828Z] Info : Starting package download to '/tmp/.appgatesdp-updates-robcsctr.h0u/appgate_6.3.0+35560+release_amd64.deb' from 'https://appgate-auto-update-artifacts.s3.amazonaws.com/appgate_6.3.0%2B35560%2Brelease_amd64.deb'.\n[2024-02-15T06:52:48.829Z] Info : Updating vpn certificate.\n[2024-02-15T06:52:48.829Z] Info : Retrieving VPN certificate.\n[2024-02-15T06:52:48.830Z] Info : VPN certificate found in secure storage for 'CN=7dbdf7ceb90a45389b2cc88f9b38bcd7,CN=aitor.iturri@appgate.com,OU=Appgate Azure AD OIDC'.\n[2024-02-15T06:52:48.940Z] Info : Initial network: (wlp0s20f3, 192.168.1.243), (wlp0s20f3, 2001:9b1:25ff:8a00::d68), (wlp0s20f3, fdf4:9135:d6a7::d68), (wlp0s20f3, fdf4:9135:d6a7:0:9ec9:b08d:a24f:67b2), (wlp0s20f3, fdf4:9135:d6a7:0:d584:19fc:8f3d:d62b), (wlp0s20f3, 2001:9b1:25ff:8a00:d086:9fda:d18e:a3a4), (wlp0s20f3, 2001:9b1:25ff:8a00:8f58:64bf:9e6a:f2ea)\n[2024-02-15T06:52:48.952Z] Info : NewLogicState 'loggedin', prev 'loggingin']\n[2024-02-15T06:52:48.955Z] Info : 'VPN Driver': Connecting.\n[2024-02-15T06:52:48.977Z] Info : 'VPN Driver': Setting log level to 'Info'.\n[2024-02-15T06:52:49.569Z] Info : Processing on-demand claims.\n[2024-02-15T06:52:49.571Z] Info : Checking next CA certificate.\n[2024-02-15T06:52:49.629Z] Info : Received a next CA certificate. Storing it.\n[2024-02-15T06:52:49.756Z] Info : 'GCP Europe West 3': VPN connected.\n[2024-02-15T06:52:49.756Z] Info : 'Azure North Europe': VPN connected.\n[2024-02-15T06:52:49.757Z] Info : 'GCP Europe West 3': Connected to 'gcp - purple31'\n[2024-02-15T06:52:49.757Z] Info : 'Azure North Europe': Connected to 'azure - purple21'\n[2024-02-15T06:52:49.758Z] Info : 'Azure North Europe': Creating a new connection.\n[2024-02-15T06:52:49.758Z] Info : 'GCP Europe West 3': Creating a new connection.\n[2024-02-15T06:52:49.761Z] Info : 'GCP Europe West 3': Logging in.\n[2024-02-15T06:52:49.762Z] Info : 'Azure North Europe': Logging in.\n[2024-02-15T06:52:49.762Z] Info : 'Azure North Europe': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:49.762Z] Info : 'GCP Europe West 3': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:49.875Z] Info : 'GCP Europe West 3': Successfully logged in.\n[2024-02-15T06:52:49.975Z] Info : 'Azure North Europe': Successfully logged in.\n[2024-02-15T06:52:49.976Z] Info : 'GCP Europe West 3': App source is online with 1 client app.\n[2024-02-15T06:52:50.288Z] Info : 'AWS EU North 1': VPN connected.\n[2024-02-15T06:52:50.288Z] Info : 'AWS EU North 1': Connected to 'aws - purple100'\n[2024-02-15T06:52:50.288Z] Info : 'AWS EU North 1': Creating a new connection.\n[2024-02-15T06:52:50.288Z] Info : 'AWS EU North 1': Logging in.\n[2024-02-15T06:52:50.289Z] Info : 'AWS EU North 1': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU Central 1': VPN connected.\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU West 2': VPN connected.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 1': VPN connected.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 3': VPN connected.\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU West 2': Connected to 'aws - purple40'\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU Central 1': Connected to 'aws - purple11'\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU North 1': Successfully logged in.\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU West 2': Creating a new connection.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 3': Connected to 'got - purple121'\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 3': Creating a new connection.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 3': Logging in.\n[2024-02-15T06:52:50.392Z] Info : 'AWS EU West 2': Logging in.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 3': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 1': Connected to 'got - purple1'\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 1': Creating a new connection.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 1': Logging in.\n[2024-02-15T06:52:50.392Z] Info : 'Gothenburg 1': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:50.393Z] Info : 'AWS EU West 2': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:50.393Z] Info : 'AWS EU Central 1': Creating a new connection.\n[2024-02-15T06:52:50.393Z] Info : 'AWS EU Central 1': Logging in.\n[2024-02-15T06:52:50.393Z] Info : 'AWS EU Central 1': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:50.503Z] Info : 'AWS EU West 2': Successfully logged in.\n[2024-02-15T06:52:50.503Z] Info : 'Gothenburg 3': Successfully logged in.\n[2024-02-15T06:52:50.503Z] Info : 'Gothenburg 1': Successfully logged in.\n[2024-02-15T06:52:50.504Z] Info : 'AWS EU North 1': App source is online with 1 client app.\n[2024-02-15T06:52:50.609Z] Info : 'AWS US West 2': VPN connected.\n[2024-02-15T06:52:50.610Z] Info : 'AWS US West 2': Connected to 'aws - purple60'\n[2024-02-15T06:52:50.610Z] Info : 'AWS US West 2': Creating a new connection.\n[2024-02-15T06:52:50.610Z] Info : 'AWS EU Central 1': Successfully logged in.\n[2024-02-15T06:52:50.610Z] Info : 'AWS US West 2': Logging in.\n[2024-02-15T06:52:50.610Z] Info : 'AWS US West 2': Begin login request with '2833d649-78dc-49a5-b416-4d5424470339'.\n[2024-02-15T06:52:50.611Z] Info : 'AWS EU Central 1': App source is offline with 4 client apps.\n[2024-02-15T06:52:50.611Z] Info : 'AWS EU West 2': App source is online with 2 client apps.\n[2024-02-15T06:52:50.611Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T06:52:50.719Z] Info : 'AWS EU Central 1': App source is online with 4 client apps.\n[2024-02-15T06:52:50.830Z] Info : 'Gothenburg 1': App source is online with 17 client apps.\n[2024-02-15T06:52:51.036Z] Info : Connected and logged into all sites.\n[2024-02-15T06:52:51.036Z] Info : 'AWS US West 2': Successfully logged in.\n[2024-02-15T06:52:51.036Z] Info : 'AWS US West 2': App source is offline with 4 client apps.\n[2024-02-15T06:52:51.140Z] Info : 'AWS US West 2': App source is online with 4 client apps.\n[2024-02-15T06:52:53.272Z] Info : Download completed, file is in '/tmp/.appgatesdp-updates-robcsctr.h0u/appgate_6.3.0+35560+release_amd64.deb'. filesize: 89099188 sha256: 24a9211d2b5e2602cb57bbe757b0164e3ff147fb4cc36be8ab838620af3e7a38\n[2024-02-15T06:52:53.521Z] Info : ExitCode: 0\n[2024-02-15T06:52:53.521Z] Info : output: GOODSIG _gpgappgate b'F36B319BCE0748F7793052E6F600207F0680FA29' b'2024-02-12'\n[2024-02-15T06:55:00.291Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T06:57:48.949Z] Info : Processing on-demand claims.\n[2024-02-15T06:57:48.950Z] Info : 'AWS US West 2': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'AWS EU Central 1': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'Gothenburg 1': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'AWS EU North 1': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'AWS EU West 2': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'GCP Europe West 3': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'Azure North Europe': Updating tokens.\n[2024-02-15T06:57:48.950Z] Info : 'Gothenburg 3': Updating tokens.\n[2024-02-15T06:57:49.051Z] Info : 'AWS EU North 1': Successfully updated tokens.\n[2024-02-15T06:57:49.051Z] Info : 'GCP Europe West 3': Successfully updated tokens.\n[2024-02-15T06:57:49.051Z] Info : 'AWS EU West 2': Successfully updated tokens.\n[2024-02-15T06:57:49.051Z] Info : 'AWS EU Central 1': Successfully updated tokens.\n[2024-02-15T06:57:49.151Z] Info : 'Azure North Europe': Successfully updated tokens.\n[2024-02-15T06:57:49.151Z] Info : 'Gothenburg 3': Successfully updated tokens.\n[2024-02-15T06:57:49.152Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T06:57:49.456Z] Info : 'AWS US West 2': Successfully updated tokens.\n[2024-02-15T06:57:50.264Z] Info : 'Gothenburg 1': Successfully updated tokens.\n[2024-02-15T06:59:00.168Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T07:00:00.284Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T07:02:48.961Z] Info : Processing on-demand claims.\n[2024-02-15T07:07:48.983Z] Info : Processing on-demand claims.\n[2024-02-15T07:12:49.036Z] Info : Processing on-demand claims.\n[2024-02-15T07:17:49.087Z] Info : Processing on-demand claims.\n[2024-02-15T07:22:49.123Z] Info : Processing on-demand claims.\n[2024-02-15T07:27:49.148Z] Info : Processing on-demand claims.\n[2024-02-15T07:32:49.209Z] Info : Processing on-demand claims.\n[2024-02-15T07:37:49.271Z] Info : Processing on-demand claims.\n[2024-02-15T07:42:49.287Z] Info : Processing on-demand claims.\n[2024-02-15T07:47:49.321Z] Info : Processing on-demand claims.\n[2024-02-15T07:52:49.342Z] Info : Processing on-demand claims.\n[2024-02-15T07:57:49.418Z] Info : Processing on-demand claims.\n[2024-02-15T08:02:48.178Z] Info : Token renewal for [5a12de06-fe40-4b49-8094-797c8ded36af] is received by 'got - purple1'. Will update the token.\n[2024-02-15T08:02:48.178Z] Info : Token renewal for [a142e674-0b06-47c6-b585-a3ac69905b35] is received by 'got - purple121'. Will update the token.\n[2024-02-15T08:02:48.178Z] Info : Token renewal for [921def11-6b2a-4ac1-a69b-33c4031d813a] is received by 'aws - purple11'. Will update the token.\n[2024-02-15T08:02:48.178Z] Info : Token renewal for [bb4826ae-7c94-4790-b181-3118b08c17be] is received by 'aws - purple60'. Will update the token.\n[2024-02-15T08:02:48.216Z] Info : Token renewal for [ef61efd4-fc2a-4c6e-aa5e-137cec6f9c46] is received by 'aws - purple100'. Will update the token.\n[2024-02-15T08:02:48.277Z] Info : Retrieving entitlement tokens.\n[2024-02-15T08:02:48.279Z] Info : Resolving hostname 'purple.appgate.com'\n[2024-02-15T08:02:48.313Z] Info : Resolved IPs: [35.157.222.129, 35.177.27.1, 35.157.235.196]\n[2024-02-15T08:02:48.313Z] Info : Trying to connect 'purple.appgate.com/35.157.235.196' with SPA key name 'CryptZone'.\n[2024-02-15T08:02:48.542Z] Info : Token renewal for [e53cfef9-edbe-4e7a-9847-1f401441fe8f] is received by 'azure - purple21'. Will update the token.\n[2024-02-15T08:02:48.764Z] Info : Token renewal for [d828fec6-4472-4e6a-94a6-ce0d636aabcc] is received by 'gcp - purple31'. Will update the token.\n[2024-02-15T08:02:48.942Z] Info : Token renewal for [2ae7cbda-6a48-40e6-b7a6-9b02f00d82c7] is received by 'aws - purple40'. Will update the token.\n[2024-02-15T08:02:50.488Z] Info : 8 new entitlement token(s) retrieved.\n[2024-02-15T08:02:50.488Z] Info : Entitlements for 'AWS US West 2': Dev - ZTP K8s Cluster API Endpoint, Dev - ZTP Dev Environment, Purple - Appliance SSH - AWS US West 2, Dev - ZTP Dev Databases, Dev - ZTP Test Environment\n[2024-02-15T08:02:50.488Z] Info : Entitlements for 'AWS EU Central 1': Test - Risk Based Access, Devops - Network Expansion Test, Purple - Admin UI - AWS EU Central, Purple - Appliance SSH Access - AWS EU Central, Dev - x advice mongo test, Purple - Kibana\n[2024-02-15T08:02:50.488Z] Info : Entitlements for 'AWS EU West 2': Purple - Appliance SSH - AWS EU West 2, Purple - Admin UI - AWS EU West, Test - AWS West, Devops - CRL Server SSH\n[2024-02-15T08:02:50.489Z] Info : Entitlements for 'AWS EU North 1': EKS Control Plane - Platform Dev, Devops - K8s - PTDeployer Database, RabbitMQ Web Console and Queue - Platform Dev, Purple - Appliance SSH - AWS EU North 1, Devops - K8s - PTDeployer\n[2024-02-15T08:02:50.489Z] Info : Entitlements for 'Gothenburg 1': Purple - Appliance SSH Access - GOT, Dev - Youtrack, Test - All Remedy, Dev - SEDEV HYPERV01, Corp - Secret Server, Corp - Printers Ping - GOT, Dev - Physical Test Environment, Dev - DNS - Devops, Dev - Teos Testlab, Dev - ChatSDP, Corp - DNS - GOT, Devops - SSH Jump, Test - Soft-realtime UDP traffic, Dev - Illumio Test, Dev - VMWare - Devops, Dev - Devops Servers - GOT, Test - Exclude, Dev - Kaspers Legacy, Test - Block Specific, Corp - Production VMWare, Test - Whatismyip dot com, Dev - Youtrack ICMP, Corp - DNS Forwarder, Dev - Developer Desktops, Corp - Printers - GOT, Dev - SecurID, Test - Exclude Google, Dev - Client to Client Access, Devops - Gateway - GOT, Dev - Github\n[2024-02-15T08:02:50.489Z] Info : Entitlements for 'GCP Europe West 3': Test - GCP, Purple - Appliance SSH Access - GCP, Dev - Prometheus in GCP\n[2024-02-15T08:02:50.489Z] Info : Entitlements for 'Azure North Europe': Purple - Appliance SSH - Azure\n[2024-02-15T08:02:50.489Z] Info : Entitlements for 'Gothenburg 3': Devops - Gateway GOT03, Dev - E2E Enivronments - GOT03, Devops - Aitorbot, Devops - E2E Environments Scripted Lookup - GOT03, Devops - K8s - Crates Caching Proxy, Dev - Testrail, Devops - K8s - Purple Reverse Controller, Dev - Rust Proxy, Dev - Squid, Devops - E2E Environments - GOT03, Devops - K8s - Control Panel, Devops - K8s - Prometheus, Devops - Kibana, Dev - Envy GOT03, Corp - SDP Manual Server, Devops - K8s - ArgoCD, Test - SAML server, Devops - Statsd Admin, Dev - Teamcity, Purple - Appliance SSH - GOT03, Corp - Support FTP, Dev - Devops Servers GOT03, Dev - Artifact Repo, Dev - Terminal Servers, Test - LDAP, Dev - Vsphere Testing - LHR, Dev - Grafana Dashboard, Devops - GOT03 Vault, Corp - DNS - GOT03, Dev - Aitorbot - Legacy, Corp - SDP License Server, Devops - GOT03 VC Admin, Dev - Aitorbot Helvetest, Test - Target - GOT03, Dev - Terminal Services Test Farm, Dev - Teamcity Agents GOT03, Dev - Coverity\n[2024-02-15T08:02:50.489Z] Info : Policies: All Developers Access, Azure Appliances SSH Access, Devops Engineers Policy-Access, DNS Policy - Europe, GBG Office Printers Policy-Access, Github Sweden Policy-Access, Purple appliances SSH-Access, Readonly Admins Policy-Access, VMWare Access Policy-Access, YT Override Policy-Access, ZTP Dev Environment, ZTP Test Environment\n[2024-02-15T08:02:50.489Z] Info : Profile configuration received: Profiles: Azure AD OIDC, AGI_Users\n[2024-02-15T08:02:50.501Z] Info : Starting package download to '/tmp/.appgatesdp-updates-robcsctr.h0u/appgate_6.3.0+35560+release_amd64.deb' from 'https://appgate-auto-update-artifacts.s3.amazonaws.com/appgate_6.3.0%2B35560%2Brelease_amd64.deb'.\n[2024-02-15T08:02:50.501Z] Info : Same update file exists. Backing it up in case the new download fails.\n[2024-02-15T08:02:50.501Z] Info : Motd already shown this session. Ignoring.\n[2024-02-15T08:02:50.818Z] Info : 'AWS US West 2': Updating tokens.\n[2024-02-15T08:02:50.818Z] Info : 'AWS EU Central 1': Updating tokens.\n[2024-02-15T08:02:50.818Z] Info : 'AWS EU West 2': Updating tokens.\n[2024-02-15T08:02:50.818Z] Info : 'AWS EU North 1': Updating tokens.\n[2024-02-15T08:02:50.818Z] Info : 'GCP Europe West 3': Updating tokens.\n[2024-02-15T08:02:50.818Z] Info : 'Gothenburg 1': Updating tokens.\n[2024-02-15T08:02:50.818Z] Info : 'Gothenburg 3': Updating tokens.\n[2024-02-15T08:02:50.822Z] Info : 'Azure North Europe': Updating tokens.\n[2024-02-15T08:02:50.931Z] Info : Processing on-demand claims.\n[2024-02-15T08:02:50.932Z] Info : Connected and logged into all sites.\n[2024-02-15T08:02:50.932Z] Info : 'AWS EU West 2': Successfully updated tokens.\n[2024-02-15T08:02:50.932Z] Info : 'AWS EU North 1': Successfully updated tokens.\n[2024-02-15T08:02:50.932Z] Info : 'Gothenburg 3': Successfully updated tokens.\n[2024-02-15T08:02:50.932Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T08:02:51.034Z] Info : 'Azure North Europe': Successfully updated tokens.\n[2024-02-15T08:02:51.034Z] Info : 'GCP Europe West 3': Successfully updated tokens.\n[2024-02-15T08:02:51.034Z] Info : 'AWS EU Central 1': Successfully updated tokens.\n[2024-02-15T08:02:51.236Z] Info : 'AWS US West 2': Successfully updated tokens.\n[2024-02-15T08:02:51.637Z] Info : 'Gothenburg 1': Successfully updated tokens.\n[2024-02-15T08:02:51.637Z] Info : 'Gothenburg 1': App source is online with 17 client apps.\n[2024-02-15T08:02:54.090Z] Info : Download completed, file is in '/tmp/.appgatesdp-updates-robcsctr.h0u/appgate_6.3.0+35560+release_amd64.deb'. filesize: 89099188 sha256: 24a9211d2b5e2602cb57bbe757b0164e3ff147fb4cc36be8ab838620af3e7a38\n[2024-02-15T08:02:54.334Z] Info : ExitCode: 0\n[2024-02-15T08:02:54.334Z] Info : output: GOODSIG _gpgappgate b'F36B319BCE0748F7793052E6F600207F0680FA29' b'2024-02-12'\n[2024-02-15T08:07:50.975Z] Info : Processing on-demand claims.\n[2024-02-15T08:07:50.975Z] Info : 'AWS US West 2': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'AWS EU Central 1': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'AWS EU West 2': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'AWS EU North 1': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'GCP Europe West 3': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'Azure North Europe': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'Gothenburg 3': Updating tokens.\n[2024-02-15T08:07:50.975Z] Info : 'Gothenburg 1': Updating tokens.\n[2024-02-15T08:07:51.076Z] Info : 'AWS EU Central 1': Successfully updated tokens.\n[2024-02-15T08:07:51.076Z] Info : 'AWS EU North 1': Successfully updated tokens.\n[2024-02-15T08:07:51.076Z] Info : 'Gothenburg 3': Successfully updated tokens.\n[2024-02-15T08:07:51.076Z] Info : 'GCP Europe West 3': Successfully updated tokens.\n[2024-02-15T08:07:51.076Z] Info : 'AWS EU West 2': Successfully updated tokens.\n[2024-02-15T08:07:51.177Z] Info : 'Azure North Europe': Successfully updated tokens.\n[2024-02-15T08:07:51.577Z] Info : 'AWS US West 2': Successfully updated tokens.\n[2024-02-15T08:07:51.778Z] Info : 'Gothenburg 1': Successfully updated tokens.\n[2024-02-15T08:10:00.321Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T08:12:51.061Z] Info : Processing on-demand claims.\n[2024-02-15T08:15:00.189Z] Info : 'Gothenburg 3': App source is online with 19 client apps.\n[2024-02-15T08:17:51.126Z] Info : Processing on-demand claims.\n[2024-02-15T08:22:51.220Z] Info : Processing on-demand claims.\n[2024-02-15T08:27:51.215Z] Info : Processing on-demand claims.\n[2024-02-15T08:32:51.283Z] Info : Processing on-demand claims.\n[2024-02-15T08:37:51.365Z] Info : Processing on-demand claims.\n[2024-02-15T08:42:51.379Z] Info : Processing on-demand claims.\n[2024-02-15T08:47:51.408Z] Info : Processing on-demand claims.\n[2024-02-15T08:52:51.440Z] Info : Processing on-demand claims.\n[2024-02-15T08:57:51.478Z] Info : Processing on-demand claims.\n[2024-02-15T09:02:51.546Z] Info : Processing on-demand claims.\n[2024-02-15T09:07:51.631Z] Info : Processing on-demand claims.\n[2024-02-15T09:12:50.311Z] Info : Token renewal for [bbde9fbd-4e27-4b43-8372-ed6ccf6342e8] is received by 'aws - purple11'. Will update the token.\n[2024-02-15T09:12:50.311Z] Info : Token renewal for [5c4b5d33-e98c-42e4-b4cd-b65798c43a45] is received by 'got - purple1'. Will update the token.\n[2024-02-15T09:12:50.311Z] Info : Token renewal for [5d183eb2-c768-4243-bcb9-2d49a5568c1c] is received by 'aws - purple100'. Will update the token.\n[2024-02-15T09:12:50.311Z] Info : Token renewal for [211953f9-19ec-4994-82b5-453568b8d865] is received by 'aws - purple60'. Will update the token.\n[2024-02-15T09:12:50.311Z] Info : Token renewal for [96c9fb5d-4837-47c8-98dc-f3671c5235b8] is received by 'got - purple121'. Will update the token.\n[2024-02-15T09:12:50.362Z] Info : Retrieving entitlement tokens.\n[2024-02-15T09:12:50.363Z] Info : Resolving hostname 'purple.appgate.com'\n[2024-02-15T09:12:50.372Z] Info : Resolved IPs: [35.157.222.129, 35.157.235.196, 35.177.27.1]\n[2024-02-15T09:12:50.372Z] Info : Trying to connect 'purple.appgate.com/35.157.235.196' with SPA key name 'CryptZone'.\n[2024-02-15T09:12:50.542Z] Info : Token renewal for [daf4ba6d-d4d4-4713-9f51-f98a0abc8494] is received by 'azure - purple21'. Will update the token.\n[2024-02-15T09:12:50.764Z] Info : Token renewal for [39d40c97-e58f-4f18-950b-f6b3e47c7440] is received by 'gcp - purple31'. Will update the token.\n[2024-02-15T09:12:50.949Z] Info : Token renewal for [bf1faba3-c4c0-4ac4-9b6d-6ce464293513] is received by 'aws - purple40'. Will update the token.\n[2024-02-15T09:12:52.621Z] Info : 8 new entitlement token(s) retrieved.\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'AWS US West 2': Dev - ZTP K8s Cluster API Endpoint, Dev - ZTP Dev Environment, Purple - Appliance SSH - AWS US West 2, Dev - ZTP Dev Databases, Dev - ZTP Test Environment\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'AWS EU Central 1': Test - Risk Based Access, Devops - Network Expansion Test, Purple - Admin UI - AWS EU Central, Purple - Appliance SSH Access - AWS EU Central, Dev - x advice mongo test, Purple - Kibana\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'AWS EU West 2': Purple - Appliance SSH - AWS EU West 2, Purple - Admin UI - AWS EU West, Test - AWS West, Devops - CRL Server SSH\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'AWS EU North 1': EKS Control Plane - Platform Dev, Devops - K8s - PTDeployer Database, RabbitMQ Web Console and Queue - Platform Dev, Purple - Appliance SSH - AWS EU North 1, Devops - K8s - PTDeployer\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'Gothenburg 1': Purple - Appliance SSH Access - GOT, Dev - Youtrack, Test - All Remedy, Dev - SEDEV HYPERV01, Corp - Secret Server, Corp - Printers Ping - GOT, Dev - Physical Test Environment, Dev - DNS - Devops, Dev - Teos Testlab, Dev - ChatSDP, Corp - DNS - GOT, Devops - SSH Jump, Test - Soft-realtime UDP traffic, Dev - Illumio Test, Dev - VMWare - Devops, Dev - Devops Servers - GOT, Test - Exclude, Dev - Kaspers Legacy, Test - Block Specific, Corp - Production VMWare, Test - Whatismyip dot com, Dev - Youtrack ICMP, Corp - DNS Forwarder, Dev - Developer Desktops, Corp - Printers - GOT, Dev - SecurID, Test - Exclude Google, Dev - Client to Client Access, Devops - Gateway - GOT, Dev - Github\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'GCP Europe West 3': Test - GCP, Purple - Appliance SSH Access - GCP, Dev - Prometheus in GCP\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'Azure North Europe': Purple - Appliance SSH - Azure\n[2024-02-15T09:12:52.621Z] Info : Entitlements for 'Gothenburg 3': Devops - Gateway GOT03, Dev - E2E Enivronments - GOT03, Devops - Aitorbot, Devops - E2E Environments Scripted Lookup - GOT03, Devops - K8s - Crates Caching Proxy, Dev - Testrail, Devops - K8s - Purple Reverse Controller, Dev - Rust Proxy, Dev - Squid, Devops - E2E Environments - GOT03, Devops - K8s - Control Panel, Devops - K8s - Prometheus, Devops - Kibana, Dev - Envy GOT03, Corp - SDP Manual Server, Devops - K8s - ArgoCD, Test - SAML server, Devops - Statsd Admin, Dev - Teamcity, Purple - Appliance SSH - GOT03, Corp - Support FTP, Dev - Devops Servers GOT03, Dev - Artifact Repo, Dev - Terminal Servers, Test - LDAP, Dev - Vsphere Testing - LHR, Dev - Grafana Dashboard, Devops - GOT03 Vault, Corp - DNS - GOT03, Dev - Aitorbot - Legacy, Corp - SDP License Server, Devops - GOT03 VC Admin, Dev - Aitorbot Helvetest, Test - Target - GOT03, Dev - Terminal Services Test Farm, Dev - Teamcity Agents GOT03, Dev - Coverity\n[2024-02-15T09:12:52.621Z] Info : Policies: All Developers Access, Azure Appliances SSH Access, Devops Engineers Policy-Access, DNS Policy - Europe, GBG Office Printers Policy-Access, Github Sweden Policy-Access, Purple appliances SSH-Access, Readonly Admins Policy-Access, VMWare Access Policy-Access, YT Override Policy-Access, ZTP Dev Environment, ZTP Test Environment\n[2024-02-15T09:12:52.621Z] Info : Profile configuration received: Profiles: Azure AD OIDC, AGI_Users\n[2024-02-15T09:12:52.628Z] Info : Starting package download to '/tmp/"
                                }
                            ]
                        }
                    ]                
                },
                "author": "aitor.iturri",
                "created": 1708002525137
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Looks like it is a DNS issue of some sort:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "[2024-02-15T10:56:13.280Z] Info : Resolving hostname 'purple.appgate.com'\n[2024-02-15T10:56:23.280Z] Warn : Lookup of 'purple.appgate.com' failed: Timeout when looking up 'purple.appgate.com'.\n[2024-02-15T10:56:23.281Z] Error : Connection to controller '"
                                },
                                {
                                    "type": "text",
                                    "text": "https://purple.appgate.com/'"
                                },
                                {
                                    "type": "text",
                                    "text": " has failed. Reason: Could not establish a connection."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "per.allansson",
                                        "text": "@per.allansson",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": "  - could you have a look when you're back? "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "aitor.iturri",
                                        "text": "@aitor.iturri",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": "  - could you attach the driver logs?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1708008727227
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Driver should handle the GW as dead if it doesn't end up getting a READY from vpnd, which would include the client not sending any/correct tokens on login - and the code looks good to me as well, so driver logs + where we see the problem, or there is nothing else to look at here."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1708515199783
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "appgate_logs-2024-02-21.zip",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "appgate_logs-2024-02-21.zip"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " and any thoughts on why DNS resolution of the controller was failing?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1708518446677
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I guess the \"not failing over to other GW\" here is for example that it doesn't go purple1 --\\> purple2 --\\> purple1 --\\> ?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "If so, that is explained by DNS problems as well - the driver fails to lookup purple2.appgate.com"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1708522265686
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As for the DNS problem, it's not possible to tell, but the machine started losing connectivity around 10-15mins before this - and it wouldn't be the first time resolved went into a strange state and needing a kick as in new DNS settings to get working again."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1708522627897
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok, let's blame the user and close :D"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1708522718578
            }
        ]
    },
    {
        "key": "SA-21829",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Steps: 1. Create some entities on 6.0 appliance 2. Take a backup with sdpctl 3. Restore the backup with a 6.2 appliance with \\"
                        },
                        {
                            "type": "text",
                            "text": "cz-restore --keep-network \\",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " Expected: 1. Restore successfully Actual: 1. Restore fails during data migration with the following logs \\"
                        },
                        {
                            "type": "text",
                            "text": "\\",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "\\"
                        },
                        {
                            "type": "text",
                            "text": " May 03 18:36:13 envy-10-97-140-2.devops cz-configd[4326]: WARNING [set fields limit] Attempt 9 of 10 failed with error: Command '['arc', 'container', 'exec', '--uid', '0', '--gid', '0', 'cz-opensearch', '--', 'es-tools', '--cmd', 'set-fields-limit', '--number', '3000']' returned non-zero exit status 1.. Sleeping 10 seconds before retrying... May 03 18:36:23 envy-10-97-140-2.devops cz-configd[5958]: Updating field limit to 3000 May 03 18:36:23 envy-10-97-140-2.devops cz-configd[5958]: Elasticsearch http-code: 404 May 03 18:36:23 envy-10-97-140-2.devops cz-configd[5958]: index not found exception May 03 18:36:23 envy-10-97-140-2.devops cz-configd[4326]: INFO [ActionRunner] RestoreOpenSearchAction failed May 03 18:36:23 envy-10-97-140-2.devops cz-configd[4326]: INFO [change] Change 48dc2d74-89b7-46bb-a75e-ad5460c3fc21 completed with result failure after 150.477 seconds May 03 18:36:23 envy-10-97-140-2.devops cz-configd[4326]: WARNING Transition failed, rolling back to previous state. Caused by: Failed to restore logserver: Command '['arc', 'container', 'exec', '--uid', '0', '--gid', '0', 'cz-opensearch', '--', 'es-tools', '--cmd', 'set-fields-limit', '--number', '3000']' returned non-zero exit status 1. Traceback (most recent call last): File \"/usr/cz-configd/configd/logserver/actions.py\", line 189, in \\_\\_call\\_\\_ utils.try\\_n\\_times( File \"/usr/cz-configd/configd/utils.py\", line 282, in try\\_n\\_times raise e File \"/usr/cz-configd/configd/utils.py\", line 266, in try\\_n\\_times return f() File \"/usr/cz-configd/configd/logserver/actions.py\", line 191, in lambda: es\\_tools(\"set-fields-limit\", [\"--number\", \"3000\"]), File \"/usr/cz-configd/configd/logserver/actions.py\", line 47, in es\\_tools subprocess.check\\_call(command, timeout=timeout) File \"/usr/lib/python3.8/subprocess.py\", line 364, in check\\_call raise CalledProcessError(retcode, cmd) subprocess.CalledProcessError: Command '['arc', 'container', 'exec', '--uid', '0', '--gid', '0', 'cz-opensearch', '--', 'es-tools', '--cmd', 'set-fields-limit', '--number', '3000']' returned non-zero exit status 1. \\",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "\\"
                        },
                        {
                            "type": "text",
                            "text": "\\",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It's actually a problem with ES."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Sep 26 10:09:53 envy-10-97-146-2.devops /__main__.py[2491]: Running command ['arc', 'container', 'exec', '--uid', '0', '--gid', '0', 'cz-opensearch', '--', 'es-tools', '--cmd', 'es-restore-dashboards']\nSep 26 10:09:54 envy-10-97-146-2.devops cz-proxyd[2788]: INFO    [spa-tls][10.97.146.3:42160] Authorized with key \"envy-10-97-146-2.devops\"\nSep 26 10:09:54 envy-10-97-146-2.devops nginx_main[2804]: 2023/09/26 10:09:54 [error] 2804#2804: *29 connect() failed (111: Connection refused) while connecting to upstream, client: 10.97.146.3, server: _, request: \"GET /peer/ws HTTP/1.1\", upstream: \""
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/peer/ws\""
                                },
                                {
                                    "type": "text",
                                    "text": ","
                                },
                                {
                                    "type": "text",
                                    "text": " host: \"envy-10-97-146-2.devops\"\nSep 26 10:09:54 envy-10-97-146-2.devops nginx[2804]: 2023/09/26 10:09:54 [error] 2804#2804: *29 connect() failed (111: Connection refused) while connecting to upstream, client: 10.97.146.3, server: _, request: \"GET /peer/ws HTTP/1.1\", upstream: \""
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/peer/ws\""
                                },
                                {
                                    "type": "text",
                                    "text": ","
                                },
                                {
                                    "type": "text",
                                    "text": " host: \"envy-10-97-146-2.devops\"\nSep 26 10:09:54 envy-10-97-146-2.devops nginx_main[2804]: 10.97.146.3 - - [26/Sep/2023:10:09:54 +0000] \"GET /peer/ws HTTP/1.1\" 502 150 \"-\" \"Python/3.8 aiohttp/3.6.2\"\nSep 26 10:09:54 envy-10-97-146-2.devops cz-configd[3457]: Deleting .kibana_7.12.1_001\nSep 26 10:09:54 envy-10-97-146-2.devops cz-configd[3457]: Elasticsearch http-code: 404\nSep 26 10:09:54 envy-10-97-146-2.devops cz-configd[3457]: index not found exception\nSep 26 10:09:54 envy-10-97-146-2.devops cz-configd[3471]: Deleting .kibana_1\nSep 26 10:09:54 envy-10-97-146-2.devops cz-configd[3471]: Elasticsearch http-code: 404\nSep 26 10:09:54 envy-10-97-146-2.devops cz-configd[3471]: index not found exception\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]: [INFO ][o.o.r.RepositoriesService] [envy-10-97-146-2.devops] put repository [backupRestoreKibana]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]: [WARN ][r.suppressed             ] [envy-10-97-146-2.devops] path: /_snapshot/backupRestoreKibana/snapshot_1/_restore, params: {repository=backupRestoreKibana, snapshot=snapshot_1}\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]: org.opensearch.repositories.RepositoryException: [backupRestoreKibana] Unexpected exception when loading repository data\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.repositories.blobstore.BlobStoreRepository.doGetRepositoryData(BlobStoreRepository.java:1673) [opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.action.ActionRunnable$2.doRun(ActionRunnable.java:88) [opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:798) [opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:52) [opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) [?:?]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at java.lang.Thread.run(Thread.java:833) [?:?]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]: Caused by: org.opensearch.common.ParsingException: Failed to parse object: unknown field [uuid] found\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.common.xcontent.XContentParserUtils.throwUnknownField(XContentParserUtils.java:72) ~[opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.repositories.RepositoryData.snapshotsFromXContent(RepositoryData.java:654) ~[opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.repositories.blobstore.BlobStoreRepository.getRepositoryData(BlobStoreRepository.java:1828) ~[opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         at org.opensearch.repositories.blobstore.BlobStoreRepository.doGetRepositoryData(BlobStoreRepository.java:1635) ~[opensearch-2.0.1.jar:2.0.1]\nSep 26 10:09:54 envy-10-97-146-2.devops cz-opensearch[2884]:         ... 6 more"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1695723994662
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Is this really expected to work?  I mean if you take a backup on 6.0 (that has a elasticsearch based db).. and try to restore the backup on 6.2 (that has a opensearch based db) that will not work...."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1697609677907
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Talk to "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "jamie.bodley",
                                        "text": "@jamie.bodley",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": "-scott to ask if the requirement to do that from 6.0 exists or not. Normally it has existed."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1697609985678
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The restore is supposed to go through the same process as an upgrade yes. This does work for controllers etc..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1697610708432
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The problem here, is that the backup/restore functions of kibana/opensearchdashboards are not compatible. If you do a backup of kibana, it will not restore on opensearchdashboards"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1697611235747
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "OK I think its fine if we consider this unsupported for 6.0 -> 6.2 specifically. We probably want to support that going forward though, or at least explicitly not supported when its not possible."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1697611324112
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Normally it works.. but since we changed product, and this is a 3rd party software..  Its really a requirments / feature missing on their product.  To make this work opensearchdashboards would need to implement the support.."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1697611430842
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Well I assume they have funcitonality to export a dashboard in kibana and one to import in opensearch. Not saying that its worth the effort here but its the same concept with Postgres/BDR."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1697612223430
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "If we assume that works.  how will that help us?  since you have the backup that was taken in 6.0 how do you create a import file from that"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1697613626444
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I'm assuming the formats are somewhat similar, else you would need to implement some kind of migration to import into opensearch dashboards. How do you do for regular 6.2 -> 6.2 backup / restore of logserver?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Anyways I'm fine for marking this ticket as won't fix."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1697614823415
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This are 2 different functions.   the backup restore uses: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://opensearch.org/docs/1.2/opensearch/snapshot-restore/",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://opensearch.org/docs/1.2/opensearch/snapshot-restore/"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " The export/import functions is a different function."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The format is different since the snapshot has support for incremental snapshots..   while the import / export is a json-ish type of format..  the snapshot is a binary format"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1697615986740
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://got-youtrack.agi.appgate.com/issue/SA-22529/Restore-should-fail-with-clear-error-when-trying-to-restore-older-logserver-backup-into-newer-logserver",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-youtrack.agi.appgate.com/issue/SA-22529/Restore-should-fail-with-clear-error-when-trying-to-restore-older-logserver-backup-into-newer-logserver"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1697616498672
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We could make this an unsupported feature as there are several strangenesses with 6.0."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1697618239962
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I can add it to the release notes if we all agree."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1697618283257
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Done - 6.2 RN is updated."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1697619293716
            }
        ]
    },
    {
        "key": "SA-23019",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Dotnet 8 has brought a lot of new build warnings for obsolete/deprecated stuff that we need to go through and fix."
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/AppDelegate.cs(88,88): warning CA1422: This call site is reachable on: 'iOS' 15.2 and later, 'maccatalyst' 15.2 and later. 'UILocalNotification.UserInfo' is obsoleted on: 'ios' 10.0 and later (Use 'UserNotifications.UNNotificationRequest' instead.), 'maccatalyst' 10.0 and later (Use 'UserNotifications.UNNotificationRequest' instead.). ("
                        },
                        {
                            "type": "text",
                            "text": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)"
                        },
                        {
                            "type": "text",
                            "text": " [/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/iOSClient.csproj::TargetFramework=net8.0-ios]"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "new ios api expects us to use a completion handler instead of calling OpenURL synchronously. Needs separate task to handle for all platforms in the future."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/AppDelegate.cs(50,59): warning CA1422: This call site is reachable on: 'iOS' 15.2 and later, 'maccatalyst' 15.2 and later. 'UIApplication.LaunchOptionsLocalNotificationKey.get' is obsoleted on: 'ios' 10.0 and later (Use 'UNUserNotificationCenterDelegate.DidReceiveNotificationResponse' instead.), 'maccatalyst' 10.0 and later (Use 'UNUserNotificationCenterDelegate.DidReceiveNotificationResponse' instead.). ("
                        },
                        {
                            "type": "text",
                            "text": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " [/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/iOSClient.csproj::TargetFramework=net8.0-ios]"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/ViewController.cs(94,6): warning CA1422: This call site is reachable on: 'iOS' 15.2 and later, 'maccatalyst' 15.2 and later. 'UIApplication.KeyWindow' is obsoleted on: 'ios' 13.0 and later (Should not be used for applications that support multiple scenes because it returns a key window across all connected scenes.), 'maccatalyst' 13.0 and later (Should not be used for applications that support multiple scenes because it returns a key window across all connected scenes.). ("
                        },
                        {
                            "type": "text",
                            "text": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " [/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/iOSClient.csproj::TargetFramework=net8.0-ios] (we only use one scene but still worth investigating)"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/ViewController.cs(141,49): warning CA1422: This call site is reachable on: 'iOS' 15.2 and later, 'maccatalyst' 15.2 and later. 'UIColor.GroupTableViewBackground' is obsoleted on: 'ios' 13.0 and later (Use 'SystemGroupedBackground' instead.), 'maccatalyst' 13.0 and later (Use 'SystemGroupedBackground' instead.). ("
                        },
                        {
                            "type": "text",
                            "text": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " [/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/iOSClient.csproj::TargetFramework=net8.0-ios]"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/ViewController.cs(357,8): warning CA1422: This call site is reachable on: 'iOS' 15.2 and later, 'maccatalyst' 15.2 and later. 'UIApplication.StatusBarStyle' is obsoleted on: 'ios' 9.0 and later (Use 'UIViewController.PreferredStatusBarStyle' instead.), 'maccatalyst' 9.0 and later (Use 'UIViewController.PreferredStatusBarStyle' instead.). ("
                        },
                        {
                            "type": "text",
                            "text": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " [/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/iOSClient.csproj::TargetFramework=net8.0-ios]"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "StatusBarStyle is obsolete but last time I tried going with the suggested changes it does not set the style properly for NavigationController "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/7547/files",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/7547/files"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/ViewController.cs(323,26): warning CA1422: This call site is reachable on: 'iOS' 15.2 and later, 'maccatalyst' 15.2 and later. 'UIApplication.StatusBarFrame' is obsoleted on: 'ios' 13.0 and later (Use the 'StatusBarManager' property of the window scene instead.), 'maccatalyst' 13.0 and later (Use the 'StatusBarManager' property of the window scene instead.). ("
                        },
                        {
                            "type": "text",
                            "text": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://learn.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca1422)"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " [/Users/manuel.moraga/Documents/stratus-client-shared/src/client/iOS/iOSClient/iOSClient.csproj::TargetFramework=net8.0-ios]"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "todo: also check log collection and token renewal"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1704725374385
            }
        ]
    },
    {
        "key": "SA-20807",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image.png){width=70%}"
                        }
                    ]
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Display message is basically \"return true\". So it should be ignored."
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Reason is typical reason."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "![](image1.png) Client gets "
                                        }
                                    ]
                                },
                                {
                                    "type": "codeBlock",
                                    "attrs": {},
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "{\n  \"method\": \"app-update\",\n  \"params\": {\n    \"apps\": {\n      \"simple_setup_ENT_HTTP\": {\n        \"remedies\": [\n          {\n            \"method\": \"DisplayMessage\",\n            \"params\": {\n              \"message\": \"message\",\n              \"actionIdentifier\": \"954925130\"\n            },\n            \"active\": false\n          },\n          {\n            \"method\": \"Reason\",\n            \"params\": {\n              \"message\": \"Please provide a reason.\",\n              \"claimSuffix\": \"reason\",\n              \"actionIdentifier\": \"-934964597\"\n            },\n            \"active\": false\n          }\n        ],\n        \"status\": \"Blocked\",\n        \"appData\": {\n          \"name\": \"http\",\n          \"description\": \"\",\n          \"url\": \""
                                        },
                                        {
                                            "type": "text",
                                            "text": "http://10.97.129.67\""
                                        },
                                        {
                                            "type": "text",
                                            "text": ","
                                        },
                                        {
                                            "type": "text",
                                            "text": "\n          \"colorCode\": 8\n        },\n        \"appDatas\": [\n          {\n            \"name\": \"http\",\n            \"description\": \"\",\n            \"url\": \""
                                        },
                                        {
                                            "type": "text",
                                            "text": "http://10.97.129.67\""
                                        },
                                        {
                                            "type": "text",
                                            "text": ","
                                        },
                                        {
                                            "type": "text",
                                            "text": "\n            \"colorCode\": 8\n          }\n        ],\n        \"displayName\": \"http\",\n        \"name\": \"http\"\n      }\n    }\n  },\n  \"jsonrpc\": \"2.0\"\n}"
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": " Status should not be "
                                        },
                                        {
                                            "type": "text",
                                            "text": "Blocked",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "text",
                                            "text": "."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "If I try to access the endpoint, I get access. So it's only a shortcut issue. Probably doesn't need to be fixed in 6.1."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "similar issue but this time there is no Display Message. It's two legit remedy methods "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "        \"remedies\": [\n          {\n            \"method\": \"PasswordAuthentication\",\n            \"params\": {\n              \"message\": \"Please provide your password.\",\n              \"claimSuffix\": \"pwd\",\n              \"actionIdentifier\": \"111500\"\n            },\n            \"active\": false\n          },\n          {\n            \"method\": \"Reason\",\n            \"params\": {\n              \"message\": \"Please provide a reason.\",\n              \"claimSuffix\": \"reason\",\n              \"actionIdentifier\": \"-934964597\"\n            },\n            \"active\": false\n          }\n        ],"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669994673831
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "moved to 6.1.1 but 6.2 is just as fine I guess."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1670514959170
            }
        ]
    },
    {
        "key": "SA-20148",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Here, the UI started crashing on build #31376 even though nothing has changed."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "https://got-teamcity.agi.appgate.com/viewType.html?buildTypeId=StratusClient",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://got-teamcity.agi.appgate.com/viewType.html?buildTypeId=StratusClient"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "Windows&branch",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "StratusClient=%3Cdefault%3E&tab=buildTypeStatusDiv"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Turned out, a library got bumped which depended on a new library that got ignored by electron packager because it has \"test\" in its name. "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/7940",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/7940"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "     \"node_modules/es-abstract\": {\n-      \"version\": \"1.20.2\",\n-      \"resolved\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://got-nexus01.agi.appgate.com:8443/repository/Npm/es-abstract/-/es-abstract-1.20.2.tgz\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n-      \"integrity\": \"sha512-XxXQuVNrySBNlEkTYJoDNFe5+s2yIOpzq80sUHEdPdQr0S5nTLz4ZPPPswNIpKseDDUS5yghX1gfLIHQZ1iNuQ==\",\n+      \"version\": \"1.20.3\",\n+      \"resolved\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://got-nexus01.agi.appgate.com:8443/repository/Npm/es-abstract/-/es-abstract-1.20.3.tgz\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n+      \"integrity\": \"sha512-AyrnaKVpMzljIdwjzrj+LxGmj8ik2LckwXacHqrJJ/jxz6dDDBcZ7I7nlHM0FvEW8MfbWJwOd+yT2XzYW49Frw==\","
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "this shouldn't have happened. When we have package-lock.json, we should always have the same output until the json changes."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "maybe because of "
                                },
                                {
                                    "type": "text",
                                    "text": "npm install",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " at the end? I always found this weird but sounds like it's needed. But perhaps changing it ti "
                                },
                                {
                                    "type": "text",
                                    "text": "npm ci",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " might fix it."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "\"copy-assets\": \"shx cp -r ./src/assets ./dist/assets && shx cp -r ./src/ui ./dist/ui && shx cp package.json ./dist/package.json && cd ./dist/ && npm install --unsafe-perm=true\","
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1663945917116
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yeah, it's that but there is no package-lock.json for electron project. Pretty tricky situation with workspaces."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1663947114136
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "it seems instead of doing npm install again, we can use the node"
                                },
                                {
                                    "type": "text",
                                    "text": "modules from the root and electron only picks what's necessary anyway.",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The problem is copying the folder as it takes too long because it has so many files there."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Thought of symlinking but we have windows :("
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1663948731005
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "windows has symlink but it didn't work as electron builder is trying to copy the whole folder, not the contents."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1664179661277
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "failed attempt here "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/7946",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/7946"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " (also other methods I tried are listed there)"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I'm out of ideas now, so leaving it up for grabs."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "One thing is to I guess move package-lock in the dist folder also but there is a single package-lock for the root folder, not for the electron. We can create one for electron but then we'd need to keep it up-to-date every time there is a bump. So I'm not a big fan of that."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1664192113886
            }
        ]
    },
    {
        "key": "SA-19794",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Description"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Running storybook locally shows js warning after latest updates "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Warning: ReactDOM.render is no longer supported in React 18. Use createRoot instead. Until you switch to the new API, your app will behave as if it's running React 17. Learn more: "
                        },
                        {
                            "type": "text",
                            "text": "https://reactjs.org/link/switch-to-createroot"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Location"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "http://localhost:8081/?path=/story/components-icon--icon",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "http://localhost:8081/?path=/story/components-icon--icon"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Definition of done"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "No more warnings"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This isn't exactly trivial. There's a lot of discussion around this, but it seems that Storybook is supposed to auto detect that we're on react 18 and use the root API, but that is not happening."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Here's a lengthy discussion, I think maybe we can just live with this for now until storybook 7.0 is out:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.com/storybookjs/storybook/issues/17831",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/storybookjs/storybook/issues/17831"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "aaron.case",
                "created": 1659715469235
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Will be fixed with SA-23530"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1717590930613
            }
        ]
    },
    {
        "key": "SA-20093",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Sep 16 03:08:15 fedora appgate-sdp[4042]: Info : Collecting logs.\nSep 16 03:08:16 fedora audit: BPF prog-id=149 op=LOAD\nSep 16 03:08:16 fedora audit: BPF prog-id=150 op=LOAD\nSep 16 03:08:16 fedora systemd[1]: Starting systemd-hostnamed.service - Hostname Service...\nSep 16 03:08:16 fedora systemd[1]: Started systemd-hostnamed.service - Hostname Service.\nSep 16 03:08:16 fedora audit[1]: SERVICE_START pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='unit=systemd-hostnamed comm=\"systemd\" exe=\"/usr/lib/systemd/systemd\" hostname=? addr=? terminal=? res=success'\nSep 16 03:08:18 fedora appgate.desktop[3966]: (node:3966) UnhandledPromiseRejectionWarning: Error: EXDEV: cross-device link not permitted, rename '/tmp/1f6a4d25-f35e-412f-957c-99910f41d8f0.zip' -> '/home/devops/appgate_logs-2022-09-16.zip'\nSep 16 03:08:18 fedora appgate.desktop[3966]:     at Object.renameSync (node:fs:980:3)\nSep 16 03:08:18 fedora appgate.desktop[3966]:     at /opt/appgate/resources/app.asar/app/App.js:229:20\nSep 16 03:08:18 fedora appgate.desktop[3966]: (node:3966) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see "
                        },
                        {
                            "type": "text",
                            "text": "https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode)"
                        },
                        {
                            "type": "text",
                            "text": "."
                        },
                        {
                            "type": "text",
                            "text": " (rejection id: 2)"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-20038",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I ran sdpctl over ssh, because I felt like it, and it seems that the configure command failed."
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": " ./sdpctl configure\n? Enter the url for the controller API (example "
                        },
                        {
                            "type": "text",
                            "text": "https://appgate.controller.com/admin)"
                        },
                        {
                            "type": "text",
                            "text": " "
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-164-2.devops:8443"
                        },
                        {
                            "type": "text",
                            "text": "\n1 error occurred:\n        * The name org.freedesktop.secrets was not provided by any .service files"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The thing is actually kinda working, the config file gets changed, but the exit code is 1, but I'm not sure what secrets is trying to secretize."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This should at most be a warning, not fail the command."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This should be fixed in "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate/sdpctl/pull/276",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate/sdpctl/pull/276"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "daniel.nilsson",
                "created": 1662718016161
            }
        ]
    },
    {
        "key": "SA-20778",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "After installing the client in multi-user mode, endpoint cannot be reached, regardless of if a single user is connected or multiple. We'll add more info here tomorrow with "
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "christoffer.karlsson",
                                "text": "@christoffer.karlsson",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": " after testing multi-user stuff on a non-server OS. Client logs attached "
                        },
                        {
                            "type": "text",
                            "text": "appgate_logs-2022-11-30.zip",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "appgate_logs-2022-11-30.zip"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": ". Server logs can be found at:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "soygul [] | 2022-11-30 08:58:57\n\tid:      f337cffa-baf5-4224-8bc2-b0c15ac524f0\n\tstate:    finished-execution\n\tappliance build from release-6.1[#31626] "
                        },
                        {
                            "type": "text",
                            "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=727819&buildTypeId=StratusImage_Build"
                        },
                        {
                            "type": "text",
                            "text": "\n\tscenario: lhr-simple_v4\n\tkeep on error: False\n\tnodes:\n\t\tcontroller\n\t\t\troles:   controller, logserver\n\t\t\tweb ui:  "
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-164-2.devops:8443"
                        },
                        {
                            "type": "text",
                            "text": "\n\t\t\tAPI specs:  "
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-164-2.devops:8443/api_specs.html"
                        },
                        {
                            "type": "text",
                            "text": "\n\t\t\tapi version: 18\n\t\t\tstatus:  Running\n\t\t\tip:      10.97.164.2\n\t\t\tnetwork: 10.97.164.0/26\n\t\t\thostname: envy-10-97-164-2.devops\n\t\t\tadmin username: admin\n\t\t\tadmin password: admin\n\t\tgateway\n\t\t\troles:   gateway\n\t\t\tstatus:  Running\n\t\t\tip:      10.97.164.3\n\t\t\tnetwork: 10.97.164.0/26\n\t\t\thostname: envy-10-97-164-3.devops\n\t\tendpoint\n\t\t\troles:   endpoint\n\t\t\thttps:   "
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-225-67.devops"
                        },
                        {
                            "type": "text",
                            "text": "\n\t\t\thttp:    "
                        },
                        {
                            "type": "text",
                            "text": "http://envy-10-97-225-67.devops"
                        },
                        {
                            "type": "text",
                            "text": "\n\t\t\tstatus:  Running\n\t\t\tip:      10.97.225.67\n\t\t\tnetwork: 10.97.225.64/26\n\t\t\thostname: envy-10-97-225-67.devops"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ping (ICMP) is not supported on multi-user mode."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669822783070
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "then we're done, http works on LHR (apparently it never worked on AWS). we just need a couple more screenshots. I'll add a note to the test description."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "teoman.soygul",
                "created": 1669828983568
            }
        ]
    },
    {
        "key": "SA-19301",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": " 23 15:10:20 appgate.example.com cz-configd[682]: INFO [ActionsRunner] Running action GetCloudDataAction(cloud_service=OpenStackCloudService(name='OpenStack', cloud_init_url='"
                        },
                        {
                            "type": "text",
                            "text": "http://169.254.169.254/openstack>"
                        },
                        {
                            "type": "text",
                            "text": "\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [GetCloudDataAction] We are running in the cloud: OpenStack\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [GetCloudDataAction] Verifying cloud instance...\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [GetCloudDataAction] Getting license type if available\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [GetCloudDataAction] No license type found\nMay 23 15:10:20 appgate.example.com cz-configd[682]: ERROR [ActionsRunner] Unhandled error while running action GetCloudDataAction(cloud_service=OpenStackCloudService(name='OpenStack', cloud_init_url='"
                        },
                        {
                            "type": "text",
                            "text": "http://16>"
                        },
                        {
                            "type": "text",
                            "text": "\n                                                     Traceback (most recent call last):\n                                                       File \"/usr/cz-configd/configd/action/actions_runner.py\", line 199, in run\n                                                         action_result = action()\n                                                       File \"/usr/cz-configd/configd/cloud/actions.py\", line 123, in __call__\n                                                         cloud_startup_script = self.cloud_service.get_startup_script(\n                                                       File \"/usr/cz-configd/configd/cloud/openstack.py\", line 97, in get_startup_script\n                                                         self._seed, self._rc_script = self._get_seed_or_rc_script(\n                                                       File \"/usr/cz-configd/configd/cloud/openstack.py\", line 50, in _get_seed_or_rc_script\n                                                         with (cdrom_path() / \"openstack/latest/user_data\").open(\"r\") as f:\n                                                       File \"/usr/lib/python3.8/pathlib.py\", line 1222, in open\n                                                         return io.open(self, mode, buffering, encoding, errors, newline,\n                                                       File \"/usr/lib/python3.8/pathlib.py\", line 1078, in _opener\n                                                         return self._accessor.open(self, flags, mode)\n                                                     FileNotFoundError: [Errno 2] No such file or directory: '/media/root/config-2/openstack/latest/user_data'\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [ActionsRunner] Running action FinishCloudServiceAction(cloud_service=OpenStackCloudService(name='OpenStack', cloud_init_url='"
                        },
                        {
                            "type": "text",
                            "text": "http://169.254.169.254/ope>"
                        },
                        {
                            "type": "text",
                            "text": "\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [FinishCloudServiceAction] Finishing cloud service\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [ActionsRunner] FinishCloudServiceAction done\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [change] Change 101048d4-0100-440d-bfe6-5a0d9bf76ff1 completed with result success after 39.157 seconds\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [transition] Received event NetworkStateChangedEvent(network_state=NetworkState(nic_ips={}))\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [transition] Staying in state cloud_initializing\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [transition] Received event NetworkStateChangedEvent(network_state=NetworkState(nic_ips={'eth0': ['10.0.0.23']}))\nMay 23 15:10:20 appgate.example.com cz-configd[682]: INFO [transition] Staying in state cloud_initializing\nMay 23 15:10:31 appgate.example.com cz-configd[682]: WARNING [status] System status changed from busy to error"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": " If the user"
                        },
                        {
                            "type": "text",
                            "text": "data is empty, the file doesn't even exist on the configdrive and the provisioning server will give a 404. This makes the appliance get stuck in cloud",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "initializing."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Workaround: entering an empty script in the userdata makes the appliance end up in waiting"
                        },
                        {
                            "type": "text",
                            "text": "config as expected.",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Obsoleted by "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-youtrack.agi.appgate.com/issue/SA-19115/OpenStack-Cannot-seed-with-json-file-or-cz-setup",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-youtrack.agi.appgate.com/issue/SA-19115/OpenStack-Cannot-seed-with-json-file-or-cz-setup"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1686228436109
            }
        ]
    },
    {
        "key": "SA-19464",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Every time aitorbot build run is executed, it has first to download the build dependencies for the project in question."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "What happens is that the teamcity requirements are downloaded, a local apt repository is created, and then apt update runs to index the local repository and the regular (mirrored) ubuntu repository."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "All the .deb files (from teamcity and from the ubuntu mirror) are cached locally by aitorbot, so that a second build of the same project will not have to download any dependency."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "However apt update sees it as a first run, so it has to download the full index from the mirror every time, as seen here:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Get:6 "
                        },
                        {
                            "type": "text",
                            "text": "http://apt.devops"
                        },
                        {
                            "type": "text",
                            "text": " focal.master/main amd64 Packages [12.8 MB]\nFetched 12.8 MB in 10s (1254 kB/s) "
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The index is not small and is a bottleneck for speed of local builds."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This task is about investigating and implementing a way to cache the index inside the docker container, by using aitorbot cache mechanism, so that if running 2 builds one after the other there would be no need to redownload that file."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Of course it must invalidate properly so it must not use the same cache for different apt snapshots and it must notice when the mirror has a new one."
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-20849",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[14:30:25]W:\t [Step 1/1]   error: invalid command 'bdist_wheel'\n[14:30:25]W:\t [Step 1/1]   ----------------------------------------\n[14:30:25]W:\t [Step 1/1]   ERROR: Failed building wheel for appium-python-client\n[14:30:25] :\t [Step 1/1]   Building wheel for appium-python-client (setup.py): finished with status 'error'\n[14:30:25] :\t [Step 1/1]   Running setup.py clean for appium-python-client\n[14:30:25] :\t [Step 1/1]   Building wheel for dbus-python (PEP 517): started\n[14:30:25] :\t [Step 1/1]   Building wheel for dbus-python (PEP 517): finished with status 'done'\n[14:30:25] :\t [Step 1/1]   Created wheel for dbus-python: filename=dbus_python-1.3.2-cp38-cp38-linux_x86_64.whl size=436863 sha256=c1f4c6a10628b3cc3d9e57020a7c26cd45ee7fcf40c4b3857626e168410781b0\n[14:30:25] :\t [Step 1/1]   Stored in directory: /home/devops/buildAgent/temp/buildTmp/pip-ephem-wheel-cache-w9sw9orx/wheels/a5/2c/9a/f67f8ac469efc4e0c3755e3110835f8d88990893e7541eb71b\n[14:30:25] :\t [Step 1/1]   Building wheel for onetimepass (setup.py): started\n[14:30:25]W:\t [Step 1/1]   ERROR: Command errored out with exit status 1:\n[14:30:25] :\t [Step 1/1]   Building wheel for onetimepass (setup.py): finished with status 'error'\n[14:30:25]W:\t [Step 1/1]    command: /tmp/virtualenv_84798607-9f0c-4ffb-a3f1-dc9616dde634/bin/python -u -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/home/devops/buildAgent/temp/buildTmp/pip-install-itxf0kdy/onetimepass/setup.py'\"'\"'; __file__='\"'\"'/home/devops/buildAgent/temp/buildTmp/pip-install-itxf0kdy/onetimepass/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' bdist_wheel -d /home/devops/buildAgent/temp/buildTmp/pip-wheel-emm_j_s1\n[14:30:25] :\t [Step 1/1]   Running setup.py clean for onetimepass\n[14:30:25]W:\t [Step 1/1]        cwd: /home/devops/buildAgent/temp/buildTmp/pip-install-itxf0kdy/onetimepass/\n[14:30:25]W:\t [Step 1/1]   Complete output (6 lines):\n[14:30:25]W:\t [Step 1/1]   usage: setup.py [global_opts] cmd1 [cmd1_opts] [cmd2 [cmd2_opts] ...]\n[14:30:25]W:\t [Step 1/1]      or: setup.py --help [cmd1 cmd2 ...]\n[14:30:25]W:\t [Step 1/1]      or: setup.py --help-commands\n[14:30:25]W:\t [Step 1/1]      or: setup.py cmd --help"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As a result of this command: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "\u00a0\u00a0Running: /tmp/virtualenv_bf03cab0-767a-4574-ad78-5c3822e0f9fe/bin/python -m pip install --index "
                                },
                                {
                                    "type": "text",
                                    "text": "https://lhr-nexus01.agi.appgate.com:8443/repository/pypi/simple"
                                },
                                {
                                    "type": "text",
                                    "text": " --prefer-binary --no-cache-dir -r requirements.txt"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1670424064875
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "For example "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/buildConfiguration/QaBuildConfigurations",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-teamcity.agi.appgate.com/buildConfiguration/QaBuildConfigurations"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "EndToEnd",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "E2eTestyLinuxRunner2/730925?buildTab=log&focusLine=127&logView=flowAware&expandAll=true"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1670424086827
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/aitorbot/pull/1356",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/aitorbot/pull/1356"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1670493596579
            }
        ]
    },
    {
        "key": "SA-23787",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,302375Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283): Fatal : Uncaught exception! Java.Lang.RuntimeException: Unable to create service crc640b86a835ec56858f.VpnService: java.lang.SecurityException: com.cryptzone.appgate.xdp: One of RECEIVER_EXPORTED or RECEIVER_NOT_EXPORTED should be specified when a receiver isn't being registered exclusively for system broadcasts\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,302671Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283):  ---> Java.Lang.SecurityException: com.cryptzone.appgate.xdp: One of RECEIVER_EXPORTED or RECEIVER_NOT_EXPORTED should be specified when a receiver isn't being registered exclusively for system broadcasts\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,302965Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283):  ---> Java.Lang.Exception: Remote stack trace:\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,303237Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283): \tat com.android.server.am.ActivityManagerService.registerReceiverWithFeature(ActivityManagerService.java:16580)\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,303554Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283): \tat android.app.IActivityManager$Stub.onTransact$registerReceiverWithFeature$(IActivityManager.java:11530)\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,303782Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283): \tat android.app.IActivityManager$Stub.onTransact(IActivityManager.java:2928)\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,304042Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283): \tat com.android.server.am.ActivityManagerService.onTransact(ActivityManagerService.java:3195)\n[13:02:07] :\t [Step 2/2]  [0m [35m    2024-05-17T11:02:07,304283Z [STREAM] [onboarding/onboarding_2Factor_auth] [client-service/stdout] 05-17 13:02:07.488950 E/Appgate (30283): \tat android.os.Binder.execTransactInternal(Binder.java:1375)"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This somehow doesn't cause any issues on 6.3.1 however. Only on 6.4.0. But it's a good thing to add early on."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1715954778933
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://developer.android.com/about/versions/14/changes/fgs-types-required#system-exempted"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1716203854702
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "blockquote",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Reserved for system applications and specific system integrations, to continue to use foreground services. >"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "blockquote",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "To use this type, an app must meet at least one of the following criteria: VPN apps (configured using Settings \\> Network & Internet \\> VPN)"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "worth a try to see if we can get the exemption?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1716205685432
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think so."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1716206392640
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Moving this to 6.4 as the change is quite big and does not look necessary for 6.3 (yet)."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1716472619992
            }
        ]
    },
    {
        "key": "SA-21909",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "There are a ton of very popular (10K+ stars on github) libraries to parse html/pdf/etc. There are also generic libraries with plugins for each type like this: "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/antlr",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/antlr"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " Obviously there are AI models for the same purpose. Maybe even GPT itself can do it!"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "We need to extract the minimal viable group of text (i.e. paragraphs) and push the plain text and metadata like below:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "pub_docs_collection.add(\n    documents = [ { \"text body\" } ],\n    metadatas = [\n        {\n            \"source\": \"Appgate Admin Manual\",\n            \"version\": \"6.2-alpha\",\n            \"section\": \"Appliance Installation\",\n            \"subsection-1\": \"Physical\",\n            \"subsection-2\": \"\",\n            \"paragraph\": 1,\n            \"url\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://sdphelp.appgate.com/adminguide/v6.2alpha/appliance-installation.html#physical\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n        },"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The when we query the DB using a question like: "
                        },
                        {
                            "type": "text",
                            "text": "Is the client backwards compatible with older versions of Appgate?",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": ", we'll get the top "
                        },
                        {
                            "type": "text",
                            "text": "n",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " documents (plaintext body + metadata + vector distances) with closes vectors to our question like:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "python3 ./app/chroma.py \nUsing embedded DuckDB without persistence: data will be transient\nNo embedding_function provided, using default embedding function: SentenceTransformerEmbeddingFunction\n{   'distances': [[0.7053964734077454]],\n    'documents': [   [   'Client Installation\\n'\n                         '\\n'\n                         'Deployment \\n'\n                         'It is possible to automate this initial deployment '\n                         'process. If you want to script/automate the '\n                         'distribution of the Client when a new version '\n                         'appears, then Appgate always posts the latest '\n                         'versions here with a static URL.\\n'\n                         '\\n'\n                         'There are details covering all the different '\n                         'operating systems in the Client deployment and '\n                         'management chapter.\\n'\n                         '\\n'\n                         'We maintain backwards compatibility so the last two '\n                         'versions of the Client should still work with the '\n                         'latest version of Appgate SDP.']],\n    'embeddings': None,\n    'ids': [['id4_client_installation_deployment']],\n    'metadatas': [   [   {   'paragraph': 2,\n                             'section': 'Client Installation',\n                             'source': 'Appgate Admin Manual',\n                             'subsection-1': 'Deployment',\n                             'subsection-2': '',\n                             'url': '"
                        },
                        {
                            "type": "text",
                            "text": "https://sdphelp.appgate.com/adminguide/v6.2alpha/installing-clients.html#deployment'"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n                             'version': '6.2-alpha'}]]}"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "You might want to merge this before modifying the scraping/parsing scripts: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/manuel/pull/10",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/manuel/pull/10"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " I had to do a lot of changes/fixes to make them runnable both during Docker Image creation and on the dev's machine."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "teoman.soygul",
                "created": 1684881139123
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "LangChain has a good bunch of AI based approaches for it: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://python.langchain.com/en/latest/modules/indexes/text",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://python.langchain.com/en/latest/modules/indexes/text"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "splitters.html They also have a ton of document loads: ",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "https://python.langchain.com/en/latest/modules/indexes/document",
                                    "marks": [
                                        {
                                            "type": "em"
                                        },
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://python.langchain.com/en/latest/modules/indexes/document"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "loaders.html"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "teoman.soygul",
                "created": 1684920545706
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Also I found out about "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/Unstructured-IO/unstructured",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/Unstructured-IO/unstructured"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " which has parsers for lots of formats. They have a great demo here: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/Unstructured-IO/pipeline-sec-filings",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/Unstructured-IO/pipeline-sec-filings"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "teoman.soygul",
                "created": 1685350261322
            }
        ]
    },
    {
        "key": "SA-22835",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The portal tests works with v6.2 appliance/controller builds but not with v6.3 builds. We tested this against both 6.3/6.2 clients and results are the same. On 6.3, we get following error: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "2023-12-01T07:49:29,786223Z [INFO] [tools/setup_portal] Appliance is still busy processing a change: {'description': 'Downloading external pkcs12 bundles', 'details': 'Downloading external pkcs12 bundles', 'end_time': None, 'event': \"RemoteConfigCommittedEvent(change_id='8aea5ee2-82a6-42a4-9852-ef534ba1a35c')\", 'id': '8aea5ee2-82a6-42a4-9852-ef534ba1a35c', 'immediate': False, 'result': None, 'start_time': {'date': '2023-12-01T07:49:08.715Z', 'monotonic': 84075.346167893}, 'status': 'running'}, sleeping 6 seconds before retrying"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": " It looks like this happened before to Natan: "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/appgate-sdp-int/stratus-tests/pull/2452#issuecomment-763749629",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/appgate-sdp-int/stratus-tests/pull/2452#issuecomment-763749629"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Below are our test runs with 6.3 (first two) and 6.2 (bottom two). Controller logs are full of errors on the failing tests, which I cannot comprehend:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "aitorbot test create --purpose portal --scenario lhr-portal_v4 --client-type none --log-level debug\nsoygul [] | 2023-12-01 08:53:39\n\tid:   82a11ca2-47f0-40f4-b0ed-5cd33f32e185\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1241133"
                        },
                        {
                            "type": "text",
                            "text": "\n\naitorbot test create --purpose portal --scenario lhr-portal_v4 --client-type none --log-level debug --client-branch release-6.2 --appliance-branch master     \nsoygul [] | 2023-12-01 11:22:54\n\tid:   0616694f-6b04-493f-9e93-b6ccdf2d122a\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1241209"
                        },
                        {
                            "type": "text",
                            "text": "\n\naitorbot test create --purpose portal --scenario lhr-portal_v4 --client-type none --log-level debug --client-branch release-6.2 --appliance-branch release-6.2\nsoygul [] | 2023-12-01 10:52:29\n\tid:   ba68668f-0fa7-419a-9115-005d2de4ab8f\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1241193"
                        },
                        {
                            "type": "text",
                            "text": "\n\naitorbot test create --purpose portal --scenario lhr-portal_v4 --client-type none --log-level debug --appliance-branch release-6.2 \nsoygul [] | 2023-12-01 10:52:49\n\tid:   ca2f601e-ccb2-4191-88e1-d7a22c2e73ac\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1241195"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "There were other portal issues like client not starting etc."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1702024599354
            }
        ]
    },
    {
        "key": "SA-23267",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Description"
                        }
                    ],
                    "attrs": {
                        "level": 1
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "When adding an invalid profile link we can break the controller"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "To reproduce:"
                        }
                    ],
                    "attrs": {
                        "level": 1
                    }
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Create new profile group"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Paste profile link in the list"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Remove one letter"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Save the form"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "See the error"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Controller logs"
                        }
                    ],
                    "attrs": {
                        "level": 1
                    }
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": " 14 09:53:34 envy-10-98-136-2.devops nginx_admin[2716]: 172.21.128.178 - - [14/Feb/2024:09:53:34 +0000] \"POST /admin/client-profiles HTTP/2.0\" 422 125 \""
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-98-136-2.devops>"
                        },
                        {
                            "type": "text",
                            "text": "\nFeb 14 09:53:34 envy-10-98-136-2.devops cz-controllerd[1846]: 172.21.128.178 - CN=3739393632304235a164363834663963,CN=admin,OU=local [14/Feb/2024:09:53:34 +0000] \"POST /admin/client-prof>\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]: ERROR[DefaultExceptionMapper] Unexpected exception\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]: java.lang.IllegalArgumentException: Last unit does not have enough valid bits\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at java.base/java.util.Base64$Decoder.decode0(Base64.java:872)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at java.base/java.util.Base64$Decoder.decode(Base64.java:570)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at java.base/java.util.Base64$Decoder.decode(Base64.java:593)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at com.appgate.controller.resources.ClientProfileResource.validateAppgateUrlConfig(ClientProfileResource.java:228)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at com.appgate.controller.resources.ClientProfileResource.validateAppgateUrlConfig(ClientProfileResource.java:216)   \nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at com.appgate.controller.resources.ClientProfileResource.validateEntity(ClientProfileResource.java:147)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at com.appgate.controller.resources.ClientProfileResource.validateEntity(ClientProfileResource.java:50)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at com.appgate.controller.resources.base.BaseEntityResource.save(BaseEntityResource.java:250)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at java.base/java.lang.reflect.Method.invoke(Method.java:580)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory.lambda$static$0(ResourceMethodI>\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodD>\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethod>\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$TypeOutInvoker.doDispatch(JavaRes>\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMeth>\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:478)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:400)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:81)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:256)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:248)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.internal.Errors$1.call(Errors.java:244)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:292)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:274)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.internal.Errors.process(Errors.java:244)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:265)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:235)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:684)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:394)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:346)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:358)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:311)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:205)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:764)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1665)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at io.dropwizard.servlets.ThreadNameFilter.doFilter(ThreadNameFilter.java:36)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.handle(AllowedMethodsFilter.java:46)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at io.dropwizard.jersey.filter.AllowedMethodsFilter.doFilter(AllowedMethodsFilter.java:40)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at com.appgate.controller.dropwizard.application.CacheControlFilter.doFilter(CacheControlFilter.java:20)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.websocket.servlet.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:170)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:202)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1635)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:527)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:221)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1381)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:176)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:484)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:174)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1303)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:129)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at io.dropwizard.metrics.jetty11.InstrumentedHandler.handle(InstrumentedHandler.java:313)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at io.dropwizard.jetty.RoutingHandler.handle(RoutingHandler.java:52)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:822)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at io.dropwizard.jetty.ZipExceptionHandlingGzipHandler.handle(ZipExceptionHandlingGzipHandler.java:26)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.RequestLogHandler.handle(RequestLogHandler.java:46)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.Server.handle(Server.java:563)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)      \nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)  \nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)   \nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)\nFeb 14 09:54:07 envy-10-98-136-2.devops cz-controllerd[1846]:         at java.base/java.lang.Thread.run(Thread.java:1583)"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-22444",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I've received an email that we should do this. It's basically rebranding of Renovate though they say they rewrote it."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Badly copied email."
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "You are receiving this one-time email because you once requested a license key for Renovate On-Premise - the self-hosted Renovate solution from Mend.io.\nWe wish to inform you that the name of Renovate On-Premise has been changed to Renovate Community Edition and accordingly has a new Docker image name that you need to migrate to.\nWhat's New?\nRenovate Community Edition is a clean rewrite of Renovate On-Premise with 100% backwards compatibility. In addition, it adds a set of administration APIs that provide real-time insights into the state of the server, plus the ability to trigger Renovate jobs. The new release also includes improved debug logging, plus a more reliable initialization sequence, which also enables all documented Renovate parameters. \nInstalling and Migrating to Renovate CE\nNow that Renovate CE is freely available and maintained actively by Mend.io, there are no planned updates to Renovate On-Premise. We encourage you to migrate to Renovate CE at your convenience.\nMigration: To migrate from Renovate On-Premise to Renovate CE, follow the migration instructions.\nNew Installation: To set up a fresh installation, follow the first-time setup instructions.\nResources and Support\nAll the resources for Renovate Community Edition can be found at the Mend GitHub site: "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/mend/renovate-ce-ee"
                        },
                        {
                            "type": "text",
                            "text": "\nIncludes:\n\u2022\tAll the official releases (Docker containers) for Renovate CE\n\u2022\tSetup instructions / documentation\n\u2022\tIssues list - a place to report any problems\nWant more?\nIf you need official support, or if your organization requires additional capacity, click ahead to learn about Renovate Enterprise Edition.\nWishing you all the best with your dependency management.\nHappy coding!"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "https://github.com/mend/renovate-ce-ee/releases/tag/6.0.0",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/mend/renovate-ce-ee/releases/tag/6.0.0"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "https://github.com/mend/renovate-ce-ee/releases/tag/mend-renovate-4.1.0",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/mend/renovate-ce-ee/releases/tag/mend-renovate-4.1.0"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I'm confused of these releases."
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-21168",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Description (What?) and Motivation (Why?)"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "  12   \u2502 [2023-02-06T04:10:15.872Z] Info : Entitlement token request to controller '"
                        },
                        {
                            "type": "text",
                            "text": "https://connect.mubadalacapital.ae/'"
                        },
                        {
                            "type": "text",
                            "text": " has been rejected. Claim\n       \u2502 s token will be updated.\n  13   \u2502 [2023-02-06T04:10:15.872Z] Info : 'VPN Driver': Closing connection - waiting for prerequisites (re-authenticate || VPN certificate || Su\n       \u2502 spend).\n  14   \u2502 [2023-02-06T04:10:15.988Z] Info : Retrieving claims token.\n  15   \u2502 [2023-02-06T04:10:16.012Z] Warn : Authentication to '"
                        },
                        {
                            "type": "text",
                            "text": "https://connect.mubadalacapital.ae/'"
                        },
                        {
                            "type": "text",
                            "text": " failed while renewing claims token. Prompting \n       \u2502 user to re-authenticate.\n  16   \u2502 [2023-02-06T04:10:16.135Z] Info : Posting token refresh request.\n  17   \u2502 [2023-02-06T04:10:16.176Z] Warn : OIDC request failed: An error occurred while sending the request.."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "\"An error occurred while sending the request\" isn't very helpful. It's coming from .NET APIs, so probably we need to dig deeper on the exception stack. Let's try to find something better to print there."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Relevant thread: "
                        },
                        {
                            "type": "text",
                            "text": "https://appgate.slack.com/archives/CU926BAP8/p1676016346369809",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://appgate.slack.com/archives/CU926BAP8/p1676016346369809"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Bonus:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2023-02-06T04:10:15.988Z] Info : Retrieving claims token.\n  15   \u2502 [2023-02-06T04:10:16.012Z] Warn : Authentication to '"
                        },
                        {
                            "type": "text",
                            "text": "https://connect.mubadalacapital.ae/'"
                        },
                        {
                            "type": "text",
                            "text": " failed while renewing claims token. Prompting \n       \u2502 user to re-authenticate."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This is also quite weird. It immediately tries to authenticate with something before using the refresh token. Does it still have the ID token in the cache?"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Definition of done"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "orderedList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Better logs."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-21447",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2023-03-15T08:36:41Z] Uploading upgrade image:\n \u2713 appgate-6.0.5-33042-release.img.zip: upload complete\n1 error occurred:\n\t* No response during upload Put \""
                        },
                        {
                            "type": "text",
                            "text": "https://35.246.176.90:8443/admin/files\""
                        },
                        {
                            "type": "text",
                            "text": ":"
                        },
                        {
                            "type": "text",
                            "text": " context deadline exceeded (Client.Timeout exceeded while awaiting headers)"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": " {{CODEBLOCK1}}"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-22437",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "We should disable that buffering like we do for peer, see: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "    # Peer file upload\n    location /peer/files {\n        if ($ssl_client_verify != SUCCESS) {\n            return 401;\n        }\n        proxy_set_header peer-cert-fingerprint $ssl_client_fingerprint;\n        proxy_set_header peer-cert-subject-dn $ssl_client_s_dn;\n        # Necessary for streaming of request body using chunked encoding\n        proxy_http_version 1.1;\n        proxy_buffering off;\n        proxy_request_buffering off;\n        client_max_body_size 0;\n        proxy_pass "
                        },
                        {
                            "type": "text",
                            "text": "http://127.0.0.1:9130/peer/files"
                        },
                        {
                            "type": "text",
                            "text": ";"
                        },
                        {
                            "type": "text",
                            "text": "\n    }"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image.png){width=70%}"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We also do something similar for customizations: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "    location /admin/appliance-customizations {\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_set_header Host $http_host;\n        proxy_pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/admin/appliance-customizations"
                                },
                                {
                                    "type": "text",
                                    "text": ";"
                                },
                                {
                                    "type": "text",
                                    "text": "\n        proxy_request_buffering off;\n        # Customizations have a hard limit of 100MB\n        client_max_body_size 101m;\n    }"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1695736337159
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So something like this: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "    location /admin/files {\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_set_header Host $http_host;\n        proxy_pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/admin/files"
                                },
                                {
                                    "type": "text",
                                    "text": ";"
                                },
                                {
                                    "type": "text",
                                    "text": "\n        proxy_request_buffering off;\n        client_max_body_size 5g;\n    }"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1695736394912
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I don't understand why the change is needed."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Ok i understand the size increase but not the url change"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1695878678747
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "There is no URL change,  that's a typo, editing it now :)."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1695884572592
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Uh I don't get it, we had this 5 years ago already: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "    location /admin/files {\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/admin/files"
                                },
                                {
                                    "type": "text",
                                    "text": ";"
                                },
                                {
                                    "type": "text",
                                    "text": "\n        proxy_request_buffering off;\n        client_max_body_size 2g;        \n    }    "
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1696857254278
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "and this what we currently have: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "    location /admin/files {{\n        proxy_set_header X-Forwarded-For $remote_addr;\n        proxy_set_header Host $http_host;\n        proxy_pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/admin/files"
                                },
                                {
                                    "type": "text",
                                    "text": ";"
                                },
                                {
                                    "type": "text",
                                    "text": "\n        proxy_request_buffering off;\n        client_max_body_size 2g;\n    }}"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1696857291490
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It could be due to sdpctl using chunked encoding: "
                                },
                                {
                                    "type": "text",
                                    "text": "http://nginx.org/en/docs/http/ngx",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://nginx.org/en/docs/http/ngx"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "http",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "proxy"
                                },
                                {
                                    "type": "text",
                                    "text": "module.html#proxy",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "http"
                                },
                                {
                                    "type": "text",
                                    "text": "version",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "blockquote",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": " When HTTP/1.1 chunked transfer encoding is used to send the original request body, the request body will be buffered regardless of the directive value unless HTTP/1.1 is enabled for proxying."
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1696857403470
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "There would be no need to use chunked for a thing of known size though."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1696857585864
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yeah which is why it only popped up now, that issue was probably not triggered when using the old upgrade script."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1696857884646
            }
        ]
    },
    {
        "key": "SA-22935",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Task description"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "See story for details. There seems to be some design description in there but not sure if it's final or not. So assigning a Design tag."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Location"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "New page."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Design"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "List: "
                        },
                        {
                            "type": "text",
                            "text": "https://www.figma.com/file/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?type=design&node-id=1343-35479&mode=design&t=mHbCNmeoZhkpZpvE-0",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://www.figma.com/file/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?type=design&node-id=1343-35479&mode=design&t=mHbCNmeoZhkpZpvE-0"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " Form: "
                        },
                        {
                            "type": "text",
                            "text": "https://www.figma.com/file/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?type=design&node-id=1343-35478&mode=design&t=mHbCNmeoZhkpZpvE-0",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://www.figma.com/file/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?type=design&node-id=1343-35478&mode=design&t=mHbCNmeoZhkpZpvE-0"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Definition of done"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Design is delivered and integrated with APIs."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The views for the Secrets List and Secrets Form are now in Figma here:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "View Secrets List in Figma",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://www.figma.com/file/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?type=design&node-id=1343%3A35479&mode=design&t=d4XQsmt6b96FssEs-1"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "View Secrets Form in Figma",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://www.figma.com/file/WRkvteyo1yAmpMV622HJC4/SDP-Admin-UI-%2F-Views?type=design&node-id=1343%3A35478&mode=design&t=d4XQsmt6b96FssEs-1"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.svensson",
                "created": 1704362341031
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Something to add potentially:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The secrets will be used with their names (unless we decide to use ID instead in which case that would add a different requirement) in the scripts. The format isn't finalized but it will look something like this:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "httpPost(\""
                                },
                                {
                                    "type": "text",
                                    "text": "https://some.server/login\""
                                },
                                {
                                    "type": "text",
                                    "text": ","
                                },
                                {
                                    "type": "text",
                                    "text": " { password: $SECRETS:server_password$ }}"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So going to a secret and changing the name might break some scripts and I think we may want to put some warning when that occurs."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1705078223399
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "After a discussion with Natan we have added the action to copy the reference to clipboard. Have changes made to the Figma files."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.svensson",
                "created": 1705328015348
            }
        ]
    },
    {
        "key": "SA-20327",
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Somewhere here: \u00a0"
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/configd/scripts/upgrade-installer-hook.py",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/configd/scripts/upgrade-installer-hook.py"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We need to add a hook. that if there is a logserver.. then we need to remove the kibana snapshot."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "More or less this needs to happen :"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": " curl -XDELETE "
                                },
                                {
                                    "type": "text",
                                    "text": "http://localhost:9300/_snapshot/backupRestoreKibana"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The reason for this, is that backup-restore uses the snapshot function of kibana."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Opensearch is not compatible with that.. so it will refuse to start if the content is there... So it needs to be removed before the upgrade is done"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1666013692051
            }
        ]
    },
    {
        "key": "SA-23252",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Our Android client refuses to connect to client after CA renewal. It consistently fails with:"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Connection failed. BadServerCertificate - [envy-10-98-129-2.devops - 0]: Client reported: bad certificate",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "For instance, in this "
                        },
                        {
                            "type": "text",
                            "text": "test",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://got-teamcity.agi.appgate.com/buildConfiguration/QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner/855132?buildTab=log&focusLine=3531&logView=flowAware&linesState=40"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " the client retries for a total of 5 mins and it fails every time."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "All of our nightlies have the same test failing, which apparently start at 20th of Jan but was masked by all other lhr/chrome issues we had:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "aitorbot test get -t nightly_android -d 5\naitorbot ['nightly_android'] | 2024-02-08 01:30:06\n\tid:   61874557-15dc-4b0f-9892-b6c27d153757\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1268233"
                        },
                        {
                            "type": "text",
                            "text": "\n\tpassed: 17/18\naitorbot ['nightly_android'] | 2024-02-10 01:30:06\n\tid:   76495717-0532-462d-bd56-f17f4707f0ae\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1268880"
                        },
                        {
                            "type": "text",
                            "text": "\n\tpassed: 17/18\naitorbot ['nightly_android'] | 2024-02-11 01:30:06\n\tid:   da5a3e53-1a33-4ecc-ac77-0a91d2eb8dc8\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1269269"
                        },
                        {
                            "type": "text",
                            "text": "\n\tpassed: 17/18\naitorbot ['nightly_android'] | 2024-02-12 01:30:06\n\tid:   6c80fe9e-79dd-4ed4-9ea7-a9442b4bd241\n\turl:  "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1269658"
                        },
                        {
                            "type": "text",
                            "text": "\n\tpassed: 17/18"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image.png)"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Weird. Works when I do this test manually. Here is a log from when it was working. Have not compared it to the failing ones yet."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1707748340478
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Were able to reproduce. Seems like this is working if the client is logged in during the renewal but fails if logged out."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1707837601184
            }
        ]
    },
    {
        "key": "SA-18985",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "A customer is saying this happens frequently to their always-on client. I don't have the details yet, but my guess is they share a local account and the local account briefly gets locked because of a mistake. Then when the reauthentication comes for the headless, it triggers this: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2022-04-12T12:22:26.215Z] Info : Token renewal for [4bd8d9fe-200c-46b6-bba0-3858b78cb556] is received by 'agaas-edgepoint-toronto-gw2'. Will update the token.\n[2022-04-12T12:22:26.222Z] Info : Token renewal for [8a53d571-013e-49d7-b463-e2d9b25560ba] is received by 'agaas-edgepoint-toronto-gw2'. Will update the token.\n[2022-04-12T12:22:26.231Z] Info : Token renewal for [4bd8d9fe-200c-46b6-bba0-3858b78cb556] is received by 'agaas-edgepoint-horner-gw1'. Will update the token.\n[2022-04-12T12:22:26.231Z] Info : Token renewal for [54355a79-e678-421a-b2f5-44021fd95216] is received by 'agaas-edgepoint-horner-gw1'. Will update the token.\n[2022-04-12T12:22:26.273Z] Info : Retrieving claims token.\n[2022-04-12T12:22:26.282Z] Info : Fetching on-boarding cookie for 'onboardingcookie-89:d4:f1:79:01:76:db:df:71:28:29:b2:24:7a:bd:a8:0f:02:63:89:30:81:44:57:df:e3:9f:9a:cf:4d:78:7c-local-EPcomputer-0DD3B900-9783-11E9-AB33-827C1F461D00' from secure storage.\n[2022-04-12T12:22:26.291Z] Info : On-boarding cookie available for 'onboardingcookie-89:d4:f1:79:01:76:db:df:71:28:29:b2:24:7a:bd:a8:0f:02:63:89:30:81:44:57:df:e3:9f:9a:cf:4d:78:7c-local-EPcomputer-0DD3B900-9783-11E9-AB33-827C1F461D00'.\n[2022-04-12T12:22:26.293Z] Info : Resolving hostname 'connect.edgepointwealth.com'\n[2022-04-12T12:22:26.293Z] Info : Resolved IPs: [52.176.90.252]\n[2022-04-12T12:22:26.294Z] Info : Trying to connect 'connect.edgepointwealth.com/52.176.90.252' with SPA key name 'Main_SPA_Key'.\n[2022-04-12T12:22:26.540Z] Info : Token renewal for [4bd8d9fe-200c-46b6-bba0-3858b78cb556] is received by 'agaas-edgepoint-barrie-gw1'. Will update the token.\n[2022-04-12T12:22:26.540Z] Info : Token renewal for [a1f67423-8d78-481b-a7a6-c0884a48d508] is received by 'agaas-edgepoint-barrie-gw1'. Will update the token.\n[2022-04-12T12:22:26.542Z] Info : Token renewal for [4bd8d9fe-200c-46b6-bba0-3858b78cb556] is received by 'agaas-edgepoint-apps-gw2'. Will update the token.\n[2022-04-12T12:22:26.543Z] Info : Token renewal for [70704fa6-f441-4082-b152-90f5931975e8] is received by 'agaas-edgepoint-apps-gw2'. Will update the token.\n[2022-04-12T12:22:26.601Z] Warn : Authentication to '"
                        },
                        {
                            "type": "text",
                            "text": "https://connect.edgepointwealth.com/'"
                        },
                        {
                            "type": "text",
                            "text": " failed while renewing claims token. Prompting user to re-authenticate.\n[2022-04-12T12:22:26.836Z] Info : Retrieving claims token.\n[2022-04-12T12:22:26.836Z] Info : Fetching on-boarding cookie for 'onboardingcookie-89:d4:f1:79:01:76:db:df:71:28:29:b2:24:7a:bd:a8:0f:02:63:89:30:81:44:57:df:e3:9f:9a:cf:4d:78:7c-local-EPcomputer-0DD3B900-9783-11E9-AB33-827C1F461D00' from secure storage.\n[2022-04-12T12:22:26.837Z] Info : On-boarding cookie available for 'onboardingcookie-89:d4:f1:79:01:76:db:df:71:28:29:b2:24:7a:bd:a8:0f:02:63:89:30:81:44:57:df:e3:9f:9a:cf:4d:78:7c-local-EPcomputer-0DD3B900-9783-11E9-AB33-827C1F461D00'.\n[2022-04-12T12:22:26.886Z] Warn : Authentication to '"
                        },
                        {
                            "type": "text",
                            "text": "https://connect.edgepointwealth.com/'"
                        },
                        {
                            "type": "text",
                            "text": " failed while renewing claims token. Prompting user to re-authenticate.\n[2022-04-12T12:22:26.992Z] Info : Disconnecting.\n[2022-04-12T12:22:26.992Z] Info : Removing VPN certificate.\n[2022-04-12T12:22:27.007Z] Info : Removing credentials.\n[2022-04-12T12:22:27.018Z] Info : Logging out from gateways and cleaning up.\n[2022-04-12T12:22:27.018Z] Info : Logout done.\n[2022-04-12T12:22:27.019Z] Info : 'VPN Driver': Closing connection.\n[2022-04-12T12:22:27.268Z] Info : User input required for 'ConnectCredentialsLoginHandler'.\n[2022-04-12T12:22:28.394Z] Info : User input required for 'ConnectCredentialsLoginHandler'.\n[2022-04-12T12:22:30.621Z] Info : User input required for 'ConnectCredentialsLoginHandler'."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": " the rest is a loop of \"ConnectCredentialsLoginHandler\". I guess we made a mistake where we passed the wrong parameter for signing out?"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "or now I'm thinking.. was this intentional?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1650986521532
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "didn't we have an issue where headless was DOSing controller with bad login attempts?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1651130605581
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/6763",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-client-shared/pull/6763"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " we did this but this was to handle the problem so to speak. I don't recall if we discussed the spamming case back then or not but doesn't matter. I suppose we can't assume the failure is always the password being incorrect. There is the user getting locked case which means it should work after a while. I think we need to be OK with the spamming (though it will eventually spam once every minutes since we have the backoff logic) given this scenario."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1651145595289
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "You're right. As you say probably something there changed and now creds get cleared."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1651145840794
            }
        ]
    },
    {
        "key": "SA-20202",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Sdpctl should give a notice when there running commands if there is a newer version available. The notice should include a link to the github pages landing page where the user can download the latest release."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The upgrade notice should be able to disable in the configuration if needed."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Example output:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": ">sdpctl appliance list\nNOTICE: A new version of sdpctl is available for download.\n"
                        },
                        {
                            "type": "text",
                            "text": "https://github.io/appgate/sdpctl"
                        },
                        {
                            "type": "text",
                            "text": "\n[...]"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
    "key": "SA-20628",
    "description": {
        "type": "doc",
        "content": [
        {
            "type": "bulletList",
            "content": [
            {
                "type": "listItem",
                "content": [
                {
                    "type": "paragraph",
                    "content": [
                    {
                        "type": "text",
                        "text": "Start client for the first time after installation (or you remove VPN profile)"
                    }
                    ]
                }
                ]
            },
            {
                "type": "listItem",
                "content": [
                {
                    "type": "paragraph",
                    "content": [
                    {
                        "type": "text",
                        "text": "login"
                    }
                    ]
                }
                ]
            },
            {
                "type": "listItem",
                "content": [
                {
                    "type": "paragraph",
                    "content": [
                    {
                        "type": "text",
                        "text": "move client to background (though I'm not even sure I did that)"
                    }
                    ]
                }
                ]
            },
            {
                "type": "listItem",
                "content": [
                {
                    "type": "paragraph",
                    "content": [
                    {
                        "type": "text",
                        "text": "come back"
                    }
                    ]
                }
                ]
            },
            {
                "type": "listItem",
                "content": [
                {
                    "type": "paragraph",
                    "content": [
                    {
                        "type": "text",
                        "text": "It's stuck at \"connecting\" state"
                    }
                    ]
                }
                ]
            }
            ]
        },
        {
            "type": "paragraph",
            "content": [
            {
                "type": "text",
                "text": "We managed this before; there is even a debug log like this"
            }
            ]
        },
        {
            "type": "blockquote",
            "content": [
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "[2022-11-16T10:51:14.034Z] Info : Android 10 or newer and application is in the background. Sending a notification for VPN activity."
                }
                ]
            }
            ]
        },
        {
            "type": "paragraph",
            "content": [
            {
                "type": "text",
                "text": "but I think it's not working."
            }
            ]
        }
        ],
        "version": 1
    },
    "comments": [
        {
        "body": {
            "type": "doc",
            "content": [
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "It works for me, but then again you need to accept the VPN dialog. Tried both on Android 11 device and Android 13 emulator. Tried this by ignoring VPN dialog and/or removing it first."
                }
                ]
            }
            ],
            "version": 1
        },
        "author": "manuel.moraga",
        "created": 1669018490841
        },
        {
        "body": {
            "type": "doc",
            "content": [
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "Can't reproduce even on our "
                },
                {
                    "type": "text",
                    "text": "Galaxy Tab A 10.1 (2019)",
                    "marks": [
                    {
                        "type": "code"
                    }
                    ]
                },
                {
                    "type": "text",
                    "text": " tablet"
                }
                ]
            }
            ],
            "version": 1
        },
        "author": "manuel.moraga",
        "created": 1669105750059
        }
    ]
    },
    {
        "key": "SA-20913",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Someone mentioned this exists: "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/MartinKuschnik/WmiLight/",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.com/MartinKuschnik/WmiLight/"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Current WMI depends on COM objects iirc and forcing us to use a worse trimming mode for .NET. Could be interesting to try this out.."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Currently it's failing with "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "WMI failed while retrieving device ID. Built-in COM has been disabled via a feature switch. See "
                                },
                                {
                                    "type": "text",
                                    "text": "https://aka.ms/dotnet-illink/com"
                                },
                                {
                                    "type": "text",
                                    "text": " for more information."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": " It seems to use COM. But it might be that trimming works better anyway. I'll try enabling COM again and see if it works. Otherwise, revert the whole thing."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1672157603473
            }
        ]
    },
    {
        "key": "SA-20897",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2022-12-12T21:40:24.639Z] Info : Starting package download to 'C:\\WINDOWS\\TEMP\\Appgate-SDP-6.1.0-Installer.exe' from '"
                        },
                        {
                            "type": "text",
                            "text": "https://bin.appgate-sdp.com/6.0/client/Appgate-SDP-6.1.0-Installer.exe'"
                        },
                        {
                            "type": "text",
                            "text": "."
                        },
                        {
                            "type": "text",
                            "text": "\n[2022-12-12T21:40:24.640Z] Info : Checking next CA certificate.\n[2022-12-12T21:40:24.645Z] Info : Same update file exists. Backing it up in case the new download fails.\n[2022-12-12T21:40:24.650Z] Error : Error during file download. System.IO.IOException: Cannot create a file when that file already exists.\n   at System.IO.FileSystem.MoveFile(String sourceFullPath, String destFullPath, Boolean overwrite)\n   at System.IO.File.Move(String sourceFileName, String destFileName, Boolean overwrite)\n   at Shared.Client.Logic.Components.AutoUpdate.FileDownloader.DownloadFileAsync(String url, String filePath)\n[2022-12-12T21:40:24.662Z] Error : Client update download error: $"
                        },
                        {
                            "type": "text",
                            "text": "https://bin.appgate-sdp.com/6.0/client/Appgate-SDP-6.1.0-Installer.exe"
                        },
                        {
                            "type": "text",
                            "text": " , $Cannot create a file when that file already exists."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "manuel.moraga",
                                        "text": "@manuel.moraga",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " - is this 6.1 or 6.1.1?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1671184882767
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Assuming 6.1.1."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1671187731226
            }
        ]
    },
    {
        "key": "SA-20523",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Even if that appliance is filtered out."
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "thomas@thomas-xps13:~/Downloads$ sdpctl appliance upgrade prepare --include 'name=purple8*' --image appgate-6.1.0-31190-master.img.zip \nsdpctl_version: dev\ncommit: \nbuild date: \n\n1 error occurred:\n\t* Malformed version: unknown"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Appliance status: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "thomas@thomas-xps13:~/Downloads$ sdpctl appliance status\nName                                                          Status     Function                             CPU     Memory    Network out/in           Disk     Version\n----                                                          ------     --------                             ---     ------    --------------           ----     -------\naws - purple10                                                offline                                         0%      0%         /                       0%       unknown\nlhr - purple51                                                healthy    Connector                            0.1%    4.1%      0.16 Kbps / 27.7 Kbps    54%      6.1.0-master+31162\npurple-internet - Autoscaling Instance i-0ac11e060395b2626    healthy    Gateway                              0.3%    17.5%     0.93 Kbps / 0.62 Kbps    11.8%    6.1.0-master+31123\naws - purple12                                                healthy    LogForwarder, Gateway                0.3%    26.6%     15.3 Kbps / 16.6 Kbps    61.4%    6.1.0-master+31179\naws - purple60                                                healthy    Gateway                              0.2%    38.5%     9.97 Kbps / 4.07 Kbps    60.5%    6.1.0-master+31179\nazure - purple20                                              healthy    Gateway                              0.7%    8.7%      0.2 Kbps / 0.16 Kbps     25.3%    6.1.0-master+31179\naws - purple71                                                healthy                                         0%      3.3%      0.32 Kbps / 0.18 Kbps    31.7%    6.1.0-master+31179\nazure - purple21                                              healthy    Gateway                              1.3%    25.2%     10.1 Kbps / 6.1 Kbps     55%      6.1.0-master+31179\naws - purple40                                                healthy    Controller, Gateway                  0.8%    30.3%     0.14 Mbps / 11.7 Kbps    24.1%    6.1.0-master+31179\naws - purple70                                                healthy    Connector                            0.3%    10.5%     1.37 Kbps / 0.73 Kbps    53.7%    6.1.0-master+31162\nlhr - purple80                                                healthy    Gateway                              0.5%    15.1%     0.36 Kbps / 0.48 Kbps    25.2%    6.1.0-master+31162\ngot - purple1                                                 healthy    Gateway                              0.6%    21.4%     64.8 Kbps / 5.86 Kbps    48.5%    6.1.0-master+31162\ngcp - purple90                                                healthy    Connector                            0.7%    11.6%     4.86 Mbps / 4.69 Mbps    54.6%    6.1.0-master+31162\nlhr - purple50                                                healthy    Connector                            0.3%    5%        0.54 Kbps / 22.1 Kbps    53.5%    6.1.0-master+31162\ngcp - purple31                                                healthy    Gateway                              2%      26.8%     10.1 Kbps / 9.67 Kbps    61.3%    6.1.0-master+31179\nPortal Access                                                 healthy                                         1.4%    24.6%     25.5 Kbps / 10.5 Kbps    1.2%     6.1.0-master+31179\ngot - purple5                                                 healthy    Gateway                              1.3%    8.3%      43.2 bps / 0.22 Kbps     30.2%    6.1.0-master+31179\ngot - purple6                                                 healthy    Gateway                              1.3%    8.5%      0.2 Kbps / 0.47 Kbps     26.7%    6.1.0-master+31179\ngot - purple3                                                 healthy    Connector                            0.5%    5.8%      15.3 Kbps / 1.21 Kbps    51.6%    6.1.0-master+31162\npurple-internet - Autoscaling Instance i-00f950c2f406c04da    healthy    Gateway                              0.2%    17.1%     7.53 Kbps / 6.8 Kbps     12.7%    6.1.0-master+31123\ngot - purple2                                                 healthy    Gateway                              1.3%    19.7%     78.4 Kbps / 22.0 Kbps    47.2%    6.1.0-master+31162\nlhr - purple81                                                healthy    Gateway                              0.3%    22%       30.2 Mbps / 30.9 Mbps    24.8%    6.1.0-master+31162\naws - purple11                                                healthy    LogForwarder, Controller, Gateway    2.3%    31.6%     0.21 Mbps / 0.12 Mbps    27.2%    6.1.0-master+31179"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "related to filter, regex can panic the whole program"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "sdpctl appliance upgrade prepare --include 'name=*' --image "
                                },
                                {
                                    "type": "text",
                                    "text": "https://appgate-appliance-upgrade-images.s3.eu-central-1.amazonaws.com/appgate-6.1.0-31190-master.img.zip"
                                },
                                {
                                    "type": "text",
                                    "text": "          \nsdpctl_version: dev\ncommit: \nbuild date: \n\npanic: regexp: Compile(`*`): error parsing regexp: missing argument to repetition operator: `*`\n\ngoroutine 1 [running]:\nregexp.MustCompile({0xc000300805, 0x1})\n\t/usr/lib/go/src/regexp/regexp.go:319 +0xbb\ngithub.com/appgate/sdpctl/pkg/appliance.applyApplianceFilter({0xc0000c7800?, 0x6, 0xcf719c?}, 0x7?)\n\t/home/dln/dev/sdpctl/pkg/appliance/functions.go:470 +0x1594\ngithub.com/appgate/sdpctl/pkg/appliance.FilterAppliances({0xc0000c6c00?, 0x6, 0xc0002769c0?}, 0x14?)\n\t/home/dln/dev/sdpctl/pkg/appliance/functions.go:427 +0xe5\ngithub.com/appgate/sdpctl/cmd/appliance/upgrade.prepareRun(0xc00002c1e8?, {0x17?, 0x0?, 0x0?}, 0xc00011f800)\n\t/home/dln/dev/sdpctl/cmd/appliance/upgrade/prepare.go:220 +0x3af\ngithub.com/appgate/sdpctl/cmd/appliance/upgrade.NewPrepareUpgradeCmd.func2(0xc000231200?, {0xc00014dd80, 0x0, 0x4})\n\t/home/dln/dev/sdpctl/cmd/appliance/upgrade/prepare.go:155 +0xba\ngithub.com/spf13/cobra.(*Command).execute(0xc000231200, {0xc00014dd40, 0x4, 0x4})\n\t/home/dln/go/pkg/mod/github.com/spf13/cobra@v1.6.1/command.go:916 +0x862\ngithub.com/spf13/cobra.(*Command).ExecuteC(0xc000230000)\n\t/home/dln/go/pkg/mod/github.com/spf13/cobra@v1.6.1/command.go:1044 +0x3bd\ngithub.com/appgate/sdpctl/cmd.Execute()\n\t/home/dln/dev/sdpctl/cmd/root.go:194 +0x12b\nmain.main()\n\t/home/dln/dev/sdpctl/main.go:10 +0x19"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "daniel.nilsson",
                "created": 1667825217706
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As i see it, we can solve this 2 ways,"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "either we replace the filter regex with glob pattern"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "or update the error messages and UX around the regex usage"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "What do you guys think? "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "lars.kajes",
                                        "text": "@lars.kajes",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "thomas.cellerier",
                                        "text": "@thomas.cellerier",
                                        "accessLevel": ""
                                    }
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "daniel.nilsson",
                "created": 1667829169552
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "IMHO update the error message and catch error if regex is invalid like the above example"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "lars.kajes",
                "created": 1667830430464
            }
        ]
    },
    {
        "key": "SA-21785",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Apr 28 08:22:56 envy-10-97-164-2.devops cz-configd[8341]: INFO [upgrade post-prepare hook] Downloading container image bundle logserver-6.2.0-33704.zip from controller envy-10-97-164-2.devops\nApr 28 08:22:56 envy-10-97-164-2.devops cz-configd[8341]: INFO [upgrade post-prepare hook] Trying next controller to download container image bundle: 404, message='Not Found', url=URL('"
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-164-2.devops:443/peer/files/logserver-6.2.0-33704.zip')"
                        },
                        {
                            "type": "text",
                            "text": "\nApr 28 08:22:56 envy-10-97-164-2.devops cz-configd[8341]: INFO [upgrade post-prepare hook] Could not download container image bundle logserver-6.2.0-33704.zip"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "From this command: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "$ SDPCTL_DOCKER_TAG=latest aitorbot env upgrade --appliance-branch helvetest-d8c71989-0638-47fc-9979-5c95965c3dd7 --yes --ignore-target-version\nFound appliance image url "
                        },
                        {
                            "type": "text",
                            "text": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage_Build/helvetest-d8c71989-0638-47fc-9979-5c95965c3dd7/artifact/appgate-6.2.0-33704.img.zip?is-build-type-id=true"
                        },
                        {
                            "type": "text",
                            "text": "\nUpgrading environment 5f038ff3-ad71-41ca-a632-7caff544eac2\nDownloading ca cert from controller...\n/home/thomas/.local/lib/python3.10/site-packages/urllib3/connectionpool.py:1045: InsecureRequestWarning: Unverified HTTPS request is being made to host 'envy-10-97-164-2.devops'. Adding certificate verification is strongly advised. See: "
                        },
                        {
                            "type": "text",
                            "text": "https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings"
                        },
                        {
                            "type": "text",
                            "text": "\n  warnings.warn(\nDownloading latest sdpctl from teamcity ...\nsdpctl_version: 2023.04.28\ncommit: f7a2aedfc20974fe9e647432c9548373365ead8e\nbuild date: 2023-04-28T07:36:46Z\n\n\nPREPARE SUMMARY\n\n1. Bundle and upload LogServer docker image\n2. Upload upgrade image appgate-6.2.0-33704.img.zip to Controller\n3. Prepare upgrade on the following appliances:\n\n  Appliance                                                Online    Current version    Prepare version\n  ---------                                                ------    ---------------    ---------------\n  controller-5f038ff3-ad71-41ca-a632-7caff544eac2-site1    \u2713         6.2.0+33704        6.2.0+33704\n  gateway-5f038ff3-ad71-41ca-a632-7caff544eac2-site1       \u2713         6.2.0+33704        6.2.0+33704\n\n\n[2023-04-28T10:21:05+02:00] Preparing image layers for LogServer:\n \u2713 uploading logserver-6.2.0-33704-release.zip: uploaded\n\n[2023-04-28T10:22:07+02:00] Preparing image on appliances:\n \u2a2f controller-5f038ff3-ad71-41ca-a632-7caff544eac2-site1: failed - Upgrade post-prepare hook failed with exit code 1\n \u2713 gateway-5f038ff3-ad71-41ca-a632-7caff544eac2-site1: ready\n1 error occurred:\n\t* prepare failed on controller-5f038ff3-ad71-41ca-a632-7caff544eac2-site1 failed Upgrade post-prepare hook failed with exit code 1:\nFailed to prepare logserver container image bundle. public.ecr.aws/appgate-sdp:443 is not reachable\n\n\n\u00a1Y un jam\u00f3n! Upgrade failed"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Those omit in the branch name in the image metadata."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1682677308103
            }
        ]
    },
    {
        "key": "SA-21948",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "We could do better now with dbd."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Example from a reboot: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "May 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1539]: [7-1] 2023-05-12 11:59:04.666 GMT   FATAL:  terminating connection due to administrator command\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [9-1] 2023-05-12 11:59:04.668 GMT   LOG:  received smart shutdown request\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [10-1] 2023-05-12 11:59:04.668 GMT   LOG:  could not open file \"postmaster.pid\": No such file or directory\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[3168]: [18-1] 2023-05-12 11:59:04.668 GMT postgres controller FATAL:  terminating connection due to administrator command\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [11-1] 2023-05-12 11:59:04.668 GMT   LOG:  background worker \"pglogical supervisor\" (PID 29) exited with exit code 1\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [12-1] 2023-05-12 11:59:04.668 GMT   LOG:  background worker \"logical replication launcher\" (PID 30) exited with exit code 1\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [13-1] 2023-05-12 11:59:04.668 GMT   LOG:  background worker \"pglogical bdr autopart 907348519 16384:0\" (PID 120) exited with exit code 1\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[3167]: [10-1] 2023-05-12 11:59:04.668 GMT postgres controller FATAL:  terminating connection due to administrator command\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [14-1] 2023-05-12 11:59:04.671 GMT   LOG:  background worker \"pglogical manager 16384\" (PID 118) exited with exit code 1\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1532]: [15-1] 2023-05-12 11:59:04.673 GMT   LOG:  background worker \"pglogical bdr consensus 907348519 16384:0\" (PID 119) exited with exit code 1\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1534]: [6-1] 2023-05-12 11:59:04.673 GMT   LOG:  shutting down\nMay 12 11:59:04 envy-10-97-130-2.devops postgresql@current[1534]: [7-1] 2023-05-12 11:59:04.673 GMT   PANIC:  could not open file \"/run/postgresql/global/pg_control\": No such file or directory\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: Created slice system-systemd\\x2dcoredump.slice.\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: Started Process Core Dump (PID 6633/UID 0).\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: cz-dbd@current.service: Succeeded.\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: Stopped Appliance Database Orchestration Daemon.\nMay 12 11:59:04 envy-10-97-130-2.devops systemd-coredump[6634]: Process 1534 (postgres) of user 111 dumped core.\n                                                                \n                                                                Stack trace of thread 24:\n                                                                #0  0x00007f749f10800b n/a (n/a + 0x0)\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: systemd-coredump@0-6633-0.service: Succeeded.\nMay 12 11:59:04 envy-10-97-130-2.devops cz-configd[760]: INFO [jsonrpcapp] internal 4 \"get_change\" success 0\nMay 12 11:59:04 envy-10-97-130-2.devops cz-configd[760]: INFO [service] cz-logd stop (reason: base system, service is disabled)\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: Stopping Appliance Logd, application for reliable logging...\nMay 12 11:59:04 envy-10-97-130-2.devops rsyslogd[1720]: imrelp[20514]: error 'server closed relp session, session broken', object  'lstn 20514: conn to clt 127.0.0.1/localhost' - input may not work as intended [v8.2001.0 try "
                        },
                        {
                            "type": "text",
                            "text": "https://www.rsyslog.com/e/2353"
                        },
                        {
                            "type": "text",
                            "text": " ]\nMay 12 11:59:04 envy-10-97-130-2.devops systemd[1]: cz-logd.service: Succeeded."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "FYI "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "masaya.ando",
                                        "text": "@masaya.ando",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "salvatore.tomaselli",
                                        "text": "@salvatore.tomaselli",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " we might want to fix this in 6.3 while we are doing other Postgres/BDR things."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1683893300875
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "How to reproduce this?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1700660700038
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think wiping the controller should do, or removing the controller function from a controller. Basically hitting a code path where we remove the config files first and stop postgres after."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1701678791939
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I didn't manage to get that error by wiping a controller or removing one."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1701691863130
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Maybe it doesn't happen anymore with postgres 14."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1701695381108
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Should it be for 6.2? Or just wontfix"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1701698009780
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Won't fix if you can't reproduce it in master as I don't think it caused any actual issues besides worried customers."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1701698208286
            }
        ]
    },
    {
    "key": "SA-20262",
    "description": {
        "type": "doc",
        "content": [
            {
            "type": "paragraph",
            "content": [
                {
                "type": "text",
                "text": "https://appgate.slack.com/files/UU9RGNUTF/F045A4JB65T/image.png",
                "marks": [
                    {
                    "type": "link",
                    "attrs": {
                        "href": "https://appgate.slack.com/files/UU9RGNUTF/F045A4JB65T/image.png"
                    }
                    }
                ]
                }
            ]
            },
            {
            "type": "paragraph",
            "content": [
                {
                "type": "text",
                "text": "https://appgate.slack.com/archives/CTVBPTZ27/p1665046705267049",
                "marks": [
                    {
                    "type": "link",
                    "attrs": {
                        "href": "https://appgate.slack.com/archives/CTVBPTZ27/p1665046705267049"
                    }
                    }
                ]
                },
                {
                "type": "text",
                "text": " (the above just gives you the screenshot)"
                }
            ]
            },
            {
            "type": "paragraph",
            "content": [
                {
                "type": "text",
                "text": "appgate_logs-2022-10-06.zip",
                "marks": [
                    {
                    "type": "link",
                    "attrs": {
                        "href": "https://got-youtrack.agi.appgate.com/api/files/61-9164?sign=MTc2MzA3ODQwMDAwMHwyMi0zMzl8NjEtOTE2NHxUaWxJdjdzZHZVNlppNmkzU2ZlcDRXbC1feE9GbW02eE9aak41SGRSNnlVDQo&updated=1665047268185&forceDownload=true"
                    }
                    }
                ]
                }
            ]
            },
            {
            "type": "paragraph",
            "content": []
            },
            {
            "type": "paragraph",
            "content": [
                {
                "type": "text",
                "text": "This will probably need two separate fixes:"
                }
            ]
            },
            {
            "type": "bulletList",
            "content": [
                {
                "type": "listItem",
                "content": [
                    {
                    "type": "paragraph",
                    "content": [
                        {
                        "type": "text",
                        "text": "It should trigger CA migration when it should"
                        }
                    ]
                    }
                ]
                },
                {
                "type": "listItem",
                "content": [
                    {
                    "type": "paragraph",
                    "content": [
                        {
                        "type": "text",
                        "text": "It should not crash when it can't/won't. (It could be a real MITM for example, then it should not crash but keep showing error)"
                        }
                    ]
                    }
                ]
                }
            ]
            },
            {
            "type": "paragraph",
            "content": []
            },
            {
            "type": "paragraph",
            "content": [
                {
                "type": "text",
                "text": "Note: log1 file seems to be irrelevant because he did not have the next CA."
                }
            ]
            },
            {
            "type": "blockquote",
            "content": [
                {
                "type": "paragraph",
                "content": [
                    {
                    "type": "text",
                    "text": "No next CA certificate found."
                    }
                ]
                }
            ]
            }
        ],
        "version": 1
    },
    "comments": [
        {
        "body": {
            "type": "doc",
            "content": [
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "I can't reproduce this locally but I can see some differences on the flow. Locally, CA migration is done before authentication while on the crashed logs it gets a different error code for the earlier steps"
                }
                ]
            },
            {
                "type": "blockquote",
                "content": [
                {
                    "type": "paragraph",
                    "content": [
                    {
                        "type": "text",
                        "text": "REST  (purple.appgate.com:443) H2243859775616 [[9]]: Read failed: 'ERR"
                    },
                    {
                        "type": "text",
                        "text": "CONNECT",
                        "marks": [
                        {
                            "type": "em"
                        }
                        ]
                    },
                    {
                        "type": "text",
                        "text": "GENERIC"
                    },
                    {
                        "type": "text",
                        "text": "ERROR - [purple.appgate.com - 1]: SSL",
                        "marks": [
                        {
                            "type": "em"
                        }
                        ]
                    },
                    {
                        "type": "text",
                        "text": "read failed: 6/unknown error number'"
                    }
                    ]
                }
                ]
            },
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "and then it gets error on authentication attempt which doesn't seem to be handled."
                }
                ]
            },
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "Not sure why. It could be related to the CRL stuff on purple which is not easy to set up locally."
                }
                ]
            }
            ],
            "version": 1
        },
        "author": "natan.abolafya",
        "created": 1665417144951
        },
        {
        "body": {
            "type": "doc",
            "content": [
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "Tried to trigger a similar crash by shutting down nginx before SAML auth. Now it's stuck in controller connection loop lol. but no crash.."
                }
                ]
            }
            ],
            "version": 1
        },
        "author": "natan.abolafya",
        "created": 1665417948337
        },
        {
        "body": {
            "type": "doc",
            "content": [
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "Looking at 3 separate logs, I see 3 different issues:"
                }
                ]
            },
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "\\- SAML renewal crash"
                }
                ]
            },
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "\\- On-boarding OTP not handling cert issues"
                }
                ]
            },
            {
                "type": "paragraph",
                "content": [
                {
                    "type": "text",
                    "text": "\\- Login: Migration with MFA crash (reproduced with combo of OIDC, refresh token, MFA and CA renewal on login. once :'() Oh, this is master only. creating a task."
                }
                ]
            }
            ],
            "version": 1
        },
        "author": "natan.abolafya",
        "created": 1665590791545
        }
    ]
    },
    {
        "key": "SA-20333",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Might be in the upgrade status too: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Oct 18 11:21:00 purple11 cz-configd[502]: INFO {'event_type': 'appliance_status_changed', 'version': 17, 'cpu': {'percent': 15.5}, 'disk': {'free': 21801762816, 'percent': 27.0, 'total': 31264641024, 'used': 8064061440}, 'memory': {'free': 401563648, 'percent': 36.8, 'total': 8333160448, 'used': 3069796352, 'available': 4888174592}, 'network': {'busiestNic': 'eth0', 'details': {'eth0': {'txSpeed': '2.46 Mbps', 'rxSpeed': '38.2 Mbps', 'dropin': 0, 'dropout': 0, 'ips': ['172.31.13.93']}}}, 'roles': {'appliance': {'status': 'busy', 'details': 'Preparing for upgrade'}, 'controller': {'status': 'healthy', 'details': 'Database controller: Database size is 119 MB'}, 'gateway': {'status': 'healthy', 'numberOfSessions': 6}, 'logForwarder': {'status': 'healthy'}}, 'state': 'controller_ready', 'status': 'busy', 'upgrade': {'status': 'downloading', 'details': '"
                        },
                        {
                            "type": "text",
                            "text": "https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-6.0.3-30868-release.img.zip'}"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " 'appliance_version': '6.0.3-30818-release', 'volumeNumber': 1}"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-20541",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw==, status: 429\nNov 09 08:12:33 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:33 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:33 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:33 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:33 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:34 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:34 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\nNov 09 08:12:34 envy-10-97-144-2.devops cz-logd[41136]: WARNING [httpClient] NOT ok response for batch against "
                        },
                        {
                            "type": "text",
                            "text": "https://collectors.de.sumologic.com/receiver/v1/http/ZaVnC4dhaV3WWh-sjzKK_FE-uB8aOXtxPtAnyT2GDUb53ew0WCwl0LrGMRVKDbvBP6dG-DiLDw3zJzUvnLWkUnDMuvmJX2d-eFKy5jrZ_ivPpP76TNBWaw=="
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " status: 429\n"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Fixed in "
                                },
                                {
                                    "type": "text",
                                    "text": "SA-20542",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-youtrack.agi.appgate.com/issue/SA-20542"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "anton.lundgren",
                "created": 1668038353201
            }
        ]
    },
    {
        "key": "SA-20782",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Often some log links are missing in the testrail test plan even though they are there in nexus, see e.g. "
                        },
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1092292",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1092292"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " gateway"
                        },
                        {
                            "type": "text",
                            "text": "syslog is missing.",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "\nthomas@thomas-xps13:~/Projects/helvetest$ aitorbot test get 9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa -d 10 --full\nperleino ['pullrequest', 'stratus-gateway', 'perleino'] | 2022-11-30 13:27:48\n\tid:       9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa\n\tstate:    stopped-execution\n\ttest:\n\t\ttest plan:      "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1092292"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\tclient:         linux\n\t\tclient_type:    interactive\n\t\tpurpose:        commit\n\t\tlevel:          STREAM\n\t\tkeep on error:  False\n\t\ttest build:     "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewQueued.html?itemId=728318"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\tcases: 10343\u2713, 10344\u2713, 9477\u2713, 9932\u2713, 2150542\u2713, 199723592\u2713, 10422\u2713, 847076\u2713, 847077\u2713, 34825832\u2713, 867662\u2713, 13985412\u2713\n\t\t      6129266\u2713, 2150543\u2713, 42699719\u2713, 63383057\u2713, 82328831\u2713, 16505594\u2713, 17637708\u2713, 66736860\u2713, 200018135\u2713, 216186214\u2713, 9400\u2713, 21221961\u2713\n\t\t      2150541\u2713, 10115\u2713, 134150376\u2713, 139395054\u2713, 147733511\u2713, 147733512\u2713, 10128\u2713, 10129\u2713, 13985413\u2713, 10131\u2713, 867625\u2713, 10347\u2713\n\t\t      10180\u2713, 32039387\u2713, 10116\u2713\n\t\tartifacts: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewQueued.html?itemId=728318"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\taitorbot [master #4586] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728185&buildTypeId=Testyd_TestydBuild"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\ttesty [master #673] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=712452&buildTypeId=Testy_TestyBuild"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-client-linux [master #31278] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=727167&buildTypeId=StratusClient_Linux"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-tests [master #10298] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728053&buildTypeId=Testy_StratusTests_StratusTestsBuild"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\tenvironment:\n\t\tartifacts: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewQueued.html?itemId=728289"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-gateway [3665 #15428] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728099&buildTypeId=StratusGateway_Build"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-client-linux [master #31278] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=727167&buildTypeId=StratusClient_Linux"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tcontrib-bdr [master #920] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728249&buildTypeId=StratusContrib_BDR"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-controller [master #11692] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=727483&buildTypeId=StratusController_Build"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-frontend [master #14327] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728135&buildTypeId=StratusFrontend_Build"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tappliance-daemons [master #26680] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728194&buildTypeId=StratusAppliance_BuildTemplate"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tstratus-logging [master #1750] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=727262&buildTypeId=StratusLogging_Build"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\tappliance-image [master #31649] "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-teamcity.agi.appgate.com/viewLog.html?buildId=728226&buildTypeId=StratusImage_Build"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\tscenario: lhr-simple_v4\n\t\tkeep on error: True\n\t\tnodes:\n\t\t\tcontroller\n\t\t\t\troles:   controller, logserver\n\t\t\t\tweb ui:  "
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-10-97-190-2.devops:8443"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\t\tAPI specs:  "
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-10-97-190-2.devops:8443/api_specs.html"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\t\tapi version: 18\n\t\t\t\tstatus:  Running\n\t\t\t\tip:      10.97.190.2\n\t\t\t\tnetwork: 10.97.190.0/26\n\t\t\t\thostname: envy-10-97-190-2.devops\n\t\t\t\tadmin username: admin\n\t\t\t\tadmin password: admin\n\t\t\tgateway\n\t\t\t\troles:   gateway\n\t\t\t\tstatus:  Running\n\t\t\t\tip:      10.97.190.3\n\t\t\t\tnetwork: 10.97.190.0/26\n\t\t\t\thostname: envy-10-97-190-3.devops\n\t\t\tendpoint\n\t\t\t\troles:   endpoint\n\t\t\t\thttps:   "
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-10-97-247-67.devops"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\t\thttp:    "
                                },
                                {
                                    "type": "text",
                                    "text": "http://envy-10-97-247-67.devops"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t\t\tstatus:  Running\n\t\t\t\tip:      10.97.247.67\n\t\t\t\tnetwork: 10.97.247.64/26\n\t\t\t\thostname: envy-10-97-247-67.devops\n\tfiles:\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_all.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_console-setup.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_cz-configd.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_cz-copylogs.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_cz-dbd%40current.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_cz-nginx%40main.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_cz-opensearchdashboards.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_dbus.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_getty%40tty1.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_lvm2-monitor.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_ntp.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_syslog.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_systemd-hostnamed.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_systemd-sysctl.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_systemd-tmpfiles-clean.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_systemd-tmpfiles-setup.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_systemd-udevd.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/controller_vgauth.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_all.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_console-setup.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_cz-configd.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_cz-gonamed.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_cz-named.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_cz-permanentcacert.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_cz-sessiond.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_cz-vpnd%401.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_dbus.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_devmon.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_getty%40tty1.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_init.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_lvm2-monitor.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_lvm2-pvscan%408%3A18.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_lvmresizer.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_ntp.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_rsyslog.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_ssh.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-hostnamed.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-journald.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-logind.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-sysctl.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-time-wait-sync.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-tmpfiles-clean.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-tmpfiles-setup.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_systemd-udevd.log.gz"
                                },
                                {
                                    "type": "text",
                                    "text": "\n\t\t"
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-nexus01.agi.appgate.com:8443/repository/test-artifacts/test-runs/9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa/gateway_vgauth.log.gz"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1669983555587
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The same list in testrail"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Test Files: browse\n\n    controller_all.log.gz\n    controller_console-setup.log.gz\n    controller_cz-configd.log.gz\n    controller_cz-copylogs.log.gz\n    controller_cz-dbd%40current.log.gz\n    controller_cz-nginx%40main.log.gz\n    controller_cz-opensearchdashboards.log.gz\n    controller_dbus.log.gz\n    controller_getty%40tty1.log.gz\n    controller_lvm2-monitor.log.gz\n    controller_ntp.log.gz\n    controller_syslog.gz\n    controller_systemd-hostnamed.log.gz\n    controller_systemd-sysctl.log.gz\n    controller_systemd-tmpfiles-clean.log.gz\n    controller_systemd-tmpfiles-setup.log.gz\n    controller_systemd-udevd.log.gz\n    controller_vgauth.log.gz\n    gateway_all.log.gz\n    gateway_console-setup.log.gz\n    gateway_cz-configd.log.gz\n    gateway_cz-gonamed.log.gz\n    gateway_cz-named.log.gz\n    gateway_cz-permanentcacert.log.gz\n    gateway_cz-sessiond.log.gz\n    gateway_cz-vpnd%401.log.gz\n    gateway_dbus.log.gz\n    gateway_devmon.log.gz\n    gateway_getty%40tty1.log.gz\n    gateway_init.log.gz\n    gateway_lvm2-monitor.log.gz\n    gateway_lvm2-pvscan%408%3A18.log.gz\n    gateway_lvmresizer.log.gz\n    gateway_ntp.log.gz\n    gateway_rsyslog.log.gz\n    gateway_ssh.log.gz\n    gateway_systemd-hostnamed.log.gz\n    gateway_systemd-journald.log.gz\n    gateway_systemd-logind.log.gz\n    gateway_systemd-sysctl.log.gz\n    gateway_systemd-time-wait-sync.log.gz\n    gateway_systemd-tmpfiles-clean.log.gz\n    gateway_systemd-tmpfiles-setup.log.gz\n    gateway_systemd-udevd.log.gz\n    gateway_vgauth.log.gz"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1669983610778
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "And finally in nexus: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "controller_all.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t550459 \t\ncontroller_console-setup.log.gz \tWed Nov 30 14:24:36 UTC 2022 \t308 \t\ncontroller_cron.log.gz \tWed Nov 30 14:24:36 UTC 2022 \t768 \t\ncontroller_cz-agentx.log.gz \tWed Nov 30 14:24:36 UTC 2022 \t511 \t\ncontroller_cz-configd.log.gz \tWed Nov 30 14:24:36 UTC 2022 \t48776 \t\ncontroller_cz-controllerd.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t325247 \t\ncontroller_cz-copylogs.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t204 \t\ncontroller_cz-dbd@current.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t19087 \t\ncontroller_cz-ffwd.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t1099 \t\ncontroller_cz-logd.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t2163 \t\ncontroller_cz-nginx@admin.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t467 \t\ncontroller_cz-nginx@main.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t731 \t\ncontroller_cz-opensearch.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t8483 \t\ncontroller_cz-opensearchdashboards.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t2374 \t\ncontroller_cz-permanentcacert.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t456 \t\ncontroller_cz-proxyd.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t3747 \t\ncontroller_dbus.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t1001 \t\ncontroller_devmon.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t241 \t\ncontroller_getty@tty1.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t365 \t\ncontroller_init.log.gz \tWed Nov 30 14:24:37 UTC 2022 \t4430 \t\ncontroller_kern.log.gz \tWed Nov 30 14:24:36 UTC 2022 \t20128 \t\ncontroller_lvm2-monitor.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t195 \t\ncontroller_lvm2-pvscan@8:18.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t284 \t\ncontroller_lvmresizer.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t294 \t\ncontroller_ntp.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t1237 \t\ncontroller_rsyslog.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t1821 \t\ncontroller_ssh.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t23528 \t\ncontroller_syslog.gz \tWed Nov 30 14:24:36 UTC 2022 \t342532 \t\ncontroller_systemd-hostnamed.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t867 \t\ncontroller_systemd-journald.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t417 \t\ncontroller_systemd-logind.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t302 \t\ncontroller_systemd-sysctl.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t269 \t\ncontroller_systemd-time-wait-sync.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t247 \t\ncontroller_systemd-tmpfiles-clean.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t326 \t\ncontroller_systemd-tmpfiles-setup.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t297 \t\ncontroller_systemd-udevd.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t453 \t\ncontroller_vgauth.log.gz \tWed Nov 30 14:24:38 UTC 2022 \t567 \t\nenvy-9fd97ef4-c4f8-454e-90c8-bc45ccdfdcaa.gz \tWed Nov 30 14:24:44 UTC 2022 \t2431 \t\ngateway_all.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t234399 \t\ngateway_console-setup.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t305 \t\ngateway_cron.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t524 \t\ngateway_cz-agentx.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t508 \t\ngateway_cz-configd.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t32831 \t\ngateway_cz-dnsfwd.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t1265 \t\ngateway_cz-gonamed.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t4828 \t\ngateway_cz-logd.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t1567 \t\ngateway_cz-named.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t12919 \t\ngateway_cz-nginx@urlaccess.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t4265 \t\ngateway_cz-permanentcacert.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t449 \t\ngateway_cz-proxyd.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t3629 \t\ngateway_cz-sessiond.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t41778 \t\ngateway_cz-vpnd@0.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t5390 \t\ngateway_cz-vpnd@1.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t9089 \t\ngateway_dbus.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t1036 \t\ngateway_devmon.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t239 \t\ngateway_getty@tty1.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t361 \t\ngateway_init.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t6899 \t\ngateway_kern.log.gz \tWed Nov 30 14:24:39 UTC 2022 \t20217 \t\ngateway_lvm2-monitor.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t191 \t\ngateway_lvm2-pvscan@8:18.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t281 \t\ngateway_lvmresizer.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t289 \t\ngateway_ntp.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t959 \t\ngateway_rsyslog.log.gz \tWed Nov 30 14:24:40 UTC 2022 \t2022 \t\ngateway_ssh.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t25532 \t\ngateway_syslog.gz \tWed Nov 30 14:24:39 UTC 2022 \t103520 \t\ngateway_systemd-hostnamed.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t884 \t\ngateway_systemd-journald.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t419 \t\ngateway_systemd-logind.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t296 \t\ngateway_systemd-sysctl.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t267 \t\ngateway_systemd-time-wait-sync.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t204 \t\ngateway_systemd-tmpfiles-clean.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t323 \t\ngateway_systemd-tmpfiles-setup.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t292 \t\ngateway_systemd-udevd.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t493 \t\ngateway_vgauth.log.gz \tWed Nov 30 14:24:41 UTC 2022 \t531 \t"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1669983629143
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As far as I can tell the problem is actually not with the updates to teamcity once the state machine has been reached. The problem is the ordering of the events. Several events can be queued in quick succession with the same priority. And, we do not guarantee the queuing order when the priorities are the same."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1669991660810
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So either you need to manually adjust priorities all over the place or we need to change themachine to have an additional \"counter\" field in the priority queue that we always increment on put event. Which is actually what the python docs discuss here "
                                },
                                {
                                    "type": "text",
                                    "text": "https://docs.python.org/3/library/heapq.html#priority-queue-implementation-notes",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://docs.python.org/3/library/heapq.html#priority-queue-implementation-notes"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " "
                                },
                                {
                                    "type": "emoji",
                                    "attrs": {
                                        "shortName": "smile"
                                    }
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1669991924189
            }
        ]
    },
    {
        "key": "SA-19182",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "08:55:35   Build plan:\n\n08:55:35    0 build in parallel: cz-nginx,cz-spad,cz-logd,cz-dnsproxyd,cz-configd,cz-geoip,cz-webd,admin-scripts,lvmresizer,cz-ffwd,cz-copylogs,cz-clientd,cz-agentx,rexport,cz-appliance-base\n\n08:55:35    1 build in parallel: cz-proxyd\n\n08:55:38   Error response from daemon: manifest for lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6 not found: manifest unknown: manifest unknown\n\n08:55:39   cz-nginx\n\n08:55:39   cz-nginx run-in-docker\n\n08:55:39     cz-nginx  Build command: run --rm --dns-option single-request-reopen --dns 10.97.2.20 --dns 10.97.2.23 --mount type=bind,source=/tmp/tmpw8qz0ejv,destination=/var/cache/apt/archives --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/nginx,destination=/build/project --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/build-artifacts/.cz-nginx.build-artifacts,destination=/build/build-artifacts --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/build-artifacts,destination=/build/local-build-artifacts --mount type=bind,source=/tmp/tmpa680i7r5,destination=/tmp/dependencies -e HOME=/root -e IN_DOCKER=1 -e PROJECT=cz-nginx -e DEPENDENCIES_DIR=/tmp/dependencies -e BUILDNUMBER=24827 -e TARGET=build -e VERSION=5.5.6 -e STRATUS_APPLIANCE_VERSION=5.5.6 -e ARTIFACTS_DIR=../build-artifacts -e LOCAL_ARTIFACTS_DIR=../local-build-artifacts -e BRANCH=5720 -e BASE_BRANCH=release-5.5 -e GOCACHE=/build/.go_cache --label cz-nginx-None --label branch=5720 lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6 appgate-build.sh build\n\n08:55:39     cz-nginx  Unable to find image 'lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6' locally\n\n08:55:39     cz-nginx  docker: Error response from daemon: manifest for lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6 not found: manifest unknown: manifest unknown.\n\n08:55:39     cz-nginx  See 'docker run --help'.\n\n08:55:39     cz-nginx\n\n08:55:39   cz-spad\n\n08:55:39   cz-spad run-in-docker\n\n08:55:39     cz-spad  Build command: run --rm --dns-option single-request-reopen --dns 10.97.2.20 --dns 10.97.2.23 --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/godaemons.mk,destination=/build/godaemons.mk --mount type=bind,source=/tmp/tmpipd83x6f,destination=/var/cache/apt/archives --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/spad,destination=/build/project --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/build-artifacts/.cz-spad.build-artifacts,destination=/build/build-artifacts --mount type=bind,source=/home/builderbob/buildAgent/work/stratus-appliance-24827/build-artifacts,destination=/build/local-build-artifacts --mount type=bind,source=/tmp/tmpa680i7r5,destination=/tmp/dependencies -e HOME=/root -e IN_DOCKER=1 -e PROJECT=cz-spad -e DEPENDENCIES_DIR=/tmp/dependencies -e BUILDNUMBER=24827 -e TARGET=build -e VERSION=5.5.6 -e STRATUS_APPLIANCE_VERSION=5.5.6 -e ARTIFACTS_DIR=../build-artifacts -e LOCAL_ARTIFACTS_DIR=../local-build-artifacts -e BRANCH=5720 -e BASE_BRANCH=release-5.5 -e GOCACHE=/build/.go_cache -e GOROOT=/build/project/go -e GOPATH=/build/project/go/tools -e GO=/build/project/go/bin/go -e GOFMT=/build/project/go/bin/gofmt -e GOLINT=/build/project/go/tools/bin/golint -e GOPROXY="
                        },
                        {
                            "type": "text",
                            "text": "https://got-nexus01.agi.appgate.com:8443/repository/goproxynexus"
                        },
                        {
                            "type": "text",
                            "text": " -e GONOSUMDB=github.com/appgate-sdp-int/* --label cz-spad-None --label branch=5720 lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6 appgate-build.sh build\n\n08:55:39     cz-spad  Unable to find image 'lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6' locally\n\n08:55:39     cz-spad  docker: Error response from daemon: manifest for lhr-nexus01.agi.appgate.com:5001/appgate-builder:release-5.5.6 not found: manifest unknown: manifest unknown.\n\n08:55:39     cz-spad  See 'docker run --help'.\n\n08:55:39     cz-spad\n\n08:55:39   cz-logd\n"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "08:55:42   Summary\n\n08:55:42     1  :  1652345739.313       0.131  0  1500  125  0  wrapper_run/cz-nginx\n\n08:55:42     2  :  1652345739.316       0.161  0  1914  125  0  wrapper_run/cz-spad\n\n08:55:42     3  :  1652345739.319       0.161  0  1928  125  0  wrapper_run/cz-logd\n\n08:55:42     4  :  1652345739.322       0.171  0  1958  125  0  wrapper_run/cz-dnsproxyd\n\n08:55:42     5  :  1652345739.324       0.148  0  1649  125  0  wrapper_run/cz-configd\n\n08:55:42     6  :  1652345739.326       0.158  0  1544  125  0  wrapper_run/cz-geoip\n\n08:55:42     7  :  1652345739.329       0.160  0  1928  125  0  wrapper_run/cz-webd\n\n08:55:42     8  :  1652345739.345       0.174  0  1670  125  0  wrapper_run/admin-scripts\n\n08:55:42     9  :  1652345739.447       0.157  0  1515  125  0  wrapper_run/lvmresizer\n\n08:55:42     10  :  1652345739.475       0.156  0  1928  125  0  wrapper_run/cz-ffwd\n\n08:55:42     11  :  1652345739.480       0.131  0  1518  125  0  wrapper_run/cz-copylogs\n\n08:55:42     12  :  1652345739.485       0.138  0  1649  125  0  wrapper_run/cz-clientd\n\n08:55:42     13  :  1652345739.488       0.139  0  1643  125  0  wrapper_run/cz-agentx\n\n08:55:42     14  :  1652345739.493       0.141  0  1660  125  0  wrapper_run/rexport\n\n08:55:42     15  :  1652345739.497       0.154  0  1691  125  0  wrapper_run/cz-appliance-base\n\n08:55:42   Process exited with code 15\n\n08:55:42   Process exited with code 15 (Step: Build (Command Line))\n\n08:55:42   Step Build (Command Line) failed"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Teh build fails so the only problem is that it's hard to see what's going on."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "aitor.iturri",
                "created": 1652346205730
            }
        ]
    },
    {
        "key": "SA-20224",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "{\n\t\"illumio\": {\n\t\t\"hits\": 0,\n\t\t\"misses\": 1,\n\t\t\"insertions\": 1,\n\t\t\"evictions\": 0,\n\t\t\"ttl\": 60,\n\t\t\"resolvers\": [{\n\t\t\t\"name\": \"Illumio Resolver Demo\",\n\t\t\t\"ready\": true,\n\t\t\t\"base-url\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://2x2demotest40.ilabs.io:8443/api/v2/orgs/1\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n\t\t\t\"update-interval\": 60,\n\t\t\t\"labels\": 20\n\t\t}]\n\t}\n}"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The structure is a map of resolvers of a type. Each resolver of a type object has fields: hits, misses, insertions, evictions, ttl and and array of objects"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "At the moment cz-gonamed only supports illumio so it will always be one parent resolver of a type object",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-23192",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "\"GET /admin/claims/names HTTP/1.0\" 200 933 \""
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-98-142-2.devops:8443/ui/access/policies/create/access\"",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://envy-10-98-142-2.devops:8443/ui/access/policies/create/access\""
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0\" 1603"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Most likely because we go to ZTP every time. Let's see if we need to go to ZTP every time. And maybe check with the ZTP team why it is so slow."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think it's good to go to ZTP every time so we have up to date information and less complexity with caching and whatnot. Will focus on figuring out what's taking time there."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1708004175757
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "According to AWS logs, it is taking about 30-40ms?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https 2024-02-15T14:13:43.170054Z app/k8s-ztpopeni-ztploadb-68a3d504a8/32eacacc18d2efac 35.157.222.129:64202 10.7.2.199:8443 0.001 0.035 0.000 200 200 508 513 \"GET "
                                },
                                {
                                    "type": "text",
                                    "text": "https://riskengine.usw1.ztp.donottrust.test.appgate.com:443/api/sdp/risk-rule"
                                },
                                {
                                    "type": "text",
                                    "text": " HTTP/1.1\" \"Appgate SDP Controller\" TLS_AES_128_GCM_SHA256 TLSv1.3 arn:aws:elasticloadbalancing:us-west-1:194335033129:targetgroup/k8s-ztpopeni-istioing-a5d1df9492/3b873cbb204ce328 \"Root=1-65ce1c17-7d85d792625fa03f14be2d4e\" \"riskengine.usw1.ztp.donottrust.test.appgate.com\" \"session-reused\" 6 2024-02-15T14:13:43.131000Z \"forward\" \"-\" \"-\" \"10.7.2.199:8443\" \"200\" \"-\" \"-\"\nhttps 2024-02-15T14:13:39.465674Z app/k8s-ztpopeni-ztploadb-68a3d504a8/32eacacc18d2efac 35.157.222.129:32156 10.7.3.61:8443 0.001 0.045 0.000 200 200 508 513 \"GET "
                                },
                                {
                                    "type": "text",
                                    "text": "https://riskengine.usw1.ztp.donottrust.test.appgate.com:443/api/sdp/risk-rule"
                                },
                                {
                                    "type": "text",
                                    "text": " HTTP/1.1\" \"Appgate SDP Controller\" TLS_AES_128_GCM_SHA256 TLSv1.3 arn:aws:elasticloadbalancing:us-west-1:194335033129:targetgroup/k8s-ztpopeni-istioing-a5d1df9492/3b873cbb204ce328 \"Root=1-65ce1c13-1a3a50790cf990f44b483689\" \"riskengine.usw1.ztp.donottrust.test.appgate.com\" \"session-reused\" 6 2024-02-15T14:13:39.417000Z \"forward\" \"-\" \"-\" \"10.7.3.61:8443\" \"200\" \"-\" \"-\""
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1708006828204
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "2024-02-16T10:29:02.605409+0000 purple10.appgate.com cz-controllerd[145303]: DEBUG[RiskEngineManager] Calling ZTP for risk rules.\n2024-02-16T10:29:03.308061+0000 purple10.appgate.com cz-controllerd[145303]: DEBUG[RiskEngineManager] Received new risk rules: [RiskRuleDefinition(id=4c46c6e7-d95e-45ca-9206-0c43f13c27b4, name=OS Version), RiskRuleDefinition(id=a59003de-4eea-4bc9-90f9-7"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "so it's just really bad latency."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I don't think I want to address this right now."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1708079480377
            }
        ]
    },
    {
        "key": "SA-22724",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Actions and Preconditions"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "orderedList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Renew claims token for the client"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Triggers MFA"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Observe logs"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Observation (with screenshots if applicable)"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs are filled with"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2023-11-17T09:30:20.972Z] Info : Posting token refresh request.\n[2023-11-17T09:30:21.282Z] Info : Retrieving claims token.\n[2023-11-17T09:30:21.282Z] Info : Fetching on-boarding cookie for 'onboardingcookie-69:5c:78:68:76:64:91:2f:25:29:1d:b3:9a:e7:f9:7c:74:fa:5a:9c:6b:84:c0:a2:14:3e:be:f5:66:dd:bf:42-Appgate Azure AD OIDC-mikael.harsjo@appgate.com-4FFB2427-0306-5BBC-B0F1-7E4089D91377' from secure storage.\n[2023-11-17T09:30:21.285Z] Info : On-boarding cookie available for 'onboardingcookie-69:5c:78:68:76:64:91:2f:25:29:1d:b3:9a:e7:f9:7c:74:fa:5a:9c:6b:84:c0:a2:14:3e:be:f5:66:dd:bf:42-Appgate Azure AD OIDC-mikael.harsjo@appgate.com-4FFB2427-0306-5BBC-B0F1-7E4089D91377'.\n[2023-11-17T09:30:22.319Z] Info : 2FA required while updating claims token at '"
                        },
                        {
                            "type": "text",
                            "text": "https://purple.appgate.com/'"
                        },
                        {
                            "type": "text",
                            "text": "."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "which means it's spamming the OIDC server."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs and/or testrail/slack links"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "[hadrien.luttiau"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip](hadrien.luttiau"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip)"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "[per.allansson"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip](per.allansson"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip)"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "[thomas.cellerier"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip](thomas.cellerier"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip)"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "[mikael.harsjo"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip](mikael.harsjo"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "appgate.com",
                                "text": "@appgate.com",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "-logs.zip)"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Repeatability: Always on master. Not confirmed on 6.2"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-19477",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The current implementation will try to re-download the update package on token renewal (every 24 hours). Even if the file hasn't been updated. This will make every client that haven't been updated to re-download which adds unnecessary load to the customer network."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Try to create a mechanism (e.g. hash or date created comparison) to avoid unnecessary downloads."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The issue with using a hash is that we can't compute the hash before downloading. As right now on the controller side we just pass on the download link to the client. We'd have to implement some sort of parsing which would download the upgrade file and generate a hash to be used in communication with the client. At the same time admins just using "
                                },
                                {
                                    "type": "text",
                                    "text": "sdp-latest",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " would then have to recompute the hash somehow."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The more kiss solution imho would be to just use some date mechanism. 2-3 days should be enough to reduce unecessary spam, while if the admin actually made an error the worst that would happen is that the end-user would need to perhaps update twice."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1655378293204
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Maybe HTTP caching mechanism? That would require the webserver admin to set it up though.."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Anyway, removing from Sprint since you all are going to be away for 2 sprints."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1656669379254
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Require the proper http standard support here maybe? Ie"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-digest-headers-13#content-digest",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-digest-headers-13#content-digest"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Then use  HTTP HEAD request to check before downloading?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1706175634790
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "idk if I'm using it correctly but doesn't seem like s3 supports it:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "curl -I -s -H \"Want-Repr-Digest: sha-256=1\" "
                                },
                                {
                                    "type": "text",
                                    "text": "https://appgate-auto-update-artifacts.s3.amazonaws.com/Appgate%20SDP%206.3.0-36858-master%20Installer.dmg"
                                },
                                {
                                    "type": "text",
                                    "text": "\nHTTP/1.1 200 OK\nx-amz-id-2: QtmEE9A4AAXybGRkpSxFGyV6EW/iYPingj5Adh/QstnyCP3WRWHIkGAo+aja/lrgSmf1aIGCQ74=\nx-amz-request-id: 3TGYDVD7Q4WE3VK4\nDate: Fri, 26 Jan 2024 15:06:24 GMT\nLast-Modified: Fri, 19 Jan 2024 12:25:23 GMT\nETag: \"47af69a17f2afd21db594711194da5aa-19\"\nx-amz-server-side-encryption: AES256\nAccept-Ranges: bytes\nContent-Type: application/x-apple-diskimage\nServer: AmazonS3\nContent-Length: 154424126"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1706281653466
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "poor mans solution would be looking at Content-Length which "
                                },
                                {
                                    "type": "text",
                                    "text": "in theory",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " should never be exactly the same :D"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1706281717950
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "the etag is a hash actually :)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1706283560453
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Last-Modified: Fri, 19 Jan 2024 12:25:23 GMT"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "![](image.png){width=70%}"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "looks about right."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1706283795890
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "but of what and how is probably not defined / guaranteed..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1706283830986
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think it's safe to assume the file hasn't changed since the last download assuming we store the header value in memory. That means we still download the file the first time after client starts but not do that until the header changes. Which is the scope of the task."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1706283988211
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " I think we should roll with ETag"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "manuel.moraga",
                "created": 1706610590872
            }
        ]
    },
    {
        "key": "SA-22332",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Looks like we are getting rate limited by AWS ECR, we should handle that: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "$ sdpctl appliance functions download LogServer --docker-registry public.ecr.aws/appgate-sdp\n1 error occurred:\n\t* failed to fetch image manifest: "
                        },
                        {
                            "type": "text",
                            "text": "https://public.ecr.aws/v2/appgate-sdp/cz-opensearchdashboards/manifests/6.2"
                        },
                        {
                            "type": "text",
                            "text": " - 429 Too Many Requests"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Note that it worked fine on retry so its not like this is always happening: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ sdpctl appliance functions download LogServer --docker-registry public.ecr.aws/appgate-sdp\nDownload complete. Files saved to /home/thomas/Downloads/appgate"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1693810971649
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "A related nitpick: It would be good to show the full file path, because now i have to guess its logserver-6.2.zip, which might not be obvious to a customer."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1693812130291
            }
        ]
    },
    {
        "key": "SA-21045",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "BTW the test case for the prometheus exporter is in nightlies, so you might want to run it explicitly "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/appgate-sdp-int/stratus-tests/blob/master/cases/appliance/prometheus_exporter.py"
                        },
                        {
                            "type": "text",
                            "text": "\nCase number 146993334\n\nAlso we will want a e2e variant with https enabled (and basic auth while we are at it) before 6.2 comes out.\nWe have most of the code to do that kind of cert generation already for urlaccess and portal testing.\nSee e.g. "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/appgate-sdp-int/stratus-tests/blob/254a362b7d77f3310020f451e5aad1a97ddfcf77/cases/foundation1/foundation1_portal.py#L123-L135"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-23203",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The file naming on the controller file repository needs to match what the upgrade hook & configd expect: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "$ sdpctl appliance upgrade prepare --image='"
                        },
                        {
                            "type": "text",
                            "text": "https://got02-artifacts.agi.appgate.com/project/7/StratusImage_Build/release-6.2/artifact/appgate-6.2.7-36152-release.img.zip?is-build-type-id=true'"
                        },
                        {
                            "type": "text",
                            "text": " --include function=Controller  --logserver-bundle ~/Downloads/Appgate-SDP-6.2-Logserver.zip --no-interactive\nsdpctl_version: 2024.02.01\ncommit: 8911494d052648cf76aee860d178bf068971f934\nbuild date: 2024-02-01T08:58:30Z\n\n\nPREPARE SUMMARY\n\n1. Bundle and upload LogServer docker image\n2. Upload upgrade image appgate-6.2.7-36152-release.img.zip to Controller\n3. Prepare upgrade on the following appliances:\n\n  Appliance                                                Online    Current version     Prepare version\n  ---------                                                ------    ---------------     ---------------\n  controller-65499d23-9aa8-4dda-8d87-508fe2d0441c-site1    \u2713         6.1.6-beta+35597    6.2.7+36152\n\n\nThe following appliances will be skipped:\n\n  Appliance                                             Online    Current version     Reason\n  ---------                                             ------    ---------------     ------\n  gateway-65499d23-9aa8-4dda-8d87-508fe2d0441c-site1    \u2713         6.1.6-beta+35597    filtered using the '--include' and/or '--exclude' flag\n\n\n[2024-02-05T11:54:13+01:00] Preparing image bundle for LogServer:\n \u2713 uploading Appgate-SDP-6.2-Logserver.zip: uploaded\nImage bundles prepared\n\n\n[2024-02-05T11:55:47+01:00] Preparing image on appliances:\n \u2a2f controller-65499d23-9aa8-4dda-8d87-508fe2d0441c-site1: failed - Upgrade post-prepare hook failed with exit code 1\n1 error occurred:\n\t* prepare failed on controller-65499d23-9aa8-4dda-8d87-508fe2d0441c-site1 failed Upgrade post-prepare hook failed with exit code 1:\nFailed to prepare logserver container image bundle. public.ecr.aws:443 is not reachable"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The easiest is for sdpctl to rename the file to follow the expected naming convention "
                                },
                                {
                                    "type": "text",
                                    "text": "logserver-6.2.zip",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ", based on the version of the appliance upgrade image."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Alternatively we can use a regexp that can extract the logserver bundle version from either "
                                },
                                {
                                    "type": "text",
                                    "text": "Appgate-SDP-6.2-Logserver.zip",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " or "
                                },
                                {
                                    "type": "text",
                                    "text": "logserver-6.2.zip",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Additionally we could even compare the appliance upgrade image version to the logserver bundle version to make sure they match, e.g. no 6.3 bundle when upgrading to 6.2."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1707131546636
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As a workaround its enough to rename the file locally but I don't think that will be acceptable to customers as nobody will remember to do that: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "mv ~/Downloads/Appgate-SDP-6.2-Logserver.zip ~/Downloads/logserver-6.2.zip"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1707131622234
            }
        ]
    },
    {
        "key": "SA-23186",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Found in the field. Cloudwatch is flagging our appliances for \"IMDSv1 activity\"."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "We are using IMDSv2 by default in configd and that works as is should. But there are more places where the AWS metadata is queried, like the AWS resolver, logd, oslogin..."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The task is to review all EC2 metadata requests and make sure the token header is included."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1708611230769
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "| function | investigation result | Status | | --- | --- | --- | | oslogin | Only used on GCP,  just make sure it isn't accidentally called on AWS. | OK | | named/aws resolver | Using v2 only. | OK | | configd | Using v2 only. | OK | | logd | Hardcoded to v1! | NOK | | autoscale | Using v2 only (for the AWS parts). | OK |"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1710946800798
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "About this note in configd "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This class supports AWS metadata v1 (IMDSv1) and v2 (IMDSv2)\n"
                                },
                                {
                                    "type": "text",
                                    "text": "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/"
                                },
                                {
                                    "type": "text",
                                    "text": "\nIMDSv2 adds a token to get the metadata, since IDMSv1 is compatible with the token we always get the token\nregardless the IMDS versions"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": " Maybe it was different earlier but now v2 can no longer be disabled, so the token will always be used, thus making all requests v2. There is no such thing as a v1-only environment."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1710949238316
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So the conclusion is that there is only one place we need to fix. After that we can say our AWS appliances are IMDSv2-only."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1710950218094
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "FYI "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "per.leino",
                                        "text": "@per.leino",
                                        "accessLevel": ""
                                    }
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1710950460631
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Have to open this one again. It turns out I was wrong about oslogin. We're checking for it on AWS too. Any packets sent to "
                                },
                                {
                                    "type": "text",
                                    "text": "169.254.169.254",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " without the token will flag the appliance for \"IMDSv1 activity\"."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "16:35:35.038250 IP 192.168.150.100.49046 > 169.254.169.254.80: Flags [S], seq 3033329003, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\n16:35:35.038292 IP 192.168.150.1 > 192.168.150.100: ICMP 169.254.169.254 tcp port 80 unreachable, length 60\n16:35:41.033913 IP 192.168.150.100.59204 > 169.254.169.254.80: Flags [S], seq 776834222, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\n16:35:41.033955 IP 192.168.150.1 > 192.168.150.100: ICMP 169.254.169.254 tcp port 80 unreachable, length 60\n16:35:48.440841 IP6 fe80::5054:ff:fe67:5a9e > ff02::2: ICMP6, router solicitation, length 16\n16:35:51.046184 IP 192.168.150.100.64618 > 169.254.169.254.80: Flags [S], seq 1695795290, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\n16:35:51.046219 IP 192.168.150.1 > 192.168.150.100: ICMP 169.254.169.254 tcp port 80 unreachable, length 60\n16:35:56.120827 ARP, Request who-has 192.168.150.1 tell 192.168.150.100, length 28\n16:35:56.120839 ARP, Reply 192.168.150.1 is-at 52:54:00:9a:52:d8, length 28\n16:35:56.291159 ARP, Request who-has 192.168.150.100 tell 192.168.150.1, length 28\n16:35:56.291302 ARP, Reply 192.168.150.100 is-at 52:54:00:67:5a:9e, length 28\n16:36:01.058240 IP 192.168.150.100.29334 > 169.254.169.254.80: Flags [S], seq 904923356, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\n16:36:01.058279 IP 192.168.150.1 > 192.168.150.100: ICMP 169.254.169.254 tcp port 80 unreachable, length 60\n16:36:01.062750 IP 192.168.150.100.29338 > 169.254.169.254.80: Flags [S], seq 1597863067, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\n16:36:01.062786 IP 192.168.150.1 > 192.168.150.100: ICMP 169.254.169.254 tcp port 80 unreachable, length 60\n16:36:02.072871 IP 192.168.150.100.29338 > 169.254.169.254.80: Flags [S], seq 1597863067, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\n16:36:02.072905 IP 192.168.150.1 > 192.168.150.100: ICMP 169.254.169.254 tcp port 80 unreachable, length 60"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1731512635706
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Erm, no. I think that was a false alarm. Those packets above will most probably contain the token as they should. I suppose I will have to test this tool on a real EC2 appliance. "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/aws/aws-imds-packet-analyzer",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/aws/aws-imds-packet-analyzer"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1733416887129
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Don't forget there is logd that uses the old SDK in places like "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/9094c4e1cc76855cd3de8f7d7300eb0691083e0d/logd/src/kinesis/kinesisGeneric.go#L20",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-appliance/blob/9094c4e1cc76855cd3de8f7d7300eb0691083e0d/logd/src/kinesis/kinesisGeneric.go#L20"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " and others"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "There is a task linked as related here (which imho it should be a subtask or depend on) "
                                },
                                {
                                    "type": "text",
                                    "text": "https://got-youtrack.agi.appgate.com/issue/SA-23555/cz-logd-Use-the-aws-sdk-go-v2-and-not-the-deprecated-one",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-youtrack.agi.appgate.com/issue/SA-23555/cz-logd-Use-the-aws-sdk-go-v2-and-not-the-deprecated-one"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1733475459568
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "THANK YOU! I was falling into despair from staring at our own code. That's probably it then. At least there is little point in banging my head against the wall until this is fixed."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1733479226750
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "kasper.gustavsson",
                                        "text": "@kasper.gustavsson",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " - Is this done?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1738057420368
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yes."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kasper.gustavsson",
                "created": 1738057792827
            }
        ]
    },
    {
        "key": "SA-22096",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Actions and Preconditions"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "orderedList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Env with multiple controllers"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Configure push profiles with profiles where one controller is unreachable"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Login with client and apply pushed profiles"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Observation (with screenshots if applicable)"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Error message that the configuration is faulty and that the configuration wasn't possible to apply"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "No profiles added"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "After logging out the profiles are available in the dropdown"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Expected"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Either accept the error or don't apply the profiles"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "CoMMENT"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This behavior is due to the DNS settings being wrong while logged in and then they are correctly applied on log out."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs and/or testrail/slack links"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2023-06-15T14:34:16.726Z] Info : New profiles: Development, FullTunnel\n[2023-06-15T14:34:16.734Z] Info : Profiles added by user: Production\n[2023-06-15T14:34:16.734Z] Info : Initializing new profile 'Development' (42298895).\n[2023-06-15T14:34:16.737Z] Info : CA certificate found in the storage for 'connect-ag-dev.sdp.avertium.com'.\n[2023-06-15T14:34:16.737Z] Info : Resolving hostname 'connect-ag-dev.sdp.avertium.com'\n[2023-06-15T14:34:16.938Z] Warn : Lookup of 'connect-ag-dev.sdp.avertium.com' failed: No such host is known.\n[2023-06-15T14:34:16.938Z] Error : First connection to controller '"
                        },
                        {
                            "type": "text",
                            "text": "https://connect-ag-dev.sdp.avertium.com/'"
                        },
                        {
                            "type": "text",
                            "text": " has failed. Details: Could not establish a connection.\n[2023-06-15T14:34:17.059Z] Error : Failed to apply profile configuration: Could not establish a connection.\n[2023-06-15T14:34:33.963Z] Info : Quit request received from UI.\n[2023-06-15T14:34:33.979Z] Info : UI connection has disconnected.\n[2023-06-15T14:34:33.980Z] Info : Shutting down the service because the UI connection is lost.\n[2023-06-15T14:34:34.060Z] Info : 'VPN Driver': Closing connection.\n[2023-06-15T14:34:38.051Z] Info : Running as normal application.\n[2023-06-15T14:34:38.071Z] Info : OSVersion: Windows 10.0.22000.1761\n[2023-06-15T14:34:38.077Z] Info : Client running with update service\n[2023-06-15T14:34:38.139Z] Info : Is normal desktop app: True, Process Session ID: 2\n[2023-06-15T14:34:38.504Z] Info : Applying Profile Configuration.\n[2023-06-15T14:34:38.519Z] Info : New profiles: Development, FullTunnel\n[2023-06-15T14:34:38.525Z] Info : Profiles added by user: Production\n[2023-06-15T14:34:38.525Z] Info : Initializing new profile 'Development' (42298895).\n[2023-06-15T14:34:38.540Z] Info : CA certificate found in the storage for 'connect-ag-dev.sdp.avertium.com'.\n[2023-06-15T14:34:38.547Z] Info : Resolving hostname 'connect-ag-dev.sdp.avertium.com'\n[2023-06-15T14:34:38.608Z] Info : Resolved IPs: [52.12.48.119]\n[2023-06-15T14:34:38.613Z] Info : Trying to connect 'connect-ag-dev.sdp.avertium.com/52.12.48.119' with SPA key name 'development'.\n[2023-06-15T14:34:39.300Z] Info : Identity Provider Okta Corp found.\n[2023-06-15T14:34:39.353Z] Info : Initializing new profile 'FullTunnel' (-1503552942).\n[2023-06-15T14:34:39.358Z] Info : CA certificate found in the storage for 'connect-ag-ft.sdp.avertium.com'.\n[2023-06-15T14:34:39.358Z] Info : Resolving hostname 'connect-ag-ft.sdp.avertium.com'\n[2023-06-15T14:34:39.393Z] Info : Resolved IPs: [52.12.48.119]\n[2023-06-15T14:34:39.394Z] Info : Trying to connect 'connect-ag-ft.sdp.avertium.com/52.12.48.119' with SPA key name 'FullTunnel'.\n[2023-06-15T14:34:40.022Z] Info : Identity Provider Okta Corp found.\n[2023-06-15T14:34:40.064Z] Info : Updating profile 'Production' (380598729).\n[2023-06-15T14:34:40.134Z] Info : Creating session for profile 'Production' (380598729).\n[2023-06-15T14:34:40.171Z] Info : Creating session for profile 'Development' (42298895).\n[2023-06-15T14:34:40.172Z] Info : Creating session for profile 'FullTunnel' (-1503552942)."
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Repeatability: (Always/XX%/Once)"
                        }
                    ],
                    "attrs": {
                        "level": 4
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Always"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "christoffer.karlsson",
                                        "text": "@christoffer.karlsson",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " time to Obsolete?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1697039697038
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Well. It depends if it is something we want to fix or not. If not we can just put it in the \"configure your DNS correctly\" pile."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1697041200645
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Not sure if we can do something about it with a reasonable amount of effort. I'd say put it into the \"fix your network\" pile."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1697095713115
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://got-youtrack.agi.appgate.com/issue/SA-22526/Dont-show-UA-on-profile-configuration-update",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://got-youtrack.agi.appgate.com/issue/SA-22526/Dont-show-UA-on-profile-configuration-update"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " is obsoleting this task."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "christoffer.karlsson",
                "created": 1697631234705
            }
        ]
    },
    {
        "key": "SA-20014",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "To function, the backup script needs the symmetric key for the backups to be set to some value."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The old backup script would fail if the symmetric key was not set. The new script just asks the user to set one."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "However in our latest release the controller always reports the key as being set. Except I didn't set it. So I can take backups but I can never use them."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Since we are strongly encouraging customers to use restore to rollback, we should make sure that"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "On 5.5:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "10:19:41 Starting backup creation on controller-d788cf7f-7bcb-4f6a-b43a-3a6a3291adc5-site1\n10:19:41 Failed to start backup creation on controller-d788cf7f-7bcb-4f6a-b43a-3a6a3291adc5-site1.\n10:19:41 Controller responded with HTTP status code 503: {\"id\":\"service unavailable\",\"message\":\"Service unavailable. Please contact your administrator. (\\\" Backup passphrase is not set. \\\")\"}\n10:19:41 Appliance was a Controller. Fatal error.\n10:19:41 Some issues were encountered during the backup process. The downloaded files might not work or contain incomplete data."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "On 6.0:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Enter password for username admin and provider name local:\n10:20:51 Authenticating to "
                        },
                        {
                            "type": "text",
                            "text": "https://envy-10-97-230-2.devops:8443"
                        },
                        {
                            "type": "text",
                            "text": "..."
                        },
                        {
                            "type": "text",
                            "text": "\n10:20:51 Authentication succeeded\n10:20:51 Authorizing...\n10:20:51 Starting backup on 1 appliances:\n10:20:51 All files will be stored in ./appgate_backup_1662538849.1224556/\n10:20:51 Starting backup creation on controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1\n10:20:51 Backup creation started on controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1\n10:20:52 Backup in progress on appliance: controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1\n10:20:55 Backup complete on appliance: controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1\n10:20:55 Downloading backup from controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1 in ./appgate_backup_1662538849.1224556/controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1.bkp\n10:20:56 Download complete for appliance: controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1\n10:20:56 Removed remote download for appliance: controller-b4ff4d50-a587-4ffb-8239-bbd5144dc936-site1"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Sorry for the noise."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1662540664806
            }
        ]
    },
    {
        "key": "SA-20908",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Setup a simple policy where you set timeout to 1000 seconds for a http call. Like "
                                        }
                                    ]
                                },
                                {
                                    "type": "codeBlock",
                                    "attrs": {},
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "var result = false;\nprint(httpGet(\""
                                        },
                                        {
                                            "type": "text",
                                            "text": "https://google.com\""
                                        },
                                        {
                                            "type": "text",
                                            "text": ","
                                        },
                                        {
                                            "type": "text",
                                            "text": " [], 1000).data);\nreturn result;"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Test it and see it returns pretty fast. (You can give a wrong URL and watch it fail I guess also)."
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Go to Controller appliance settings and remove DNS servers and add a fake one, like "
                                        },
                                        {
                                            "type": "text",
                                            "text": "2.2.2.2",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Go back to the policy and test it again. It takes longer than 10 seconds to fail."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "The problem is possibly multiplied because we added extra DNS calls to httpXXX calls for security reasons (like making sure it doesn't return 127.0.0.1)."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "So we need to look into both our own code where DNS is involved and "
                                        },
                                        {
                                            "type": "text",
                                            "text": "HttpURLConnection",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "text",
                                            "text": " calls. Relevant class: JavaFunctions.java under policy evaluator project."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "a suggestion is to make a DNS resolution call in a thread and fail if it exceeds timeout. "
                                },
                                {
                                    "type": "text",
                                    "text": "https://thushw.blogspot.com/2009/11/resolving-domain-names-quickly-with.html",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://thushw.blogspot.com/2009/11/resolving-domain-names-quickly-with.html"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1671125501457
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "just going to drop this here in case it's needed later. Decided to not go ahead with it."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Here is a code where we can pass IP in the URL and do hostname verification. Known issues:"
                                }
                            ]
                        },
                        {
                            "type": "bulletList",
                            "content": [
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "commented out code might be necessary. I started having inconsistent behavior there but left it be for now."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "\"Host\" header is possible to override in this case. We might not want to allow that?"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "There is no proper HostnameVerifier available in PolicyEvaluator project which is basically a plain java project. "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "DefaultHostnameVerifier",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": " is from Apache HTTP client library. If we're to add that library as dependency, then we might as well just use that library instead which should provide more flexibility. "
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "    // System.setProperty(\"sun.net.http.allowRestrictedHeaders\", \"true\");\n    var hostname = \"www.appgate.com\";\n    var resolvedAddress = InetAddress.getByName(hostname).getHostAddress();\n\n    URL urlResolved = new URL(\""
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "https://\""
                                                },
                                                {
                                                    "type": "text",
                                                    "text": " + resolvedAddress);\n    HttpURLConnection connection = (HttpURLConnection) urlResolved.openConnection();\n    if (connection instanceof HttpsURLConnection httpsConnection) {\n      //httpsConnection.setRequestProperty(\"sun.net.http.allowRestrictedHeaders\", \"true\");\n      httpsConnection.setHostnameVerifier(new HostnameVerifier() {\n        @Override\n        public boolean verify(String ip, SSLSession session) {\n          return new DefaultHostnameVerifier().verify(hostname, session);;\n        }\n      });\n    }"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1671638506908
            }
        ]
    },
    {
        "key": "SA-21620",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Exactly like illumio. They come from the same framework "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "{\n\t\"azure\": {\n\t\t\"cache\": {\n\t\t\t\"hits\": 0,\n\t\t\t\"misses\": 1,\n\t\t\t\"insertions\": 1,\n\t\t\t\"evictions\": 0,\n\t\t\t\"ttl\": 60\n\t\t},\n\t\t\"resolvers\": [{\n\t\t\t\"name\": \"Azure Resolver\",\n\t\t\t\"ready\": true,\n\t\t\t\"managed-identity\": false,\n\t\t\t\"update-interval\": 60\n\t\t}]\n\t},\n\t\"illumio\": {\n\t\t\"cache\": {\n\t\t\t\"hits\": 0,\n\t\t\t\"misses\": 2,\n\t\t\t\"insertions\": 1,\n\t\t\t\"evictions\": 0,\n\t\t\t\"ttl\": 60\n\t\t},\n\t\t\"resolvers\": [{\n\t\t\t\"name\": \"Illumio Resolver ilabs\",\n\t\t\t\"ready\": true,\n\t\t\t\"base-url\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://demotest6.ilabs.io:8443/api/v2/orgs/1\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n\t\t\t\"update-interval\": 60,\n\t\t\t\"labels\": 20\n\t\t}]\n\t}\n}"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-22017",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Description"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The "
                        },
                        {
                            "type": "text",
                            "text": "Collect Appliance logs from these Sites",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " in the LF settings redirects to the incorrect URL"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Also we should show the \"redirect popover warning\" when the user click on the link (see policy form for example) ![](Selection"
                        },
                        {
                            "type": "text",
                            "text": "4581.png)",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Location"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "/ui/system/appliances/edit/"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "To reproduce"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "For example at: "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/system/appliances/edit/fdf7fbe6-01ef-4baa-922f-42e5ec19b3d9?tab=ApplianceFormFunction",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://purple10.agi.appgate.com:8443/ui/system/appliances/edit/fdf7fbe6-01ef-4baa-922f-42e5ec19b3d9?tab=ApplianceFormFunction"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " ![](image.png){width=70%}"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "redirects to "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/sites/edit/4fcbb04f-4bfa-4668-a426-f534f37f712f",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://purple10.agi.appgate.com:8443/ui/sites/edit/4fcbb04f-4bfa-4668-a426-f534f37f712f"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " which results in ![](image1.png){width=70%}"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "when it should probably  redirect to "
                        },
                        {
                            "type": "text",
                            "text": "https://purple10.agi.appgate.com:8443/ui/system/sites/edit/4fcbb04f-4bfa-4668-a426-f534f37f712f",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://purple10.agi.appgate.com:8443/ui/system/sites/edit/4fcbb04f-4bfa-4668-a426-f534f37f712f"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Definition of done"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "The \"warning popover\" should be shown when the user clikc on the link"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Update redirect "
                                        }
                                    ]
                                },
                                {
                                    "type": "codeBlock",
                                    "attrs": {},
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "From: "
                                        },
                                        {
                                            "type": "text",
                                            "text": "https://purple10.agi.appgate.com:8443/ui/sites/edit/4fcbb04f-4bfa-4668-a426-f534f37f712f"
                                        },
                                        {
                                            "type": "text",
                                            "text": "\nTo: "
                                        },
                                        {
                                            "type": "text",
                                            "text": "https://purple10.agi.appgate.com:8443/ui/system/sites/edit/4fcbb04f-4bfa-4668-a426-f534f37f712f"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-19027",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "root@envy-10-97-146-2:/home/cz# jq . /mnt/state/upgrade-status.json \n{\n  \"status\": \"ready\",\n  \"details\": \"appgate-6.0.0-28724-beta.img.zip\",\n  \"metadata\": {\n    \"imageUrl\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com:443/testsd/project/666/StratusImage_Build/release-6.0/artifact/appgate-6.0.0-28724-beta.img.zip?is-build-type-id\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n    \"imagePath\": \"/mnt/data/download/appgate-6.0.0-28724-beta.img.zip\"\n  }\n}"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Maybe the wipe needs to delete that file actually."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1651158998879
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "In the upgrade test we take a backup before doing the upgrade. After the upgrade is done we revert to the previous partition and restore from backup."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "On the next attempt to run the upgrade test configd thinks it already has downloaded the upgrade file and does nothing. The upgrade complete then fails with file not found. The problem is that the upgrade status is not cleared on restore (wipe?)."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1651159126228
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We need to check that is cleared on the filesystem but also in memory in the state value."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1651159151730
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Like you mentioned on slack "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "masaya.ando",
                                        "text": "@masaya.ando",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " its probably better to also do this when doing the \"switch to other partition\" part of the upgrade."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1651474483440
            }
        ]
    },
    {
        "key": "SA-20281",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Task description"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "To follow ZTP we should group the dependencies update in SDP "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "{\n  \"enabled\": true,\n  \"$schema\": \""
                        },
                        {
                            "type": "text",
                            "text": "https://docs.renovatebot.com/renovate-schema.json\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n  \"schedule\": [\"every weekend\"],\n  \"rebaseWhen\": \"conflicted\",\n  \"labels\": [\"dependencies\"],\n  \"separateMajorMinor\": false,\n  \"packageRules\": [\n    {\n      \"matchDepTypes\": [\"devDependencies\"],\n      \"matchUpdateTypes\": [\"minor\", \"patch\"],\n      \"groupName\": \"devDependencies\",\n      \"semanticCommitType\": \"chore\"\n    },\n    {\n      \"matchDepTypes\": [\"dependencies\"],\n      \"matchUpdateTypes\": [\"minor\", \"patch\"],\n      \"groupName\": \"dependencies\",\n      \"semanticCommitType\": \"chore\"\n    },\n    {\n      \"matchDepTypes\": [\"devDependencies\"],\n      \"matchUpdateTypes\": [\"major\"],\n      \"groupName\": \"devDependencies - Major\",\n      \"semanticCommitType\": \"chore\"\n    },\n    {\n      \"matchDepTypes\": [\"dependencies\"],\n      \"matchUpdateTypes\": [\"major\"],\n      \"groupName\": \"dependencies - Major\",\n      \"semanticCommitType\": \"chore\"\n    }\n  ]\n}"
                        }
                    ]
                },
                {
                    "type": "heading",
                    "content": [
                        {
                            "type": "text",
                            "text": "Definition of done"
                        }
                    ],
                    "attrs": {
                        "level": 2
                    }
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Renovate config is updated"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-20805",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image.png){width=70%} ![](image1.png)"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2022-12-02T13:57:00.836Z] Received: {\n  \"method\": \"app-update\",\n  \"params\": {\n    \"apps\": {\n      \"simple_setup_ENT_HTTP\": {\n        \"remedies\": [\n          {\n            \"method\": \"DisplayMessage\",\n            \"params\": {\n              \"message\": \"message\",\n              \"actionIdentifier\": \"954925130\"\n            },\n            \"active\": true\n          },\n          {\n            \"method\": \"Reason\",\n            \"params\": {\n              \"message\": \"Please provide a reason.\",\n              \"claimSuffix\": \"reason\",\n              \"actionIdentifier\": \"-934964597\"\n            },\n            \"active\": true\n          }\n        ],\n        \"status\": \"Remedy\",\n        \"appData\": {\n          \"name\": \"http\",\n          \"description\": \"\",\n          \"url\": \""
                        },
                        {
                            "type": "text",
                            "text": "http://10.97.129.67\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n          \"colorCode\": 8\n        },\n        \"appDatas\": [\n          {\n            \"name\": \"http\",\n            \"description\": \"\",\n            \"url\": \""
                        },
                        {
                            "type": "text",
                            "text": "http://10.97.129.67\""
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": "\n            \"colorCode\": 8\n          }\n        ],\n        \"displayName\": \"http\",\n        \"name\": \"http\"\n      }\n    }\n  },\n  \"jsonrpc\": \"2.0\"\n}"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I think we may have known about this but ignored in the past. Not sure. But it's probably fine to leave this to future."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "not sure if this is a client or gateway issue yet.. Need to think a bit :)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669989534229
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Probably a 6.2 fix. but let's discuss this next week "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "per.leino",
                                        "text": "@per.leino",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": ". We might need a new field to fix this."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669991856475
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Aha. its a OR with a displaymessage,..  and since client think a active display-message is a problem.. then there is a problem =)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1670225035324
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yeah, exactly. if we add the \"OR\" info to the message, then client can distinguish that and behave accordingly."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "but nothing important really. not a very likely scenario. So we can look at it when we're bored :)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1670231327645
            }
        ]
    },
    {
        "key": "SA-19837",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The result seems to always be 0."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "![](image.png)"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We are just passing on what nginx itself reports, you can see for yourself by running: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "root@purple80:/home/cz# curl "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9202/url_access/general_statistics"
                                },
                                {
                                    "type": "text",
                                    "text": "\nActive connections: 7 \nserver accepts handled requests\n 432903 432903 633296 \nReading: 0 Writing: 1 Waiting: 6 "
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1660207359228
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "gw"
                                },
                                {
                                    "type": "text",
                                    "text": "http",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "open"
                                },
                                {
                                    "type": "text",
                                    "text": "connection is a gauge, not a counter, so it can go up and down at any time. I would expect we would see the value go up on a busy server.",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1660207623609
            }
        ]
    },
    {
        "key": "SA-22026",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Tyron encountered a metrics aggregator bug where some appliances are connected but they are not getting scraped by the aggregatore. Restarting agentx on the client side fixes it."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This reminds me a lot of the old configd -> controller websocket issues we used to have, when the controller restarted and all appliances connected at once. I suspect some kind of race condition when many appliances connect at the same time, for example when initially setting up the aggregator or rebooting the aggregator."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Tyron also says some labels only appeared after restarting agentx, see here: ![](image.png){width=70%}"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1685620227953
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I attached the logs, 001 is the aggregator and 042 one of the appliance's whose metrics were missing."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1685620305606
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Could also be related to keepalive etc on websocket, see all the params we pass in configd "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/configd/configd/websocket/connector.py#LL344C1-L360C18",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-appliance/blob/master/configd/configd/websocket/connector.py#LL344C1-L360C18"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "                self._websocket = await self._session._ws_connect(\n                    self.url,\n                    headers={\"Accept\": ACCEPT_HEADER},\n                    # Timeout for websocket to close\n                    timeout=10.0,\n                    # Make sure to not get stuck in an infinite wait in case of a bug\n                    receive_timeout=30.0,\n                    # Answer pings from the controller with pongs automatically\n                    autoping=True,\n                    # Ping the controller after X seconds of inactivity\n                    heartbeat=30.0,\n                    # Messages like the token revocation list can get quite large\n                    max_msg_size=256 * 1024 * 1024,\n                    # Enable per-message compression on websocket,\n                    # zlib compression level between 9 and 15.\n                    compress=9,\n                )"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1685620572869
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "That's my initial theory, that the connection fell for some reason and the socket didn't notice yet\u2026 I have to check the logs though"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685620808550
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Do you know if the failure is temporary or permanent?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Does it skips some metrics and then they come back, or once it starts skipping, after 3 hours they're still missing?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685622876992
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "permanent it was like that since may 16."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1685623532809
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "oh ok. Not good at all then"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685623759479
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yeah, though at least there is a workaround of restarting agentx. But I suspect it will happen again on reboot/upgrade of the aggregator."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1685624335336
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The logs from the leaf appliance for agentx start when agentx got restarted. That appliance then connects to the aggregator and that's when it appears in the aggregator logs. Before then the aggregator didn't know anything about that appliance."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "But without prior logs of the leaf one it's difficult to know anything about the before status."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Do you have logs from any other appliance that was missing in the aggregator, where the logs go more back in time?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Anyway it could be a configd issue with configuration or agentx bug not attempting the connection for some reason or failing initially and never retrying\u2026 but without older logs it's difficult to know."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685688291843
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "-- Logs begin at Tue 2022-09-06 09:02:43 UTC, end at Fri 2023-06-02 11:24:09 UTC. --\n2023-05-26T13:37:14.786788+0000 cz-agentx[1077]: [WARNING] Connection to aggregator at sdplog-001.appgate.com failed Received message 8:1000 is not str. Triggering a reconnect after sleep 1\n2023-05-26T13:37:16.384472+0000 cz-agentx[1077]: [INFO] Connected to Prometheus aggregator at "
                                },
                                {
                                    "type": "text",
                                    "text": "https://sdplog-001.appgate.com:443/prometheus_aggregator"
                                },
                                {
                                    "type": "text",
                                    "text": "\n2023-05-27T02:19:17.680690+0000 cz-agentx[1077]: [WARNING] Connection to aggregator at sdplog-001.appgate.com failed Received message 8:1000 is not str. Triggering a reconnect after sleep 1\n2023-05-27T02:19:34.842559+0000 cz-agentx[1077]: [INFO] Connected to Prometheus aggregator at "
                                },
                                {
                                    "type": "text",
                                    "text": "https://sdplog-001.appgate.com:443/prometheus_aggregator"
                                },
                                {
                                    "type": "text",
                                    "text": "\n2023-05-27T02:22:02.680493+0000 cz-agentx[1077]: [WARNING] Connection to aggregator at sdplog-001.appgate.com failed Received message 8:1000 is not str. Triggering a reconnect after sleep 1\n2023-05-27T02:22:04.264849+0000 cz-agentx[1077]: [INFO] Connected to Prometheus aggregator at "
                                },
                                {
                                    "type": "text",
                                    "text": "https://sdplog-001.appgate.com:443/prometheus_aggregator"
                                },
                                {
                                    "type": "text",
                                    "text": "\n2023-05-27T02:27:09.729652+0000 cz-agentx[1077]: [WARNING] Connection to aggregator at sdplog-001.appgate.com failed Received message 8:1000 is not str. Triggering a reconnect after sleep 1\n2023-05-27T02:27:11.275830+0000 cz-agentx[1077]: [INFO] Connected to Prometheus aggregator at "
                                },
                                {
                                    "type": "text",
                                    "text": "https://sdplog-001.appgate.com:443/prometheus_aggregator"
                                },
                                {
                                    "type": "text",
                                    "text": "\n2023-06-02T09:01:18.988771+0000 cz-agentx[1077]: [WARNING] Connection to aggregator at sdplog-001.appgate.com failed Received message 257:None is not str. Triggering a reconnect after sleep 1\n2023-06-02T09:01:20.983539+0000 cz-agentx[1077]: [INFO] Connected to Prometheus aggregator at "
                                },
                                {
                                    "type": "text",
                                    "text": "https://sdplog-001.appgate.com:443/prometheus_aggregator"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685707729805
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It seems that occasionally it gets some strange data, then disconnects and reconnects. The last one is because agentx had gotten restarted on the other side. But that's over a period of several days, and it seems to reconnect immediately after."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685708483367
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "2023-06-02T10:12:36.756968+0000 cz-agentx[13152]: Error handling request\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]: Traceback (most recent call last):\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:   File \"/usr/lib/python3/dist-packages/aiohttp/web_protocol.py\", line 418, in start\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:     resp = await task\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:   File \"/usr/lib/python3/dist-packages/aiohttp/web_app.py\", line 458, in _handle\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:     resp = await handler(request)\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:   File \"/usr/lib/python3/dist-packages/agentx/webserver.py\", line 107, in websocket_handler\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:     await asyncio.wait_for(self._send_command(ws, cmd), 3)\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:   File \"/usr/lib/python3.8/asyncio/tasks.py\", line 494, in wait_for\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:     return fut.result()\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:   File \"/usr/lib/python3/dist-packages/agentx/webserver.py\", line 62, in _send_command\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:     end_marker = await ws.receive_str()\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:   File \"/usr/lib/python3/dist-packages/aiohttp/web_ws.py\", line 426, in receive_str\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]:     raise TypeError(\n2023-06-02T10:12:36.756968+0000 cz-agentx[13152]: TypeError: Received message 8:1000 is not WSMsgType.TEXT"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The strange messages also happen server side, but whenever they happen it seems that the connection is dropped and the peer just reconnects. I'm not sure which side is first being faulty."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685708641319
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So, "
                                },
                                {
                                    "type": "text",
                                    "text": "8:1000",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " is this library's way to say "
                                },
                                {
                                    "type": "text",
                                    "text": "CLOSE",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " and "
                                },
                                {
                                    "type": "text",
                                    "text": "257:None",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " means "
                                },
                                {
                                    "type": "text",
                                    "text": "CLOSED",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1685711159337
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "salvatore.tomaselli",
                                        "text": "@salvatore.tomaselli",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " what is happening here?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1686136901941
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "A workaround that should hopefully eliminate all complaints from Tyron is merged in 6.2, but we haven't tested it yet."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I'm trying to see if I can eliminate the root cause as well."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1686137150973
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So did we 'work around' or was 'the root cause fixed'?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1687184380659
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "That bug seems to be fixed. However Tyron found a different one too :D"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1687187385514
            }
        ]
    },
    {
        "key": "SA-21254",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "We will also need e2e tests for all 3 commands.\nWe have e2e tests for the existing commands already.\nSee "
                        },
                        {
                            "type": "text",
                            "text": "https://github.com/appgate-sdp-int/stratus-tests/tree/master/cases/appliance/remote_commands"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Very nice of you to have taken this "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "per.leino",
                                        "text": "@per.leino",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " ! Gratitude."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1680264913043
            }
        ]
    },
    {
        "key": "SA-19028",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Basically cache is always valid as long as the item is read. That is not a very good cache if you can never update it since there is no info about when it was added."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "anton.lundgren",
                                        "text": "@anton.lundgren",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " "
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "hadrien.luttiau",
                                        "text": "@hadrien.luttiau",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": " please don't do manual testing on policy engine cache yet as it might need a rewrite :D."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1651159345294
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Is there a way to make the cache by user vs global? Guess we can use the cache.\\\\ or so for that use case"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kurt.glazemakers",
                "created": 1651159663937
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yes, you can use "
                                },
                                {
                                    "type": "text",
                                    "text": "claims.user.username",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " as prefix for the cache name for that."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1651162043604
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "For Jamie. Available functions: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "cache.get(key, functionToGetIfItsNotInCache) // will pass 1 day validity\ncache.get(key, functionToGetIfItsNotInCache, validityDurationSeconds)\ncache.getIfPresent(key) // will return the cached value if it hasn't expired. Otherwise null\ncache.put(key, value) // will pass 1 day validity\ncache.put(key, value, validityDurationSeconds)"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "An example on how to get github IPs once a week "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "return cache.get('github IPs', \n                 () => JSON.parse(httpGet('"
                                },
                                {
                                    "type": "text",
                                    "text": "https://api.github.com/meta').data).api"
                                },
                                {
                                    "type": "text",
                                    "text": ","
                                },
                                {
                                    "type": "text",
                                    "text": "\n                 60 * 60 * 24 * 7);"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1651246980711
            }
        ]
    },
    {
        "key": "SA-20966",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1102000",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://got-testrail.agi.appgate.com/index.php?/plans/view/1102000"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " "
                        },
                        {
                            "type": "text",
                            "text": "https://got-teamcity.agi.appgate.com/buildConfiguration/QaBuildConfigurations",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://got-teamcity.agi.appgate.com/buildConfiguration/QaBuildConfigurations"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "EndToEnd",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "E2eTestyOsxRunner/737130?hideProblemsFromDependencies=false&hideTestsFromDependencies=false&expandBuildChangesSection=true"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "you can see it keeps trying to reach helvetest at the end "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[16:47:26]W:\t [Step 1/1] [testy-end2end] HTTP error when reporting to helvetest at "
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com/testsd/executions/507ce503-4123-42fa-a1da-9b6d3fc0b3ad/running-testplan/finished-testcase"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " expected http status 202but got 404, will retry\n[16:47:37]W:\t [Step 1/1] [testy-end2end] HTTP error when reporting to helvetest at "
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com/testsd/executions/507ce503-4123-42fa-a1da-9b6d3fc0b3ad/running-testplan/finished-testcase"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " expected http status 202but got 404, will retry\n[16:47:37]W:\t [Step 1/1] [testy-end2end] Dropping reporting event to helvetest after multiple retries "
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com/testsd/executions/507ce503-4123-42fa-a1da-9b6d3fc0b3ad/running-testplan/finished-testcase"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " with message: {\"module_name\": \"headless_client/cert_auth\", \"actual_tags\": [\"HeadlessClient\", \"57345885\"], \"start_time\": \"2022-12-22T15:45:22,392264Z\", \"running_time\": 57.244816, \"exception_string\": \"401: {\\\"id\\\":\\\"unauthorized\\\",\\\"message\\\":\\\"Credentials are required to access this resource.\\\"}\", \"stack_trace\": [\"  File \\\"/usr/local/Cellar/python@3.9/3.9.9/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\\\", line 532, in __exit__\\n    raise exc_details[1]\\n\", \"  File \\\"/usr/local/Cellar/python@3.9/3.9.9/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\\\", line 517, in __exit__\\n    if cb(*exc_details):\\n\", \"  File \\\"/usr/local/Cellar/python@3.9/3.9.9/Frameworks/Python.framework/Versions/3.9/lib/python3.9/contextlib.py\\\", line 405, in _exit_wrapper\\n    callback(*args, **kwds)\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/admin/admin.py\\\", line 353, in tear_down\\n    self.appliances.revert()\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/admin/resource.py\\\", line 397, in revert\\n    self.put(appliance_id, appliance)\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/admin/resource.py\\\", line 352, in put\\n    return super().put(element_id, body, timeout=timeout)\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/admin/resource.py\\\", line 92, in put\\n    r = self.rest_client.put(f'{self.base_uri}/{element_id}', body, timeout=timeout)\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/rest/rest.py\\\", line 180, in put\\n    return self.__request('PUT', path, headers=headers, body=body, timeout=timeout or self.timeout)\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/rest/rest.py\\\", line 155, in __request\\n    return self.__prepare_response(r)\\n\", \"  File \\\"/tmp/cz-stratus-tests/stratus/rest/rest.py\\\", line 115, in __prepare_response\\n    raise BadResponseException(status_code=r.status, content=content)\\n\"], \"time\": \"2022-12-22T15:46:19,637080Z\", \"status\": \"FAILED\", \"test_id\": \"6666\", \"test_uuid\": \"507ce503-4123-42fa-a1da-9b6d3fc0b3ad\", \"suite_id\": \"1102001\", \"case_id\": \"57345885\", \"ident\": \"testy\", \"purpose\": \"headless\"}\n[16:47:37]W:\t [Step 1/1] [testy-end2end] HTTP error when reporting to helvetest at "
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com/testsd/executions/507ce503-4123-42fa-a1da-9b6d3fc0b3ad/running-testplan/finished-testcase"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " expected http status 202but got 404, will retry\n[16:47:38]W:\t [Step 1/1] [testy-end2end] HTTP error when reporting to helvetest at "
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com/testsd/executions/507ce503-4123-42fa-a1da-9b6d3fc0b3ad/running-testplan/finished-testcase"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " expected http status 202but got 404, will retry\n[16:47:40]W:\t [Step 1/1] [testy-end2end] HTTP error when reporting to helvetest at "
                        },
                        {
                            "type": "text",
                            "text": "https://got-helvetest.agi.appgate.com/testsd/executions/507ce503-4123-42fa-a1da-9b6d3fc0b3ad/running-testplan/finished-testcase"
                        },
                        {
                            "type": "text",
                            "text": ","
                        },
                        {
                            "type": "text",
                            "text": " expected http status 202but got 404, will retry"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I killed the agent later because we have a single macOS test agent and I wanted to run another test."
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-19578",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "appgate_logs-2022-06-28.zip",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "appgate_logs-2022-06-28.zip"
                                    }
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "What change didn't it detect?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1656419185296
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Tested with 6.0 client on macOS and it works for me. So how was this tested? How did they change the proxy setting? We set and check the one set with"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": " networksetup -getautoproxyurl ..."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "so if any other setting was used/changed then it works as designed..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1656445192271
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Here is the moooooovie."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1656510398781
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "it was very short"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1656518494950
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "well it was too big for YT to upload :-("
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1656573776095
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Repeated same procedure as in video and it works for me"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1656587620642
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Jim waited 7 mins and it did not fix itself."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1656927158612
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yeah there is nothing in his logs about detecting the change, so that matches"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1656928447857
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "What next?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1656928598718
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Ignore until I am back in August? It's a minor (as in works for me) issue for a best-effort feature."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1656929769893
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Please collect what "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "'/Library/Application Support/AppGate/osx/set_proxy' "
                                },
                                {
                                    "type": "text",
                                    "text": "https://pac.menlosecurity.com/menlosecurity-285ef47e1252/jag1-wpad.dat"
                                },
                                {
                                    "type": "text",
                                    "text": " verify"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": " says when run after the proxy setting has been changed in the network connections. All assuming the pac URL is the same ofc..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1657052416498
            }
        ]
    },
    {
        "key": "SA-23002",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "It is not needed anymore since bdr does not use pglogical now. "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "root@purple10:/home/cz# cz-dbs pg cli\nRunning:  /usr/bin/sudo --preserve-env=HOME,TERM,PYTHONPATH -u postgres python3 -W ignore -m pgcli.main -p 443 -h /run/cz-dbd/dbd-current controller\nServer: PostgreSQL 14.10 (Ubuntu 14.10-0ubuntu0.22.04.2)\nVersion: 3.3.1\nHome: "
                        },
                        {
                            "type": "text",
                            "text": "http://pgcli.com"
                        },
                        {
                            "type": "text",
                            "text": "\ncontroller> \\dn\n+-----------+----------+\n| Name      | Owner    |\n|-----------+----------|\n| bdr       | postgres |\n| pglogical | postgres |\n| public    | postgres |\n+-----------+----------+\nSELECT 3\nTime: 0.024s"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "These statements need to be filtered from the dumped SQL: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "\n--\n-- Name: pglogical; Type: SCHEMA; Schema: -; Owner: postgres\n--\n\nCREATE SCHEMA pglogical;\n\n\nALTER SCHEMA pglogical OWNER TO postgres;\n\n--\n-- Name: pglogical; Type: EXTENSION; Schema: -; Owner: -\n--\n\nCREATE EXTENSION IF NOT EXISTS pglogical WITH SCHEMA pglogical;\n\n\n--\n-- Name: EXTENSION pglogical; Type: COMMENT; Schema: -; Owner: \n--\n\nCOMMENT ON EXTENSION pglogical IS 'PostgreSQL Logical Replication';"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1704188746292
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Hmm I think removing pglogical schema should be done in the future once we don't support upgrades from versions running a BDR older than 4.0."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1704201093990
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "For reference I had added this during database migration: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "async def drop_pglogical_schema(connectable: Connectable) -> None:\n    async with ensure_connection(connectable) as conn:\n        await conn.execute(\"drop schema if exists pglogical cascade\")\n\n@dataclass\nclass RemovePGLogicalSchemaAction(AsyncAction):\n    \"\"\"\n    pglogical was dropped as a dependency for BDR 4+.\n    We need to clean up its leftover schema.\n    \"\"\"\n\n    cluster: PostgresCluster = field(repr=False)\n\n    async def arun(self) -> ActionResult:\n        try:\n            self.log.info(\"Dropping pglogical schema\")\n            await drop_pglogical_schema(self.cluster)\n        except Exception as e:\n            raise DbdTransitionError(\"Failed to drop pglogical schema\") from e\n        return None\n\n@@ -574,6 +575,7 @@ def handle_migrate_database_transition_in_bdr_ready_or_database_ready(\n        [\n            MigrateDatabaseAction(),\n            AlterControllerDatabaseOwner(cluster=state.value.cluster),\n+           RemovePGLogicalSchemaAction(cluster=state.value.cluster),\n        ]"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1704201213714
            }
        ]
    },
    {
        "key": "SA-21176",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "\"profile_settings\":{\"enabled\":true,\"profiles\":[{\"name\":\"Test Copy\",\"controller_url\":\""
                        },
                        {
                            "type": "text",
                            "text": "https://sdp-controllers.sdpfederal.com\",\"ca_finger_print\":\"8fd37c09b5481c01ad5cc512a06c4b17c4c3bc5841eb25b95529d54b239d3175\",\"spa_name\":\"test-copy\",\"spa_key\":\"dcceea399f3f538eab99c58137296faaa64ccf7064570b6b00c9ef4624b8a2f8\",\"identity_provider_name\":\"local\"}]"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "It should probably only the names, not the whole object."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Docs needs update: authorization"
                                },
                                {
                                    "type": "text",
                                    "text": "succeeded event will need a change for push profile feature. It used to be called \"profile",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "settings\", now is \"pushed"
                                },
                                {
                                    "type": "text",
                                    "text": "profile",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "names\"."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1676380356020
            }
        ]
    },
    {
        "key": "SA-20008",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This should explain why the upgrade failed: "
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2022-09-06T13:45:03+02:00] Preparing image on appliances:\n \u2a2f controller2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: idle - \n \u2a2f controller3-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: idle - \n \u2a2f controller-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: idle - \n \u2713 gateway1-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: ready\n \u2713 gateway2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: ready\n3 errors occurred:\n\t* Upgrade failed on controller-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1 - \n\t* Upgrade failed on controller3-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1 - \n\t* Upgrade failed on controller2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1 - "
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "full log: "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "thomas@thomas-xps13:~/Projects/stratus-appliance/configd$ aitorbot env upgrade --appliance-branch release-6.0 --yes --backend sdpctl bc54fbf0-53e7-4f14-9b40-0f0013c0728b\nFound appliance image url "
                                },
                                {
                                    "type": "text",
                                    "text": "https://lhr-artifacts.agi.appgate.com/project/7/StratusImage_Build/release-6.0//artifact/appgate-6.0.2-30189-beta.img.zip?is-build-type-id=true"
                                },
                                {
                                    "type": "text",
                                    "text": "\nUpgrading environment bc54fbf0-53e7-4f14-9b40-0f0013c0728b\nDownloading ca cert from controller...\n/usr/lib/python3/dist-packages/urllib3/connectionpool.py:1015: InsecureRequestWarning: Unverified HTTPS request is being made to host 'envy-10-97-136-2.devops'. Adding certificate verification is strongly advised. See: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings"
                                },
                                {
                                    "type": "text",
                                    "text": "\n  warnings.warn(\nDownloading latest sdpctl from teamcity ...\nUsing cached sdpctl_linux_amd64 into /tmp/tmpo6g5l6zi/sdpctl_linux_amd64\n\nPREPARE SUMMARY\n\n1. Upload upgrade image appgate-6.0.2-30189-beta.img.zip to Controller\n2. Prepare upgrade on the following appliances:\n\nAppliance                                                 Online    Current version    Prepare version\n---------                                                 ------    ---------------    ---------------\ncontroller2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1    \u2713         5.5.8+30107        6.0.2-beta+30189\ncontroller3-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1    \u2713         5.5.8+30107        6.0.2-beta+30189\ncontroller-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1     \u2713         5.5.8+30107        6.0.2-beta+30189\ngateway1-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1       \u2713         5.5.8+30107        6.0.2-beta+30189\ngateway2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1       \u2713         5.5.8+30107        6.0.2-beta+30189\n\n\n3. Delete upgrade image from Controller\n\n\n[2022-09-06T13:45:03+02:00] Preparing image on appliances:\n \u2a2f controller2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: idle - \n \u2a2f controller3-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: idle - \n \u2a2f controller-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: idle - \n \u2713 gateway1-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: ready\n \u2713 gateway2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1: ready\n3 errors occurred:\n\t* Upgrade failed on controller-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1 - \n\t* Upgrade failed on controller3-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1 - \n\t* Upgrade failed on controller2-bc54fbf0-53e7-4f14-9b40-0f0013c0728b-site1 - "
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1662466663698
            }
        ]
    },
    {
        "key": "SA-20736",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "2022-11-25T10:11:23.706315+0000 cz-webclient@9019[4075]: [2022-11-25T10:11:23.706Z] Error : Error occurred on SAML authentication: System.IndexOutOfRangeException: Index was outside the bounds of the array.\n2022-11-25T10:11:23.706315+0000 cz-webclient@9019[4075]:    at Shared.Client.Service.OidcService.Execute(String methodName, Object contract, HttpHeaderDictionary headers) in /home/appgate/cabf95aa4bca1f9d/src/client/Shared/Client/Service/OidcService.cs:line 35\n2022-11-25T10:11:23.706315+0000 cz-webclient@9019[4075]:    at Shared.Communication.Rest.Server.ServerExecutor.Execute(HttpRequest request) in /home/appgate/cabf95aa4bca1f9d/src/client/Shared/Communication/Rest/Server/ServerExecutor.cs:line 55\n2022-11-25T10:11:23.706315+0000 cz-webclient@9019[4075]:    at Shared.Http.Server.HttpServerConnection.Process() in /home/appgate/cabf95aa4bca1f9d/src/client/Shared/Http/Server/HttpServerConnection.cs:line 45"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "[cz-webclient"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "9019.log",
                                "text": "@9019.log",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "](cz-webclient"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "9019.log",
                                "text": "@9019.log",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": ")"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Before that, there is this log; so that might be the trigger point. "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Warn : OIDC request failed: BadRequest - {\"error\":\"invalid_grant\",\"error_description\":\"AADSTS700084: The refresh token was issued to a single page app (SPA), and therefore has a fixed, limited lifetime of 1.00:00:00, which cannot be extended. It is now expired and a new sign in request must be sent by the SPA to the sign in page. The token was issued on 2022-11-23T09:36:37.0732822Z.\\r\\nTrace ID: e88eca10-0565-447a-ad11-468af157d600\\r\\nCorrelation ID: 8aaedb47-c954-4c35-8b0d-1af7c00dee2f\\r\\nTimestamp: 2022-11-25 10:11:21Z\",\"error_codes\":[700084],\"timestamp\":\"2022-11-25 10:11:21Z\",\"trace_id\":\"e88eca10-0565-447a-ad11-468af157d600\",\"correlation_id\":\"8aaedb47-c954-4c35-8b0d-1af7c00dee2f\",\"error_uri\":\""
                                },
                                {
                                    "type": "text",
                                    "text": "https://login.microsoftonline.com/error?code=700084\"}"
                                },
                                {
                                    "type": "text",
                                    "text": "."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669371762342
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "No, I tried again by removing my settings (refresh token) and it's still the same."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669371966036
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It happens on a fresh portal env and OKTA too. So looks like a generic problem somehow."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669383372265
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Seems to be a webd change that escapes "
                                },
                                {
                                    "type": "text",
                                    "text": "?",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " in "
                                },
                                {
                                    "type": "text",
                                    "text": "/oidc?code=brOUP_8Fbr9TjQ2-KXtaKUhT7zoPs4uqM18_gfqEuZE&state=client",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " proved by this revert "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.com/appgate-sdp-int/stratus-appliance/pull/6204",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-appliance/pull/6204"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1669385814939
            }
        ]
    }
]