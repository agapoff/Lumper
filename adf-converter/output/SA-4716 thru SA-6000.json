[
    {
        "key": "SA-5804",
        "description": {
            "version": 1,
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Else it can't download appliance upgrades from the cryptzone download center."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "See "
                        },
                        {
                            "type": "text",
                            "text": "https://askubuntu.com/questions/920156/curl-unable-to-obtain-local-certificate-on-ubuntu",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://askubuntu.com/questions/920156/curl-unable-to-obtain-local-certificate-on-ubuntu"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "  wget -P /tmp/ -nv https://www.digicert.com/CACerts/DigiCertSHA2SecureServerCA.crt\n  openssl x509 -in /tmp/DigiCertSHA2SecureServerCA.crt -inform DER \\\n               -out /tmp/DigiCertSHA2SecureServerCA.pem -outform PEM\n  sudo cp -uv /tmp/DigiCertSHA2SecureServerCA.pem /etc/ssl/certs\n  sudo c_rehash"
                        }
                    ]
                }
            ]
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "And I assume this magic is being done to 3.2.1?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1502457581029
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yes"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1502457681048
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "omg :D"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1502462459922
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1392",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1392"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1502695964433
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Thomas Cellerier",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                                                "title": "thomas.cellerier"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " Can you do this retrospectively to an existing appliance?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1502699600905
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "hmmm yeah by running the code in the link at the top. It will disappear after a reboot though."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1502701995355
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As a reminder, here is why ubuntu doesn't want the cert in by default "
                                },
                                {
                                    "type": "text",
                                    "text": "https://bugs.launchpad.net/ubuntu/+source/ca-certificates/+bug/1700757",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://bugs.launchpad.net/ubuntu/+source/ca-certificates/+bug/1700757"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1502714407770
            }
        ]
    },
    {
        "key": "SA-5774",
        "description": {
            "version": 1,
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Sometimes teamcity build step fails before it can start with this:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[15:03:56][Step 1/1] ['C:\\\\Program Files\\\\Python35\\\\python.exe', '-m', 'testy', '-r', 'console', 'end2end', '--test-root', 'C:\\\\users\\\\admin\\\\artifacts\\\\cz-stratus-tests\\\\cases', '--scenario-root', 'C:\\\\users\\\\admin\\\\artifacts\\\\cz-stratus-tests\\\\scenarios', '--shared-settings', 'C:\\\\users\\\\admin\\\\artifacts\\\\cz-stratus-tests\\\\shared_settings', '--log-level', 'STREAM', '--scenario', 'simple', '-p', 'reporting.end2end.purpose=commit', 'reporting.end2end.test-plan-id=6666', 'reporting.end2end.cases-by-run=284993:16505594/41740281/42699718/10128/10129/10131/867625/10347;284994:867662/867663/27752253/6129266;284995:847076/847077', 'reporting.end2end.testyd-report-url=https://testyd.ad.cryptzone.com/testsd/', 'reporting.end2end.test-execution-uuid=13b8b3e2-8ddf-402b-bfcd-6844164d0722', '--tags', '16505594', '41740281', '42699718', '10128', '10129', '10131', '867625', '10347', '867662', '867663', '27752253', '6129266', '847076', '847077']\n[15:03:56][Step 1/1] Exception found: ¡Madre puta! testy exited with error code: 2"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I've seen it a few times already and not sure what error code 2 is, so.."
                        }
                    ]
                }
            ]
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://testrail.ad.cryptzone.com/index.php?/plans/view/284992",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://testrail.ad.cryptzone.com/index.php?/plans/view/284992"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1501858912505
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "[15:03:56][Step 1/1] Running: net start W32Time\n[15:03:56][Step 1/1] The requested service has already been started.\n[15:03:56][Step 1/1]\n[15:03:56][Step 1/1] More help is available by typing NET HELPMSG 2182.\n[15:03:56][Step 1/1] "
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Could this be related?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Do we have any more examples?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "aitor.iturri",
                "created": 1502717068966
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "no, I think that happens every time. probably should be cleaned, but not related."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1502717188505
            },
            {
                "body": {
                    "type": "doc",
                    "version": 1,
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "In that example (and seems that also in this one "
                                },
                                {
                                    "type": "text",
                                    "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=202968&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner&tab=buildLog&_focus=399",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=202968&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyAndroidRunner&tab=buildLog&_focus=399"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ") "
                                },
                                {
                                    "type": "text",
                                    "text": "testy",
                                    "marks": [
                                        {
                                            "type": "strong"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " tries to start a service that it's running and then it fails with error 2 (first problem). After that aitorbot tries to upload logs (maybe we should not try it there) and to finish the test which fails because testy did not report any change."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think that we should fix 2 things:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "1 The reason why testy fails"
                                },
                                {
                                    "type": "hardBreak"
                                },
                                {
                                    "type": "text",
                                    "text": "2 To destroy the test instead of finishing it in that case, then the environment/test will be destroyed/archived"
                                }
                            ]
                        }
                    ]
                },
                "author": "aitor.iturri",
                "created": 1502717629327
            }
        ]
    },
    {
        "key": "SA-5767",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Associated to the –image-url IMAGE\\"
                        },
                        {
                            "type": "text",
                            "text": "URL option we need to be able specify optional username:password so for instance we can upgrade from a secured source such as ",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "https://www.cryptzone.com/downloadcenter/appgate",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://www.cryptzone.com/downloadcenter/appgate"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Currently the script just times out with Upgrade Failed and leaves the Controllers in non HA and running the old version."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Tried using ["
                        },
                        {
                            "type": "text",
                            "text": "https://user",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://user"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": ":pass[@download]........]("
                        },
                        {
                            "type": "text",
                            "text": "https://user",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://user"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": ":"
                        },
                        {
                            "type": "text",
                            "text": "pass"
                        },
                        {
                            "type": "mention",
                            "attrs": {
                                "id": "download",
                                "text": "@download",
                                "accessLevel": ""
                            }
                        },
                        {
                            "type": "text",
                            "text": "........). and it failed the same way."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I will test against "
                                },
                                {
                                    "type": "text",
                                    "text": "https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1502451138491
            },
            {
                "body": {
                    "version": 1,
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Actually basic auth in the URL works, the issue is the certificate on our download website isn't valid according to the ubuntu CA store."
                                },
                                {
                                    "type": "hardBreak"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "In [3]: requests.get('https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip')\nSSLError: (\"bad handshake: Error([('SSL routines', 'ssl3_get_server_certificate', 'certificate verify failed')],)\",)\n\nIn [4]: requests.get('https://download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip', verify=False)\nOut[4]: <Response [401]>\n\nIn [8]: requests.get('<https://cz-ag:<password> redacted>@download.cryptzone.com/files/download/AppGate-3.2.0/bin/AppGate-3.2.0.img.zip', verify=False)"
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "attrs": {
                                "level": 1
                            },
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Works"
                                }
                            ]
                        }
                    ]
                },
                "author": "thomas.cellerier",
                "created": 1502451839159
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Cert is missing from the Appliance build............."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1502454735267
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "And I guess we need to document this."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1502457743234
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Thomas Cellerier",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                                                "title": "thomas.cellerier"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " So will the syntax ["
                                },
                                {
                                    "type": "text",
                                    "text": "https://user",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://user"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":pass[@download].......]("
                                },
                                {
                                    "type": "text",
                                    "text": "https://user",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://user"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":"
                                },
                                {
                                    "type": "text",
                                    "text": "pass"
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "download",
                                        "text": "@download",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": ".......). now work? If so I should document this."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1502699505477
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yes it works."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1502702542911
            }
        ]
    },
    {
        "key": "SA-5681",
        "description": {
            "version": 1,
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I tried both with the built-in key and with a new key, giving the full URL to the client."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Proxyd showed this"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Jul 17 09:44:31 envy-172-17-122-1.devops cz-proxyd: [M 7f6a66e9bc00] spa_yaml_parse(): key with name \"Built-in-be85360895242\" will be used\nJul 17 09:44:31 envy-172-17-122-1.devops cz-proxyd: [M 7f6a66e9bc00] spa_yaml_parse(): key with name \"pinocammino\" will be used"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "(pinocammino is the other key I had created)."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "On the client I get"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "jul 17 12:03:34 salvo-VirtualBox Main[12566]: AppGate Service: Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://envy-172-17-122-1.devops/' has failed. Details: Connection failed."
                        }
                    ]
                }
            ]
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Known issue. We broke SPA compatibility on 3.2."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "3.1 client should work with 3.2 controller (TCP) though."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1500286194640
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Gah, change the test text accordingly then! :D"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1500286304730
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "What should this test be testing then? "
                                },
                                {
                                    "type": "text",
                                    "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/44216746",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/44216746"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1500286340793
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "disable SPA, test the rest of the stuff."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We don't have any process to update the texts as that would take huge time for us. Volunteers like you should ;)."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1500286534744
            }
        ]
    },
    {
        "key": "SA-5585",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Connecting to purple, with SPA. SPA passes but then nginx refuses the certificate apparently."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The UI, never shows the window to accept the certificate fingerprint, like it used to do last week."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "There is a known issue with corrupt gnome keyring, which we managed to fix by removing the login keyring file manually. but not installed shouldn't trigger that as libsecret should be able to figure that out."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499174252782
            },
            {
                "body": {
                    "version": 1,
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "lug 04 14:13:20 mongibello AppGate[26483]: Debug - [ApplicationContext - LogFunction:66] SHIM: '0x7f4c1c2b50a0: SSL_connect, ssl_error=5, error:00000005:lib(0):func(0):DH lib verify_result=1'\nlug 04 14:13:20 mongibello AppGate[26483]: Debug - [ApplicationContext - LogFunction:66] SHIM: '0x7f4c1c2b50a0: write(connect) failed'\nlug 04 14:13:20 mongibello AppGate[26483]: Debug - [ApplicationContext - LogFunction:66] SHIM: '0x7f4c1c2a5040: failed to connect: 3'"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "According to the logs, it fails to verify the certificate. No CA certificate should be supplied to SHIM at this point."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Only happens Salvatore's machine atm."
                                }
                            ]
                        }
                    ]
                },
                "author": "natan.abolafya",
                "created": 1499176522573
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "you can bet some guy in rackspace doesn't have gnome-keyring, the guy even asked to support KDE's kwallet on that call…"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499176779544
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I don't believe this issue is related to gnome-keyring. The problem occurs before gnome-keyring is utilized."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499176914841
            },
            {
                "body": {
                    "type": "doc",
                    "version": 1,
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Having seen \"ssl_error=5\", thought it may be related to the 5 we receive when certificate doesn't match the hostname. That prints a different log, namely:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "2017-07-04T14:00:08.616Z Debug - [ApplicationContext - LogFunction:66] SHIM: '0538F020: certificate host/ip mismatch (test.envy/172.17.112.1)'\n2017-07-04T14:00:08.618Z Debug - [ApplicationContext - LogFunction:66] SHIM: '0591B440: failed to connect: 5'\n2017-07-04T14:00:08.618Z Debug - [ApplicationContext - LogFunction:66] SHIM: '0538F020: write(connect) failed'"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": []
                        }
                    ]
                },
                "author": "natan.abolafya",
                "created": 1499176979152
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "uninstalled my gnome-keyring. It works."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Though when I restart the client, it doesn't anymore because spa key is not stored anywhere. But that's a different issue."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499179789939
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "[Per Allansson]("
                                },
                                {
                                    "type": "text",
                                    "text": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " \"per.allansson\") what do you need from "
                                },
                                {
                                    "type": "text",
                                    "text": "Salvatore Tomaselli",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                                                "title": "salvatore.tomaselli"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " tcp dump again?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499243035352
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "one that includes all packets :)"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "tcpdump -s 0 -w packets.dump -i <ethX> host <gatewayip> and port 443"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499244129290
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I have the same one i took yesterday."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499244346416
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "but the one from yesterday didn't contain the return traffic from the gateway"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499244544954
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I had just set to capture \"any\" on wireshark… I can take it again"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499244594491
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "wireshark has issues sometimes capturing, especially when on any"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499246938827
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "some text"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499249081531
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Thanks. There are a lot of SSL connects there that are closed down immediately after the client sends the first HELLO packet. Are we sure there are no interesting logs in nginx as to why this happens?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499280651085
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Right that's what the ticket says..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499280683667
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The thing is, there is no certificate sent in first Client Hello so it doesn't make sense that server complains about it."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499280972385
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I have no access to purple logs :)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499327979260
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "let me know when you want to watch live logs and we can gather somewhere."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499329242762
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "try with this client:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "["
                                },
                                {
                                    "type": "text",
                                    "text": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient\\",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient\\"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "Linux/193712",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":id/appgate\\_3.2.0-7037-2067\\_amd64.deb]("
                                },
                                {
                                    "type": "text",
                                    "text": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient_Linux/193712",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://teamcity.ad.cryptzone.com/repository/download/StratusClient_Linux/193712"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":"
                                },
                                {
                                    "type": "text",
                                    "text": "id/appgate"
                                },
                                {
                                    "type": "text",
                                    "text": "3.2.0-7037-2067",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "amd64.deb)"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "and do touch /tmp/shimdebug2 before starting it - shim will then debug log to /tmp/shimdebug.log which you can copy to this support case"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1499331548997
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "By the way keyring is unrelated. I installed it and still had the same issue."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499345338536
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It works fine connecting to my own env."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499355035540
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Hm, sooo some news, it works ONLY if my env allows the predefined SPA key, once I delete it, I am no longer able to login. Both TCP or UDP."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499356524990
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We made some tests with "
                                },
                                {
                                    "type": "text",
                                    "text": "Natan Abolafya",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                                                "title": "natan.abolafya"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ". It seems that deleting the config+pasting the URL in the client seems to mostly work, while clicking on the link seems to always fail."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "After one of these failures, the client will ALWAYS fail to connect to an SPA with a custom key, whatever you do."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499432919561
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Another thing we saw is that, after failing with the built-in key, he copies the full url and presses sign in. What we see on proxyd is that SPA succeeds for the first time and then the client proceeds to reconnect (retrieve certificate and verify it), which fails with proxyd saying \"it's Built-in key, and I don't know anything about it\"."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This does not happen when we clear the config, start appgate and enter the full url using copy paste (something fishy with clicking the URL..)."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Which makes me think of this far fetch suspicion: Salvatore rebuilds stuff for Debian, missing some details, which leads to some memory problems in shim/spa implementation where it ends up reusing the old setting somehow."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499443415064
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "That's a build log from my machine."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499673004361
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Kosmas Valianos",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/kosmas.valianos",
                                                "title": "kosmas.valianos"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " could you take a look at the last comments and make up theories? :D"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499673182067
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Post the logs allan requested as well."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "do touch /tmp/shimdebug2 before starting it - shim will then debug log to /tmp/shimdebug.log which you can copy to this support case"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It's the only way to get the shim logs"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "(latest client shall be enable to do this. No need to use the client PR)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499675366017
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It causes the client to crash, there is a conversation on the client channel."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499675979161
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Try this. I tried right now and worked fine for me! While on beta branch:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "git pull\n\nsudo make clean\n\n./make-linux.sh ipt\n\nsudo chown -R kosmas:kosmas /opt/appgate/\n\ncp src/client/Lib/libcryptzone\\_ssl.so /opt/appgate/service/\n\ntouch /tmp/shimdebug2\n\nless +F /tmp/shimdebug.log"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Start AppGate client after that. I am able to see shim logs live like that (Ubuntu 16.04)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499676882597
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "(This is very useful if you want to edit something in the cryptzone\\"
                                },
                                {
                                    "type": "text",
                                    "text": "ssl.c in the stupid debug\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "init() to make your OS log (in case it still crashes for X reason for your OS)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499677193997
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "sudo chown -R kosmas:kosmas /opt/appgate/\n\ncp src/client/Lib/libcryptzone\\_ssl.so /opt/appgate/service/"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "or better yet, "
                                },
                                {
                                    "type": "text",
                                    "text": "sudo cp",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " :P"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499678695551
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Hm how to put this… it's kinda working today. But only if I paste the link instead of clicking on it."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "If I click on it then it fails and after failure, pasting will never work."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Natan Abolafya",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                                                "title": "natan.abolafya"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " could this be related to the fact that I change /etc/machine-id every day? (personal workaround to avoid the annoying onboarding failure)."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499679830633
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "or better yet, sudo cp :P"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "old remains when the log path was in that path which is root owned instead of the /tmp ;)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499680231223
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "could this be related to the fact that I change /etc/machine-id every day? (personal workaround to avoid the annoying onboarding failure)."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "no, but"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "[^image.png]"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499680423306
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "That's the \"magic\" log"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "1499679628: spa\\_encrypt(): Setting the psk's name: \"CryptZone\""
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Some of them say build-in!!! Correlate which key is used when, depending to what you do. Clicking the link or copy paste or whatevah you do."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499680426045
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Names should be self explicative."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499689797511
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The just paste has at the end 2 times:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "1499689581: spa\\"
                                },
                                {
                                    "type": "text",
                                    "text": "encrypt(): Setting the psk's name: \"CryptZone\"",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "the click on link NEVER has that. Only build in so click on link does not work then ?!"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The click on link plus paste bla the same"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499690378805
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So it looks the proper params are not passed to the internals from the what the user is actually entering."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499690670679
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Maybe some quoting is needed in the .desktop file? I can try :)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499690826483
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "there might be two issues here:"
                                }
                            ]
                        },
                        {
                            "type": "bulletList",
                            "content": [
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "  clicking the link only takes the hostname part not the whole thing (probably)"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "  spa config getting lost at some point (this is what we should focus first I think)"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499691003284
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "clicking the link only takes the hostname part not the whole thing (probably)"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Nope. The process gets launched with the correct command line."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "/opt/appgate/AppGate --url=appgate://purple.cryptzone.com/eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoiQ3J5cHRab25lIiwia2V5IjoiY2QzMzdiMmE1OTU1Yjg3OTk3YzlkYzRjNGRhZTM1ZDRmNTA1ZTE0ZmZhZWU3NWFlZjVhZDZhZjQ1M2M5ODgyOCJ9fQ=="
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499691335118
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok. weird as there is nothing platform specific how we handle the url received. unless you have some buggy mono or something which would be a really buggy one."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499691494679
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2093",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2093"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "here is a PR with better logs with detailed SPA info, so we can isolate the issue better. "
                                },
                                {
                                    "type": "text",
                                    "text": "Salvatore Tomaselli",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                                                "title": "salvatore.tomaselli"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " please test with this and paste the logs."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499781358782
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This is what happened."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499784867129
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The logs posted are shim. I think natan wants the business logic logs as this is what the PR changed"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "btw the click link thing is definitely broken. This file has not a single custom key. All of them report \"Built-in-be85360895242\""
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499787119637
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "asd"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499787495567
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Well here for sure a crystal clear problem. Client C# part reverts back to the build-in... (after the warning issues?!)."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'.\nlug 11 16:50:46 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\nlug 11 16:50:57 mongibello AppGate[18774]: Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\nlug 11 16:50:57 mongibello AppGate[18774]: Info - [LoginHandler - Start] User input required for 'ControllerUrlLoginHandler'.\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Received a new URL config from user. Parsing..\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [UrlFormatter - ParseUrlConfig] URL config parsed. SPA mode: UdpTcp, Name: CryptZone\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://purple.cryptzone.com/'.\nlug 11 16:51:13 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [UrlLookup - Lookup] Resolving hostname 'purple.cryptzone.com'\nlug 11 16:51:13 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'CryptZone'.\nlug 11 16:51:15 mongibello AppGate[18774]: Info - [ControllerFetcherFactory - CreateControllerFetcher] Using Controller API V4\nlug 11 16:51:15 mongibello AppGate[18774]: Info - [UrlLookup - Lookup] Resolving hostname 'purple.cryptzone.com'\nlug 11 16:51:15 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'CryptZone'.\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [ControllerFetcherFactory - CreateControllerFetcher] Using Controller API V4\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Storing new SPA config.\nlug 11 16:51:16 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:16 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://purple.cryptzone.com/'.\nlug 11 16:51:16 mongibello AppGate[18774]: <warning> failed when retrieveing secret service: 'The name org.freedesktop.secrets was not provided by any .service files'\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [UrlLookup - Lookup] Resolving hostname 'purple.cryptzone.com'\nlug 11 16:51:16 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\nlug 11 16:51:26 mongibello AppGate[18774]: Info - [OpenSslSocket - Connect] Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "A second issue is that the click link looks definitely broken in the tomaselian logs. The latest click\\"
                                },
                                {
                                    "type": "text",
                                    "text": "link.bz2 file has not a single \"custom key\". All of them report \"Built-in-be85360895242\"",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1499845584621
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yeah, if you continue, there are ones with 'Cryptzone' and they seemed to work. As I can't correlate the timestamps when you clicked, when you pasted to the logs; can't say much about that."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499847827201
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I made different files for when I just pasted, just clicked or both. When I did both, I tried once clicking, waited, then pasted. Shouldn't it be deterministic?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499850741182
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "those are only the shim logs. I need the service logs. Lemme know when I can watch you do it and check the logs at the same time."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499852415785
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "mind blowing.. After "
                                },
                                {
                                    "type": "text",
                                    "text": "\"Storing new SPA config.\"",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ", it should just go to certificate trust stuff. But instead it goes back to setting url for some reason? what the hell."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499861865682
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "maybe your window system (and electron) is trolling us and somehow clicks \"Sign in\" twice which triggers this issue somehow.."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "could you enable debug logs and trigger the issue please?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "~/.config/appgatexdp-service/user.settingsInfo -> Debug",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499862994535
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "asd"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1499873156617
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "wtf, I can see the full url reaches the mono service when you click actually. But disappears at some point? This is so weird."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "As for the other scenario, I can see this:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Debug - [LoginHandler - Finish:179] Finish handler with new state 'TrustCertificate'"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "but then it moves on to SetControllerUrl again for some reason. And I think it thinks it's in auto-login session:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Debug - [LoginHandler - AutoLogin:96] Task could not complete on autologin"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "And this makes no sense whatsoever. Sounds like a super far-fetch bug triggered by only you. I'm off till Monday. Maybe "
                                },
                                {
                                    "type": "text",
                                    "text": "Petter Gustafsson",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/petter.gustafsson",
                                                "title": "petter.gustafsson"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " can make some sense. Bug him if he has time, otherwise we can continue on Monday :)."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "P.S."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Another thing that's different on your env is locale btw. May be relevant."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1499876738331
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I will take a look :)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "petter.gustafsson",
                "created": 1499932408002
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2103",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2103"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "this may have fixed the problem. Salvatore, could you try again?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1500466613954
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "No difference."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1500471097774
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Issue is still there btw"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1507037041351
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Kosmas has the same issue on Ubuntu, so it's really not a magic thing that only happens for me. He uses ubuntu."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1511778282944
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yeah, last time I tried by clicking on appgate://hostname/base64\\"
                                },
                                {
                                    "type": "text",
                                    "text": "data the AppGate client indeed started but the base64 data were not used. I thought there is a task specifically for this problem but I cannot find it atm. Maybe I just whined in slack but didn't make a task",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1511778389011
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Kosmas, can you retry and post the logs?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1511778463216
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Actually it was in my laptop so will try again there and post the logs"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1511791280406
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok, my problem is in Windows 10 actually when I click the link from the mail app. URL with base64 mess. Created a task for it [SA-6721](SA-6721). but "
                                },
                                {
                                    "type": "text",
                                    "text": "Salvatore Tomaselli",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                                                "title": "salvatore.tomaselli"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " check if it is actually similar/same issue"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "[2017-11-27T21:27:26.284Z] Info : UI has connected to service.\n[2017-11-27T21:27:26.448Z] Info : UI is ready.\n[2017-11-27T21:27:26.449Z] Info : UI connected.\n[2017-11-27T21:27:26.457Z] Info : Connecting to TUN driver.\n[2017-11-27T21:27:26.461Z] Info : Setting log level of TUN driver to Info.\n[2017-11-27T21:27:26.477Z] Info : Setting locale to en-US.\n[2017-11-27T21:27:26.531Z] Info : Received a URL config from storage. Parsing..\n[2017-11-27T21:27:26.533Z] Warn : Invalid URL config received. Invalid length for a Base-64 char array or string.. config: eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoiQ3J5cHRab25lIiwia2V5IjoiY2QzMzdiMmE1OTU1Yjg3OTk3YzlkYzRjNGRhZTM1ZDRmNTA1ZTE0ZmZhZWU3NWFlZjVhZDZhZjQ1M2M5ODgyOCJ9fQ\n[2017-11-27T21:27:26.534Z] Info : Setting controller URL to 'https://purple.cryptzone.com/'.\n[2017-11-27T21:27:26.544Z] Info : CA certificate found in the storage for 'purple.cryptzone.com'.\n[2017-11-27T21:27:26.548Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-11-27T21:27:26.634Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.209Z] Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.519Z] Error : First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\n[2017-11-27T21:27:27.523Z] Info : User input required for 'ControllerUrlLoginHandler'."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1511820014524
            }
        ]
    },
    {
        "key": "SA-5521",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Typical IPv6 environment creation with aitorbot"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Entering URL: "
                        },
                        {
                            "type": "text",
                            "text": "envy-fd00-ffff-a-300-172-17-300-1.devops",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " and clicking NEXT => Connection failed"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Logs from business logic",
                            "marks": [
                                {
                                    "type": "strong"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "2017-06-28T11:27:58.931Z Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/'.\n2017-06-28T11:27:58.931Z Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\n2017-06-28T11:27:58.932Z Info - [OpenSslSocket - Connect] Trying to connect using IP address 'fd00:ffff:a:300::1'.\n2017-06-28T11:27:58.932Z Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/' has failed. Details: Connection failed."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "tun-service is not used as it is early in the flow. No logs there"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "sudo tcpdump -n ip6",
                            "marks": [
                                {
                                    "type": "strong"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "tcpdump does not show any DNS requests/SSL packets so it feels no packets are being send ?!"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "IPv6 settings on the Mac same as another machine [Windows 10 VM] which has been verified it can connect to the environment"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Gateway: fd00:ffff:a:60::254\n\nIPv6: fd00:ffff:a:60:192:168:111:153\n\nPrefix Length: 64\n\nDNS 1: fd00:ffff:a:40:172:17:40:9\n\nDNS 2: fd00:ffff:a:40:172:17:40:8"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": " nslookup can resolve the "
                        },
                        {
                            "type": "text",
                            "text": "envy-fd00-ffff-a-300-172-17-300-1.devops",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " in a proper IPv6 address and pinging a fellow IPv6 workstation and the office DNS servers/office Gateway worked fine so IPv6 settings are fine"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Per Allansson",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/per.allansson",
                                                "title": "per.allansson"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " could you try locally with your mac some time?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1498650715084
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "2017-06-29T11:29:08.756Z Info - [ControllerUrlLoginHandler - HandleInput] Setting controller URL to 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/'.\n2017-06-29T11:29:08.764Z Info - [CertificateConsumer - RetrieveCaCertificate] No CA certificate found in storage. Retrieving from controller.\n2017-06-29T11:29:08.770Z Info - [OpenSslSocket - Connect] Trying to connect using IP address 'fd00:ffff:a:300::1'.\n2017-06-29T11:29:08.771Z Error - [ControllerLogic - SetControllerUrl] First connection to controller 'https://envy-fd00-ffff-a-300-172-17-300-1.devops/' has failed. Details: Connection failed."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Accessing webui though at ["
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-fd00-ffff-a-300-172-17-300-1.devops",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://envy-fd00-ffff-a-300-172-17-300-1.devops"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":444]("
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-fd00-ffff-a-300-172-17-300-1.devops",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://envy-fd00-ffff-a-300-172-17-300-1.devops"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":"
                                },
                                {
                                    "type": "text",
                                    "text": "444) through a browser works, so it is definitely a problem what we saw for IPv6"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1498736617428
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "shim logs:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "1498741507: Connecting to envy-fd00-ffff-a-300-172-17-300-1.devops/fd00:ffff:a:300::1 ...\n\n1498741507: connect() failed for UDP socket: 65/No route to host"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": " so IPv6 + OS X + connect() in UDP socket = issue"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1498738163878
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2024",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2024"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1498747543439
            }
        ]
    },
    {
        "key": "SA-5383",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "For now there is only limited help:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "cz@envy-172-17-116-1:~$ which cz-upgrade\n/usr/sbin/cz-upgrade\ncz@envy-172-17-116-1:~$ cz-upgrade --help\nusage: cz-upgrade [-h] [--port PORT] [--device-id DEVICE_ID]\n                  [--username USERNAME] [--provider PROVIDER] [--no-verify]\n                  [--cacert CACERT] [--peer-api-version PEER_API_VERSION]\n                  --image-url IMAGE_URL [-y]\n                  hostname\n\npositional arguments:\n  hostname              AppGate Controller hostname or ip\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --port PORT           AppGate Controller admin port\n  --device-id DEVICE_ID\n  --username USERNAME\n  --provider PROVIDER\n  --no-verify           Do NOT verify the server certificate\n  --cacert CACERT       Path to CA cert file\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, will be auto-discovered\n                        if not set\n  --image-url IMAGE_URL\n                        Upgrade image url\n  -y, --yes             Batch mode, don't ask for confirmation"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This should include some instructions and examples."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The file is in the appliance repo under "
                        },
                        {
                            "type": "text",
                            "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/tree/master/stratus/upgrader",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/tree/master/stratus/upgrader"
                                    }
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Simple upgrade:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ ./cz-upgrade envy-172-17-134-1.devops --no-verify --image-url https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-3.1.1-5282-master.img.zip\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-134-1.devops:444\nPeer API version is 5\nAuthorizing\n\nUpgrade plan:\n\nUpgrade controller(s): controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\n\nUpgrade gateway(s): gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\n\nUpgrading controllers...\nStarting appliance upgrade for controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\nWaiting for appliances to come back online: controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 ...\nAppliance controller-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is online and in state single_controller_ready\n\nUpgrading gateways...\nStarting appliance upgrade for gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1\nWaiting for appliances to come back online: gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 ...\nAppliance gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is online and in state upgrading\nAppliance gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is now offline\nAppliance gateway-06033153-73ca-49ff-b8e5-d1e4a20c6be6-site1 is now online and in state appliance_ready\n\nUpgrade done!\nAll appliances are now running version 3.1.1-5282-master"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Multi-controller upgrade:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Discovering peer API version for https://envy-172-17-130-2.devops:444...\nPeer API version is 5\nAuthenticating to https://envy-172-17-130-2.devops:444...\nAuthorizing...\n\nUpgrade plan:\n1. Disable controller role on the following appliance(s): controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\n2. Upgrade first controller: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1\n3. Upgrade additional controllers: controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\n4. Enable controller role on the following appliance(s): controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\n5. Upgrade gateway(s): gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1\n\nWaiting for appliance(s) to come back online in state multi_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1, controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state multi_controller_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state multi_controller_ready\n\nDisabling controller on controller-7e60c460-22c0-4281-8c25-9314747ba800-site1...\nWaiting for appliance(s) to come back online in state single_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is offline and in state unknown\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now online and in state single_controller_ready\nWaiting for appliance(s) to come back online in state appliance_ready: controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state appliance_ready\n\nUpgrading controllers...\nStarting appliance upgrade for controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1\nWaiting for appliance(s) to come back online in state single_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state single_controller_ready\nStarting appliance upgrade for controller-7e60c460-22c0-4281-8c25-9314747ba800-site1\nWaiting for appliance(s) to come back online in state appliance_ready: controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state upgrading\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now offline\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now online and in state data_migration\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state appliance_ready\n\nEnabling controller on controller-7e60c460-22c0-4281-8c25-9314747ba800-site1...\nWaiting for appliance(s) to come back online in state multi_controller_ready: controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1, controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state single_controller_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state appliance_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state waiting_bdr_joining\nAppliance controller2-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state multi_controller_ready\nAppliance controller-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state multi_controller_ready\n\nUpgrading gateways...\nStarting appliance upgrade for gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1\nWaiting for appliance(s) to come back online in state appliance_ready: gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 ...\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is online and in state upgrading\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now offline\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now online and in state data_migration\nAppliance gateway-7e60c460-22c0-4281-8c25-9314747ba800-site1 is now in state appliance_ready\n\nUpgrade done!\nAll appliances are now running version 3.2.0-5439-master"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Example of setting password via env variable and user cancelling an upgrade:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ CZ_UPGRADE_PASSWORD=admin ./cz-upgrade --image-url http://blah:8080/thang envy-fd00-ffff-a-300-172-17-300-1.devops --no-verify\nDiscovering peer API version for https://envy-fd00-ffff-a-300-172-17-300-1.devops:444...\nPeer API version is 5\nAuthenticating to https://envy-fd00-ffff-a-300-172-17-300-1.devops:444...\nAuthorizing...\n\nUpgrade plan:\n\n1. Upgrade controller(s): envy-fd00-ffff-a-300-172-17-300-1_devops\n2. Upgrade gateway(s): gateway-151dbc56-feb7-421b-8004-ddff0be464d9-site1\n\nDo you want to continue [Y/n]? n\nUpgrade cancelled by user!"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1496313809529
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Example of a failed upgrade from upgrading purple:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ ./cz-upgrade purple10.cryptzone.com --cacert ca-cert-purple.pem --image-url https://s3.eu-central-1.amazonaws.com/appgate-appliance-upgrade-images/appgate-3.2.0-5447-master.img.zip\nDiscovering peer API version for https://purple10.cryptzone.com:444...\nPeer API version is 5\nEnter password for username admin and provider name local:\nAuthenticating to https://purple10.cryptzone.com:444...\nAuthorizing...\n\nUpgrade plan:\n\n1. Disable controller role on the following appliance(s): aws - purple11\n2. Upgrade first controller: aws - purple10\n3. Upgrade additional controllers: aws - purple11\n4. Enable controller role on the following appliance(s): aws - purple11\n5. Upgrade gateway(s): got - purple1\n6. Upgrade gateway(s): gce - purple30, azure - purple20, got - purple3, got - purplex, got - purple2\n\nDo you want to continue [y/N]? y\nWaiting for appliance(s) to come back online in state multi_controller_ready: aws - purple11, aws - purple10 ...\nAppliance aws - purple11 is online and in state multi_controller_ready\nAppliance aws - purple10 is online and in state multi_controller_ready\n\nDisabling controller on aws - purple11...\nWaiting for appliance(s) to come back online in state single_controller_ready: aws - purple10 ...\nAppliance aws - purple10 is offline and in state unknown\nAppliance aws - purple10 is now online and in state single_controller_ready\nWaiting for appliance(s) to come back online in state appliance_ready: aws - purple11 ...\nAppliance aws - purple11 is online and in state appliance_ready\n\nUpgrading controllers...\nStarting appliance upgrade for aws - purple10\nWaiting for appliance(s) to come back online in state single_controller_ready: aws - purple10 ...\nAppliance aws - purple10 is online and in state data_migration\nAppliance aws - purple10 is now in state cloud_initializing\nAppliance aws - purple10 is now in state single_controller_ready\nStarting appliance upgrade for aws - purple11\nWaiting for appliance(s) to come back online in state appliance_ready: aws - purple11 ...\nAppliance aws - purple11 is online and in state upgrading\nAppliance aws - purple11 is now offline\nUpgrade failed: Appliances [Appliance(name=\"aws - purple11\", peer_hostname=\"purple11.cryptzone.com\", role={'controller', 'gateway'}, site=06590afe-3eae-4437-aff6-523c06045103)] never came online in state appliance_ready!\n$ echo $?  # Script exit code is 0 on success, 1 on failure \n\n1"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1496396570157
            }
        ]
    },
    {
        "key": "SA-5348",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "May 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: [upgrade] Downloaded http://testyd.devops:6640/testyd/api/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appga\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: [upgrade] Deleting upgrade file: /mnt/data/download/appgate-3.2.0-5394-master.img.zip?is-build-type-id\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: [config-control] Failed to upgrade the appliance: Not an upgrade image file: /mnt/data/download/appgate-3.2.0-5394-master.img.zip?\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: Traceback (most recent call last):\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:   File \"/usr/cz-configd/configd/upgrade.py\", line 193, in upgrade_task\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:     upgrade(*args, next_state=next_state, **kwargs)\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:   File \"/usr/cz-configd/configd/upgrade.py\", line 144, in upgrade\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]:     raise UpgradeError('Not an upgrade image file: {}'.format(image_path))\nMay 26 12:33:46 envy-fd00-ffff-a-300-172-17-300-1.devops cz-configd[742]: configd.upgrade.UpgradeError: Not an upgrade image file: /mnt/data/download/appgate-3.2.0-5394-master.img.zip?is-build-type-id"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1259",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1259"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495802732770
            }
        ]
    },
    {
        "key": "SA-5328",
        "comments": [
            {
                "body": {
                    "version": 1,
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I had similar issues when initially testing xenial on virtualbox and added this hack:"
                                },
                                {
                                    "type": "hardBreak"
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/blob/master/initramfs/local-top/lvm2#L66-L68",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/blob/master/initramfs/local-top/lvm2#L66-L68"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Doesn't work without this for some reason\nSee https://bugs.launchpad.net/ubuntu/+source/lvm2/+bug/1573982\nvgchange -ay"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It never happened afterwards so forgot about it."
                                },
                                {
                                    "type": "hardBreak"
                                },
                                {
                                    "type": "text",
                                    "text": "The current issue seems related."
                                }
                            ]
                        }
                    ]
                },
                "author": "thomas.cellerier",
                "created": 1495528147726
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I had taken the \"fix\" from that comment on the linked issue:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "My workaround is as I explained in the issue description: I added a script in /etc/initramfs-tools/scripts/local-top/ folder which performs "
                                },
                                {
                                    "type": "text",
                                    "text": "vgchange -ay",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495528193817
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Adding this to the boot command line fixes it for some weird reason:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "scsi\\"
                                },
                                {
                                    "type": "text",
                                    "text": "mod.scan=sync",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Found here "
                                },
                                {
                                    "type": "text",
                                    "text": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=616689",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=616689"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495533153205
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "With that fix our patched initramfs/local-top/lvm2 can be removed to use the default one."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495533662844
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "With that fix our patched initramfs/local-top/lvm2 can be removed to use the default one."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Taking that back, doesn't work now."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495533845737
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Added this in local-top/lvm2 before vgchange:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "lvm vgscan --mknodes"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "And set this in etc/lvm/lvm.conf:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "use\\"
                                },
                                {
                                    "type": "text",
                                    "text": "lvmetad = 0",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495534819219
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1253",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1253"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495543931310
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The debian bug mentions that bug being fixed in initramfs-tools 0.119, however we are running 0.122:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "\\# dpkg --list|grep initramfs-tools ii initramfs-tools 0.122ubuntu8.8 all generic modular initramfs generator (automation) ii initramfs-tools-bin 0.122ubuntu8.8 amd64 binaries used by initramfs-tools ii initramfs-tools-core 0.122ubuntu8.8 all generic modular initramfs generator (core tools)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495552032116
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "maybe the actually problem is this with logic in the local-top/lvm script:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "    /dev/mapper/*)\n            eval $(dmsetup splitname --nameprefixes --noheadings --rows \"${dev#/dev/mapper/}\")\n            if [ \"$DM_VG_NAME\" ] && [ \"$DM_LV_NAME\" ]; then\n                    lvchange_activate \"$DM_VG_NAME/$DM_LV_NAME\"\n            fi\n            ;;\n    /dev/*/*)\n            # Could be /dev/VG/LV; use lvs to check\n            if lvm lvs -- \"$dev\" >/dev/null 2>&1; then\n                    lvchange_activate \"$dev\"\n            fi\n            ;;"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "for some reason its not matching our devices"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495552471818
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "root"
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "envy",
                                        "text": "@envy",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": "-172-17-136-2:~# dmsetup splitname --nameprefixes --noheadings --rows \"${dev#/dev/mapper/}\" DM\\"
                                },
                                {
                                    "type": "text",
                                    "text": "VG\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "NAME='' DM\\"
                                },
                                {
                                    "type": "text",
                                    "text": "LV\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "NAME='' DM\\"
                                },
                                {
                                    "type": "text",
                                    "text": "LV\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "LAYER=''"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495552489862
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "root"
                                },
                                {
                                    "type": "mention",
                                    "attrs": {
                                        "id": "envy",
                                        "text": "@envy",
                                        "accessLevel": ""
                                    }
                                },
                                {
                                    "type": "text",
                                    "text": "-172-17-136-2:~# lvm lvs – \"/dev/mapper/czvg\""
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "LV VG Attr LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "data czvg -wi-ao—- 23.75g"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "image1 czvg -wi-ao—- 2.00g"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "state1 czvg -wi-ao—- 1.00g"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1495552668715
            }
        ]
    },
    {
        "key": "SA-5222",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This means a client can impersonate an appliance and push audit logs."
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "location /ffwd {\n    if ($ssl_client_verify = NONE) {\n        return 401;\n    }\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_pass <http://127.0.0.1:9011;>\n}"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We need to go through all the appliance-appliance comms to make sure we always check DNs."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494323331223
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Same for ffwd:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "location /ffwd {\n    if ($ssl_client_verify = NONE) {\n        return 401;\n    }\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_pass <http://127.0.0.1:%(ffwd_server)d;>\n}"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Which means anybody can push AUDIT logs."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494323628248
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "False alarm for sessiond:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "location /sessions { if ($ssl\\"
                                },
                                {
                                    "type": "text",
                                    "text": "client\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "verify = NONE) { return 401; } if ($ssl\\"
                                },
                                {
                                    "type": "text",
                                    "text": "client\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "s\\"
                                },
                                {
                                    "type": "text",
                                    "text": "dn != \"/CN=AppGate XDP CA\") { return 401; } proxy\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:%(sessiond\\",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://127.0.0.1:%(sessiond\\"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "port)d/sessions; }",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494325293307
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "In [14]: requests.post('["
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-172-17-106-2.devops",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://envy-172-17-106-2.devops"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":444/sessions/revocations']("
                                },
                                {
                                    "type": "text",
                                    "text": "https://envy-172-17-106-2.devops",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://envy-172-17-106-2.devops"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ":"
                                },
                                {
                                    "type": "text",
                                    "text": "444/sessions/revocations'), cert=('cert.pem', 'key.pem'), verify='cacert.pem', data='LOL', headers={'Accept': 'application/vnd.cryptzone.peer-v4+json'}).text"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Out[14]: '<html>\\\\r\\\\n<head><title>401 Authorization Required</title></head>\\\\r\\\\n<body bgcolor=\"white\">\\\\r\\\\n<center><h1>401 Authorization Required</h1></center>\\\\r\\\\n<hr><center>nginx</center>\\\\r\\\\n</body>\\\\r\\\\n</html>\\\\r\\\\n'"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494325427210
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Well that sucks..."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "import websocket\nimport uuid\n\nserver = 'envy-172-17-106-1.devops'\nport = 514\nc = websocket.create_connection('wss://{}:444/ffwd/TCP/{}'.format(server, port), sslopt={'keyfile': 'key.pem', 'certfile': 'cert.pem', 'ca_certs': 'cacert.pem'}, header={'Accept': 'application/vnd.cryptzone.peer-v1+json'})\nc.send_binary('<%d>%s' % (0 + 3*8, 'testing testing!!! HACK ALERT!!! %s\\n' % str(uuid.uuid4())))\nc.close()"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494332772442
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "May 9 12{{COLON"
                                },
                                {
                                    "type": "text",
                                    "text": "NUM",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "26}}47 testing testing!!! HACK ALERT!!! 8f61f147-b2ca-46ba-8f40-fbdd9d74c239"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494332818963
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1201",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1201"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1494337242470
            }
        ]
    },
    {
        "key": "SA-4948",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Then you can press it many times and this log happens:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "2017-03-30T07:25:02.419Z Info - [IdentitityProviderLoginHandler - HandleInput] provider 'Cryptzone Inc. SAML' selected.\n2017-03-30T07:25:02.528Z Info - [LoginHandler - Start] Starting handler 'ConnectSamlLoginHandler'\n2017-03-30T07:25:03.632Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:03.636Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:03.636Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:03.750Z Info - [ConnectLoginHandler - TryLogin] Redirection to an external identity provider is received. URL: https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml\n2017-03-30T07:25:03.754Z Info - [SamlHandler - ListenToken] Starting HTTP Server to receive SAML token.\n2017-03-30T07:25:03.754Z Info - [SamlHandler - ListenToken] Starting the browser to https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml.\n2017-03-30T07:25:05.070Z Info - [SamlHandler - ListenToken] Received SAML token. Will send it to controller.\n2017-03-30T07:25:05.070Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:05.074Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:05.074Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:05.294Z Info - [ControllerLogic - HandlePostAuthentication] Authentication succeeded. Claims Token: [TokenId: acf8e40b-1405-4b3e-a8ac-2f63d0412a02, DistinguishedName: CN=3ea4534c93444931a91289f6606e6422,CN=natan.abolafya,OU=OKTA, FirstName: Natan, LastName: Abolafya, ExpirationTime: 2017-03-30 22:25:04], On-demand Claims: [[]], Custom Scripts: [[]]\n2017-03-30T07:25:05.450Z Info - [UntrustedClaimsHandler - RetriveNewUntrustedClaimsToken] Processing on-demand Claims: []\n2017-03-30T07:25:05.454Z Info - [ConnectLoginHandler - RetrieveEntitlementToken] Getting entitlement tokens for the first time.\n2017-03-30T07:25:05.454Z Info - [ControllerLogic - UpdateEntitlementToken] Retrieving new entitlement tokens.\n2017-03-30T07:25:06.458Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:06.458Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:06.458Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:06.534Z Info - [ControllerLogic - UpdateEntitlementToken] New 4 entitlement tokens retrieved.\n2017-03-30T07:25:06.542Z Info - [ConnectLoginHandler - UpdateVpnToken] Updating vpn certificate\n2017-03-30T07:25:06.542Z Info - [ControllerLogic - RetrieveVpnCertificate] No VPN certificate found in secure storage for CN=3ea4534c93444931a91289f6606e6422,CN=natan.abolafya,OU=OKTA. Generating a key-pair for a new one.\n2017-03-30T07:25:06.590Z Info - [ConnectLoginHandler - TryLogin] Redirection to an external identity provider is received. URL: https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml\n2017-03-30T07:25:06.590Z Info - [SamlHandler - ListenToken] Starting HTTP Server to receive SAML token.\n2017-03-30T07:25:06.594Z Info - [SamlHandler - ListenToken] Starting the browser to https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml.\n2017-03-30T07:25:07.277Z Info - [SamlHandler - ListenToken] Received SAML token. Will send it to controller.\n2017-03-30T07:25:07.281Z Info - [ConnectLoginHandler - TryLogin] Try to login using 'OKTA'\n2017-03-30T07:25:07.281Z Info - [ControllerLogic - TryLogin] Getting the first claims token.\n2017-03-30T07:25:07.281Z Info - [ControllerLogic - UpdateClaimsToken] Retrieving claims token.\n2017-03-30T07:25:07.489Z Info - [ControllerLogic - HandlePostAuthentication] Authentication succeeded. Claims Token: [TokenId: 8bfa011d-ca6a-4fcf-a4db-c7b6970bcd7f, DistinguishedName: "
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-4781",
        "description": {
            "version": 1,
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "We get "
                        },
                        {
                            "type": "text",
                            "text": "err_spdy_protocol_error",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " on some pages at random times: "
                        },
                        {
                            "type": "text",
                            "text": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=157664&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyWindowsRunner&tab=buildLog&state=33#_state=33&focus=5266",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://teamcity.ad.cryptzone.com/viewLog.html?buildId=157664&buildTypeId=QaBuildConfigurations_EndToEnd_E2eTestyWindowsRunner&tab=buildLog&state=33#_state=33&focus=5266"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "[Step 1/1]     2017-03-09T06:42:48,835774Z [STREAM] [admin_ui\\basic_test] [Admin UI Browser] [2017-03-09 07:41:47.498000] https://envy-172-17-100-1.devops:444/ui/bower_components/angular/angular.js - Failed to load resource: net::ERR_SPDY_PROTOCOL_ERROR",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "According to article: "
                        },
                        {
                            "type": "text",
                            "text": "https://ma.ttias.be/nginx-spdy-error-neterr_spdy_protocol_error/",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://ma.ttias.be/nginx-spdy-error-neterr_spdy_protocol_error/"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": " this can be due to "
                                        },
                                        {
                                            "type": "text",
                                            "text": "/usr/local/nginx/fastcgi_temp/",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "text",
                                            "text": " not having proper permissions which can be fixed by: "
                                        },
                                        {
                                            "type": "text",
                                            "text": "chown nginx:nginx /usr/local/nginx/fastcgi_temp/ -R",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": " can also be a space issue on appliance so temp dir is not writeable (no solution for this)."
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": " we can disable spdy in chrome in e2e tests via starting chrome with options: "
                                        },
                                        {
                                            "type": "text",
                                            "text": "--use-spdy=npn-http",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": []
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Spotted by "
                        },
                        {
                            "type": "text",
                            "text": "Hadrien Luttiau",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "http://got-youtrack.agi.appgate.com:8112/users/hadrien.luttiau"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": " & "
                        },
                        {
                            "type": "text",
                            "text": "Natan Abolafya",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya"
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    {
        "key": "SA-5988",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "good old "
                        },
                        {
                            "type": "text",
                            "text": "--extra-purposes",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "but I guess something like"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "aitorbot test create --purpose commit --purpose nightly",
                            "marks": [
                                {
                                    "type": "code"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "should be enough."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Use case: Nightly does not include commit tests because in most cases, commit tests are covered during the day; so no need to run them again."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "However, when I'm running Fedora nightly or IPv6 tests once a day, I want both nightly tests and commit tests at once, because there is no IPv6 hourly test."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I cannot seem to get this working.."
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "G:\\Code\\stratus-client-shared\\src\\ui>aitorbot test create --purpose runme --purpose commit\nCreating a multipurpose test, we will query aitorbot for the test case ids now\n¡Cojones! POST /executions HTTP 400: Errors on client input: Some of the tests cases provided could not be resolved.\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test create --purpose nightly --purpose commit\nCreating a multipurpose test, we will query aitorbot for the test case ids now\n¡Joder! POST /executions HTTP 400: Errors on client input: Some of the tests cases provided could not be resolved.\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test purposes\nusage: main.py test purposes [-h] [--project-id PROJECT_ID]\n                                 {list,cases} ...\nmain.py test purposes: error: the following arguments are required: purposescmd\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test purposes list\namazon amazondebug ax-e ax-s azure backuprestore commit controllerha dont care esxi gce ha headless highavail lrt nightly nightly-candidate nousage physical physical-candidate runme template test-debug ui upgrade\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot test create --purpose nightly --purpose commit --client windows\nCreating a multipurpose test, we will query aitorbot for the test case ids now\n¡Madre puta! POST /executions HTTP 400: Errors on client input: Some of the tests cases provided could not be resolved.\n\nG:\\Code\\stratus-client-shared\\src\\ui>aitorbot version\n4.1.46"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Aitor Iturri",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/aitor.iturri",
                                                "title": "aitor.iturri"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1507307667103
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/testyd/pull/422",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/testyd/pull/422"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "❯ ./scripts/aitorbot test create --purpose commit --purpose runme\nCreating a multipurpose test, we will query aitorbot for the test case ids now\neof:\n        id:   c7966b8e-61db-40e3-905e-9ba90ead1234\n        url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/320642"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "aitor.iturri",
                "created": 1507635441653
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "works great"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1507798320898
            }
        ]
    },
    {
        "key": "SA-5917",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Example usage from tyron:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": " cz-upgrade --username tyronturner --provider local --cacert c:\\tmp\\AppGate_CA.der --image-url https://cz-ag:passwd@download.cryptzone.com/files/download/AppGate-3.2.1/bin/AppGate-3.2.1.img.zip hqxdpc01.cryptzone.com hqxdpc01.cryptzone.com"
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "There seems to be a python stdlib function for that "
                        },
                        {
                            "type": "text",
                            "text": "https://docs.python.org/3/library/ssl.html#ssl.DER\\_cert\\_to\\_PEM\\_cert",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://docs.python.org/3/library/ssl.html#ssl.DER_cert_to_PEM_cert"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "So we could support it without adding any additional requirements."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1429/files",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1429/files"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1503995583803
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "For docs: the –cacert argument now accepts either a DER format certificate or a PEM format ceritificate."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1504860033711
            }
        ]
    },
    {
        "key": "SA-5909",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The user may think OTP was actually accepted. Really weird."
                        }
                    ]
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  Setup controller and initiate OTP remedy on the client."
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  ssh to controller, kill identityd "
                                        },
                                        {
                                            "type": "text",
                                            "text": "sudo service cz-identityd stop",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  enter OTP"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  Remedy card disappears with the following logs:"
                                        }
                                    ]
                                },
                                {
                                    "type": "codeBlock",
                                    "attrs": {},
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "[2017-08-25T14:38:07.034Z] Info : Sending OTP pin to controller. [ClaimSuffix: 'a', ProviderId: '03542d1e-733c-4c43-a567-d28fbc4649a7', State: '']\n[2017-08-25T14:38:07.053Z] Info : Existing REST connection lost. Reconnecting.\n[2017-08-25T14:38:07.054Z] Info : Resolving hostname 'envy-172-17-102-1.devops'\n[2017-08-25T14:38:07.058Z] Info : Trying to connect 'envy-172-17-102-1.devops/172.17.102.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-08-25T14:38:08.100Z] Info : REST connection could not be established. 'Internal Server Error'. Will try the next IP address.\n[2017-08-25T14:38:08.103Z] Info : Initializing OTP seed for 03542d1e-733c-4c43-a567-d28fbc4649a7\n[2017-08-25T14:38:08.106Z] Info : Resolving hostname 'envy-172-17-102-1.devops'\n[2017-08-25T14:38:08.109Z] Info : Trying to connect 'envy-172-17-102-1.devops/172.17.102.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-08-25T14:38:09.139Z] Info : REST connection could not be established. 'Internal Server Error'. Will try the next IP address.\n[2017-08-25T14:38:09.142Z] Error : Request to controller 'https://envy-172-17-102-1.devops/' during OTP initialization has been rejected. Reason: (HTTP 500) Internal Server Error\n[2017-08-25T14:38:09.145Z] Info : Otp Action with message 'aa' has been cancelled by the user."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "not sure why we even try to initialize OTP again in this scenario."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1503672388258
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok, initialization happens because of lack of parantheses on non-radius case. but for radius case, the problem persists."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1503673085164
            }
        ]
    },
    {
        "key": "SA-5860",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Be it envy, teamcity, testrail or github."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Right now teamcity down gives something like that:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "thomas@thomas:~$ aitorbot env create --scenario controller_ha\n¡Madre puta! POST /executions HTTP 502: <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">\n\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">\n    <head>\n        <title>The page is temporarily unavailable</title>\n        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n        <style type=\"text/css\">\n            /<![CDATA[/\n            body {\n[...]"
                        }
                    ]
                }
            ],
            "version": 1
        }
    }
]