[
    {
        "key": "SA-7484",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  Occasional UI freezes"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  cant click it to see the status in ios"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  it messes up onboarding cookie somehow after failure(s)"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  on-boarding cookie issues."
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  saml screen doesn't show"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "does not support token renewals properly"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1520429537046
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "it messes up onboarding cookie somehow after failure(s)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1520440687581
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "saml screen doesn't show"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1520512073783
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Mar  8 13:26:45 Cryptzones-iPad iOSClient[560] <Notice>: [2018-03-08T12:26:45.401Z] Info : Starting HTTP Server to receive SAML token.\nMar  8 13:26:45 Cryptzones-iPad iOSClient[560] <Notice>: [2018-03-08T12:26:45.404Z] Info : Starting the browser to https://dev-764072.oktapreview.com/app/cryptzonedev764072_cryptzonetest_1/exk67telgvNxuVCid0h7/sso/saml.\nMar  8 13:26:45 Cryptzones-iPad iOSClient(WebKit)[560] <Notice>: 0x1c00deca0 - UIProcess is taking a background assertion because a page load started\nMar  8 13:26:45 Cryptzones-iPad iOSClient(WebKit)[560] <Notice>: 0x136d0de18 - UIProcess is taking a foreground assertion because the view is visible\nMar  8 13:26:45 Cryptzones-iPad iOSClient(UIKit)[560] <Error>: Unable to simultaneously satisfy constraints.\nMar  8 13:26:45 Cryptzones-iPad iOSClient(UIKit)[560] <Error>: Unable to simultaneously satisfy constraints.\nMar  8 13:27:15 Cryptzones-iPad mediaserverd(AudioToolbox)[25] <Notice>: 1171: pid 560(iOSClient)\nMar  8 13:27:20 Cryptzones-iPad iOSClient(UIKit)[560] <Notice>: XPC connection interrupted\nMar  8 13:27:31 Cryptzones-iPad ReportCrash[563] <Notice>: Formulating report for corpse[560] iOSClient"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1520512641251
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "3.3.3 client seems to work, still. A 4.0 client built with 3.3.3 shim+packettunnel is just as bad as the plain 4.0 version."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1520512784004
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Per Allansson [14:01]"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "client built from "
                                },
                                {
                                    "type": "text",
                                    "text": "3a7e6b70fb36519455b615617526020dfa764fa9",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.com/appgate-sdp-int/stratus-logging/commit/3a7e6b70fb36519455b615617526020dfa764fa9"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " (Jan 12) works"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Per Allansson [14:08]"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "client built from 7b8bed5 (PR 2729 ios autorotate) doesn't work "
                                },
                                {
                                    "type": "text",
                                    "text": ":slightly\\_smiling\\_face:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Silvercast Nguyen [14:09]"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "yup, the blocking mainthread is due to webview view manipulating"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1520515017252
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "client built from b875612a (PR 2675 iOS native nav) doesn't work (edited)"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "client built from 9a12f359f - PR merge before b875612a - works"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "so it's PR 2675 that is the breaker"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1520516889593
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Here is a fix/improvement for when we keep getting token renewals from GW, but UI is napping -"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "eventually the packettunnel extension will run out of memory: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2790",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2790"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1520593015503
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2791",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2791"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " this is a fix for napping UI. Other UI issues will be solved in the same PR."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "silvercast.nguyen",
                "created": 1520594079323
            }
        ]
    },
    {
        "key": "SA-7402",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Client was happy sending SPA-UDP and using the custom key i.e. it was using the custom URL with the settings. After I upgraded to latest master I couldn't connect to controller anymore. I noticed in the logs that the client was trying to reach the controller using the default settings i.e. with the build-in key. It has lost the URL with the settings. I had to reseed it"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Platform, distribution etc."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1519652694189
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Ubuntu LTS 16.04"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1519652845062
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Some logs after the upgrade and when the build-in key started being used"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "feb 26 13:42:19 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-b3:38:b7:f3:e8:82:d9:37:63:3f:13:61:36:a0:ff:99:e8:81:ea:53:04:1d:28:75:b4\nfeb 26 13:42:19 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-15:f9:bc:22:13:3e:ba:0a:91:b2:e0:8e:e9:0e:89:a4:e7:91:ff:b5:39:f5:fc:c1:7a\nfeb 26 13:42:19 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-a7:3a:62:12:61:3f:f4:01:bd:5d:02:93:3f:36:6c:c8:e4:e3:46:8b:79:0a:9e:54:60\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : Renaming key '$OnBoardingCookie-f3:85:48:6a:4a:08:37:30:85:1d:25:55:dc:24:bb:df:78:c5:ba:e4:67:75:95:fb:ac\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : Running as user 'kosmas'.\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : Process starting.\nfeb 26 13:42:20 kosmas-VirtualBox appgate-sdp[14568]: Info : ApplicationVersion: 4.0.0-10024-master\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : UI has connected to service.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : UI is ready.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : UI connected.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Connecting to TUN driver.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting locale to en-US.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting log level of TUN driver to Info.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting controller URL to 'https://purple.cryptzone.com/'.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : CA certificate found in the storage for 'purple.cryptzone.com'.\nfeb 26 13:42:21 kosmas-VirtualBox appgate-sdp[14568]: Info : Resolving hostname 'purple.cryptzone.com'\nfeb 26 13:42:22 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be853608952\nfeb 26 13:42:32 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be853608952\nfeb 26 13:42:42 kosmas-VirtualBox appgate-sdp[14568]: Error : First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\nfeb 26 13:42:42 kosmas-VirtualBox appgate-sdp[14568]: Info : User input required for 'ControllerUrlLoginHandler'.\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : Setting controller URL to 'https://purple.cryptzone.com/'.\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : CA certificate found in the storage for 'purple.cryptzone.com'.\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : Resolving hostname 'purple.cryptzone.com'\nfeb 26 13:42:47 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be853608952\nfeb 26 13:42:58 kosmas-VirtualBox appgate-sdp[14568]: Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be853608952"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1519653438202
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2758",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2758"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "silvercast.nguyen",
                "created": 1519738461009
            }
        ]
    },
    {
        "key": "SA-7396",
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "feb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Controller password update for controller : L5aURZIq15;I5:A\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] UUID update for gateway : 4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:42:57 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] UUID update for endpoint : 4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1\nfeb 23 10:42:57 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Initializing Terraform: /opt/envy/terraform init\nfeb 23 10:42:57 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Exec, dir:/var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:42:57 envy envy[12019]: [golang-sh]$ /opt/envy/terraform init\nfeb 23 10:42:58 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Execute : /var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:42:58 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Exec, dir:/var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:42:58 envy envy[12019]: [golang-sh]$ /opt/envy/terraform apply\nfeb 23 10:43:12 envy envy[12019]: 23/Feb/2018:10:43:12 +0100 404 121μs \"GET /env/82c7c4ac-bada-4b6c-97cb-d5f9c4331540 HTTP/1.0\" - \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ch\nfeb 23 10:43:12 envy envy[12019]: 23/Feb/2018:10:43:12 +0100 404 45μs \"GET /favicon.ico HTTP/1.0\" - \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.3\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: s:[]json.InterfaceJson(nil), Hostname:\"\", ApiUsername:\"\", ApiPassword:\"\", SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string(nil), Healthchec\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: controller status: Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Starting to provision : controller\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: gateway status: Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Starting to provision : gateway\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: endpoint status: Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Starting to provision : endpoint\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Using default controller api username\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Using default controller api password\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller provisioning dispatched for controller\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] Could not establish a connection (SSH) to the controller. Unable to find the path to the private key: No priva\nfeb 23 10:44:01 envy envy[12019]: Will try connecting using password authentication.\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Provisioning dispatched for gateway\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Waiting for controller to be ready\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller status is Ready for provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Endpoint provisioning finished!\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: ssword:\"\", SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string{\"172.17.106.1\"}, Healthchecks:[]*status.NodeStatusInfoHealthcheck(nil), Provide\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller username update for controller : admin\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Controller password update for controller : admin\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]:  SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string{\"172.17.106.1\"}, Healthchecks:[]*status.NodeStatusInfoHealthcheck(nil), Provider:\"vsphere\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: controller status: Provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]:  SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string{\"172.17.106.1\"}, Healthchecks:[]*status.NodeStatusInfoHealthcheck(nil), Provider:\"vsphere\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: n{Ip:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0xac, 0x11, 0x69, 0x0}, Network:(*net.IPNet)(0xc4219ee630), NetworkString:\"172.17.105.0/24\"}}},\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: gateway status: Provisioning\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:01 envy envy[12019]: [Master][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][INFO] Status update for: endpoint status: Running\nfeb 23 10:44:01 envy envy[12019]: Verification error: &url.Error{Op:\"Get\", URL:\"https://172.17.106.1:444/appliance/status\", Err:(*net.OpError)(0xc420472fa0)}\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] Controller is down\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] Verify service failed The controller service is down\nfeb 23 10:44:01 envy envy[12019]: [Controller][33e883a2-d802-4dcc-8cf3-faa6fa84b83d][WARNING] HealthCheck of controller failed The controller service is down\nfeb 23 10:44:07 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Adding new status listener\nfeb 23 10:44:08 envy envy[12019]: [Restserver][WARNING] Unable to send on websocket\nfeb 23 10:44:08 envy envy[12019]: 23/Feb/2018:10:44:07 +0100 0 489512μs \"GET /env/ws/4ac34bc0-8b53-4d9e-8189-b1cf31df8253 HTTP/1.0\" - \"wCS/1.0\"\nfeb 23 10:44:08 envy envy[12019]: 23/Feb/2018:10:44:07 +0100 200 274μs \"GET /env/4ac34bc0-8b53-4d9e-8189-b1cf31df8253 HTTP/1.0\" - \"http4s-blaze/0.15.11a\"\nfeb 23 10:44:08 envy envy[12019]: [Restserver][INFO] Sending interrupt to masterHandler : 4ac34bc0-8b53-4d9e-8189-b1cf31df8253\nfeb 23 10:44:08 envy envy[12019]: 23/Feb/2018:10:44:08 +0100 0 72μs \"DELETE /env/4ac34bc0-8b53-4d9e-8189-b1cf31df8253 HTTP/1.0\" - \"http4s-blaze/0.15.11a\"\nfeb 23 10:44:08 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Trying to destroy an environment...\nfeb 23 10:44:08 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][INFO] Executing the Terraform destroy command\nfeb 23 10:44:08 envy envy[12019]: [AwsHandler][4ac34bc0-8b53-4d9e-8189-b1cf31df8253-site1][DEBUG] Exec, dir:/var/opt/envy/storage/4ac34bc0-8b53-4d9e-8189-b1cf31df8253/4ac34bc0-8b53-4d9e-8189-b1cf31df8253-\nfeb 23 10:44:08 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][DEBUG] Received a master channel communication: channels.Communication{Request:\"nodeStatusUpdate\", Payload:status.NodeStatu\nfeb 23 10:44:08 envy envy[12019]: e:\"\", ApiUsername:\"\", ApiPassword:\"\", SshKey:\"\", SshKeyPath:\"\", LogLevels:map[string]interface {}(nil)}, Ips:[]string(nil), Healthchecks:[]*status.NodeStatusInfoHealthche\nfeb 23 10:44:08 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][INFO] Status update for: controller status: Destroying\nfeb 23 10:44:08 envy envy[12019]: [Master][4ac34bc0-8b53-4d9e-8189-b1cf31df8253][INFO] Status update for: gateway status: Destroying"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1519638964941
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I can’t reproduce the issue via create->destroy->create but.."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "My env ‘disappeared’ during weekend so I tried creating one first thing in the morning and started getting "
                                },
                                {
                                    "type": "text",
                                    "text": "Error occured",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " every time. Don't know what happened during the weekend."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Edit: can repro via create->destroy->create cycle again.. but my disappearing env during weekend remains a mystery.."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "teoman.soygul",
                "created": 1519641665082
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/envy/pull/221",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/envy/pull/221"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " this should do it.."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.leino",
                "created": 1519911636849
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "noice"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "teoman.soygul",
                "created": 1519915507319
            }
        ]
    },
    {
        "key": "SA-7380",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "For example to resize an AWS or Azure instance."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Adding support for extending an existing volume in cz-resize-data "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1894",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1894"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519308827579
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Installing part probe in appliances "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1895",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1895"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519308841779
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Here is a walk through on resizing an AWS instance:"
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "In the AWS console"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "orderedList",
                            "content": [
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Take a snapshot of the instance's volume."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Stop the instance."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Click on the instance, block devices, and click on the volume link, for example "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "vol-062fd64977435e526",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "From the volume page, right click modify volume and enter the desired disk space, for example 100 for 100 GiB."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Start the instance."
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "On the appliance"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "orderedList",
                            "content": [
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "SSH and get a root console on the appliance with "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "sudo -s",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Make sure the disk has been expanded by running "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "fdisk -l",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "The first line should show the new disk size, for example "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "100 GiB",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "fdisk -l\nDisk /dev/xvda: 100 GiB, 107374182400 bytes, 209715200 sectors\n[...]"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Find the name of the lvm partition on the appliance with pvdisplay in the PV Name column, here it is "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "/dev/xvda2",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": ":"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "#pvdisplay\n\n  --- Physical volume ---\n  PV Name               /dev/xvda2\n  VG Name               czvg\n  PV Size               199.75 GiB / not usable 2.00 MiB\n  Allocatable           yes\n  PE Size               4.00 MiB\n  Total PE              51135\n  Free PE               1280\n  Allocated PE          49855\n  PV UUID               N417eY-ZPMZ-fo5W-pmq9-Agmr-1BxP-5fAp8B"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Verify the size of the data partition before, here it is "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "13G",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": ":"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "\\# df -h /dev/czvg/data \n\nFilesystem      Size  Used Avail Use% Mounted on\n\n/dev/czvg/data     14G  197M   13G   2% /mnt/data"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Get the script, copy it to the appliance and make it executable."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "https://github.ad.cryptzone.com/raw/cryptzone/stratus-appliance/master/scripts/cz-resize-data?token=AAAAGZ76acwSMzhZ6eZYbqU4homc0mACks5amArxwA%3D%3D",
                                                    "marks": [
                                                        {
                                                            "type": "link",
                                                            "attrs": {
                                                                "href": "https://github.ad.cryptzone.com/raw/cryptzone/stratus-appliance/master/scripts/cz-resize-data?token=AAAAGZ76acwSMzhZ6eZYbqU4homc0mACks5amArxwA%3D%3D"
                                                            }
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "wget https://s3.amazonaws.com/appgatedownload/cz-resize-data\nchmod +x cz-resize-data"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Run the script with the lvm partition as a parameter."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "\\# ./cz-resize-data /dev/xvda2"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Verify that the data partition was expanded, here it's size was increased to "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "93G",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "codeBlock",
                                            "attrs": {},
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "\\# df -h /dev/czvg/data \n\nFilesystem      Size  Used Avail Use% Mounted on\n\n/dev/czvg/data     93G  215M   89G   1% /mnt/data"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": " Note that the script will reserve 5 GiB for upgrades (image2 and state2 lvm logical volumes) since appliance versions lesser than 3.3 do not have the capability to resize the data partition on upgrade to make room for the image and state."
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519309412298
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This worked with datadog"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519373661263
            }
        ]
    },
    {
        "key": "SA-7363",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "["
                        },
                        {
                            "type": "text",
                            "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group\\",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group\\"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "by=cases",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": ":title&group\\_order=asc&group\\_id=-1]("
                        },
                        {
                            "type": "text",
                            "text": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group_by=cases",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://testrail.ad.cryptzone.com/index.php?/tests/view/65222020&group_by=cases"
                                    }
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": ":"
                        },
                        {
                            "type": "text",
                            "text": "title&group"
                        },
                        {
                            "type": "text",
                            "text": "order=asc&group",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        },
                        {
                            "type": "text",
                            "text": "id=-1)"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "not sure if its related but i see a lot of this in rsyslog's own logs"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Feb 20 10:35:34 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:34 envy-172-17-122-1.devops rsyslogd[17654]: Child 19360 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:34 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:35 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:35 envy-172-17-122-1.devops rsyslogd[17654]: Child 19368 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:35 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:36 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:36 envy-172-17-122-1.devops rsyslogd[17654]: Child 19379 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:36 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:37 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:37 envy-172-17-122-1.devops rsyslogd[17654]: Child 19387 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:38 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]\nFeb 20 10:35:39 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' resumed (module 'omprog') [v8.32.0 try http://www.rsyslog.com/e/2359 ]\nFeb 20 10:35:39 envy-172-17-122-1.devops rsyslogd[17654]: Child 19394 has terminated, reaped by main-loop. [v8.32.0 try http://www.rsyslog.com/e/0 ]\nFeb 20 10:35:39 envy-172-17-122-1.devops rsyslogd[17654]: action 'action 6' suspended (module 'omprog'), retry 0. There should be messages before this one giving the reason for suspension. [v8.32.0 try http://www.rsyslog.com/e/2007 ]"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519122970316
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It didn't start failing with the new rsyslog actually but after that, weird "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1876",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1876"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519124201238
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Seems related to log2audit which itself is related to the latest logd client update:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "root@envy-172-17-122-1:~# cz-log2audit\nTraceback (most recent call last):\n File \"/usr/bin/cz-log2audit\", line 14, in <module>\n   import logdclient  # type: ignore\n File \"/usr/local/lib/python3.5/dist-packages/logdclient/init.py\", line 4, in <module>\n   from . import logc\n File \"/usr/local/lib/python3.5/dist-packages/logdclient/logc.py\", line 28, in <module>\n   _logc = swig_import_helper()\n File \"/usr/local/lib/python3.5/dist-packages/logdclient/logc.py\", line 24, in swig_import_helper\n   _mod = imp.load_module('_logc', fp, pathname, description)\n File \"/usr/lib/python3.5/imp.py\", line 242, in load_module\n   return load_dynamic(name, filename, file)\n File \"/usr/lib/python3.5/imp.py\", line 342, in load_dynamic\n   return _load(spec)\nImportError: /usr/local/lib/python3.5/dist-packages/logdclient/_logc.so: undefined symbol: logc_send_guaranteed_no_reconnect"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519124763508
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Caused by updated the python library but not the underlying appliance library"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-contrib/pull/178",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-contrib/pull/178"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1882",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1882"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Fixed by per here:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1887",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1887"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1519125182514
            }
        ]
    },
    {
        "key": "SA-7213",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "I guess the X should not be there - or should not create the new entry!"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "SA-7248",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "SA-7248"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1518183452423
            }
        ]
    },
    {
        "key": "SA-7273",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "According to Thomas, controller returns 'Conflict' for filename after the file upload is complete. That means, the stream handling is not really as we want on the controller side."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think this is fine (except possibly nginx caching?), eller "
                                },
                                {
                                    "type": "text",
                                    "text": "Thomas Cellerier",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                                                "title": "thomas.cellerier"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1518613603777
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I don't think it's nginx caching as it's the whole file. But yeah close it if you want."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1518616110016
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "didn't you say it was 20% when you got the conflict today?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1518616200435
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "No it was 20% when uploading against a 3.3 controller which doesn't even have the API. Which is why I made this PR "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1873",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1873"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I have to check, I might have increased the upload limit for 4.0 unnecessarily since it is disabled in particular for the file repository api."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "EDIT:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This is the location in 4.0:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "location /admin/files { proxy\\"
                                },
                                {
                                    "type": "text",
                                    "text": "set\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "header X-Forwarded-For $remote\\"
                                },
                                {
                                    "type": "text",
                                    "text": "addr; proxy\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "pass "
                                },
                                {
                                    "type": "text",
                                    "text": "http://127.0.0.1:9130/peer/files",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://127.0.0.1:9130/peer/files"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ";"
                                },
                                {
                                    "type": "text",
                                    "text": " proxy\\"
                                },
                                {
                                    "type": "text",
                                    "text": "request\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "buffering off; client\\"
                                },
                                {
                                    "type": "text",
                                    "text": "max\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "body\\"
                                },
                                {
                                    "type": "text",
                                    "text": "size 2g; }",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1518617005742
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ah, right. ok, so still a problem."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1518617101236
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Failed.. Jersey (the REST part of dropwizard) waits for full upload before starting the process. I tried a bunch of things but didn't help. It could very well be how HTTP works."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I was able to start processing right away with a change but failed to read the file this time. However, curl looks like this then:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "* Connected to localhost (127.0.0.1) port 9130 (#0)\nPUT /peer/files HTTP/1.1\nUser-Agent: curl/7.35.0\nHost: localhost:9130\nAccept: application/vnd.appgate.peer-v7+json\nContent-Length: 816884983\nExpect: 100-continue\nContent-Type: multipart/form-data; boundary=------------------------2e5e265bd20f44bc\n\n< HTTP/1.1 100 Continue\n< HTTP/1.1 204 No Content\n< Date: Fri, 23 Feb 2018 13:17:30 GMT\n<\n\n* Send failure: Broken pipe\n* Closing connection 0\ncurl: (55) Send failure: Broken pipe"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1519392932714
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Stackoverflow here I come."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1519393095216
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://stackoverflow.com/questions/10615410/jersey-multipart-streaming-without-disk-buffering-at-the-receiving-server",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://stackoverflow.com/questions/10615410/jersey-multipart-streaming-without-disk-buffering-at-the-receiving-server"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "for reference"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "curl -X PUT --header \"Accept: application/vnd.appgate.peer-v10+json\" --header \"Authorization: Bearer eyJjbGFpbXNUb2tl\nbiI6ImV5SmhiR2NpT2lKU1V6VXhNaUlzSW5wcGNDSTZJa1JGUmlJc0luUjVjQ0k2SWtwWFZDSjkuZUp5dGt0dHU0akFRaHQ4bHQ1RFd6c0Z4a0pDV0lLQlF\nvSlJ5WHZYQ3NSMXdTZUxnaEZNcTNyME9XMjMzQWZadVBQN0cvL2lmK1RRS3VlZHBueGtOZytEUVJoQkVwa1VCTXgwcjlFenN1Y0IwR1NRQSs2SHYyOUNvR3\nlMUGo3emlMUUI5RTJBVFdqUG9OQnk3NGFJSGhQMk5admdsRTRybi8wTDJEd1E4cDRLWXlBdVJibzhpMzNFMkpnblhlSHZjMUpMSWpTemsyYmJuUU0vR2JnZ\n2pSam5Bb1I5aUJ1dWFJU3dSYWYxbDNvd2xKWEVsbUZKMXpRck8yakVSaVJiK05ESnlqU1dwR3MyNmsyUGVrcWRhTWZmUHRjMEFyZWdZbjd0clhiZm4xenRN\nWlZvb0djZGNhVDdZalpQbFM4WlYvL1R4dEpvSG84VnNhOUhSZVRuSUxtdFlQRjdLYzN0MGNDWHR0Tk01UUtSUHl5eVlUdC9zVGJlZDJNT29WT3RUc2lnazV\n2NndIRVZ4TnluWHkrRUZBdEh1dlI2Z014Rnk4UHcyN1J4YWJMZFk5N0lXdnlhcmFQbzZMYk55T1ZidTRubWRnbGJ0TXJOMndhYjdrVXUyNzVEQlpIL2RQTD\nRFbzlmZEV3aDZNN2EwdHJOTzA3amQ2a2FtUDUzKy9Kd25STVE2K20zY2ZmcDFQejlRbVJqdmRTTVNLaSsrM1E2T0l0WWowRDdFNUcreVZkWG8wU2hTU0tXd\nnNwMU1xN3dPeWJaNi9uL09UVENlRnFLNFRwUTg2VmpkRnpGME9mRm9CRXpFUGRlRWtEdW1qNEd0MXdnQUN3RHFFNFNNVzFXc1laZmJTS2RZdGF2SWRHQ29Z\nZGYzVEFTZ0J5Mk1JWEdwRmpybVhLVi9lcjAzb1ZNRjJkNU5DcjlkZUwvZHZnQ0VzUEdkLlNVUG9XQUhrTlF5VWFnTytZNVZFVktzOHpHKzlSVzRxRmZEUGF\nOVXgvVmd5Q0JHa0Q4aEZadEdDbnZuOFhjRDVNdFhGaEE2b01wKzUvdDNSRUU1dGVWQVJxMzVXQ1huV3UvSllpVTNpTVhYdWhoUGRoWUdqSnQ1b0RpQXd3Sm\nRLekFWNFdwNThzTTZwdGlPTWpVOVBSV1hSSEhkODhtSXBwM3J2RFZoc3hyST0iLCJhZG1pbmlzdHJhdGlvblRva2VuIjoiZXlKaGJHY2lPaUpTVXpVeE1pS\nXNJbnBwY0NJNklrUkZSaUlzSW5SNWNDSTZJa3BYVkNKOS5lSnhOa0R0ckF6RVFoUDlLVUowMXE1Tk9qK3RjcG82ckJCZDZuUkc1RjVJY1lnNy85MGdoTVdH\nYlhlYWJHZGlkbFBVakxDK2VETVM1VVRLRkFvUWZGWERVQWl4YUNxTjNETDNodlJ3TmVTWXg1MnRvZklkVUF5cWczWW55Z2JPaGx3ZUIrRmFaOExYRkZQSi9\npUDFCNG9DU044aE5Kczc1OU9nM3lqSkJjWVRPb1FmZVdRbEs5Z2k5cHdhVnRsb3pXbTFwblZyeSswNWljMWswM2pxQklJUG5RR25nWUxscG5ZZ2RvdE5HaU\n9wYXpCd3EvWHJMSmN4UFJ6L0hKZWFTVEluclV1VXR4Yzg0aGN0dmNybHRqVDVPVTlXS1NaZFFIbWQyYXhOM1l1bzVsSFFOOVNlKytjNk52ZnhzOS91NXpqZ\nTR5V1RpLlBCYnNZeStSK21oOTNQekxRQzBmSG9GcE5HdGVHZFo3eGdWcG45MjhjaXhTREljWnl6dWhHbzBmQXVSTGdiSmM2ZC9jbngzcUZlQzl6RmdzRFpr\nUm5BeW95Mk93SG1MMDFTSXU3MXNBNFBCNUdVdWJjVGQySGFwOWVEQzcrdTdZWnlUbHlvRFNmUUdrZkRTTUxQVmk0Z2g4bSsycHJUYWIzejAzMlZ3cWt1bz0\nifQ==\" http://localhost:9130/admin/files -F \"file=@C:\\\\Users\\\\natan.abolafya\\\\Downloads\\\\appgate-5.0.0-14972-master.img\n.zip\""
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1565621293840
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "In nginx it looks like we need set http 1.1 protocol too or else it doesn't proxy the chunked encoding. "
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "        proxy_http_version 1.1;"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1565793372519
            }
        ]
    },
    {
        "key": "SA-7095",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "The passphrase remains set."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "could you tell me in which case?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadi.misagh",
                "created": 1516619084294
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This is what normally happens if I try to backup a newly created appliance:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": " $ python3 appgate-backup.pyz https://envy-172-17-116-1.devops:444 --no-verify\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-116-1.devops:444...\nAuthentication succeeded\nAuthorizing...\nStarting backup on 1 appliances:\n\ncontroller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nFailed to start backup creation.\nHTTP Error 500: {\"id\":\"internal server error\",\"message\":\"Internal server error. Backup passphrase is not set. Please contact your administrator.\"}\n\n"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "But if I do this:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ aitorbot test create --purpose backuprestore --scenario controller\\_ha --ex 4910c1be-a896-4889-b31b-f332ac4844ea "
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "After, this is what happens:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ python3 appgate-backup.pyz https://envy-172-17-116-1.devops:444 --no-verify\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-116-1.devops:444...\nAuthentication succeeded\nAuthorizing...\nStarting backup on 1 appliances:\n\ncontroller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nBackup creation started.\nAll files will be stored in /tmp/1517223805.21248/\nBackup complete on appliance: controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nDownloading backup from controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1 in /tmp/1517223805.21248/controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nDownload complete for appliance: controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1\nRemoved remote download for appliance: controller2-4910c1be-a896-4889-b31b-f332ac4844ea-site1"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "So, as you can see, the state of the appliance after the test is not the same as before."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1517223971166
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1452",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-tests/pull/1452"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1517392763237
            }
        ]
    },
    {
        "key": "SA-7057",
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The upgrade API got expanded quite a lot during the 4.0.0 development cycle from a single API call POST /upgrade to a set of API calls."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The main functionality that was added was:"
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Upgrade status"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The appliance now maintains an upgrade status that can be queries, allowing the upgrade script and command to get feedback on the progress of an upgrade. This allows discovering common errors like failing to download an upgrade file or a signature verification failure. The upgrade script now uses this functionality automatically if the controller and target appliance support it."
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Prepared upgrades"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It is possible to prepare an upgrade before starting it's installation. That means downloading the upgrade file on an appliance and making sure it's signature is correct. This means errors can be discovered before the critical upgrade installation as well as time saved during the installation. To prepare an upgrade pass the "
                                },
                                {
                                    "type": "text",
                                    "text": "--prepare",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " flag to the upgrade script. Once the preparation is successful, run the script again with the "
                                },
                                {
                                    "type": "text",
                                    "text": "--install",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " flag."
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Hosting upgrade files on the controller"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This allows appliances to download the upgrade image from a controller, not requiring extra ips and ports to be allowed in firewalls since all appliances already require access to the controller. If passing a local file to the controller using the "
                                },
                                {
                                    "type": "text",
                                    "text": "--image",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " flag the upgrade script will upload the file to the controller. If using an URL, the appliances will download from the URL directly. The controller can be instructed to download the file first using the "
                                },
                                {
                                    "type": "text",
                                    "text": "--host-image-on-controller",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " flag. The appliances will then download the file from the controller."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516204614720
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Thomas Cellerier",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/thomas.cellerier",
                                                "title": "thomas.cellerier"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " assume the parameter-options are changing; or at least you are adding new ones?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Current ones are here: "
                                },
                                {
                                    "type": "text",
                                    "text": "https://help.cryptzone.com/adminguide/v3.3/upgrading-appliances.html?anchor=collective-upgrade",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://help.cryptzone.com/adminguide/v3.3/upgrading-appliances.html?anchor=collective-upgrade"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1516721544002
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yes they are changing quite a lot, I will add a comment here detailing the changes to the CLI."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516723662291
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Changes to the command line interface"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "These changes implied a bunch of changes on the command line interface."
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Script file name change"
                                }
                            ],
                            "attrs": {
                                "level": 4
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The script extension changed so the script name changed from "
                                },
                                {
                                    "type": "text",
                                    "text": "appgate-upgrade.py",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " to "
                                },
                                {
                                    "type": "text",
                                    "text": "appgate-upgrade.pyz",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": ". It is still called in the same way, that is "
                                },
                                {
                                    "type": "text",
                                    "text": "python(3) appgate-upgrade.pyz <arguments>",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The technical reason for this is that we split the upgrade script code into several submodules and shared some with the backup script. In the future we will be able to share that code with any \"admin script\", for example that could be used for the autoscaling script as well."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Python allows you to package several scripts in a single zip file with the "
                                },
                                {
                                    "type": "text",
                                    "text": "pyz",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " extension and call it like you would call single "
                                },
                                {
                                    "type": "text",
                                    "text": "py",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " script."
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Actions"
                                }
                            ],
                            "attrs": {
                                "level": 4
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The upgrade script was fairly simple before, it only had one possible action which was to upgrade a collective. With the addition of prepared upgrades we need a lot more actions. The different actions available are now:"
                                }
                            ]
                        },
                        {
                            "type": "bulletList",
                            "content": [
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "  run: Perform a full upgrade. This is equivalent to what the upgrade script has been doing up to now."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "  prepare: Prepare an upgrade but do NOT install it. This means the upgrade file will be downloaded/uploaded to all the appliances, the signature verified as well as any other preconditions applicable at this point."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "  install: Install a prepared upgrade."
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "listItem",
                                    "content": [
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "  cancel: Cancel a prepared upgrade."
                                                }
                                            ]
                                        },
                                        {
                                            "type": "paragraph",
                                            "content": [
                                                {
                                                    "type": "text",
                                                    "text": "Most of the command line flags are shared between all actions. Only a few differ like "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "--image",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": " and "
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "--host-on-controller",
                                                    "marks": [
                                                        {
                                                            "type": "code"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "text",
                                                    "text": "."
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Install"
                                }
                            ],
                            "attrs": {
                                "level": 4
                            }
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ python3 appgate-upgrade.pyz run --help\nusage: appgate-upgrade.pyz run [-h] --image IMAGE [--host-on-controller]\n                               [-c CONTROLLER] [--cacert CACERT] [--port PORT]\n                               [--username USERNAME] [--provider PROVIDER]\n                               [-y] [-l {debug,error,info,warning}]\n                               [--peer-hostname PEER_HOSTNAME]\n                               [--target-version TARGET_VERSION]\n                               [--ignore-target-version] [--no-verify]\n                               [--device-id DEVICE_ID]\n                               [--peer-api-version PEER_API_VERSION] [--color]\n                               [--no-color]\n\nRun full upgrade.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --image IMAGE         Upgrade image file or URL\n  --host-on-controller  Host upgrade image file on controller\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Prepare"
                                }
                            ],
                            "attrs": {
                                "level": 4
                            }
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ python3 appgate-upgrade.pyz prepare --help\nusage: appgate-upgrade.pyz prepare [-h] --image IMAGE [--host-on-controller]\n                                   [-c CONTROLLER] [--cacert CACERT]\n                                   [--port PORT] [--username USERNAME]\n                                   [--provider PROVIDER] [-y]\n                                   [-l {debug,error,info,warning}]\n                                   [--peer-hostname PEER_HOSTNAME]\n                                   [--target-version TARGET_VERSION]\n                                   [--ignore-target-version] [--no-verify]\n                                   [--device-id DEVICE_ID]\n                                   [--peer-api-version PEER_API_VERSION]\n                                   [--color] [--no-color]\n\nPrepare an upgrade.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --image IMAGE         Upgrade image file or URL\n  --host-on-controller  Host upgrade image file on controller\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Install"
                                }
                            ],
                            "attrs": {
                                "level": 4
                            }
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ python3 appgate-upgrade.pyz install --help\nusage: appgate-upgrade.pyz install [-h] [-c CONTROLLER] [--cacert CACERT]\n                                   [--port PORT] [--username USERNAME]\n                                   [--provider PROVIDER] [-y]\n                                   [-l {debug,error,info,warning}]\n                                   [--peer-hostname PEER_HOSTNAME]\n                                   [--target-version TARGET_VERSION]\n                                   [--ignore-target-version] [--no-verify]\n                                   [--device-id DEVICE_ID]\n                                   [--peer-api-version PEER_API_VERSION]\n                                   [--color] [--no-color]\n\nInstall a prepared upgrade.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                                }
                            ]
                        },
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Cancel"
                                }
                            ],
                            "attrs": {
                                "level": 4
                            }
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ python3 appgate-upgrade.pyz cancel --help\nusage: appgate-upgrade.pyz cancel [-h] [-c CONTROLLER] [--cacert CACERT]\n                                  [--port PORT] [--username USERNAME]\n                                  [--provider PROVIDER] [-y]\n                                  [-l {debug,error,info,warning}]\n                                  [--peer-hostname PEER_HOSTNAME]\n                                  [--target-version TARGET_VERSION]\n                                  [--ignore-target-version] [--no-verify]\n                                  [--device-id DEVICE_ID]\n                                  [--peer-api-version PEER_API_VERSION]\n                                  [--color] [--no-color]\n\nCancel a prepared upgrade\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -c CONTROLLER, --controller CONTROLLER\n                        AppGate Controller peer hostname or ip The server\n                        should be specified in the following form:\n                        [https://]hostname[:port] If the port is specified\n                        here it takes precedence over the port argument.\n  --cacert CACERT       Path to the controller's CA cert file in PEM or DER\n                        format\n  --port PORT           AppGate Controller admin port\n  --username USERNAME   Admin username\n  --provider PROVIDER   Identity provider for the admin user\n  -y, --yes             Batch mode, don't ask for confirmation\n\nadvanced optional arguments:\n  -l {debug,error,info,warning}, --log-level {debug,error,info,warning}\n                        Log level\n  --peer-hostname PEER_HOSTNAME\n                        Specify the peer hostname of the AppGate controller\n                        you are connecting to. Use this if connecting via an\n                        ip or hostname that differs from the peer hostname\n  --target-version TARGET_VERSION\n                        Specify the target AppGate version in X.Y.Z format\n                        (e.g. 3.2.1). Alternatively the X.Y.Z-buildnumber-\n                        branch format (e.g. 3.2.1-6220-release) can also be\n                        used. The target version will be guessed from the\n                        image URL if it is unspecified\n  --ignore-target-version\n                        Do not try to guess the target version from the image\n                        URL. This takes precedence over --target-version if\n                        both are set\n  --no-verify           Do NOT verify the controller's certificate\n  --device-id DEVICE_ID\n                        Device id of the local machine, it will be generated\n                        at every run if not set\n  --peer-api-version PEER_API_VERSION\n                        Controller Peer API version, it will be auto-\n                        discovered if not set\n  --color               On Windows, force the use of colors\n  --no-color            Do not use colors"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516873906876
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "heading",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "cz-config upgrade"
                                }
                            ],
                            "attrs": {
                                "level": 2
                            }
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "cz-config upgrade also got updated to reflect the new capabilities"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ cz-config upgrade --help\nusage: cz-config upgrade [-h] [--no-delete] [--no-wait] [-n] [--force]\n                         [--prepare] [--install] [--finalize] [--cancel]\n                         [--status]\n                         [FILE]\n\npositional arguments:\n  FILE             Absolute URL to upgrade file, using the file://, http:// or\n                   https:// protocol, or absolute path to file\n\noptional arguments:\n  -h, --help       show this help message and exit\n  --no-delete      Do not delete the appliance upgrade image after upgrade\n  --no-wait        Don't wait for the upgrade to complete before returning\n  -n, --no-reboot  Do not reboot the appliance after upgrade\n  --force          Ignore peer API validation errors when installing the\n                   upgrade\n  --prepare        Prepare the upgrade but don't install the image\n  --install        Install a prepared upgrade\n  --finalize       Finalize a successful upgrade, this will trigger a reboot\n  --cancel         Cancel a prepared upgrade\n  --status         Print upgrade status"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516875765309
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This is now done and available here "
                                },
                                {
                                    "type": "text",
                                    "text": "https://sdphelp.cyxtera.com/adminguide/v4.0/upgrading-appliances.html",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://sdphelp.cyxtera.com/adminguide/v4.0/upgrading-appliances.html"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "However the terminology used in cz-config and the upgrade script need changeing to match."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1517300242240
            }
        ]
    },
    {
        "key": "SA-7047",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "By default the upgrade script would still run a full upgrade."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This would add two flags:"
                        }
                    ]
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  prepare"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  install"
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Prepare would make sure all appliances have the upgrade file downloaded and verified."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Install would actually install the previously prepared upgrade."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "There could also be a cancel flag to cancel a prepared upgrade."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "This would only be available if all appliances in the collective have peer API version >= 7."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "First shot:"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "$ python3 -m appgate_upgrade --image-url https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8508-master.img.zip?is-build-type-id --username admin --no-verify envy-172-17-128-1.devops --prepare\nDiscovering peer API version for https://envy-172-17-128-1.devops:444...\nPeer API version is 7\nEnter password for username admin and provider name local:\nAuthenticating to https://envy-172-17-128-1.devops:444...\nAuthentication succeeded\nAuthorizing...\n\nPrepared upgrade plan:\n\nPrepare upgrade on the following appliances: controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1, gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1\nAppliances will be prepared for upgrade to version 4.0.0-8508-master\n\nDo you want to continue [y/N]? y\n\nPrepare upgrade on the following appliances: controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1, gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1\nUpgrade status for gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to downloading: https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8508-master.img.zip?is-build-type-id\nUpgrade status for controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to downloading: https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8508-master.img.zip?is-build-type-id\nUpgrade status for controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to verifying: appgate-4.0.0-8508-master.img.zip\nUpgrade status for gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 changed to verifying: appgate-4.0.0-8508-master.img.zip\nUpgrade status for controller-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 reached expected value ready: /mnt/data/download/appgate-4.0.0-8508-master.img.zip\nUpgrade status for gateway-0ab18dbc-d3aa-4254-a834-cc963324e119-site1 reached expected value ready: /mnt/data/download/appgate-4.0.0-8508-master.img.zip\n\nReady for upgrade!"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516207078978
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1809",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1809"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516283441595
            }
        ]
    },
    {
        "key": "SA-6934",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Renewed CA certificate:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "12-21 15:48:21.490  2400  2630 I Appgate : Info : SiteStatus {\"simple_setup Site\":{\"gw-id\":null,\"host\":null,\"ip\":null,\"status\":\"disconnected\",\"error\":null,\"code\":0,\"protocol-version\":0}}\n12-21 15:48:21.493  2400  2400 I Appgate : Info : TUN failure on site 'simple_setup Site'.\n12-21 15:48:21.494  2400  2400 I Appgate : Info : Site connection lost on 'simple_setup Site'.\n12-21 15:48:26.493  2400  2630 V Appgate : [simple_setup Site] Connect...\n12-21 15:48:26.496  2400  2630 V Appgate : [simple_setup Site] Connecting to envy-172-17-140-2.devops:443 (172.17.140.2) with tls.\n12-21 15:48:26.496  2400  2630 V Appgate : shim_connect(): Connecting to TLS://envy-172-17-140-2.devops|172.17.140.2:443 (tunnel: yes) ...\n12-21 15:48:26.497  2400  2707 V Appgate : Sending SPA data encapsulated in a DNS query\n12-21 15:48:26.497  2400  2707 V Appgate : Sending DTLS ClientHello with SPA extension\n12-21 15:48:27.299  2400  2630 V Appgate : shim_connect(): Connected to envy-172-17-140-2.devops/172.17.140.2\n12-21 15:48:27.306  2400  2708 V Appgate : shim_ssl_connect(): Verification enabled for host name: envy-172-17-140-2.devops\n12-21 15:48:27.559  2400  2630 V Appgate : [simple_setup Site] ResendCachedTokens\n12-21 15:48:27.565  2400  2630 I Appgate : Info : SiteStatus {\"simple_setup Site\":{\"gw-id\":\"gateway-7a56989e-5682-4917-9b3c-f0d8032e9a3a-site1\",\"host\":\"envy-172-17-140-2.devops\",\"ip\":\"172.17.140.2\",\"status\":\"connected\",\"error\":null,\"code\":0,\"protocol-version\":1}}\n12-21 15:48:27.566  2400  2400 I Appgate : Info : TUN connected on site 'simple_setup Site'.\n12-21 15:48:27.567  2400  2400 I Appgate : Info : Site connection recovered on 'simple_setup Site'.\n12-21 15:48:27.568  2400  2630 V Appgate : [simple_setup Site] RunPacketLoop\n12-21 15:48:27.703  2400  2630 V Appgate : [simple_setup Site] SENDTO\n12-21 15:48:27.703  2400  2630 V Appgate : [simple_setup Site] Compression: 0\n12-21 15:48:27.704  2400  2630 I Appgate : Info : SendTo reply {\"id\":null,\"site-id\":\"simple_setup Site\",\"message\":{\"error\":{\"code\":3,\"message\":\"claimstoken_invalid\"},\"id\":13377331,\"jsonrpc\":\"2.0\"}}\n12-21 15:48:27.904  2400  2699 I Appgate : Info : Logging in to gateway 'envy-172-17-140-2.devops'.\n12-21 15:48:27.907  2400  2400 I Appgate : Info : SendTo {\"id\":null,\"site-id\":\"simple_setup Site\",\"message\":{\"jsonrpc\":\"2.0\",\"method\":\"login\",\"params\":{\"claimsToken\":\"eyJhbGciOiJSUzUxMiIsInppcCI6IkRFRiIsInR5cCI6IkpXVCJ9.eJytVtfOo1gSfpf/lvaYcEgttbQYm2STwYBXc0E45GSyGfW7L9272p0H2LtS6TuVT33119fUVbCVk6/vX3HCYCRJJCcIk+QEMAw9MSgenwg2TFI6wtMIJF/fvopxnOEvPI5i9AnDTzjmYOA7oL6T+B8YQ70ODNz6YoDj30H430AU/guUFONUtNlcjDlMtLCBB5zXflAolrB4mFAEYHCSohgGZY+wQiKJABuC8NuBibrom+7+qLs4rH+5a+Ph008w4euwaA63f3314afuwl9hYqEkxkmyv16j5yLJakjV+waga49v2WgSNDXR27b1sZFktkVY9eh15dpUK0NorVuMCq6G0FABGlx3Noi6VcJ55EIrs9AR7JvgZ7EQrSbvTOycokw51H2akF3P3gntPsRnNElqjX+BxcYmE6RTMWPd7p6LWLeJBUOBmeiqMUc8F7/6LbpFRXrH5OpGR2rk3Qy1vIqrsNoMnpW41dICNk5lmnAivPRt17WVfclkY8Zeev6QtLca+YQeewFfGRb2agA1wkT/5E09pVXizhdbTFv+gyBP9obmgXu3EaPAROpBGkvfsJrPuilqFspuNZlnWIDRH1fgdrTzDFzpCrKxrDCEd8M57mj9SfkZGDCcENXrRjllODebhJmft+xrqb9T+LSYZK+8bfvSRaZyq731x4+jVxX8/G5Q3LXT0NU1HI4ePRWd7DxjE7KlWD1UIRDNLdbiyWxpbxtL62MUc7Z2yUZJoEPsJsirY40QJLdz/5maJ/VZo7hzH+qLOKPOYCmuosltRkjC55MUJpSht5ZkGeHPh4INZNWxdLmk54UxSEJ6A80kOJLGyxe/RGd2KGogTcGtiUve6YlVuV8KrtTP16UbzXMnhRJfYsXLtfXWhAVFKfJdfazkQzxXaHK1p8Gb3p5rLM2tCD5Q83YnD0SVUObV6WJB8s9570DoLlsvCau2HeUBrqdI2sgLjCI671xQPih2caz8RYlPCY6GS6Ble8kM2a/Mtafu1mVU6DoieGNGck/bHohHTeGNwwNildztHNESx7K4eRHvmQOugG9mY8kngqYK3ji3ecoRZSDGpZbupCCUNyuHdyh9mM4qdixIrjyFXHhyJguNW+lPdr5P1s5voZ8RVZDLouUL4Drshb3bjvq5eHGxbaNtXVr0fumMF5htMlBqIjs7yOjcN3kdREMt4jHcKSIvgRF74l28Gr7gzxMQtweJkLLIJzfI7z5Fci4jO7YaLbEQZuX17UE+T33N85PCIBB0jBxlfIq3nYvvQbjEdxuVtopq4e4oHwuEmXwrDe6Kl9nzXeQ+J8HVTy+V0vdDQOqLEkRljOdylqLJs3QMzx+J7oElmLbUHaJ/rAaSIN60vo8RRgbDlh17Ar8FwvIMuAsnZr9mGOA0m4ZseIqiMD0BPGVPERZHJ4IgkhQNmZgE2DHVR7rtqHIzVZKCxYqb8V5q3Xtj1g2EYOQxfwYpGiSEP5OuSgheZfGPy4Taoq4sCiKYerYNI2e+MCZ6S5B9Tw9vCJ9GIp7tI1/RiIpiDlL8ZoVW9wyk/ZicHCf05ROYOee9WlPC4nazHSCVYRbPMWp160MIbxGX+owxXC5IvJCvNapjpixbrSBu+bVbVvR+Dpg166xjiO99KVJq7CzypizyzraJ5HiUIRitXSGNCFXFsvswhmwcDwMId1CrJXolEA5vmPWFD9s7mwlzErh7dv2UYlcH1wrTJdQ2o2vkzmnyIkPVZF2tsoYnRan7Wp9xR0gaBlToKOLuqw6YnMkoTzGcmY+c8VJH3vIeelXg5wuXx1T7isnUxwfvNhRepaMVwrbhu311SXVniUV79SExRiKCWkqu2maIGGPnPXfEGfAe5SM6zW4ofOh3WoYhLGzpUYavwS4lWbnu8v6sRJpgVWlYlYnR56tS8ySc23rb80ADETHLqnTem49yVzD+vI6QAvfWQvTMn1W7z01RrtOq7SFhP/VEeAKvaSfBthdhNB5pQ+MpY9Z5YRmy++A12/C9K73w/XhWcJqfK7x6jJyhw+FRVuJbb0RXSYJih6jKypZgvDlUjqoLpyGFQR9LVmmyow13t0yPbWtj4kZ0Al2U01vnRWp/kzml4sTbZFV+irbLY0iVkko342qZP75+/vz21R/02f6PQ2ETFvUh/fPr4Nt/TGFUw/GPuGu+/vz2lRbDOP2HtI8NFn2Ob1GH/1U5v8GHLsx+WSoS2E7F9DGGbjnk4fe9EZEwpOMUPVGQJk8YBsGJZVDihDIoiqNozIYU9X88E478it/3AEgZNqaZE3s8PQEa0ofEghN52IkZKiEgwA+38wiH9t/eDjOHYgqz37UY4TT3X3/+/PkvlgX85A==.SLxNj8JFmaTa6WkHuXDEeAY/Dvlyb61lIBiEk0qUeBY/vWUMsF7IM9qGdncyXkkft0yuy7uxiqJE7yogGmrrX/v3ETTRHM+IkEHG4cpZEzuqelrGNx/bahkEeDv2Lc22kGbNdidSkAzkZz2CjuSDR6G4p18n57XgTpsfan3NPsPPJ6CGomQUATRI5KLNCeV3+QupJTihYnD255D7pqT/63wdmojxOQDyDszAva/9ooZHKJyGvtIGC+I1Uv10Lsa8DuSy3vTj5VPXwJw8WEx1tz7wN6IoxGox+63thSezk2xgr4oyUD91bd6NPIjmvodwrjPOQCxTFNubS2yvN5WRr7Or4CXXxhx61lpWLcd9olo2E+vwRP+gDwFmimQQVX0PGJ8QaFX3tu5UHUbyiCLHUt2D7DssUMTbRb0qq+GEOMp0Mrx9zBTys7UsVt6wp55WYj2e7j5l77GbWuQPUKBT/t0fOBhf5fITK9Hui8gidFqB83CetimyPI8s9qyI5QUj2LXEutc4r1GiVWNqQMevz9xmiSZzXypjBpEL+WvP7mFX7dCWeiTagW7WPXARwx/NsrBwd1ZD38aXBcJiOXVwnRLnbI1Lb5a+aBxUKco4U9bpcK2q4Nm3jU3hHo/qMdJyR3FZROoMN8VOOw9qmwo4IHRCyfw6kYj2w38WBlcErQE=\",\"entitlementToken\":\"eyJhbGciOiJSUzUxMiIsInppcCI6IkRFRiIsInR5cCI6IkpXVCJ9.eJylk2tr2zAYhf+LPkeeJEvx5dtGs9ZhpGV1Ye0IQTenIr6oke0uhPz3SmkozWBbYQhkOO8jnXOwvQd9t9FtoUAOkhTHGBMOE1RVkBKSQU5TBRmTGddapCJDYAKMc4MOPEE4gZhAgktMczrNGYlilDx4Rv+yZqvdb1BygkiaBUjW3DSufPOXKsWMxQpqrRSkGCOYIiJhnHFVJYJUgip/jNd1J3mvVWFBvgcj9Ucxi5Bf2I/H6dEV4VyJNEenhSnyGzj4aG1v+lo3/vmFO62+d0Nv2jXIK147fTb3+X/uQcsb7a90prG1XjndD3Y1W5Srq7K8CXFkb7r2Fe13NqCF/Syldu5t6rWQ+tkLbhAnqpd2NVgvPXbuaAVwQiKcRDhOIgKWE2C77esgRWB58IIyztZ8t/h7Itm1ygTbb93ayODdqvdyuHJ5mPy52U2xuPyfZkY2/6oWyOMAQcLYh9qdUn2s3fJcAVdPl9Vds50/PRbsq76e19fjLLuY34KzF34rt8aGwKDY3F+4WW02xTi9323uFB/ED/Np9Pzaf3vPfFeoY35KkqziGYdC8PDTVBkUWAoYx7GqEE8lo9jXewGQgRAI.k6N6FCiUyy2cf4CBwf21hGEnOYJWds8OzxyDVzOcX7BM25G3P90D86N2wQPQz1JpAZY7uL8bzE7JY3YhMEeeIX9Hjoc2laVpTrv0vWm5Mch9L1skn5NT7JHAvsKkDyPBVq7hI/cTzxB+mNGt3mnskZHTDorjlISR8bamRmDnujUUp3j3\n12-21 15:48:27.907  2400  2400 V Appgate : [simple_setup Site] UpdateCachedTokens: method: login\n12-21 15:48:27.907  2400  2400 V Appgate : [simple_setup Site] UpdateCachedTokens: updated\n12-21 15:48:27.916  2400  2630 V Appgate : [simple_setup Site] SENDTO\n12-21 15:48:27.916  2400  2630 V Appgate : [simple_setup Site] Compression: 0\n12-21 15:48:27.917  2400  2630 I Appgate : Info : SendTo reply {\"id\":null,\"site-id\":\"simple_setup Site\",\"message\":{\"error\":{\"code\":3,\"message\":\"claimstoken_invalid\"},\"id\":2,\"jsonrpc\":\"2.0\"}}\n12-21 15:48:28.908  2400  2476 W Appgate : Warn : Gateway 'envy-172-17-140-2.devops' rejected the claims token. Will get a new claims token from controller. Reason: ClaimsTokenInvalid\n12-21 15:48:29.911  2400  2446 I Appgate : Info : Retrieving claims token.\n12-21 15:48:29.911  2400  2446 I Appgate : Info : Fetching on-boarding cookie for 'OnBoardingCookie-44:c2:36:94:7f:ed:80:66:ee:4c:b0:af:00:ab:93:df:b3:c7:21:6a:31:86:87:94:99:6e:29:b5:e1:f8:c6:ae-local-bob' from secure storage.\n12-21 15:48:29.923  2400  2446 I Appgate : Info : On-boarding cookie available for 'OnBoardingCookie-44:c2:36:94:7f:ed:80:66:ee:4c:b0:af:00:ab:93:df:b3:c7:21:6a:31:86:87:94:99:6e:29:b5:e1:f8:c6:ae-local-bob'.\n12-21 15:48:29.925  2400  2446 I Appgate : Info : Existing REST connection lost. Reconnecting.\n12-21 15:48:29.925  2400  2446 I Appgate : Info : Resolving hostname '172.17.140.1'\n12-21 15:48:29.925  2400  2446 I Appgate : Info : Trying to connect '/172.17.140.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n12-21 15:48:29.925  2400  2446 V Appgate : shim_connect(): Connecting to TLS://|172.17.140.1:443 (tunnel: no) ...\n12-21 15:48:29.927  2400  2709 V Appgate : Sending SPA data encapsulated in a DNS query\n12-21 15:48:29.927  2400  2709 V Appgate : Sending DTLS ClientHello with SPA extension\n12-21 15:48:30.728  2400  2446 V Appgate : shim_connect(): Connected to /172.17.140.1\n12-21 15:48:30.731  2400  2710 V Appgate : shim_ssl_connect(): Verification enabled for IP: 172.17.140.1\n12-21 15:48:30.832  2400  2710 V Appgate : TLS alert write:fatal:unknown CA\n12-21 15:48:30.833  2400  2710 V Appgate : connection_thread(): 0x981c0000 write(connect) failed\n12-21 15:48:30.835  2400  2446 I Appgate : Info : REST connection could not be established. 'Invalid certificate provided.'. Will try the next IP address.\n12-21 15:48:30.838  2400  2446 E Appgate : Error : SSL certificate of controller 'https://172.17.140.1/' is not accepted. Will check next CA certificate. Reason: Invalid certificate provided."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "OK, I debugged a bit and it looks like it verifies just fine. The logs above happen when sessiond is restarted but not yet vpnd with the new CA. My emulator reconnects too quickly I suppose."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "However, shim returns ERR\\"
                                },
                                {
                                    "type": "text",
                                    "text": "CONNECT\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "CERT\\"
                                },
                                {
                                    "type": "text",
                                    "text": "ERROR which is the same code we use for VPN cert failure. That still works but makes the client do some extra unnecessary rounds.",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Either, the assumption is wrong and VPN cert error happens with ERR\\"
                                },
                                {
                                    "type": "text",
                                    "text": "CONNECT\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "SSL\\"
                                },
                                {
                                    "type": "text",
                                    "text": "ERROR or shim needs to return a different error for bad server certificate.",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1514046335135
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Maybe add the extra error handling on to this commit? "
                                },
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2627",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-client-shared/pull/2627"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1514538588254
            }
        ]
    },
    {
        "key": "SA-6933",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "When I go on the UI, appliances, and click download logs, I get an error saying that the controller is offline."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This is what happens on the appliance. It never seems to reach configd at all."
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Dec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 0\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 0\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 126 \"-\" \"python-requests/2.14.2\" 10\nDec 21 14:39:53 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 145 \"-\" \"python-requests/2.14.2\" 12\nDec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Identity (controller-connector)\" 1\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 0\nDec 21 14:39:53 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 210 \"-\" \"python-requests/2.14.2\" 15\nDec 21 14:39:53 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:39:53 +0000] \"GET /healthcheck HTTP/1.1\" 200 107 \"-\" \"python-requests/2.14.2\" 9\nDec 21 14:39:56 envy-172-17-158-1.devops nginx[4587]: 192.168.100.87 - - [21/Dec/2017:14:39:56 +0000] \"GET /admin/appliances/0e7bb42e-9753-48a8-911a-5dba2a6a3190/logs HTTP/2.0\" 406 161 \"https://envy-172-17-158-1.devops:444/ui/appliances\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36\"\nDec 21 14:39:56 envy-172-17-158-1.devops cz-managed[3252]: 192.168.100.87 - - [21/Dec/2017:14:39:56 +0000] \"GET /peer/appliances/0e7bb42e-9753-48a8-911a-5dba2a6a3190/logs HTTP/1.0\" 406 161 \"https://envy-172-17-158-1.devops:444/ui/appliances\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36\" 6\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Identity (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 145 \"-\" \"python-requests/2.14.2\" 8\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authorization (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 107 \"-\" \"python-requests/2.14.2\" 9\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 0\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Authentication (controller-connector)\" 0\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 126 \"-\" \"python-requests/2.14.2\" 5\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authd[3121]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-authord[3912]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-identityd[3196]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET / HTTP/1.1\" 404 0 \"-\" \"Service.Management (controller-connector)\" 1\nDec 21 14:40:03 envy-172-17-158-1.devops cz-managed[3252]: 127.0.0.1 - - [21/Dec/2017:14:40:03 +0000] \"GET /healthcheck HTTP/1.1\" 200 210 \"-\" \"python-requests/2.14.2\" 10"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It's a UI issue where it doesn't send the "
                                },
                                {
                                    "type": "text",
                                    "text": "......appgate-zip",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " (it sends ....appgate-json which was working until this version). It's fixed in the new UI. We're not maintaining the old UI."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1513868993124
            }
        ]
    },
    {
        "key": "SA-6909",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2017-12-19T10:31:55.608Z] Info : UI has connected to service.\n[2017-12-19T10:31:55.803Z] Info : UI is ready.\n[2017-12-19T10:31:55.804Z] Info : UI connected.\n[2017-12-19T10:31:55.824Z] Info : Setting locale to en-US.\n[2017-12-19T10:31:55.883Z] Info : Connecting to TUN driver.\n[2017-12-19T10:31:55.886Z] Info : Setting log level of TUN driver to Info.\n[2017-12-19T10:31:55.940Z] Info : Setting controller URL to 'https://envy-172-17-140-1.devops/'.\n[2017-12-19T10:31:55.945Z] Info : CA certificate found in the storage for 'envy-172-17-140-1.devops'.\n[2017-12-19T10:31:55.949Z] Info : Resolving hostname 'envy-172-17-140-1.devops'\n[2017-12-19T10:31:55.962Z] Info : Trying to connect 'envy-172-17-140-1.devops/172.17.140.1' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-12-19T10:31:56.603Z] Info : Using Controller API V4\n[2017-12-19T10:31:56.623Z] Info : Certificate is already trusted. Moving on..\n[2017-12-19T10:31:56.630Z] Info : Retrieving provider names from controller.\n[2017-12-19T10:31:56.658Z] Info : Provider names: [local]\n[2017-12-19T10:31:56.679Z] Info : Provider 'local' selected.\n[2017-12-19T10:31:56.682Z] Info : User input required for 'ConnectCredentialsLoginHandler'.\n[2017-12-19T10:32:07.506Z] Info : User input required for 'ControllerUrlLoginHandler'.\n[2017-12-19T10:32:08.600Z] Info : Received a new URL config from user. Parsing..\n[2017-12-19T10:32:08.620Z] Info : URL config parsed. SPA mode: UdpTcp, Name: CryptZone\n[2017-12-19T10:32:08.623Z] Info : Setting controller URL to 'https://purple.cryptzone.com/'.\n[2017-12-19T10:32:08.628Z] Info : No CA certificate found in storage. Retrieving from controller.\n[2017-12-19T10:32:08.631Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-12-19T10:32:08.673Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'CryptZone'.\n[2017-12-19T10:32:12.685Z] Info : Using Controller API V4\n[2017-12-19T10:32:12.728Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-12-19T10:32:12.732Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'CryptZone'.\n[2017-12-19T10:32:13.743Z] Info : Using Controller API V4\n[2017-12-19T10:32:13.762Z] Info : Storing new SPA config.\n[2017-12-19T10:32:13.941Z] Info : User input required for 'TrustCertificateLoginHandler'.\n[2017-12-19T10:32:17.372Z] Info : Certificate accepted. Storing it.\n[2017-12-19T10:32:17.476Z] Info : User input required for 'IdentityProviderLoginHandler'."
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-6859",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "This is to be able to download and verify the upgrade file in advance of the actual upgrade."
                        }
                    ]
                },
                {
                    "type": "bulletList",
                    "content": [
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  "
                                        },
                                        {
                                            "type": "text",
                                            "text": "POST /upgrade/prepare {\"image-url\": \"[file://..](file://..).\"}",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "listItem",
                            "content": [
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "  "
                                        },
                                        {
                                            "type": "text",
                                            "text": "POST /upgrade {\"image-url\": \"file://<name>\"}",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "text",
                                            "text": " Will use a relative path to install the upgrade image previously prepared. This will also verify the upgrade file and run the actual upgrade. This returns with HTTP 202 and an upgrade id."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "The image-url now supports specifying a controller with the "
                                        },
                                        {
                                            "type": "text",
                                            "text": "controller://<hostname>:<port>/<name>",
                                            "marks": [
                                                {
                                                    "type": "code"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "text",
                                            "text": " scheme."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "Download the upgrade file from the controller and verify it (checksum, signature etc...). This returns with HTTP 202 and an upgrade id."
                                        }
                                    ]
                                },
                                {
                                    "type": "paragraph",
                                    "content": [
                                        {
                                            "type": "text",
                                            "text": "This API needs to be reflected on the controller on a per appliance level."
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think checking signature is already enough by itself no?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1513250725216
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Also, how do we get the expected checksum?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1513250736820
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I think checking signature is already enough by itself no?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "True"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Also, how do we get the expected checksum?"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "It's already there in the zip."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1513253902992
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The cyxtera keyring is in /usr/share/keyrings/cyxtera-keyring.pgp"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "You need to pass it to gpg to use that one to verify the signature. (You probably need to rebase)"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1513330130359
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1753",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1753"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Add POST /upgrade/prepare route. This will download the upgrade file but"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "not actually install it. The upgrade can be resumed from the installed upgrade"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "file later."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Added cz-config upgrade –prepare flag to use this feature from the command line."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The cz-config upgrade command now waits for the upgrade to complete, printing the upgrade"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "status changes along the way."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Added cz-config upgrade –no-wait flag to return to the previous behavior."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The upgrade now returns an error if the destination file for an upgrade file download already exists."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "The upgrade download now supports downloading the upgrade file from a controller using appliance"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "authentication."
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Example usage with cz-config:"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Prepare"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "root@envy-172-17-132-2:~# cz-config upgrade --prepare https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8105-master.img.zip?is-build-type-id\nUpgrade status changed to downloading: https://testyd.ad.cryptzone.com:443/testsd/project/7/StratusAppliance_BuildStratusAppliance_2/master/artifact/appgate-4.0.0-8105-master.img.zip?is-build-type-id\nUpgrade status changed to ready: /mnt/data/download/appgate-4.0.0-8105-master.img.zip"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Install"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "root@envy-172-17-132-2:~# cz-config upgrade --no-reboot /mnt/data/download/appgate-4.0.0-8105-master.img.zip\n\nAppliance upgrade started using /mnt/data/download/appgate-4.0.0-8105-master.im\ng.zip...                                                                               \nUpgrade status changed to installing: /mnt/data/download/appgate-4.0.0-8105-master.img.zip\n\nAppliance upgrade done, a reboot is required for the upgrade to go into effect.                                                                               \nUpgrade status changed to success: a reboot is required for the upgrade to go into effect"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1513686975094
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1786",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1786"
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-controller/pull/1267",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-controller/pull/1267"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1516177389872
            }
        ]
    },
    {
        "key": "SA-6802",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "1> Add help URLs for the pages in the manual. This will make it easy to maintain all manual related text and link in one place - and make sure things end up in the right place."
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "So for the Sites example "
                        },
                        {
                            "type": "text",
                            "text": "https://help.cryptzone.com/adminguide/v3.3/sites-configure.html",
                            "marks": [
                                {
                                    "type": "link",
                                    "attrs": {
                                        "href": "https://help.cryptzone.com/adminguide/v3.3/sites-configure.html"
                                    }
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "2> Do something so it is easy to (automatically) to insert / change the the v3.3 according to the version being built?"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Hum on the frontend it is easier if we keep the URL as it is right now. We are composing the URL on everypage using"
                                }
                            ]
                        },
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "const URL_base =  'https://help.cryptzone.com/adminguide'\nconst version = '3.3'\nconst directory = 'sites-configure'\n\nreturn final_URL = '{URL_base}/{version}/{directory}.html'"
                                }
                            ]
                        },
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": " And we can also export these constants aside of the "
                                },
                                {
                                    "type": "text",
                                    "text": "helper-text.json",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1512564094480
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok but the version should be 3.3 in the above case as we don't plan on supporting point releases. So you would limit the version to x.y and strip any .z"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1513093241806
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Yes it is actually without the "
                                },
                                {
                                    "type": "text",
                                    "text": ".z",
                                    "marks": [
                                        {
                                            "type": "code"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " I don't know why I added it. I'll update"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "hadrien.luttiau",
                "created": 1513093392057
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Move these variables into the json file at the top."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1513243687267
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Add language info"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "jamie.bodley-scott",
                "created": 1513245109542
            }
        ]
    },
    {
        "key": "SA-6721",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Clicking the custom URL through Windows 10 mail app delivers wrong base64 to AppGate. Apparently there is some mess with URL and base64. We probably need to URL\\"
                        },
                        {
                            "type": "text",
                            "text": "encode(base64(data)) or some trick of some sort to avoid the confusions",
                            "marks": [
                                {
                                    "type": "em"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2017-11-27T21:27:26.284Z] Info : UI has connected to service.\n[2017-11-27T21:27:26.448Z] Info : UI is ready.\n[2017-11-27T21:27:26.449Z] Info : UI connected.\n[2017-11-27T21:27:26.457Z] Info : Connecting to TUN driver.\n[2017-11-27T21:27:26.461Z] Info : Setting log level of TUN driver to Info.\n[2017-11-27T21:27:26.477Z] Info : Setting locale to en-US.\n[2017-11-27T21:27:26.531Z] Info : Received a URL config from storage. Parsing..\n[2017-11-27T21:27:26.533Z] Warn : Invalid URL config received. Invalid length for a Base-64 char array or string.. config: eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoiQ3J5cHRab25lIiwia2V5IjoiY2QzMzdiMmE1OTU1Yjg3OTk3YzlkYzRjNGRhZTM1ZDRmNTA1ZTE0ZmZhZWU3NWFlZjVhZDZhZjQ1M2M5ODgyOCJ9fQ\n[2017-11-27T21:27:26.534Z] Info : Setting controller URL to 'https://purple.cryptzone.com/'.\n[2017-11-27T21:27:26.544Z] Info : CA certificate found in the storage for 'purple.cryptzone.com'.\n[2017-11-27T21:27:26.548Z] Info : Resolving hostname 'purple.cryptzone.com'\n[2017-11-27T21:27:26.634Z] Info : Trying to connect 'purple.cryptzone.com/35.157.222.129' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.209Z] Info : Trying to connect 'purple.cryptzone.com/35.157.235.196' with SPA UdpTcp and key name 'Built-in-be85360895242'.\n[2017-11-27T21:27:27.519Z] Error : First connection to controller 'https://purple.cryptzone.com/' has failed. Details: Connection failed.\n[2017-11-27T21:27:27.523Z] Info : User input required for 'ControllerUrlLoginHandler'."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "On linux it seems to be passed correctly, I haven't seen such error, so I don't think it's related."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1511858899212
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Natan Abolafya",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/natan.abolafya",
                                                "title": "natan.abolafya"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " checked and confirmed"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "Roy.nard",
                "created": 1512986982655
            }
        ]
    },
    {
        "key": "SA-6501",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[16:14:19][Step 1/1] java (3s)\n[16:14:19][java] make[1]: Entering directory '/home/builderbob/buildAgent/work/81fe2044905f47d9/java'\n[16:14:19][java] fakeroot ./build.sh\n[16:14:19][java] --2017-10-30 15:14:20--  http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz\n[16:14:20][java] Resolving download.oracle.com (download.oracle.com)... 80.239.237.17, 80.239.237.8\n[16:14:20][java] Connecting to download.oracle.com (download.oracle.com)|80.239.237.17|:80... connected.\n[16:14:20][java] HTTP request sent, awaiting response... 302 Moved Temporarily\n[16:14:20][java] Location: https://edelivery.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz [following]\n[16:14:20][java] --2017-10-30 15:14:20--  https://edelivery.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz\n[16:14:20][java] Resolving edelivery.oracle.com (edelivery.oracle.com)... 2.23.151.234, 2a02:26f0:18:499::2d3e, 2a02:26f0:18:489::2d3e\n[16:14:20][java] Connecting to edelivery.oracle.com (edelivery.oracle.com)|2.23.151.234|:443... connected.\n[16:14:20][java] HTTP request sent, awaiting response... 302 Moved Temporarily\n[16:14:20][java] Location: http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz?AuthParam=1509376580_943c57005242c86ea2e8833269dbd91e [following]\n[16:14:20][java] --2017-10-30 15:14:20--  http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/server-jre-8u144-linux-x64.tar.gz?AuthParam=1509376580_943c57005242c86ea2e8833269dbd91e\n[16:14:20][java] Connecting to download.oracle.com (download.oracle.com)|80.239.237.17|:80... connected.\n[16:14:23][java] HTTP request sent, awaiting response... 404 Not Found\n[16:14:23][java] 2017-10-30 15:14:23 ERROR 404: Not Found.\n[16:14:23][java]\n[16:14:23][java] make[1]: *** [package] Error 8"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "This is a file and not an APT package so that would need to be hosted on some file server."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1509439380308
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I see it's http as well, no https link available from oracle?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1509439407353
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https works fine too actually, but no real point in using it as we check against checksum anyway"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1509610358362
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "From where do we get the ckecksum, so that we can do the comparison actually? Obviously if it is downloaded as well from the internetz through http then doesn't add any security..."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "kosmas.valianos",
                "created": 1509612030455
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We use the checksum provided by Oracle, which we check manually each time."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1509612917569
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://www.oracle.com/webfolder/s/digest/8u151checksum.html",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://www.oracle.com/webfolder/s/digest/8u151checksum.html"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "per.allansson",
                "created": 1509613070253
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "We could host the binaries in nexus (akira) which seems to have binary capabilities."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1510216049265
            }
        ]
    },
    {
        "key": "SA-6465",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "[2017-10-25T14:10:33.714Z] Info : Recieved requested configuration '{\n  \"username\": null,\n  \"password\": null,\n  \"controllerurl\": \"appgate://envy-172-17-114-1.devops/eyJzcGEiOnsibW9kZSI6IlVEUC1UQ1AiLCJuYW1lIjoidGVzdCIsImtleSI6ImIxZTM4ZmE0MDRjNTZmNjI4NDc1MmUxYzQ3ZTVlNjcxNzdjNjhlOGJmNmQ4N2VkMjAwMTNlZTU5NDc4MDdhZWIifX0=\",\n  \"identityProvider\": null,\n  \"trustedCertificatePath\": null,\n  \"authenticationCertificateName\": null,\n  \"authenticationCertificatePassword\": null\n}'\n[2017-10-25T14:10:33.794Z] Info : Trying to connect 'envy-172-17-114-1.devops/172.17.114.1' with SPA UdpTcp and key name 'test'.\n[2017-10-25T14:10:37.199Z] Info : Using Controller API V4\n[2017-10-25T14:10:37.199Z] Info : Storing new SPA config.\n[2017-10-25T14:10:37.209Z] Info : Certificate is already trusted. Moving on..\n[2017-10-25T14:10:37.309Z] Info : Retrieving provider names from controller.\n[2017-10-25T14:10:37.349Z] Info : Provider names: [AD, local]\n[2017-10-25T14:10:37.349Z] Info : User input required for 'IdentityProviderLoginHandler'.\n[2017-10-25T14:10:37.349Z] Info : Provider 'local' selected.\n[2017-10-25T14:10:37.449Z] Info : User input required for 'ConnectCredentialsLoginHandler'.\n[2017-10-25T14:10:37.449Z] Info : Logging in using 'local'.\n[2017-10-25T14:10:37.459Z] Info : Authenticating for the first time. RememberMe: False, Credentials: [Username '']\n[2017-10-25T14:10:37.459Z] Info : Retrieving claims token.\n[2017-10-25T14:10:37.469Z] Info : Fetching on-boarding cookie for 'OnBoardingCookie-66:aa:47:ad:6e:ba:b0:aa:99:4c:9a:ff:75:fb:39:5d:ec:82:58:a5:b3:4a:f6:4d:c3:6e:61:c1:28:29:2b:d3-local-' from secure storage.\n[2017-10-25T14:10:37.469Z] Info : No on-boarding cookie found.\n[2017-10-25T14:10:37.559Z] Warn : Controller 'https://envy-172-17-114-1.devops/' rejected authentication on login."
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Well, after that it rejects any connection attempts from plap."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1508946750330
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "codeBlock",
                            "attrs": {},
                            "content": [
                                {
                                    "type": "text",
                                    "text": "\\[2017-10-26T07:51:57Z\\] Warn : \\[ConnectableCredential::ConnectAndCheckConfiguration:453\\] Service is not correctly configured\n\n\\[2017-10-26T07:51:57Z\\] Error : \\[ConnectableCredential::GetSerialization:675\\] There was an error with status '5' during login to AppGate"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1509004373309
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "ok, failure turned out to be irrelevant. However, authenticating with empty username is not a good idea. Maybe it's not audit logged (because of empty username) but still, each PLAP client will basically spam the controller for no reason."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1509009395124
            }
        ]
    },
    {
        "key": "SA-6340",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Oct 12 06:53:23 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] SaveStateLabelAction done\nOct 12 06:53:23 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"POST /configuration HTTP/1.0\" 204 0 \"\" \"Service.Management (appliance-connector)\" 460\nOct 12 06:53:24 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 562 \"\" \"Service.Management (appliance-connector)\" 433\nOct 12 06:53:53 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"POST /event HTTP/1.0\" 204 0 \"\" \"python-requests/2.14.2\" 0\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO [StateMachine] Received event BDRNodeKickedEvent(pull_config=False, delay=10), transitioning from state waiting_bdr_removal to appliance_ready\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO Leaving BDR group and disabling controller\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] Running action LeaveBDRGroupAction(node_name='envy-172-17-100-2.devops') ...\nOct 12 06:53:54 envy-172-17-100-2.devops cz-configd[13168]: INFO [LeaveBDRGroupAction] Leaving BDR group...\nOct 12 06:54:01 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr extension in database controller_authorization\nOct 12 06:54:01 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping btree_gist extension in database controller_authorization\nOct 12 06:54:08 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr extension in database controller_identity\nOct 12 06:54:08 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping btree_gist extension in database controller_identity\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr extension in database controller_management\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping btree_gist extension in database controller_management\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [postgresql] Dropping bdr supervisor database\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] LeaveBDRGroupAction done\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [ActionsRunner] Running action ApplyServicesAction(force=True) ...\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [ApplyServicesAction] Applying services configuration with current configuration /mnt/state/config/20171012-065323-ek6hq45n and previous configurat\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-proxyd stop (reason: base system, service is disabled)\nOct 12 06:54:10 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] postgresql@9.4-main stop (reason: controller, service is disabled)\nOct 12 06:54:13 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 521 \"\" \"Service.Management (appliance-connector)\" 408\nOct 12 06:54:18 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-authd stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-authord stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-identityd stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-managed stop (reason: service is disabled)\nOct 12 06:54:19 envy-172-17-100-2.devops cz-configd[13168]: INFO [service] cz-elasticrestore start (reason: log server, service is enabled, required files are present)\nOct 12 06:54:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 511 \"\" \"Service.Management (appliance-connector)\" 171\nOct 12 06:55:21 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 521 \"\" \"Service.Management (appliance-connector)\" 408\nOct 12 06:56:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 161\nOct 12 06:57:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 161\nOct 12 06:58:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 162\nOct 12 06:59:21 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 521 \"\" \"Service.Management (appliance-connector)\" 409\nOct 12 07:00:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 165\nOct 12 07:01:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 163\nOct 12 07:02:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 163\nOct 12 07:03:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 165\nOct 12 07:04:20 envy-172-17-100-2.devops cz-configd[13168]: INFO [rest] \"GET /status HTTP/1.0\" 200 512 \"\" \"Service.Management (appliance-connector)\" 159\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Stopping AppGate appliance configuration daemon...\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Stopped AppGate appliance configuration daemon.\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Starting AppGate appliance configuration daemon...\nOct 12 07:05:19 envy-172-17-100-2.devops systemd[1]: Started AppGate appliance configuration daemon.\nOct 12 07:05:19 envy-172-17-100-2.devops cz-configd[8370]: INFO [logger] Set log level to info\nOct 12 07:05:19 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting configuration daemon...\nOct 12 07:05:19 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Loading appliance configuration plugin stratus...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting State Machine...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] Running action InitStateMachineAction(recovery_state='waiting_bdr_removal') ...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting JsonRPCActor service...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [JsonRPCEventsActor] Spawning config control thread...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [JsonRPCEventsActor] Waiting for requests...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] InitStateMachineAction done\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] Chaining event InitStateMachineEvent(recovery_state='waiting_bdr_removal', has_inbox=False)\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [StateMachine] Received event InitStateMachineEvent(recovery_state='waiting_bdr_removal', has_inbox=False), transitioning from state init to waiting\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ActionsRunner] Running action ApplyServicesAction(force=True) ...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting Seeding Thread service...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [config-control] Starting REST service on main thread...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [rest] Starting REST service on http://unix:/run/cz-configd/configd.socket ...\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [ApplyServicesAction] Applying services configuration with current configuration /mnt/state/config/20171012-065323-ek6hq45n and previous configurati\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: serving on http://unix:/run/cz-configd/configd.socket\nOct 12 07:05:20 envy-172-17-100-2.devops cz-configd[8370]: INFO [service] cz-elasticrestore start (reason: log server, service is enabled, required files are present)\nOct 12 07:05:21 envy-172-17-100-2.devops cz-configd[8370]: INFO [rest] \"GET /status HTTP/1.0\" 200 509 \"\" \"Service.Management (appliance-connector)\" 426"
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "Same happened to "
                                },
                                {
                                    "type": "text",
                                    "text": "Jamie Bodley-Scott",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/jamie.bodley-scott",
                                                "title": "jamie.bodley-scott"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": " with waiting\\"
                                },
                                {
                                    "type": "text",
                                    "text": "bdr\\",
                                    "marks": [
                                        {
                                            "type": "em"
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "joining."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1510910984231
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "One solution would be to not save these two states to"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1517569620108
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "One solution would be to not save these two states to disk."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1517569620108
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1853",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "https://github.ad.cryptzone.com/cryptzone/stratus-appliance/pull/1853"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "thomas.cellerier",
                "created": 1517569947221
            }
        ]
    },
    {
        "key": "SA-6217",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "<13>Sep 28 12:10:29 cz-restore: Restoring ElasticSearch...\nElasticsearch is up, starting restore procedure\nThu Sep 28 12:10:29 UTC 2017\nRestoring: logstash-2017.09.27_restore\nUrl: http://localhost:9300/logstash-2017.09.27_restore\nGot none accepted status during put 400\npayload: {\"mappings\": {\"default\": {\"properties\": {\"geoip\": {\"dynamic\": true, \"type\": \"object\", \"properties\": {\"ip\": {\"type\": \"ip\"}, \"location\": {\"type\": \"geo_point\"}}}, \"@timestamp\": {\"type\": \"date\"}, \"message\": {\"index\": \"analyzed\", \"type\": \"string\"}}}}}\nTraceback (most recent call last):\n  File \"/usr/cz-elasticsearch/scripts/backup_restore.py\", line 216, in <module>\n    main()\n  File \"/usr/cz-elasticsearch/scripts/backup_restore.py\", line 213, in main\n    put_everything(args, \"http://localhost:9300\")\n  File \"/usr/cz-elasticsearch/scripts/backup_restore.py\", line 81, in put_everything\n    payload_with_meta = json.loads(line)\n  File \"/usr/lib/python3.5/json/init.py\", line 319, in loads\n    return _default_decoder.decode(s)\n  File \"/usr/lib/python3.5/json/decoder.py\", line 339, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n  File \"/usr/lib/python3.5/json/decoder.py\", line 357, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nThu Sep 28 12:10:29 UTC 2017\nDb restore done\n<13>Sep 28 12:10:29 cz-restore: The services will be running again momentarily\nroot@envy-172-17-140-1:/mnt/data# "
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I of course can't replicate this on my env"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1507204824390
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I tried both normal and HA"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1507204837672
            }
        ]
    },
    {
        "key": "SA-6150",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "paragraph",
                    "content": [
                        {
                            "type": "text",
                            "text": "Right now it can be hard to see what id corresponds to what test:"
                        }
                    ]
                },
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "thomas@thomas:~$ for client in linux windows osx fedora android; do aitorbot test create -d aitorbot 403 --client $client -t testing_aitorbot_on_$client; done\nthomas:\n    id:   eb550063-0a52-49c9-9225-3521cf4609d6\n    url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309530\nthomas:\n    id:   b440c81b-9a35-4ede-b1fb-dfa58e661e7e\n    url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309536\nthomas:\n    id:   7d1e416f-03f5-475e-9a23-501f9c040765\n    url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309541\nthomas:\n    id:   575b35a8-dfeb-4bb1-984f-8d723e1aacab\n    url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309545\nthomas:\n    id:   d9b10fcb-45db-41c8-a5e0-8c83d5c04ffa\n    url:  https://testrail.ad.cryptzone.com:443/index.php?/plans/view/309549"
                        }
                    ]
                }
            ],
            "version": 1
        }
    },
    {
        "key": "SA-6145",
        "description": {
            "type": "doc",
            "content": [
                {
                    "type": "codeBlock",
                    "attrs": {},
                    "content": [
                        {
                            "type": "text",
                            "text": "Err:4 https://dl.yarnpkg.com/debian stable InRelease             \n  The following signatures couldn't be verified because the public key is not available: NO_PUBKEY E074D16EB6FF4DE3\nGet:6 https://deb.nodesource.com/node_6.x stretch/main amd64 Packages [1005 B]                                                                                                        \nFetched 17.1 kB in 6s (2719 B/s) "
                        }
                    ]
                }
            ],
            "version": 1
        },
        "comments": [
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "could you give some background here "
                                },
                                {
                                    "type": "text",
                                    "text": "Salvatore Tomaselli",
                                    "marks": [
                                        {
                                            "type": "link",
                                            "attrs": {
                                                "href": "http://got-youtrack.agi.appgate.com:8112/users/salvatore.tomaselli",
                                                "title": "salvatore.tomaselli"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "text",
                                    "text": "?"
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1507542489744
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "I tried to run updates on the chroot. This is needed since we statically link stuff, so we might need the security fixes that get released later on."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "salvatore.tomaselli",
                "created": 1507551585395
            },
            {
                "body": {
                    "type": "doc",
                    "content": [
                        {
                            "type": "paragraph",
                            "content": [
                                {
                                    "type": "text",
                                    "text": "aha ok. generally we create chroot from scratch, so not a big deal."
                                }
                            ]
                        }
                    ],
                    "version": 1
                },
                "author": "natan.abolafya",
                "created": 1507552079091
            }
        ]
    }
]